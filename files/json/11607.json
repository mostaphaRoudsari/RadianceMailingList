{"body": "\nDear list,\n\nI am trying to format HDR images produced from a Canon A570 digital camera\nwith a 180 deg fisheye converter attached.\n\nThe images are 1600,1200 pixels (x,y) and have the circular \"fisheye\" view\ncentered in the image.\n\nI need to do three operations:\n\n1) crop image down to a square shape, so that it bounds the hemispherical\nview of the lens and\n\n2) filter the cropped image down to less than 800 x 800 pixels to input to\nevalglare (i can do this with pfilt -1, and this works fine so long as\npcompos is not involved)\n\n3) then i need to edit the image file's header info and trick it into\nthinking it has a 180 view (since the camera does not know it has a\nconverter attached!) e.g.\n\n\nVIEW= -vta -vh 180 -vv 180 -vp 0 0 0 -vd 1 0 0 -vu 0 0 1\n\n\nRight now i am perplexed when i use pcompos to crop the image via:\n\npcompos -x 1200 input/$image -200 0 > output/{$image}\n\nThe result is a new \"cropped\" hdr image that looks great from a cropping\nstandpoint, but the luminance values are much lower when viewed in\nphotosphere (compared to the orig image)\n\nMy guess is there is something happening to the header:\n\nhere is the original header:\n\n\n#?RADIANCE\nCAMERA= Canon Canon PowerShot A570 IS version v.0\nEXPOSURE=8.278360e-02\nVIEW= -vtv -vh 52.456387 -vv 40.558973\nCAPDATE= 2010:10:07 10:41:59\nhdrgen created HDR image from 'IMG_0450.JPG' 'IMG_0449.JPG' 'IMG_0448.JPG'\n'IMG_0447.JPG' 'IMG_0446.JPG' 'IMG_0445.JPG' 'IMG_0444.JPG' 'IMG_0443.JPG'\n'IMG_0442.JPG' 'IMG_0441.JPG'\nPRIMARIES= 0.6400 0.3300 0.3000 0.6000 0.1500 0.0600 0.3127 0.3290\nFORMAT=32-bit_rle_rgbe\n\n-Y 1200 +X 1600\n\n................ and the result after the pcompos ...................\n\n#?RADIANCE\nCAPDATE= 2011:03:01 06:30:57\nGMT= 2011:03:01 14:30:57\ninput/201010071045.hdr:\nCAMERA= Canon Canon PowerShot A570 IS version v.0\nEXPOSURE=8.778544e-02\nVIEW= -vtv -vh 52.456387 -vv 40.558973\nCAPDATE= 2010:10:07 10:46:59\nhdrgen created HDR image from 'IMG_0460.JPG' 'IMG_0459.JPG'\n'IMG_0458.JPG' 'IMG_0457.JPG' 'IMG_0456.JPG' 'IMG_0455.JPG'\n'IMG_0454.JPG' 'IMG_0453.JPG' 'IMG_0452.JPG' 'IMG_0451.JPG'\nPRIMARIES= 0.6400 0.3300 0.3000 0.6000 0.1500 0.0600 0.3127 0.3290\npcompos -x 1200 input/201010071045.hdr -200 0\nFORMAT=32-bit_rle_rgbe\n\n-Y 1200 +X 1200\n\n..................................................................\n\nWhile on the subject of header manipulation, I am eager for suggestions\nfor how to edit lines of the header. In my case i want to replace the\noriginal view line\n\nVIEW= -vtv -vh 52.456387 -vv 40.558973\n\n\nwith\n\n\nVIEW= -vta -vh 180 -vv 180 -vp 0 0 0 -vd 1 0 0 -vu 0 0 1\n\n\n\nI have tried doing this \"manually\" in BBedit and Xcode, but get an\n\"unexpected end of file\" error\n\n\n\nAny suggestions are appreciated!\n\n-Kyle\n\nKyle Konis\nPh.D. Candidate\nDept. of Architecture (Building Science)\nUniversity of California, Berkeley\nResearch Assistant, Lawrence Berkeley National Lab\nTel. (206) 303 9786\nEmail: kkonis at berkeley.edu\n\n\n\n\n", "replyTo": "", "sender": "kkonis at berkeley.edu", "isquestion": true, "tags": [], "id": "<f9fe629e83666d76139edc0398c8513d.squirrel@calmail.berkeley.edu>", "refs": [], "datetime": "Tue, 1 Mar 2011 06:48:48 -0800", "email": "kkonis at berkeley.edu", "subject": "[Radiance-general] image formatting for input to evalglare"}