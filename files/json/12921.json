{"body": "\nHi Jack,\n\nIt would be nice if rcalc were smart about strings, but all it can really do is pass them from one place in the input to another place in the output.  It never looks at them, really, and none of the operations supports strings.\n\nRegarding your second idea of including the material along with the value, you can do this with rcalc as written.  You would have to go for an ascii output, like so:\n\nvwrays -ff [args] | rtrace -h `vwrays -d [args]` -ffa -omv [rargs] octree | sed -f alphas.txt > alphaval.txt\n\nThe file \"alphas.txt\" would contain something like:\n\ns/^mat1\t/0.35\t/\ns/^mat2\t/1.0\t/\ns/^mat3\t/0.0\t/\ns/^mat4\t/0.75\t/\n[etc.]\n\nThis would replace each material with an associated alpha value.  From there, you would have to convert to 16-bit RGBA or something if you wanted to load it into Photoshop, and I think you would need a C program for that.  Alternately, you could split the file using rcalc and pvalue like so:\n\nrcalc -e '$1=$1' -of alphaval.txt | pvalue -h -y $YRES +x $XRES -df -b > alpha.hdr\nrcalc -e '$1=$2;$2=$3;$3=$4' -of alphaval.txt | pvalue -h -y $YRES +x $XRES -df > image.hdr\n\nPhotoshop can load, convert, and combine HDR files, though you probably have to change from 32-bit to 16-bit mode when you do.  Just make sure not to use any of the fancy tone-mappers when you do....\n\nI'm not sure the above would be any faster than Iebele's current method, but it would avoid separate rtrace steps.  This permits you to use the -pj option of vwrays safely, as you won't risk sampling one object in one run and another object in another.  (Pseudorandom sequences should guarantee this in any case, but I'm not sure they do on all systems.)\n\nCheers,\n-Greg\n\n\n\n", "replyTo": "<4F48EEE5.3070802@visarc.com>", "sender": "Greg Ward", "isquestion": false, "tags": [], "id": "<044591CE-E720-47C8-B018-3F4525E70DB9@lmi.net>", "refs": ["<CAD_et2V0-_7c-CJkuOmVtReznQ_HYbr1F5iZOoTFmJnTHTuhpA@mail.gmail.com>", "<4F47E8C6.3000902@visarc.com>", "<E43A469A-DD3B-46C1-A274-8CCF024DD498@yahoo.it>", "<A366C96E-16D7-49C3-A781-FB12FCF9E757@lbl.gov>", "<10A70AB5-2B76-43CE-8E35-DAA535B5D0B8@lbl.gov>", "<CAD_et2WuSADPX3i2HoQac8jw7WrgcZbbAw4AKUR8QhN0QbZDUQ@mail.gmail.com>", "<4F48EEE5.3070802@visarc.com>"], "datetime": "Sat, 25 Feb 2012 09:28:26 -0800", "email": "gregoryjward at gmail.com", "subject": "[Radiance-general] Generating alpha channels using vwrays andrtrace"}