{"body": "\nWell, thanks a lot folks, for your comments on this. Jacks suggestion has\nbeen used over years, but recently we started using tmeshes, and because of\nthat parts of the octree is frozen. So we had to find some other solution,\nwithout messing around with multiple material files for each tmesh. I've\ntried both Gregs and Andys suggestions and they both work really smooth.\nWhen running the command in a bash script I found awk performing about\n25-30% faster as sed. See below how the commands are put in bash (not\nchecking argument values etc.) and their timed outputs pasted thereafter.\n\nThere remain some issues in the script when rendering non-square images\n(like 1920x1080 HD), but that will be worked out. All together this has all\nbeen very helpful,\n\nCheers,\n\nIebele\n\n\n--- ralpha script  ---\n\n#!/bin/bash\n\nif ( ! getopts \":v:m:x:y:o:\" opt ); then\necho \"Usage: `basename $0` -v viewfile -m modifier -x xres -y yres\n-o octree\" >&2\nexit\nfi\n\nwhile getopts \"v:m:x:y:o:\" opt; do\ncase $opt in\nv)      viewfile=$OPTARG\n;;\nm)      modifier=$OPTARG\n;;\nx)      xres=$OPTARG\n;;\ny)      yres=$OPTARG\n;;\no)      octree=$OPTARG\n;;\nesac\ndone\n\n\necho \"using awk\" >&2\ntime vwrays -ff -vf $viewfile -x $xres -y $yres | \\\nrtrace `vwrays -d -vf $viewfile -x $xres -y $yres`  -ffa -om\n$octree  | \\\nawk -v v1=$modifier '{if( $1 == v1 ) print 1.0; else print 0.0;}'\n| \\\npvalue +x $xres -y $yres -h -da -b -r\n\necho \"using sed\" >&2\ntime vwrays -ff -vf $viewfile  -pa 0 -x $xres -y $yres | \\\nrtrace -h -x $xres -y $yres  -ffa -om $octree  | \\\nsed -e \"s/^$modifier/1/\" -e \"s/^[^1].*$/0/\" | \\\npvalue -h -r -b -d -x $xres -y $yres\n\n\n--- output --\n\n./ralpha -v hermitage_brug01.vp -m water -x 16000 -y 16000 -o export.oct >\n/dev/null\n\nusing awk\nreal    5m21.743s\nuser    8m51.873s\nsys     0m7.116s\n\nusing sed\nreal    7m55.060s\nuser    13m41.563s\nsys     0m5.199s\n\n\n\n\n\n\n2012/2/25 Andy McNeil <amcneil at lbl.gov>\n\n-------------- next part --------------\nAn HTML attachment was scrubbed...\nURL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20120225/ca57056f/attachment.html>\n\n", "replyTo": "<10A70AB5-2B76-43CE-8E35-DAA535B5D0B8@lbl.gov>", "sender": "Iebele Abel", "isquestion": false, "tags": [], "id": "<CAD_et2WuSADPX3i2HoQac8jw7WrgcZbbAw4AKUR8QhN0QbZDUQ@mail.gmail.com>", "refs": ["<CAD_et2V0-_7c-CJkuOmVtReznQ_HYbr1F5iZOoTFmJnTHTuhpA@mail.gmail.com>", "<4F47E8C6.3000902@visarc.com>", "<E43A469A-DD3B-46C1-A274-8CCF024DD498@yahoo.it>", "<A366C96E-16D7-49C3-A781-FB12FCF9E757@lbl.gov>", "<10A70AB5-2B76-43CE-8E35-DAA535B5D0B8@lbl.gov>"], "datetime": "Sat, 25 Feb 2012 12:41:24 +0200", "email": "iabel at iebele.nl", "subject": "[Radiance-general] Generating alpha channels using vwrays andrtrace"}