{"refs": [], "id": "<84F05BA9118BBD4A8FC6409808CE266C23444B@ENGRMAIL2.engr.psu.edu>", "subject": "[Radiance-general] New rtcontrib program", "email": "adiance-general-bounces@radiance-online.org on behalf of Greg Ward", "body": "\nHi,\n\nAfter installing mksource and rcontrib, mkillum does not finish any more. There seems to be a conflict. Mkillum without -ab 1 works fine, but anything else is now disfunctional, meaning, it just runs without end. Can others please check if they have similar experiences?\n\nThanks\n\nMartin Moeck\n\n\n\n\n-----Original Message-----\nSent: Thu 5/26/2005 3:17 PM\nTo: Radiance general discussion\nCc:\n\n\nHi All,\n\nSomewhat related to the light pipe discussion, I have just completed\nwork on a new utility called \"rtcontrib,\" for computing arbitrary\nlight contributions.  This is a culmination of earlier work I did on\nrtrace to allow for the correct reporting of ray weights in trace\noutput (the new -oTW option), which I mentioned on radiance-dev a\nlittle over a month ago.  The benefits of this facility will not\nreally be felt or known until a third (C-shell script) layer is added\nfor calculating daylight coefficients and the like.  Right now, the\nsimplest thing you can do with rtcontrib is arrive at a set of images\ncorresponding to the different light sources in your scene, such that\nyou can recombine them with dimming multipliers to simulate lighting\ncontrols.  An example of this is given in the man page, attached.\n\nRtcontrib can also be used by the more adventurous among you to\ncompute input/output relations for devices such as light pipes and\nshading systems, although I have yet to test such an approach,\nmyself.  I expect we'll be learning more about what one can do with\nthis in the coming months, and I hope to work with Christoph Reinhart\nand John Mardaljevic on standardizing daylight coefficient\ncalculations for starters.\n\n-Greg\n\n---------\n\nRTCONTRIB(1)\nRTCONTRIB(1)\n\n\n\nNAME\nrtcontrib - compute contributions in a RADIANCE scene\n\nSYNOPSIS\nrtcontrib  [ -n nprocs ][ -e expr ][ -f source ][ -o fspec ]\n[ -b binv ]\n-m mod ..  [ $EVAR ] [ @file ] [ rtrace options ] octree\n\nDESCRIPTION\nRtcontrib computes ray contributions  (i.e.,  color\ncoefficients)  for\nobjects  whose  modifiers  are named in one or more -m\nsettings.  These\nmodifiers are usually materials associated with light\nsources  or  sky\ndomes, and must directly modify some geometric primitives to\nbe consid-\nered in the output.  The output of rtcontrib has many\npotential  uses.\nSource contributions can be used as components in linear\ncombination to\nreproduce any desired variation, e.g., simulating lighting\ncontrols  or\nchanging  sky  conditions  via  daylight coefficients.  More\ngenerally,\nrtcontrib can be used to compute arbitrary  input-output\nrelationships\nin  optical  systems,  such  as  luminaires,  light  pipes,\nand shading\ndevices.\n\nRtcontrib calls rtrace(1) to calculate the contributions for\neach input\nray,  and the output tallies are sent to one or more files\naccording to\nthe -o specification.  If an output specification contains a\n\"%s\"  for-\nmat,  this will be replaced by the modifier name.  The -b\noption may be\nused to further define a \"bin number\" within each object if\nfiner reso-\nlution is needed, and this will be applied to a \"%d\" format\nin the out-\nput file specification if present.  The actual bin number\nis  computed\nat  run  time  based  on  ray  direction  and  surface\nintersection, as\ndescribed below.  The most recent -b and -o options to the\nleft of each\n-m  setting  affect only that modifier.  (The ordering of\nother options\nis unimportant.)\n\nIf a -b expression is defined for a particular modifier, the\nbin number\nwill  be  evaluated  at run time for each ray contribution\nfrom rtrace.\nSpecifically, each ray's world intersection point will be\nassigned  to\nthe  variables Px, Py, and Pz, and the normalized ray\ndirection will be\nassigned to Dx, Dy, and Dz.  These parameters may be combined\nwith def-\ninitions given in -e arguments and files read using the -f\noption.  The\ncomputed bin value will be rounded to the nearest whole\nnumber.   This\nmechanism  allows the user to define precise regions or\ndirections they\nwish to accumulate, such as  the  Tregenza  sky\ndiscretization,  which\nwould  be  otherwise  impossible to specify as a set of\nRADIANCE primi-\ntives.  The rules and predefined functions available for\nthese  expres-\nsions are described in the rcalc(1) man page.\n\nIf  no  -o  specification is given, results are written on\nthe standard\noutput in order of modifier (as given on the  command  line)\nthen  bin\nnumber.  Concatenated data is also sent to a lone output file\n(i.e., an\ninitial -o specification without formatting strings).  If a \"%\ns\" format\nappears  but  no  \"%d\" in the -o specification, then each\nmodifier will\nhave its own output file, with multiple values per record in\nthe  case\nof  a  non-zero  -b  definition.  If a \"%d\" format appears\nbut no \"%s\",\nthen each bin will get its own output file, with  modifiers\noutput  in\norder  in each record.  For text output, each RGB coefficient\ntriple is\nseparated by a tab, with a newline at the end of each ray\nrecord.   For\nbinary  output  formats,  there is no such delimiter to mark\nthe end of\neach record.\n\nInput and output format defaults to plain text, where each\nray's origin\nand  direction (6 real values) are given on input, and one\nline is pro-\nduced per output file per ray.  Alternative data\nrepresentations may be\nspecified  by  the  -f[io] option, which is described in the\nrtrace man\npage along with the associated -x and -y resolution\nsettings.  In  par-\nticular, the color ('c') output data representation together\nwith posi-\ntive dimensions for -x and -y will  produce  an\nuncompressed  RADIANCE\npicture, suitable for manipulation with pcomb(1) and related\ntools.\n\nIf  the  -n  option  is specified with a value greater than\n1, multiple\nrtrace processes will be used to accelerate  computation  on\na  shared\nmemory  machine.  Note that there is no benefit to using more\nprocesses\nthan there are local CPUs available to do the work, and  the\nrtcontrib\nprocess itself may use a considerable amount of CPU time.\n\nOptions  may be given on the command line and/or read from\nthe environ-\nment and/or read from a file.  A command argument beginning\nwith a dol-\nlar  sign  ('$')  is  immediately replaced by the contents of\nthe given\nenvironment variable.  A command argument beginning  with\nan  at  sign\n('@') is immediately replaced by the contents of the given file.\n\nEXAMPLES\nTo  compute  the  proportional  contributions  from sources\nmodified by\n\"light1\" vs. \"light2\" on a set of illuminance values:\n\nrtcontrib -I+ @render.opt -o c_%s.dat -m light1 -m light2 \\\nscene.oct < test.dat\n\nTo generate a pair of images corresponding to these two\nlights' contri-\nbutions:\n\nvwrays -ff -x 1024 -y 1024 -vf best.vf | rtcontrib -ffc \\\n`vwrays -d -x 1024 -y 1024 -vf best.vf` @render.opt \\\n-o c_%s.pic -m light1 -m light2 scene.oct\n\nThese images may then be recombined using the desired outputs\nof light1\nand light2:\n\npcomb  -c  100  90  75  c_light1.pic  -c 50 55 57\nc_light2.pic \\\n\nTo compute an array of illuminance contributions according\nto  a  Tre-\ngenza sky:\n\nrtcontrib -b tbin -o sky.dat -m skyglow -b 0 -o ground.dat \\\n-m groundglow @render.opt -f tregenza.cal scene.oct < test.dat\n\nAUTHOR\nGreg Ward\n\nSEE ALSO\ncnt(1), getinfo(1), pcomb(1), pfilt(1), ra_rgbe(1), rcalc(1),\nrpict(1),\nrtrace(1), vwrays(1), ximage(1)\n\n\n\nRADIANCE                            5/25/05\nRTCONTRIB(1)\n\n\n_______________________________________________\nRadiance-general mailing list\nRadiance-general@radiance-online.org\nhttp://www.radiance-online.org/mailman/listinfo/radiance-general\n\n\n-------------- next part --------------\nA non-text attachment was scrubbed...\nName: not available\nType: application/ms-tnef\nSize: 17350 bytes\nDesc: not available\nUrl : http://radiance-online.org/pipermail/radiance-general/attachments/20050605/1ed010b1/attachment-0001.bin\n", "isquestion": true, "replyTo": "", "tags": [], "sender": "adiance-general-bounces@radiance-online.org on behalf of Greg War", "datetime": "Sun Jun  5 17:09:24 2005"}