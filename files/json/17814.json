{"body": "\nComments inline, but I agree with the general sentiment that it's simpler (and more accurate) to apply genBSDF and other tools already suited to the purpose.  (Note that the \"bsdfquery\" program can be used to extract any desired BSDF angles.)  The genBSDF program employs rcontrib, which is much more powerful (and efficient) than using rtrace.  For single materials with no texture and no geometry, what you are doing should work.\n\n\nYou should actually point the direction vector \"straight up\" along the normal of your surface, not towards the light source.  This is the cause of your discrepancy between L1 and L2.  Illuminance is measured at the surface, and should account for the cosine angle to the light source(s).\n\n\nSee above.  L2 should match L1 when L1's vector matches surface normal, provided your other calculation options match.\n\n\nIlluminance = Irradiance convolved with Vlambda using a peak efficacy of 683 lumens/watt at 555 nm.  Same for luminance and radiance.\n\n\nSince the BRDF is a differential quantity, it can evaluate to greater than 1.0.  Theoretically, it can even be infinite if the surface is purely specular, although the integrated value will be less than 100%\n\n\n\n", "replyTo": "Subject: [Radiance-general] Rtrace for Radiance & Irradiance Calc.", "sender": "Greg Ward", "isquestion": false, "tags": [], "id": "<783CFECA-A7DF-4A4B-953F-1F2C6FB2AB25@lmi.net>", "refs": ["<AE55A995167B224DBBFA16500E3AB9B3047C1283@NDJSMBX202.ndc.nasa.gov>"], "datetime": "Thu, 9 Apr 2015 09:45:07 -0700", "email": "gregoryjward at gmail.com", "subject": "[Radiance-general] Rtrace for Radiance & Irradiance Calc."}