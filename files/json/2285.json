{"refs": ["<44275907.1060204@oriel.ox.ac.uk>\t<1F9D2A0E-480A-419C-B8DD-C69445718C6E@gmail.com>\t<4428173E.4050909@oriel.ox.ac.uk>", "<D10F8691-3A5F-4142-A92D-F3B454AF5CEC@gmail.com>", "<44283E82.1020102@oriel.ox.ac.uk>"], "id": "<BB7EBF9F-50CA-417D-9286-8C90CF482682@gmail.com>", "subject": "[Radiance-general] specifying sources", "email": "gregoryjward at gmail.com", "body": "\nHi Will,\n\n\nI gave you the result for a 3200K black body.  To compute the same\nfor other temperatures, illumcal.csh should work.  I get weird\nresults for the correlated color temperature, and I think there is\nsomething wrong with that part of the calculation, but the CIE (x,y)\nvalues seem OK.  If I run:\n\n( echo '# Black Body at 3200K' ; cnt 100 | rcalc -e 'lambda=(780-350)/\n99*$1+350' -f blackbody.cal\n-e temp:3200 -e '$1=lambda;$2=u(lambda,temp)' ) > bb3200.dat\ncsh -f illumcal.csh bb3200.dat\n\nI get nearly the same results as before.\n\n\nCIE (x,y) chromaticity coordinates can be converted to CIE XYZ if you\nhave a Y value using:\n\nX = x/y*Y;\nZ = (1-x-y)/y*Y;\n\nSimilarly, you can get CIE (x,y) from XYZ using:\n\nx = X/(X+Y+Z);\ny = Y/(X+Y+Z);\n\n\nYes, that is correct.  It also means that they should have done you\nthe favor of premultiplying the source and filter spectra, so you\ndon't have to.\n\n\nYou should premultiply, not divide, your source and scene colors, and\npreferably do this over each wavelength of the visible spectrum.  If\nyou don't have spectral data, then yes, you will just be multiplying\nthe (Sharp) RGB values.  The intensity of the source should not be\ntaken into the scene colors, so that you don't have reflectances\ngreater than 1, which would be a disaster.\n\n\nYou don't need to \"regain\" the color information, as you have\neffectively accomplished a vonKries white balance during rendering.\n\n-Greg\n\n", "isquestion": false, "replyTo": "Subject: [Radiance-general] specifying sources", "tags": [], "sender": "Gregory J. Ward", "datetime": "Mon Mar 27 23:01:42 2006"}