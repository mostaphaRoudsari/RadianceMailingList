{"refs": ["<47F0C242.8000709@poczta.fm>", "<A1406DFC-B4FB-45AB-BF6C-8321010A3094@lmi.net>"], "id": "<48106DDB.8000200@poczta.fm>", "subject": "[Radiance-general] Re: rtrace: -ospec options", "email": "arcin.gawronski at poczta.fm", "body": "\nHi Greg!\n\nThanks for leads. I tried the settings you suggested but problem still\noccured. I continued my search and I found out what was wrong: the -I\nparameter! I used -i and I get as earlier table of zeros plus one\ncorrect value (8829, this same value I get when I use only -ov). The\nproblem is still with distance. For this zero values sometimes distance\nl equals 0 (most of rays) and sometimes it's normal value (from more or\nless 1.0005 to  1.5955). For non-zero value (8829) distance l=0.01).\n\nI also noticed, that when I use -me parameter (the value of -me 0.2 0.2\n0.2 is not so large, I mean for test calculations, not for real media)\nRadiance counts the L(s) value using l=1.156, this is exactly average of\ndistances l for this zero values! This is quite strange to me...\n\nAnyway, this case is solved.\n\nFurther contemplations of problem:\n\nI started this discussion, because I want to calculate some formula.\nFirst I thought, that it will be possible to compute it using results\nget from rtrace (value and distance for single ray) but now I know it's\nmuch more complicated. In the file with results there are a lot of data\nthat are finally casted away (aren't they?), so I think that operations\non this data is not a good idea.\n\nMy new concept is to write(change?) a few additional lines to code of\n\"rayparticipate\" function. However I don't really understand this code... :(\nI can't find where is hide this formula\nL(s)=L(0)*exp(-ext*s)    (assume albedo=0)\nI would like to add to formula above some value according to expression\nL1(s)=L(s)+[L(0)-L(s)]*[1-exp(-ext*s)]\nI want \"rayparticipate\" function to return me this L1(s) value instead\nof L(s). Is this possible? Could you tell me where and what I have to\nadd/change in code of this function? (I attach the code below)\nI also thought about write new function similar to \"rayparticipate\" but\nit possibly required more changes (not in raytrace.c but also in a few\nanother files).\n\nI will be very thankful for help.\nRegards, Marcin\n\n\nextern void\nrayparticipate(            /* compute ray medium participation */\nregister RAY  *r\n)\n{\nCOLOR    ce, ca;\ndouble    re, ge, be;\n\nif (intens(r->cext) <= 1./FHUGE)\nreturn;                /* no medium */\nre = r->rot*colval(r->cext,RED);\nge = r->rot*colval(r->cext,GRN);\nbe = r->rot*colval(r->cext,BLU);\nif (r->crtype & SHADOW) {        /* no scattering for sources */\nre *= 1. - colval(r->albedo,RED);\nge *= 1. - colval(r->albedo,GRN);\nbe *= 1. - colval(r->albedo,BLU);\n}\nsetcolor(ce,    re<=FTINY ? 1. : re>92. ? 0. : exp(-re),\nge<=FTINY ? 1. : ge>92. ? 0. : exp(-ge),\nbe<=FTINY ? 1. : be>92. ? 0. : exp(-be));\nmultcolor(r->rcol, ce);            /* path extinction */\nif (r->crtype & SHADOW || intens(r->albedo) <= FTINY)\nreturn;                /* no scattering */\nsetcolor(ca,\ncolval(r->albedo,RED)*colval(ambval,RED)*(1.-colval(ce,RED)),\ncolval(r->albedo,GRN)*colval(ambval,GRN)*(1.-colval(ce,GRN)),\ncolval(r->albedo,BLU)*colval(ambval,BLU)*(1.-colval(ce,BLU)));\naddcolor(r->rcol, ca);            /* ambient in scattering */\nsrcscatter(r);                /* source in scattering */\n}\n\n\nGreg Ward pisze:\n\n----------------------------------------------------------------------\nPoprowadz swoj klub do zwyciestwa!\nSprawdz >>> http://link.interia.pl/f1d76\n\n\n", "isquestion": false, "replyTo": "Subject: [Radiance-general] Re: rtrace: -ospec options", "tags": [], "sender": "=?UTF-8?B?TWFyY2luIEdhd3JvxYRza2k=?=", "datetime": "Thu Apr 24 04:24:16 2008"}