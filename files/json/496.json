{"refs": [], "id": "", "subject": "[Radiance-general] Re: Warning message and glass definition", "email": "adiance-general@radiance-online.org", "body": "Message-ID: <6009952A-F6F6-11D7-A89B-000A956D40C8@lmi.net>\n\nThanks, Rob, for responding to Arvinder's questions.  I have nothing to\nadd to your comments on the warning, but let me add a bit to your\nresponse on glazings.\n\nFirst, I agree that Arvinder should go with the glass type.  The\nlibrary glass type is probably not appropriate, and you are better off\ndefining your own.  The specification you came up with:\n\nvoid glass class_lglass\n0\n0\n3\n0.927 0.927 0.927\n\nis very close to correct.  I assume you used the formula recommended in\nthe Radiance reference manual, or else the identical one from Chapter 4\n(page 240) of \"Rendering with Radiance\":\n\n{ ---------------- trans1.52.cal --------------- }\nsq(x) : x*x;\nn = 1.52;\t\t\t\t{ index of refraction }\nrn = sq((1-n)/(1+n));\t\t{ normal reflectivity }\n{ normal transmissivity }\ntn = (sqrt(sq(sq(1-rn))+4*sq(rn*Tn))-sq(1-rn))\n/ (2*rn*rn*Tn);\n\nI actually got a slightly different value when I used 85% as the\ntransmittance:  tn=0.926 for Tn=0.85.  However, the part that isn't\ndocumented for you is the formula for normal reflectance, which is:\n\nRn=rn+rn*(1-rn)*sq(tn)*(1-sq(tn)*sq(rn))/(2-sq(tn)*sq(rn));\n\nIf you add this to the above file and run calc on, you'll find that by\nplugging in an index of refraction of 1.52 (the default for glass),\nyour normal reflectance is 6% rather than your desired 5%.  To get a\nvalue of 5%, I had to play around with the index of refraction in calc\nuntil I got something close, as the formula is rather nasty to solve\nexactly.  What I came up with was n=1.465, which gives a transmissivity\nof 0.913.  Your glass specification then becomes:\n\nvoid glass class_lglass\n0\n0\n4\n0.913 0.913 0.913 1.465\n\nThis is the specification you should use.  Notice the extra argument to\nspecify the index of refraction.\n\nIt would be much simpler if Radiance took the normal reflectance and\ntransmittance of the glazing and figured out the transmissivity and\nindex of refraction for you.  The only downside is that you wouldn't\nreally know whether the values you'd be giving it were physically\nrealizable.  You might want to give a transmittance of 90% and a\nreflectance of 8%, thinking that were perfectly reasonable as it\ndoesn't sum to 100%.  Oddly enough, no such pane of glass exists or\ncould be made in the real world.  This is why the specification is for\nthe normal transmissivity (the light not absorbed in one pass through\nthe glass interior), which is legal anywhere between 0 and 1, and the\nindex of refraction, which is well-studied and available in tables and\ncan be inferred by measurements.\n\nThe exact behavior of glass as a function of angle is a bit\ncomplicated, even though it is physically one of the simplest materials\nto model.  Section 3.3 of\n<http://floyd.lbl.gov/radiance/refer/materials.pdf> gives the full\nformula if you feel like diving into the deep end, as it seems you do.\n\n-Greg\n\n\n", "isquestion": false, "replyTo": "Subject: [Radiance-general] Re: Warning message and glass definiti", "tags": [], "sender": "Greg Ward", "datetime": "Sat, 4 Oct 2003 22:40:06 -0700"}