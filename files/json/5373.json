{"body": "\nsome UV stuff here and hopefully not too many mistakes...\n\n\n\nhttp://web.mac.com/geotrupes/iWeb/Main%20site/RadBlog/3690C181-7F9F-43AD\n-B5B2-A5D239AD503E.html\n\n\n\nG.\n\n\n\n\n\n________________________________\n\n[mailto:radiance-general-bounces@radiance-online.org] On Behalf Of Jack\nde Valpine\nSent: 03 April 2007 18:10\nTo: Radiance general discussion\n\n\n\nHi Iebele,\n\nTo use local u,v coordinate mapping (Lu,Lv) you need to use obj2mesh\nrather than obj2rad.\n\nHere is the process for making a mesh element:\n\nDefine mats.tree.rad using simple materials first as an example. The\nnames of the materials must correspond to the names of the materials\nindicated for the .obj geometry (take a look in the .mtl file to get the\nnames).\n\nmats.tree.rad:\n\nvoid plastic Bark\n0\n0\n5 1 1 1 0 0\n\nvoid plastic Leaf\n0\n0\n5 1 1 1 0 0\n\nGenerate tree.rtm as follows:\n\nobj2mesh -a mats.tree.rad tree.obj > tree.rtm\n\nCreat tree.mesh.rad as follows:\n\ntree.mesh.rad:\n\nvoid mesh tree\n1 tree.rtm\n0\n0\n\nTest you mesh:\n\nobjview tree.mesh.rad\n\nNow lets apply more complex materials using local u,v coordinate\nmapping. To do this you need the following image data:\n\n1.\tbark.pic\n2.\taspect ratio for bark.pic (y/x), lets call it <arB>\n3.\tleaf.pic\n4.\taspect ration for leaf.pic (y/x), lets call it <arL>\n5.\tleaf.matte.pic - this is the alpha/matte channel for the leaf.\nThe correct way to setup the matte is  for white to represent the leaf\nand black to represent what is not the leaf. This means that you may\nhave to invert the matte the comes from xfrog.\n\nNow lets create the complex materials in mats.tree.rad\n\nmats.tree.rad:\n\n#BARK definition\nvoid colorpict bark.tile\n7 red green blue Bark.pic . frac(Lu) frac(Lv)*<arB>\n0\n0\n\nbark.tile plastic Bark\n0\n0\n5 1 1 1 0 0\n\n#LEAF definition\nvoid colorpict leaf.tile\n7 red green blue Bark.pic . frac(Lu) frac(Lv)*<arL>\n0\n0\n\nleaf.tile plastic leaf.map\n0\n0\n5 1 1 1 0 0\n\nleaf mixpict Leaf\n7 leaf.map void green leaf.matte.pic . frac(Lu) frac(Lv)*<arL>\n0\n0\n\nNow recompile your mesh:\n\nobj2mesh -a mats.tree.rad tree.obj > tree.rtm\n\nNow view it:\n\nobjview tree.mesh.rad\n\nYou should add Bark and Leaf to your ambient exclude file/list if you do\nnot want them in the ambient calculation. You can use tree.mesh.rad\nalong with replmarks, xform or some other method to deploy the tree\nobject in the scene.\n\nThis should work fine. Let me know if you have any questions.\n\n-Jack\n\nGregory J. Ward wrote:\n\nHi Iebele,\n\nI can't be much help on this, as I'm not familiar with the model, but\nthe general idea with local coordinates is that you don't have to do the\nmapping yourself.  It's supposedly handled by the mesh generation\nsoftware, and isn't affected by transformations as a global coordinate\nmapping would be.\n\nI hope this is a helpful clue, as it's about all I have to offer.\n-Greg\n\n\n\n\n\nThanks Greg an Jack for your excellent and very  helpfull suggestions.\n\nI now have succesfully converted the .obj file to rad, using obj2rad (\npolytrans did indeed work with Xfrog obj-files, but meshlab did not\naccept these files Lars ).\n\nHowever I can't get the mapping right. I've tried a lot, but with no\nsucces. Would you please share with me an example of the materials you\nuse for the bark and the leaves?\n\nI just don't really understand when and how to use Lu and Lv  or\nfrac(Lu) and frac(Lv) in the colorpict modifier and how these can ever\nbe placed  in a reasonable way on each triangle in the output of\nobj2rad, which in my case is like :\n\nleaf_col_leaf2 polygon leaf22836.60976\n0\n0\n9\n-0.250204           0.195593             13.838\n-1.00383          -0.956752            13.8816\n-1.21881           -0.19178            13.5622\n\nI never really understood the meaning of texture-coordinates, but at\nthis time I feel that is what  is  missing here.\n\nIs there a difference in using obj2rad and obj2mesh for this purpose ? I\ntried both but with the some odd results concerning the coordinate\nmapping.\n\n-Iebele\n\n\n_______________________________________________\nRadiance-general mailing list\nRadiance-general@radiance-online.org\nhttp://www.radiance-online.org/mailman/listinfo/radiance-general\n\n\n\n\n\n\n\n--\n# Jack de Valpine\n# president\n#\n# visarc incorporated\n# http://www.visarc.com\n#\n# channeling technology for superior design and construction\n____________________________________________________________\nElectronic mail messages entering and leaving Arup  business\nsystems are scanned for acceptability of content and viruses\n-------------- next part --------------\nAn HTML attachment was scrubbed...\nURL: http://radiance-online.org/pipermail/radiance-general/attachments/20070403/73d1104c/attachment.htm\n", "replyTo": "", "sender": "info@iebele.nl", "isquestion": true, "tags": [], "id": "<CC0B19F4C6132F4D9FDDEBF194200FB502E8843D@ldcexc02.global.arup.com>", "refs": [], "datetime": "April 3, 2007 8:39:12 AM PDT", "email": "iebele", "subject": "Re: [Radiance-general] Ambient exclude transfomed materialininstances"}