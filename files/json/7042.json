{"refs": ["<jkfq67$rjv$1@dough.gmane.org>", "<427773F0-7BBD-4D33-85D2-9884B7264A98@lmi.net>", "<BAE8E899-19AB-4B1A-AFD1-E59176B0D353@coolshadow.com>", "<25CF3DB3-AD8D-42DA-BF7D-AE605519C092@lmi.net>"], "id": "<7F18F8EB-6171-437F-B48F-1FAC3FB4BC5F@iebele.nl>", "subject": "[Radiance-general] pcomb-masking color channels", "email": "iabel at iebele.nl", "body": "\nHi Chris,\n\nI had something similar a few weeks ago, and figured out this:\n\npcomb -e 'sens=1.5;difr=(ri(1)-sens)-ri(2);difg=(gi(1)-sens)-gi(2); difb=(bi(1)-sens)-bi(2); ro=if(difr,ri(1),ri(2)); go=if(difg,gi(1),gi(2)); bo=if(difb,bi(1),bi(2)); '  sun.hdr blue_sky.hdr   |   ximage\n\nYou can tweak the \"sens\" variable to get the result you want. In my case (which was not a sky picture) the value was around 0.9 to get the result I was after. The value you need to mask the sun out of the sun.hdr image must probably be higher. If the value is too low, the result will be just a copy of blue_sky.hdr.\n\nThe command first finds the difference between pixel values for red, green and blue in sun.hdr and blue_sky.hdr. The difference (tweaked by 'sens' ) determines from which input file the pixel component value is written to the output.\n\nIf you are only interested in changing the luminance values of blue_sky.hdr at those spots where the sun (or clouds) are bright in sun.hdr you may try something like this:\n\npcomb -e 'sens=1.5;difl=(li(1)-sens)-li(2);ro=if(difl, li(1)*ri(2),li(2)*ri(2) ); go=if(difl, li(1)*gi(2),li(2)*gi(2) ); bo=if(difl, li(1)*bi(2),li(2)*bi(2) );  ' sun.hdr blue_sky.hdr | image\n\nUsing these commands, the sun (and clouds) will appear with sharp boundary edges (not blurred) in the resulting composite image.\n\nHope this helps a bit,\n\nIebele\n\n\n\nOp 30 mrt. 2012, om 07:45 heeft Greg Ward het volgende geschreven:\n\n\n-------------- next part --------------\nAn HTML attachment was scrubbed...\nURL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20120330/73d2792c/attachment.html>\n\n", "isquestion": false, "replyTo": "Subject: [Radiance-general] pcomb-masking color channels", "tags": [], "sender": "Iebele Abel", "datetime": "Fri, 30 Mar 2012 13:50:42 +0300"}