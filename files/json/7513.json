{"refs": [], "id": "", "subject": "[Radiance-general] Attempt to illuminate Paul Debevec'srnl_scene.rad with a hemispherical HDR image of the sky", "email": "kskonis at gmail.com", "body": "Message-ID: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>\n\nDear list,\n\nI am attempting to illuminate Paul Debevec's rnl_scene.rad with a\nhemispherical HDR image of a dynamic sky.\n\nAfter the tutorial in http://www.pauldebevec.com/RNL/Source/\n\nI have succeeded in simply substituting in my image, but because it is\na 180-degree fisheye image (zenith view of sky) rather than a light\nprobe, i am encountering some issues with the resulting \"reality\" of\nthe output image.\n\nI would appreciate suggestions for how to properly map this image data\nto a hemisphere (i.e. sky) in radiance to enable the image to serve\nproperly as a light source.\n\nI have included the relevant code below, and sample images on a\ntemporary webpage:\n\nhttps://sites.google.com/site/konisskytemp/\n\n\nI would appreciate any suggestions!\n\n-Kyle\n\n\n### Here is the relevant description of the lighting environment ( i\nhave only changed the image file name to source my 1350 x 1350 px\ncropped sky image)\n\n################################################################\n#\n#  Lighting Environment\n#\n################################################################\n\n# specify the probe image and how it is mapped onto geometry\n\nvoid colorpict hdr_env\n7 red green blue cropped.hdr angmap.cal sb_u sb_v\n0\n0\n\n# specify a \"glow\" material that will use this image\n\nhdr_env glow env_glow\n0\n0\n4 1 1 1 0\n\n# specify a large inward-pointing box to be mapped with the HDR environment\n\n!genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250\n\n\n\n\n\n################################################################\n### and here is angmap.cal\n################################################################\n\n{\nangmap.cal\n\nConvert from directions in the world to coordinates on the angular sphere image\n\n-z is forward (outer edge of sphere)\n+z is backward (center of sphere)\n+y is up (toward top of sphere)\n}\n\nsb_u = 0.5 + DDx * r;\nsb_v = 0.5 + DDy * r;\n\nr = 0.159154943*acos(DDz)/sqrt(DDx*DDx + DDy*DDy);\n\nDDy = Py*norm;\nDDx = Px*norm;\nDDz = Pz*norm;\n\nnorm = 1/sqrt(Py*Py + Px*Px + Pz*Pz);\n\n\n\n\n### Any suggestions for solutions would be appreciated\n\nI assume that i need to map the image to a hemisphere (representing\nthe sky dome) rather than a box\n\nperhaps passing the image as a glow rather than the standard sky glow?\n\nskyfunc glow skyglow\n0\n0\n4 1.000 1.000 1.000 0\nskyglow source sky\n0\n0\n4 0 0 1 180\n\nOr to a sphere?\n\n\n\nAnd i assume that i need a different angmap.cal file, given that this\nwas written to interpret light probe images . . . and not\nhemispherical fisheye images\n\n\n", "isquestion": true, "replyTo": "", "tags": [], "sender": "kyle konis", "datetime": "Sun, 14 Oct 2012 03:13:00 -0700"}