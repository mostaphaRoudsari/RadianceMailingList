{"refs": ["<CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>"], "id": "<CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>", "subject": "[Radiance-general] possible inconsistency of bin numbersbetween BSDF and kelms_int.cal", "email": "hujia06 at gmail.com", "body": "\nHi all:\n\nIn the Klems_init.cal file, for south window (using kbinS), the Klems\ncoordinate is defined as:\n\nz+: pointing to inside (that is, (0,1, 0)  )\nx+: pointing to West ( that is (-1, 0, 0) )\ny+: pointing to Up (0,0,1)\n\nThis coordinate is consistent with the Klems coordinate system used in\nWINDOW 6 (see this: https://dl.dropbox.com/u/15562376/coordinate.jpg). In\nthe figure, Klems coordinate system defines: x or xr points to (-1, 0, 0)\nand  y or yr points to (0, 0, 1).\n\nHowever, if using this command to calculate view matrix:\n\n$ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b *kbinS* -bn Nkbins -m\nwindow_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx\n\nwhere, kbinS defines z axis in the Klems coordinate system as (0 1 0), that\nis, pointing to room interior.\n\nThus, the bin number calculated by Klems_init.cal is actually based on z\nhemisphere <https://dl.dropbox.com/u/15562376/coordinate.jpg> (the\nhemisphere protrudes towards room). the bin number corresponds with\n\"Transmittance Front\" in BSDF xml file. For example, ray direction (-1, -1,\n0) (backward, ray travels from inside to outside room) hits the bin\n58<https://dl.dropbox.com/u/15562376/bin.jpg>\ndefined in z hemisphere because the hemisphere protrudes towards (0 1 0).\nBut ray direction (-1 -1 0) hits bin\n46<https://dl.dropbox.com/u/15562376/bin.jpg> defined in\nz reverse (i.e., zr) coordinate because the hemisphere protrudes towards (0\n-1 0) (towards outside).\n\nWhen calculating Daylighting Matrix, it still uses Klems_init.cal and\nkbinS, that is, z hemisphere coordinate system, therefore, Radiance seems\nneeding to use \"Transmission Front\", which is defined in z hemisphere.  But\ncurrently Radiance uses \"Transmission Back\" (from inside to outside), which\ndefined in zr hemisphere,\n\nSo, should we need to\n\n(a) use \"*kbinN*\" (defining z axis of Klems coordinate towards (0 -1 0) )\nand \"Transmission Back\" for south window,  or\n(b) use \"Transmission Front\" and *kbinS*?\n\nI am very confused about this. Does anyone know the possible reasons?\n\nThank you !\n\nJia\n\n\nOn Sat, Oct 20, 2012 at 8:11 AM, Jia Hu <hujia06 at gmail.com> wrote:\n\n-------------- next part --------------\nAn HTML attachment was scrubbed...\nURL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/f8332024/attachment.html>\n\n", "isquestion": false, "replyTo": "<CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>", "tags": [], "sender": "Jia Hu", "datetime": "Sat, 20 Oct 2012 16:01:27 -0400"}