{"refs": ["<CAOG+NiyM4q-bfcUKAPdCGhbunO_CRw_110D8RC5SrkgW1=7OeA@mail.gmail.com>", "<CAGhWmF7sHniEKq_w35wpgEme-MriJTjXR5WXoU9gc_8HGk-Tcw@mail.gmail.com>", "<CAK+g53CUg2cQ-uPUkm6TXmimD9_a2ma24xawwgG+ABJPsWaqVw@mail.gmail.com>", "<CAEkFE9hV9R1SQri9tCLsPRTKDfMzqmYbYpmqa=+=8XktgF7F2g@mail.gmail.com>", "<CAOG+NiwrEoAp9gtqZDsXhjrANqSxggnd=ZXwhzJEb63xxopKfw@mail.gmail.com>"], "id": "<CAGhWmF6FK4tMawMEacXVcA0v4o5GRjCdUEwehW8Cz4FYJsUTTg@mail.gmail.com>", "subject": "[Radiance-general] HDR Sky Camera @ LBNL's Flexla", "email": "the.oat.cracker at gmail.com", "body": "\nHi, I found 2 references and did a test to generate HDR image-based\nrendering, steps are explained below.\n\nBut I'm still rubbing my head to understand how the Cartesian coordinates\nor the postion vector of a point on the sky is transformed as UV\ncoordinates of the fisheye image as shown in the \"angmap.cal\" file. So,\nadvices are greatly appreciated!\n\nThanks!\nJoe\n\n\nReferences:\n1. Debevec, P. (2002). Image-based lighting. IEEE Computer Graphics and\nApplications, 22(2), 26-34. doi: 10.1109/38.988744\n2. Au, P. Y. P. (2013). HDR Luminance Measurement: Comparing real and\nsimulated data. (Master of Building Science Thesis), Victoria University of\nWellington.\n\n\nSteps:\nStep1. prepare the following 6 files and put them in the same folder\n\n#### 1.1 geom.rad ################################################\nred_plastic sphere ball\n0\n0\n4 2 2 0.5 0.5\n\nsteel sphere ball1\n0\n0\n4 2 -2 0.5 0.5\n\ngold sphere ball2\n0\n0\n4 -2 -2 0.5 0.5\n\nwhite_matte sphere ball3\n0\n0\n4 -2 2 0.5 0.5\n\ncrystal sphere ball4\n0\n0\n4 0 0 1 1\n\n!genbox gray_plastic pedestal_top 8 8 0.5 | xform -t -4 -4 -0.5\n\n\n#### 1.2 materials.mat ################################################\nvoid plastic red_plastic\n0\n0\n5 .7 .1 .1 .06 .1\n\nvoid metal steel\n0\n0\n5 0.6 0.62 0.68 1 0\n\nvoid metal gold\n0\n0\n5 0.75 0.55 0.25 0.85 0.2\n\nvoid plastic white_matte\n0\n0\n5 .8 .8 .8 0 0\n\nvoid dielectric crystal\n0\n0\n5 .5 .5 .5 1.5 0\n\nvoid plastic black_matte\n0\n0\n5 .02 .02 .02 .00 .00\n\nvoid plastic gray_plastic\n0\n0\n5 0.25 0.25 0.25 0.06 0.0\n\n\n\n#### 1.3 sky_and_ground.rad ################################################\nvoid colorpict hdr_image\n7 red green blue 140621_1530.hdr angmap.cal u v\n0\n0\n\nhdr_image glow sky_glow\n0\n0\n4 1 1 1 0\n\nsky_glow source HDR_sky\n0\n0\n4 0 0 1 180\n\n# ground\nvoid glow ground_glow\n0\n0\n4 1 1 1 0\n\nground_glow source ground\n0\n0\n4 0 0 -1 180\n\n\n#### 1.4 angmap.cal ################################################\n{\nangmap.cal\n\nConvert from directions in the world (Dx, Dy, Dz) into (u,v)\ncoordinates on the light probe image\n\n+z is up (toward top of sphere, i.e. the zenith)\n+y is North\n}\n\nd = sqrt(Dx*Dx + Dy*Dy);\n\nr = acos(Dz)/PI;\n\nu = 0.5 - Dx/d * r;\nv = 0.5 + Dy/d * r;\n\n\n#### 1.5 view.vf ################################################\n# looking towards east\n#rvu -vtv -vp -12 0 0.5 -vd 1 0 0 -vu 0 0 1 -vh 60 -vv 40\n# looking towards west\n#rvu -vtv -vp 12 0 0.5 -vd -1 0 0 -vu 0 0 1 -vh 60 -vv 40\n# looking towards north\nrvu -vtv -vp 0 -12 0.5 -vd 0 1 0 -vu 0 0 1 -vh 60 -vv 40\n# looking towards south\n#rvu -vtv -vp 0 12 0.5 -vd 0 -1 0 -vu 0 0 1 -vh 60 -vv 40\n\n\n#### 1.6 cmd.sh ################################################\noconv ./materials.mat ./sky_and_ground.rad ./geom.rad > ./scene.oct\n\nrvu -vf ./view.vf ./scene.oct\n\n#ximage ./sky.hdr\n\nrpict -x 2400 -y 2400 -t 30 -ab 1 -ar 50000 -aa 0.08 -ad 128 -as 64 -st 0\n-lw 0 -lr 8 -vf ./view.vf ./scene.oct > ./image.hdr\n\npfilt -1 -x /3 -y /3 -r 1 ./image.hdr > ./image_filtered.hdr\n\n\nStep2. put the 140621_1530.hdr file provided by LBNL (\nhttp://flexskycam.lbl.gov) in the same folder\n\nStep3. run the cmd.sh batch file to produce the rendering\n\n\n\n\nOn Sat, Jun 28, 2014 at 7:28 AM, Andrew McNeil <amcneil at lbl.gov> wrote:\n\n-------------- next part --------------\nAn HTML attachment was scrubbed...\nURL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20140629/7b56fa0b/attachment-0001.html>\n\n", "isquestion": false, "replyTo": "Subject: [Radiance-general] HDR Sky Camera @ LBNL's Flexlab", "tags": [], "sender": "Joe Smith", "datetime": "Sun, 29 Jun 2014 01:06:48 +0800"}