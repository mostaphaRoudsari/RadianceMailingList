{"body": "Carsten Bauer wrote:\n\n\n>\n> Hi Peter,\n>\n> now the time has come for me to ask one of those (probably stuuupid) \n> questions\n> which are hovering around in my mind for a loooong time:\n>\n> In irradiance runs (rpict -i ...) all surface materials are replaced \n> by the\n> mysterious \"Lambertian\" material with the reflectance set to PI.\n> This is obvious for a surface lit by a direct source (in Radiance \n> terms), setting\n> refl=PI makes the caculated radiance equal to the irradiance by the \n> classical formula.\n> (at least for the approximation of purely lambertian surfaces)\n> But as soon as ambient light is considered, i.e. the light reflected \n> (diffusely) via\n> several bounces in the scene, isn't  there an error introduced by \n> setting ALL materials'\n> reflectivity equal to PI regardless of their real properties?\n> Furthermore, specular reflections aren't considered at all with this \n> treatment.\n>\n> So, from this point of view, -i in its current form has some \n> considerable limitations\n> additionally to your mentionings...\n>\n> Hmmm ??!! \n>  \n> -Carsten\n\n\nHi Carsten,\nthe irrad code is somehow an interesting piece of C code (the MAT_CLIP \nhack is not part of current standard distribution)\n\n\n                if (do_irrad && !(r->crtype & ~(PRIMARY|TRANS)) &&\n                                (ofun[m->otype].flags & (T_M|T_X)) && \n(m->otype!=MAT_CLIP)  ) {\n                        if (irr_ignore(m->otype)) {\n#if  MAXLOOP\n                                depth--;\n#endif\n                                raytrans(r);\n                                return(1);\n                        }\n                        if (!islight(m->otype))\n                                m = &Lamb;\n                }\n\n\nIf I decode the   !(r->crtype & ~(PRIMARY|TRANS))   correctly, it \ntriggers if  crtype  has no flags set, but PRIMARY or TRANS. So any \nreflected or ambient ray will see the original materials. Light sources \nwill not be \"lamberted\" too. The core idea is \"lambert\" a surface only \nfor the first ray coming from the eye (PRIMARY), while all other calcs \ngo on as usual.\nHowever, algorithms for the surface in question will be influenced by \nthe substitution (e.g. no ambient calcs for glass, no speculars for \nlambertian).\n\n\nI trust Greg has further insights and/or corrections.\n-Peter\n\n\n\n\n pab-opto, Freiburg, Germany, www.pab-opto.de\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-dev/2003-September/000199.html).</sup>", "attachments": [], "created_by_name": "Peter Apian-Bennewitz", "created_at": "September 05, 2003 at 12:13PM", "created_by": "Peter_Apian-Bennewitz", "parent_id": "radiance-dev_000191", "id": "radiance-dev_000199"}