{"body": "Hi Peter,\n\n\nThe declaration for lseek() is done manually in rtio.h following an \ninclusion of <sys/types.h>, which is included by standard.h, which is \nincluded by holo.h (and thence by rholo.h).  So, it should be declared \nproperly.  I logged onto radiance-online and checked it with cc -E, and \nlseek() is declared in rholo.c and holofile.c without the <unistd.h> \ninclusion.\n\n\nThe reason we did this rather than including <unistd.h> is because this \nheader is not found on all systems, most notably Windows.  The \ndeclaration in rtio.h appears to match the Linux declaration, unless \n-D_FILE_OFFSET_BITS=64 is assigned.  I noticed that this macro was \nrecently added to the default makeall by schorsch (version 1.7, \n2003/07/12), and this seems to be the trouble.\n\n\nI guess the solution is to include the new \"platform.h\" for all files \nthat use lseek(), which are the following by my search:\n\n\ncommon/preadwrite.c\nhd/genrhenv.c\nhd/genrhgrid.c\nhd/holofile.c\nhd/rhcopy.c\nhd/rhinfo.c\nhd/rholo.c\nhd/rhoptimize.c\nhd/rhpict.c\npx/pinterp.c\nrt/ambient.c\nrt/persist.c\nrt/rpict.c\nutil/rpiece.c\nutil/vwrays.c\n\n\nSince \"platform.h\" includes <unistd.h> on all UNIX systems, this should \nsolve the problem, I would think.  (Schorsch, do you agree?)\n\n\n-Greg\n\n\nP.S.  For some reason, the source auxiliary files are not included in \nthe HEAD distribution.  The following files are missing:\n\n\nray/src/common/tmesh.cal\nray/src/cv/lamp.tab\nray/src/cv/source.cal\nray/src/cv/tilt.cal\nray/src/gen/clockface.hex\nray/src/gen/glaze1.cal\nray/src/gen/glaze2.cal\nray/src/gen/illum.cal\nray/src/gen/rev.cal\nray/src/gen/skybright.cal\nray/src/gen/surf.cal\nray/src/rt/rayinit.cal\n\n\nPlease add them, as makeall depends on them for proper operation.\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-dev/2003-October/000217.html).</sup>", "attachments": [], "created_by_name": "Greg Ward", "created_at": "October 19, 2003 at 10:27AM", "created_by": "Greg_Ward", "parent_id": "radiance-dev_000215", "id": "radiance-dev_000217"}