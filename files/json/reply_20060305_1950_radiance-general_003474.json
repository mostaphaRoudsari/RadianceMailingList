{"body": "Hi Will,\n\n\nI think your problem is in \"source_pic.cal\":\n\n\nmr(r,g,b) = r;\nmg(r,g,b) = g;\nmb(r,g,b) = b;\n\n\nmyu = Px/128;\nmyv = Px/128;\n\n\nFirst off, you are using Px as indices for both u and v picture  \ncoordinates, which is bound to be wrong.  Second, you should probably  \nbe using something based on the ray direction rather than the  \nintersection point, which is with the light source surface and  \nunrelated to the output distribution.  Something more along the lines  \nof:\n\n\nmyu = atan2(-Dx, Dz)/(20*DEGREE) + 0.5;\nmyv = atan2(Dy, Dz)/(20*DEGREE) + 0.5;\n\n\nThe above assumes that your light is pointed in the negative Z  \ndirection (as it seems to be) and that your distribution is oriented  \nwith the horizontal scanlines along the X-axis in world space.  It  \nalso assumes that the picture is square and covers 20 degrees  \nhorizontally and vertically.\n\n\nA paper that covers this idea in great detail, including local  \nphotometry modelling, is:\n\n\n\tM. Goesele, X. Granier, W. Heidrich, and H.-P. Seidel\n\t\"Accurate Light Source Acquisition and Rendering\"\n\tSIGGRAPH '03\n\t<http://www.cs.ubc.ca/~heidrich/Papers/Siggraph.03.pdf>\n\n\n-Greg\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2006-March/003474.html).</sup>", "attachments": [], "created_by_name": "Greg Ward", "created_at": "March 05, 2006 at 07:50PM", "created_by": "Greg_Ward", "parent_id": "radiance-general_003459", "id": "radiance-general_003474"}