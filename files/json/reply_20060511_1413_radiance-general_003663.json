{"body": "Thanks Greg, i think i'm near to get it, but there is something that is not\nworking, i dont know if Rdot is the DOT product or the -DOT product, i tried\nthe two but it is still not working, i\u00b4ve been trying to do some tests with\ncalc and it seems to work but something must be wrong because rpict gives\nthe aiming error, what is the best tool in radiance to test this kind of\nthings, i say, testing cal files while sending rays\n\n\nvoid prism2 water\n     9 transm dx dy dz reflect dxx dyy dzz water.cal\n     0\n     3 1 1 1\n\n\n####water.cal#####\nnrwater=1.3;\n\n\ncos1=if(Rdot,Rdot,-Rdot);\nnratio=if(Rdot,1/nrwater,nrwater);\ndnormx=if(Rdot,Nx,-Nx);\ndnormy=if(Rdot,Ny,-Ny);\ndnormz=if(Rdot,Nz,-Nz);\n\n\nd3=1.0-(nratio*nratio*(1.0 -(cos1*cos1)));\ncos2=sqrt(d3);\nd1bis=cos1;\nd2bis=nratio*cos2;\nd1t=(d1bis-d2bis)/(d1bis+d2bis);\nreflpp=d1t*d1t;\nd1p=1.0/cos1;\nd2=nratio/cos2;\nd1=(d1p-d2)/(d1p+d2);\nreflp=reflpp+(d1*d1);\nrefl=reflp*.5;\ntransp=1.0 -refl;\ntrans=transp*nratio*nratio;\n\n\n\n\nreflect=if(d3,refl,1.0);\ntransm=if(d3,trans,0.0);\n\n\ndm=nratio*cos1 - cos2;\n\n\ndx=nratio*Dx+dm*dnormx;\ndy=nratio*Dy+dm*dnormy;\ndz=nratio*Dz+dm*dnormz;\n\n\ndxx=Dx+2.0*cos1*dnormx;\ndyy=Dy+2.0*cos1*dnormy;\ndzz=Dz+2.0*cos1*dnormz;\n\n\n\n\n\n\n\n\n----- Original Message -----\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2006-May/003663.html).</sup>", "attachments": [], "created_by_name": "Ignacio Mun\u00e1rriz", "created_at": "May 11, 2006 at 02:13PM", "created_by": "Ignacio_Mun\u00e1rriz", "parent_id": "radiance-general_003656", "id": "radiance-general_003663"}