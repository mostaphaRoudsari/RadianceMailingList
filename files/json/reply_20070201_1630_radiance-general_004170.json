{"body": "Hi Axel,\n\n\nIf you want to derive light sources from an HDR you should take a look \nat mksource, this will evaluate the scene and then output as set of \nillum sources.\n\n\n-Jack\n\n\nAxel Jacobs wrote:\n> Dear all,\n>\n> I'm trying to process an HDR image to pick out the light source. The image\n> was taken with hdrgen:\n> RGBE: http://luminance.londonmet.ac.uk/pickup/004.hdr\n> falsecolor: http://luminance.londonmet.ac.uk/pickup/004_fc.jpg\n> Header:\n> $ head -10 004.hdr\n> #?RADIANCE\n> CAMERA= NIKON E990 version E990v1.1\n> hdrgen created HDR image from '0129_012.jpg' '0129_011.jpg' '0129_010.jpg'\n> '0129_009.jpg' '0129_008.jpg' '0129_007.jpg' '0129_006.jpg' '0129_005.jpg'\n> '0129_004.jpg' '0129_003.jpg' '0129_002.jpg' '0129_001.jpg'\n> Removed lens flare\n> EXPOSURE=4.175030e-01\n> CAPDATE= 2007:01:29 17:33:57\n> PRIMARIES= 0.6400 0.3300 0.3000 0.6000 0.1500 0.0600 0.3127 0.3290\n> FORMAT=32-bit_rle_rgbe\n> -Y 768 +X 1024\n>\n> What I'm after is to black out all pixels below a certain threshold, and\n> leave all others, i.e. the ones that are part of the light source\n> untouched.\n>\n> Firstly, a quick test-run to warm up:\n> $ pcomb -e 'lo=li(1)' -o 004.hdr > test.pic ; ximage test.pic &\n> This does nothing but show the brightness. The -o ensures I get\n> photometric units.\n>\n> Fine so far. BUT: If I run the same command straight into ximage, the\n> picture looks the same, but hitting 'L' displays a luminance of 0.0 for\n> all pixels (the square light source should have a luminance of just under\n> 500 cd/m2):\n> $ pcomb -e 'lo=li(1)' -o 004.hdr |ximage\n> This is the first thing that I don't understand.\n>\n> Second question: To set the threshold to 400 cd/m2 like described above, I\n> run:\n> $ pcomb -e 'lo=if(li(1)-400/WE,li(1),0)' -o 004.hdr > test.pic ; ximage\n> test.pic &\n> WE is the white efficacy, which seems to be read-only: Setting WE=2000\n> doesn't do anything.\n> URL: http://luminance.londonmet.ac.uk/pickup/400.png (the light only --\n> rest is black)\n>\n> >From pcomb(1):\n> \"... WE gives the white efficacy (lumens/brightness) for pixel values,\n> which may be used with the -o option or the  le(n) values to convert to\n> absolute photometric units (see below)\"\n>\n> The exposure value le(n) is the same for the entire picture (in my case\n> just over 0.4), so is it correct to say that I only have to worry about it\n> when combining multiple images? And that WE is equally useful with li(n),\n> not just li(n) and -o?\n>\n> So combining multiple images with different exposures would be done like so:\n> $ pcomb -e 'lo=li(1)/le(1)+li(2)/le(2)' -o 004.hdr 006.hdr > test.pic\n> Right?\n>\n> Thanks for shedding some light on the issue.\n>\n> Cheers\n>\n> Axel\n>\n>\n>\n> _______________________________________________\n> Radiance-general mailing list\n> Radiance-general at radiance-online.org\n> http://www.radiance-online.org/mailman/listinfo/radiance-general\n>\n>\n>   \n\n\n\n\n# Jack de Valpine\n# president\n#\n# visarc incorporated\n# http://www.visarc.com\n#\n# channeling technology for superior design and construction\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2007-February/004170.html).</sup>", "attachments": [], "created_by_name": "Jack de Valpine", "created_at": "February 01, 2007 at 04:30PM", "created_by": "Jack_de_Valpine", "parent_id": "radiance-general_004169", "id": "radiance-general_004170"}