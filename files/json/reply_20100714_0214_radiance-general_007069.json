{"body": "Morning Jia.\n\n\nOn Wed, Jul 14, 2010 at 3:28 AM, Jia Hu <hujia06 at gmail.com> wrote:\n> Dear Radiance experts:\n>\n> I plan to calculate illuminance of\u00a0an office model by using multiprocessing\n> (6 processors). I saw some posts discussing about this\n> problems (e.g.\n> http://www.rumblestrip.org/interests/light/rtrace-multiprocessing-option-initial-test-results/).\n>\n> (1) I have some questions about the usage of rtrace.\n> There are two options \"i\", \"I\" (one lower i and one upper\u00a0i).\n> I checked the manual page but I am still confused with their difference.\n\n\nFirst think about what rtrace really does: It calculates the\nbrightness of a point on a surface seen from the origin with a given\nview direction (the six coords per line you feed into it). The result\nis a separate value for the red, green and blue colour component. If\nyou do number of calculation each with a slightly different angle you\ncan compose an image out of these r,g,b values. This is what rpict\ndoes.\n\n\nThe brightness of the spot depends obviously on the colour of the wall\nand the amount of light that falls onto it. A dark wall will reflect\nless of the incident light than a white wall. You can use rcalc to\nconvert these into to the photopic average ie. how \"bright\" this spot\nappears to the human eye.\n\n\nSo far so good, but in daylight simulation we are traditionally less\ninterested in the brightness of a surface than in the light that falls\nonto it. Therefore rpict and rtrace offer the \"-i\" (lower case) switch\nwhich will ignore the surface colour on the last bounce and report the\namount of light that falls on a given spot instead of the light that\nis reflected off it. An image calculated with this option can be\nconverted with falsecolor to a colour map or in a contour line image\nwhich shows the Lux levels on any given surface.\n\n\nWhat now if you want to calculate the incident light on a surface when\nthere is no physical surface that would show in an image (like a\ntheoretical workplane)? This is what the \"-I\" (upper case) option\naccomplishes: In addition to reporting the irradiance/illuminance it\nalso adds a virtual plane at the point of your origin and flips around\nthe origin and direction.\n\n\nTake for example an origin of (0,0,0.75) and a direction of (0,0,1)\nfor up which calculates the horizontal illuminance at 750mm. With \"-i\"\nrtrace would look from (0,0,0.75)  straight up to the ceiling and\ncalculate the light falling onto the spot at (0,0) on the ceiling.\nWith \"-I\" rtrace creates a virtual surface at 750mm with a surface\nnormal of (0,0,1) (=horizontal). Then it places the origin at\n(0,0,0.75+1) and looks down onto this surface (new view\ndirection=(0,0-1)). The result is the irradiance on a horizontal\nsurface calculated at (0,0,0.75). Just what we need for daylight\nfactors etc.\n\n\n> (2) What is the option \"-h\" (in rtrace)\u00a0used for? I run several times but do\n> not see any header information.\n\n\nAs I mentioned above you can created images pixel by pixel using\nrtrace. However, a valid Radiance picture needs a header containing\nthe resolution and other information. By default rtrace prints this\nheader before it prints the results of the calculations. (I assume\nthere are historical reasons for that. I'd expect that most uses of\nrtrace switch the header of with \"-h\".)\n\n\nYou probably have never seen the header because your output is piped\nthrough rcalc which converts it into a bit of number garbage. Just try\nthe following commands on your bash prompt:\n\n\necho \"0 0 1 0 0 1\" | rtrace scene.oct\necho \"0 0 1 0 0 1\" | rtrace -h scene.oct\necho \"0 0 1 0 0 1\" | rtrace -h -w scene.oct\n\n\nSubstitute \"scene.oct\" with any octree you have around. The difference\nbetween the first two should be obvious. The last command uses \"-w\" to\nswitch of the warning about \"no light sources found\", too. That will\nonly be printed if you have no sun in your scene, though.\n\n\n> (3) There\u00a0are interior\u00a0blinds installed. If I first use mkillum to make the\n> window as a secondary light source, and then run rtrace, in this case\u00a0the\n> program\u00a0runs twice to get the illuminance value.\u00a0Does\u00a0this way\u00a0make running\n> faster than directly using rtrace (only once)?\u00a0 I input the model\u00a0from\n> Revit and thus the window object is connected in the .rad file and therefore\n> It is not easy to use mkillum (To use mkillum requires either (1) not\n> to import window from revit and to generate window\u00a0in Radiance or (2) cut\n> and paste the window .rad to a separate .rad file?)\n\n\nmkillum can help you saving time by splitting the calculation in one\npart for the exterior (until the light reaches the window) and one for\nthe interior. If your exterior is fairly simple there is little gain\nfrom this extra step.\n\n\nYou will also find it difficult to extract the window glass geometry\nfrom your *.rad file if it is produced by Revit. The normals might be\nthe wrong way around and you may have multiple surfaces instead of\nonly one as mkillum requires. I think you're better of not to use\nmkillum at his point. If you have doubts about the accuracy of your\ncalculations increase \"-ab\" by 1 or 2.\n\n\n> (4) For mutiprocessing, besides the option \"-n\",\u00a0\u00a0is there any other\n> options\u00a0I should pay attention\u00a0to?\u00a0I use Python script, and should I set\n> other options related to Python itself?\n\n\nThere are no options for Python that would affect Radiance. From Rob's\npage you should know that you need to specify an ambient file (\"-af\"\noption) to benefit of the \"-n\" parallel processing. If you have a\nnumber of options for your geometry you can also just run one rtrace\nprocess for each scene in a separate shell. Then you don't have to\nworry about parallel processing options.\n\n\nCheers,\nThomas\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2010-July/007069.html).</sup>", "attachments": [], "created_by_name": "Thomas Bleicher", "created_at": "July 14, 2010 at 02:14AM", "created_by": "Thomas_Bleicher", "parent_id": "radiance-general_000060", "id": "radiance-general_007069"}