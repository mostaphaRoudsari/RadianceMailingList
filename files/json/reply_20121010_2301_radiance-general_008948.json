{"body": "It is really very difficult to do what you are attempting without running into multiple errors.  For one thing, integrating the sun, which will cover only a few pixels in an image, is problematic.  Also, you can neither add together R+G+B nor use the luminance factor 179 (built into your 47, 117, 15 scalars) in your conversion.  That said, the following should work for the sky component (-i option):\n\n\n( oconv - | rpict -vd 0 0 1 -vu 0 1 0 -vth -vh 180 -vv 180 -x 1024 -y 1024 | pvalue -h -H -b -d | total -m | rcalc -e '$1=$1*4' ) << _EOF_\n\n\n!gensky 1 15 15:00 -i -B 57 -a 43.0528 -o -143.2123 -m -150.0\n\n\nskyfunc glow skyglow\n0\n0\n4 1 1 1 0\n\n\nskyglow source sky\n0\n0\n4 0 0 1 180\n_EOF_\n\n\nThe final multiplier of 4 is perhaps difficult to understand.  Because the image covers a square area, whereas you only want the circle in the center, you need to multiply the average by 4/pi.  However, you also need to multiply the averaged result by pi to get irradiance (rather than averaged radiance).  Hence, you need to multiply by pi*4/pi, which is just 4.  Using this, I get back a value of 56.736 (rather than 57.0), showing the normalization is not perfect.\n\n\nIf I try to compute the output of the sun only, I can do this by leaving off the sky description and going to a much higher resolution image:\n\n\ngensky 1 15 15:0 +i -R 455 -a 43.0528 -o -143.2123 -m -150.0 \\\n\t| oconv - | rpict -vd 0 0 1 -vu 0 1 0 -vth -vh 180 -vv 180 -x 10000 -y 10000 \\\n\t| pvalue -h -H -b -d | total -m | rcalc -e '$1=$1*4'\n\n\nThe above yields a result of 444.1, which is a higher relative error than the sky calculation most likely due to the difficult of integrating such a small source using a full hemispherical image.\n\n\nI hope this helps.\n-Greg\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2012-October/008948.html).</sup>", "attachments": [], "created_by_name": "Greg Ward", "created_at": "October 10, 2012 at 11:01PM", "created_by": "Greg_Ward", "parent_id": "radiance-general_008947", "id": "radiance-general_008948"}