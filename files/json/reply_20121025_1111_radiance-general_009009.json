{"body": "Hi, Lars, Thanks for your detailed explanation!\n\n\nThe following bash script is put up according to the suggestions from all\nprevious replies to this post. This method is view type independent.\nAnyway, I'd appreciate further advices from the list to make it more\nsuccinct and efficient, or point out the loopholes if there are any.\n\n\n# start__________________________\n# calculate Sky Exposure Factor\n# which is defined as the ratio between\n# the solid angle subtended by visible sky patch/patches\n# and that of the unobstructed sky hemisphere (which is 2*PI)\noconv ./plastic_mat.rad ./geom.rad > ./SkyEF_scene.oct\nrpict -av 1 1 1 -vf ./view_vts.vf -x 1000 -y 1000 ./SkyEF_scene.oct | pcomb\n-e 'solidAngle=S(1);ro=if(ri(1),0,solidAngle); go=if(gi(1),0,solidAngle);\nbo=if(bi(1),0,solidAngle)' -o - | pvalue -h -H | rcalc -e '$1=$3' | total |\nrcalc -e '$1=$1/2/PI' > ./SkyEF_results.txt\n# end__________________________\n\n\nThe contents of \"view_vts.vf\" (note that the location of the view point is\nslightly away from the surface of the scene geometry):\nrvu -vts -vp 0 0 0.001 -vd 0 0 1 -vu 0 1 0 -vh 180 -vv 180 -vo 0 -va 0 -vs\n0 -vl 0\n\n\n\n\nThe following step-by-step break down of the commands might be useful for\ndebugging purpose.\n\n\n# start__________________________\noconv ./plastic_mat.rad ./geom.rad > ./SkyEF_scene.oct\n\n\nrpict -av 1 1 1 -vf ./view_vts.vf -x 800 -y 800 ./SkyEF_scene.oct >\n./SkyEF_vts.hdr\n\n\ncat ./SkyEF_vts.hdr | pcomb -e 'omega=S(1);ro=if(ri(1),0,omega);\ngo=if(gi(1),0,omega); bo=if(bi(1),0,omega)' -o - > ./SkyEF_solidAngle.hdr\n\n\ncat ./SkyEF_solidAngle.hdr | pvalue -h -H >\n./SkyEF_xpos_ypos_solidAngleVal.txt\n\n\ncat ./SkyEF_xpos_ypos_solidAngleVal.txt | rcalc -e '$1=$3' | total >\n./SkyEF_total_solidAngle_of_visible_sky.txt\n\n\ncat ./SkyEF_total_solidAngle_of_visible_sky.txt | rcalc -e '$1=$1/2/PI' >\n./SkyEF_results.txt\n# end__________________________\n\n\n\n\nThanks again for the help from all of you!\n- Ji\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2012-October/009009.html).</sup>", "attachments": [], "created_by_name": "Ji Zhang", "created_at": "October 25, 2012 at 11:11AM", "created_by": "Ji_Zhang", "parent_id": "radiance-general_008984", "id": "radiance-general_009009"}