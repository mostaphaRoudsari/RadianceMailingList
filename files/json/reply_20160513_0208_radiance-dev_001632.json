{"body": "Ok, I think I got it figured out.\n\n\nThe code in wordfile() blindly assumed that read() would always return\nexactly the number of bytes requested. This is NOT garanteed by the\nspecification. It's perfectly valid for read() to return less, but\nnever more data than requested.\n\n\nWindows is doing something very reasonable here. When the requested\nread size would split up a CRNL, then it stops reading one byte earlier.\nThis ensures that the next read() will be able to correctly convert the\nCRNL into a single NL.\n\n\nThe consequence for us is that counting back from the end of MAXWLEN \nwill\ngive us the wrong position in the data. We need to save the value of n\nright after the read(), and use that instead of MAXWLEN in the \nmemmove().\nReading in binary mode is unnecessary.\n\n\nI've checked a working version into CVS.\n\n\nCheers\n-schorsch\n\n\n\n\nAm 2016-05-13 02:06, schrieb Gregory J. Ward:\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-dev/2016-May/001632.html).</sup>", "attachments": [], "created_by_name": "Georg Mischler", "created_at": "May 13, 2016 at 02:08AM", "created_by": "Georg_Mischler", "parent_id": "radiance-dev_001617", "id": "radiance-dev_001632"}