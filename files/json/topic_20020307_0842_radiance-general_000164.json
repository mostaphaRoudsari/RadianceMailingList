{"topic": "Problem with avlmemi", "category": "radiance-general", "attachments": [], "created_by_name": "John de Valpine", "created_at": "March 07, 2002 at 08:42AM", "body": "Hi:\n\n\nAmbient value sorting, sortambvals(), can be turned of\nat compile time (rather than messing with the source\ncode) with the following addition to rmake in the\nMACH= line:\n\n\n-Dtracktime=0\n\n\n\n\nfor example (for compilation on a linux box):\n\n\n#!/bin/sh\nexec make \"SPECIAL=\" \\\n        \"OPT=-O2 -DSPEED=40\" \\\n        \"MACH=-DBSD -Dlinux -DDCL_ATOF\n-L/usr/X11R6/lib -I/usr/include/X11 -DNOSTEREO\n-Dtracktime=0 -DMAXOBJBLK=131071 -DBIGMEM\" \\\n        ARCH=IBMPC \"COMPAT=bmalloc.o erf.o\ngetpagesize.o\" \\\n        INSTDIR=/usr/local/bin \\\n        LIBDIR=/usr/local/lib/ray \\\n        CC=gcc \"$@\" -f Rmakefile   \n\n\nRegards,\n\n\n-Jack de Valpine\n\n\n\n\n\n\n---- radiance-general@radiance-online.org wrote:\n> Jan Wienold wrote:\n> > \n> > Hi all,\n> > \n> > we installed the 3.4 RADIANCE and get now in many\ncases following error message:\n> > \n> > rpict: consistency - address not found in avlmemi\n> > \n> > We also tried to store an ambient file and to\nrestart the job with it - with the same result.\n> > \n> > If we use our \"older\" version (I think it is 3.1\npatchlevel 11), this problem does not occur.\n> > \n> > Any idea how to solve that?\n> \n> \n> Howdy Jan -- long time no see! :^)\n> \n> Oh yeah... the age-old avlmemi bug... the plight of\nany RADIANCE\n> developer! This problem popped up on patchlevel 20.\nI circumvented it by\n> simply disabling the call to sortambvals() at line\n#230 in the ambient.c\n> module:\n> \n> #if 0        \n>    if (tracktime)                          /* sort\nto minimize thrashing\n> */             sortambvals(0);\n> #endif\n>    \n> Runs fine without it! Maybe Greg can shed some light\non why\n> sortambvals() is needed. As far as I can see this\nshould be redundant on\n> modern VM systems.\n> \n> See ya!\n> \n> \n> -- \n> \"Life is too short for core dumps\"\n> _______________________________________________\n> Radiance-general mailing list\n> Radiance-general@radiance-online.org\n>\nhttp://www.radiance-online.org/mailman/listinfo/radiance-general\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2002-March/000164.html).</sup>", "id": "radiance-general_000164", "created_by": "John_de_Valpine"}