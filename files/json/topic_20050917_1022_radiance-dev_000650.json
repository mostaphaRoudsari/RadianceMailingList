{"topic": "SPEED or no SPEED", "category": "radiance-dev", "attachments": [], "created_by_name": "Georg Mischler", "created_at": "September 17, 2005 at 10:22AM", "body": "Hi all,\n\n\nthe recent efforts to compile under mingw have directed my attention\nto an issue in Radiance that has bothered me for quite a while.\nThe makeall script (and consequently my SCons configuration) defines\na value of SPEED for every known platform. This is used as follows:\n\n\nIn px/clrtab.c, the closest color routines are activated when SPEED > 8.\nThe lowest SPEED setting in makeall is 80, so this test has become\nrather pointless.\n\n\nIn px/neuclrtab.c, DEFSMPFAC is defined as 240/SPEED+3.\nWith the current values of SPEED, this ends up somewhere between 1 and 3.\nIf DEFSMPFAC was already defined before (eg. through a -Dxxx directive),\nthen it gets *redefined* to 30. This difference of about an order of\nmagnitude makes me thing that this also isn't what was originally\nintended.\n\n\nIn rt/rv3.c, WFLUSH is set depending on SPEED. This is the only case\nwhere I can still agree with the original intention, even if the\nmethod fails in similar ways as with the other cases.\n\n\nBy principle, there's no way to determine the performance of the\ntarget system at compile time. And one of the worst ways to even\ntry is by looking at the OS of the compiling system. I'm not sure\nif this ever was a good idea, but it certainly isn't on todays\nhardware/operating systems.\n\n\nFor clrtab.c, the test can be removed without further thought.\n\n\nFor neuclrtab.c, I assume that the original intention was a tradeoff\nbetween performance and memory use. Since both criteria are not\nreally critical anymore, I suggest we find a value of DEFSMPFAC\nthat is optimal for the algorithm in most situations and leave\nit at that.\n\n\nFor rv3.c, we could also just set a reasonable fixed value (as the\nWindows version does). If we really want to optimize to the actual\nperformance of the machine, then we'll have to test its speed\nat run time. I'm not sure if that's really worth the effort, though.\n\n\nThe goal in any case is to eliminate the compile variable SPEED.\nAny objections or other comments?\n\n\n\n\n-schorsch\n\n\n\n\nGeorg Mischler  --  simulations developer  --  schorsch at schorsch com\n+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-dev/2005-September/000650.html).</sup>", "id": "radiance-dev_000650", "created_by": "Georg_Mischler"}