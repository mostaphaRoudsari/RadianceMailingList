{"topic": "Calculating diffuse component in a BRTDfunc", "category": "radiance-general", "attachments": [], "created_by_name": "Iebele Abel", "created_at": "September 30, 2005 at 04:10PM", "body": "Hi all,\n\n\nI am writing a BRTD material which I want to use to change the diffuse \ncomponent of a surface, related to a certain direction an the surface \nnormal.\nRadiance reports: error bad arguments for BRTDfunc\nWhat am I doing wrong here?\n\n\nI get the impression that the rfdif, gfdif, bfdif, rbdif, gbdif and \nbbdif are not variables ???\nIf these are not variables, how can I change/calculate/define the \ndiffuse component in a BRTDfunc?\nSee the bold lines of the example in my cal file.\n\n\nI appreciate any suggestions !\n\n\nIebele\n\n\n\n\n<--- snip  ---->\n\n\n\n\n{\n    directional.cal\n\n\n    arg10 red diffuse\n    arg11 green diffuse\n    arg12 blue diffuse\n    arg13 direction x \n    arg14 direction y\n    arg15 direction z\n}\n\n\n{ RGB values for the reflection  }\nvalr  = arg(10);\nvalg  = arg(11);\nvalb  = arg(12);\nxdir = arg(13);\nydir = arg(14);\nzdir = arg(15);\n\n\n{ dot product direction and normal }\nDdN = (xdir*Nx)+(ydir*Ny)+(zdir*Nz);\n\n\n{ always return a positive value }\nmulti = if(DdN, DdN, -DdN) ;\n\n\n*reflr = CrP + (multi*valr)  ;\nreflg = CgP + (multi*valg)  ;\nreflb = CbP + (multi*valb)  ;*\n\n\n\n\n{\n    example usage:\n        void BRTDfunc LAYER114\n        10\n        0 0 0                          / reflection\n        0 0 0                          / specular\n        0 0 0          \n        directional.cal\n        0\n        15\n       * reflr reflg reflb              */ diffuse front*\n        reflr reflg reflb  *            / diffuse back\n        0 0 0                          / trans\n        0.8 0.7 0.6                    / color of surface\n        0.57735 0.57735 0.57735        / vector defining bright side of \nsurface\n}\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2005-September/002980.html).</sup>", "id": "radiance-general_002980", "created_by": "Iebele_Abel"}