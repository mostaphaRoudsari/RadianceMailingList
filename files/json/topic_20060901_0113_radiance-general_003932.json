{"topic": "Carsten Bauer marble cal file", "category": "radiance-general", "attachments": [], "created_by_name": "Cristiano Guarnaschelli", "created_at": "September 01, 2006 at 01:13AM", "body": "Hello all\nTime ago I've downloaded from RadZilla Project web pages marvellous Radiance\nMaterials wrote by Cartsen Bauer\n(patterns and cal files).\nOnly now I've found the time to check and test them, and even if they are\nall incredibles,\nI think that marbles are...almost real.\nI'm trying to study them to find the way to manage them to have different\ncolors etc,\nand I post this 2 questions hope that someone could help me to understand:\n\n\n1- changing colors in marbles.\n    I've understand that the main color of the \"dark brown marble\" (For\nexample) is managed  by\n\n\n    void colorfunc marble2up\n    4 red grn blu c-stone3tilxy.cal\n    0\n    42  0.5  0.16 0.05 0.03\n    0.6   0.19 0.08 0.06\n    0.65   0.15 0.085 0.045\n    0.9   0.155 0.043 0.025\n          0.165 0.09  0.05\n    0.2 0.25 0.15\n    0.2   4.2 7.3 11.6\n          1.0 1.0 1.0\n    0.11 0.46 4\n    2 1.8 0.13\n    -0.1 0.12 1\n    90.0 0.5 0.5 0.25\n\n\n    where the 42 parameters are the 42 ones of the c-stone3tilxy.cal file:\n\n\n       arg(1)  arg(2)  arg(3)  arg(4)     color at  0<  x <arg(1)\n      arg(5)  arg(6)  arg(7)  arg(8)     color at  arg(1)< x <arg(5)\n      arg(9)  arg(10) arg(11) arg(12)    color at  arg(5)< x <arg(9)\n      arg(13) arg(14) arg(15) arg(16)    color at  arg(9)< x <arg(13)\n          arg(17) arg(18) arg(19)    color at  arg(13)<x <1\n      arg(20)        turbulence\n      arg(21)        turb scale\n      arg(22)        unsharp borders\n\n\n      arg(23) arg(24) arg(25) arg(26)  crack color at arg(23)\n      arg(27) arg(28) arg(29)  crack color at border\n\n\n      arg(30)  crack left border  {( < arg(23) )}\n      arg(31)  crack right border {( > arg(23) )}\n      arg(32)  crack  period\n\n\n      arg(33)  crack  noise-func selector (1- perl. 2- fract. 3- rand.\n4-perl*rand)\n      arg(34)  crack  turb  intensity\n      arg(35)  crack scale\n\n\n      arg(36)  crack occurrence threshhold (-1 < arg(36) < 1)\n      arg(37)    \" scale\n      arg(38) -\n\n\n      arg(39)  tiling rot. angle (degrees)\n      arg(40)  tiling xstep\n      arg(41)  tiling ystep\n      arg(42)  tiling xoffset\n\n\n     First 19 parmeters are related to the marble color.\n     My question is: is there a way to \"calculate/Define\" those 19 paremters\nfor the desired color?\n     they are not \"triple values\" (r g b), they are 4 values for each \"row\",\nand what means \"color at  arg(1)< x <arg(5)\"\n\n\n\n\n    2- marble tiles.\n      Marble tiles are defined with args 39-40-41-42 or also in the marble\nmat file?\n      Is it possible to use the marble pattern without tiles?\n\n\n      Any help is welcome\n\n\n        Cristiano\n\n\n      Here the dark brown marble mat file and calc files.\n\n\n ################################################################\n    #################  dark brown marble, white cracks #############\n################################################################\n\n\n#\n#  x y plane, tiles x 0.5 y 0.5 (args 40 & 41)\n#\n\n\nvoid colorfunc marble2up\n4 red grn blu c-stone3tilxy.cal\n0\n42  0.5  0.16 0.05 0.03\n    0.6   0.19 0.08 0.06\n    0.65   0.15 0.085 0.045\n    0.9   0.155 0.043 0.025\n          0.165 0.09  0.05\n    0.2 0.25 0.15\n    0.2   4.2 7.3 11.6\n          1.0 1.0 1.0\n    0.11 0.46 4\n    2 1.8 0.13\n    -0.1 0.12 1\n    90.0 0.5 0.5 0.25\n\n\n\n\nvoid plastic marble2base\n0\n0\n5  0.17 0.065 0.04 0 0.03\n\n\nvoid colorfunc grouts2\n4 red grn blu c-1c.cal\n0\n3 0.51 0.505 0.5\n\n\n\n\nvoid texfunc fugen\n6 xpert ypert zpert t-brickptxz.cal -rx -90\n0\n14 0.5 0.5 0.25 1\n   0.01 0.01 1\n   0.28 0.15 0.32\n   1 0 1 1\n\n\n\n\nfugen mixfunc marble2tex\n6 marble2up grouts2 fore m-brickptxz.cal -rx -90\n0\n14  0.5 0.5  0.25\n    1 0.006 0.006 1\n    0.002 0.002 1\n    1 0.0 20 20\n\n\nmarble2tex plastic marble2\n1 marble2base\n0\n5  1  1  1  0.3  0.03\n\n\n ################################################################\n\n\n\n\n################################################################\n    #################  c-stone3tilxy.cal #############\n################################################################\n\n\n{ (c)-20.08.2002-C.Bauer(Berlin)\n\n\n  c-stone3tilxy.cal\n\n\n  5 color fractal noise (softened) crack x tiling xy\n\n\n  output: red, grn, blu (names to list as colorfunc string args)\n\n\n\n\n  42 parameters:\n\n\n  arg(1)  arg(2)  arg(3)  arg(4)     color at  0<  x <arg(1)\n  arg(5)  arg(6)  arg(7)  arg(8)     color at  arg(1)< x <arg(5)\n  arg(9)  arg(10) arg(11) arg(12)    color at  arg(5)< x <arg(9)\n  arg(13) arg(14) arg(15) arg(16)    color at  arg(9)< x <arg(13)\n      arg(17) arg(18) arg(19)    color at  arg(13)<x <1\n  arg(20)        turbulence\n  arg(21)        turb scale\n  arg(22)        unsharp borders\n\n\n  arg(23) arg(24) arg(25) arg(26)  crack color at arg(23)\n      arg(27) arg(28) arg(29)  crack color at border\n\n\n  arg(30)  crack left border  {( < arg(23) )}\n  arg(31)  crack right border {( > arg(23) )}\n  arg(32)  crack  period\n\n\n  arg(33)  crack  noise-func selector (1- perl. 2- fract. 3- rand.\n4-perl*rand)\n  arg(34)  crack  turb  intensity\n  arg(35)  crack scale\n\n\n  arg(36)  crack occurrence threshhold (-1 < arg(36) < 1)\n  arg(37)    \" scale\n  arg(38) -\n\n\n  arg(39)  tiling rot. angle (degrees)\n  arg(40)  tiling xstep\n  arg(41)  tiling ystep\n  arg(42)  tiling xoffset\n\n\n}\n\n\nshifty = floor(Py/arg(41));\nshiftx = floor((Px-shifty*arg(42))/arg(40));\n\n\nrotang = DEGREE*arg(39)*(shiftx+shifty);\n\n\nPPx = Px*cos(rotang) + Py*sin(rotang);\nPPy = Py*cos(rotang) - Px*sin(rotang);\nPPz = Pz;\n\n\ndist = arg(20)*fnoise3(PPx,PPy,PPz);\n\n\nxev = (PPx + dist)/arg(21);\nyev = (PPy + dist)/arg(21);\nzev = (PPz + dist)/arg(21);\n\n\nselector = if(arg(22), 0.5*(1-fnoise3(xev,\nyev,zev))+arg(22)*(0.5-rand((PPx+PPy+PPz)/3)),\n                              0.5*(1-fnoise3(xev, yev, zev)));\n\n\ndelfa13 = selector-arg(13);\ndelfa9  = selector-arg(9);\ndelfa5  = selector-arg(5);\ndelfa1  = selector-arg(1);\n\n\nfnorm = if(delfa13, delfa13/(1-arg(13)), if(delfa9, delfa9/(arg(13)-arg(9)),\n       if(delfa5, delfa5/(arg(9)-arg(5)), if(delfa1, delfa1/(arg(5)-arg(1)),\nselector/arg(1)))));\n\n\n\n\nbasenoise = select(floor(arg(33)), arg(34)*noise3(PPx,PPy,PPz),\narg(34)*fnoise3(PPx,PPy,PPz),\n\n\narg(34)*rand((PPx+PPy+PPz)/3),arg(34)*(noise3(PPx,PPy,PPz)*rand((PPx+PPy+PPz\n)/3)));\n\n\nxfilt = (PPx+basenoise)/arg(35);\n\n\nfildec = mod(floor(xfilt), arg(32));\n\n\nfdl = frac(xfilt);\n\n\nfilfa = if(fildec, 0, if(fdl-arg(31), 0 , if(fdl-arg(30), if(fdl-arg(23),\n1 - (fdl-arg(23))/(arg(31)-arg(23)),\n                                                              1-\n(arg(23)-fdl)/(arg(23)-arg(30))), 0)));\nfilfa2 = if(noise3(PPx/arg(37),PPy/arg(37),PPz/arg(37))-arg(36), filfa, 0);\n\n\nfred = arg(27) + filfa2*(arg(24)-arg(27));\nfgrn = arg(28) + filfa2*(arg(25)-arg(28));\nfblu = arg(29) + filfa2*(arg(26)-arg(29));\n\n\n\n\nRl = if(delfa13, arg(14), if(delfa9, arg(10), if(delfa5, arg(6), if(delfa1,\narg(2), arg(17)))));\nGl = if(delfa13, arg(15), if(delfa9, arg(11), if(delfa5, arg(7), if(delfa1,\narg(3), arg(18)))));\nBl = if(delfa13, arg(16), if(delfa9, arg(12), if(delfa5, arg(8), if(delfa1,\narg(4), arg(19)))));\n\n\nRu = if(delfa13, arg(17), if(delfa9, arg(14), if(delfa5, arg(10), if(delfa1,\narg(6), arg(2)))));\nGu = if(delfa13, arg(18), if(delfa9, arg(15), if(delfa5, arg(11), if(delfa1,\narg(7), arg(3)))));\nBu = if(delfa13, arg(19), if(delfa9, arg(16), if(delfa5, arg(12), if(delfa1,\narg(8), arg(4)))));\n\n\n\n\nred = (Rl+(Ru-Rl)*fnorm)*fred;\ngrn = (Gl+(Gu-Gl)*fnorm)*fgrn;\nblu = (Bl+(Bu-Bl)*fnorm)*fblu;\n################################################################\n\n\n################################################################\n    #################  c-1c.cal #############\n################################################################\n\n\n{ (c)-20.08.2002-C.Bauer(Berlin)\n\n\n  c-1c.cal\n\n\n  1 color cal file (workaround for mixing)\n\n\n  output red, grn, blu\n\n\n  arg(1) = red color val\n  arg(2) = green  \"\n  arg(3) = blue   \"\n}\n\n\nred = arg(1);\ngrn = arg(2);\nblu = arg(3);\n\n\n################################################################\n\n\n\n\n################################################################\n    #################  t-brickptxz.cal #############\n################################################################\n{ (c)-20.08.2002-C.Bauer(Berlin)\n\n\n   t-brickptxz.cal\n\n\n    brick normal-pattern xz-plane, x-offset\n\n\n  output: xpert, ypert, zpert (texfunc-string args)\n\n\n  14 parameters\n\n\n  arg(1)   zstep\n  arg(2)   xstep\n  arg(3)   xoffset\n  arg(4)   -\n  arg(5)   grout size z\n  arg(6)   grout size x\n  arg(7)   -\n  arg(8)   grout effect ampl.\n  arg(9)   -\n  arg(10)  -\n  arg(11)  noise-func selector (1 - perlin, 2 - fractal)\n  arg(12)  turb. amplitude\n  arg(13)  turb. scale x\n  arg(14)  turb. scale z\n}\nPPz = Pz +  arg(12)*select(arg(11),\nnoise3(Px/arg(13),Py/arg(13),Pz/arg(14)), fnoise3(Px/arg(13), Py/arg(13),\nPz/arg(14)));\n\n\nPPx = Px +  arg(12)*select(arg(11),\nnoise3(Px/arg(13),Py/arg(13),Pz/arg(14)), fnoise3(Px/arg(13), Py/arg(13),\nPz/arg(14)));\n\n\npr = PPz/arg(1);\n\n\nevpt = frac(pr)*arg(1);               {eval points}\n\n\nstp = floor(pr);\nevx = arg(2)*frac((PPx-stp*arg(3))/arg(2));\ndelmfal = evx-arg(3);\ndelmfau = evx-(arg(3)+arg(6));\ndelmf6 = if(delmfal, if(delmfau,0,1),0);\ndelfa5 = evpt-arg(5);\ndelfa5h = evpt-(arg(5)/2);\ndelfa6  = evx-arg(6);\ndelfa6h = evx - (arg(6)/2);\nxpert = if(delfa5,if(delfa6,0,if(delfa6h, -arg(8), arg(8))),0);\nypert = 0;\nzpert =  if(delfa5, 0 , if(delfa5h, if(delfa6,-arg(8),0), if(delmf6, 0,\narg(8))));\n\n\n################################################################\n\n\n\n\n################################################################\n    #################  t-brickptxz.cal #############\n################################################################\n{ (c)-20.08.2002-C.Bauer(Berlin)\n\n\n  m-brickptxz.cal\n\n\n  brick mix pattern, foreground = brick-material, background = grout\nmaterial\n  output: fore\n\n\n  14 parameters\n\n\n  arg(1)   zstep\n  arg(2)   xstep\n  arg(3)   xoffset\n  arg(4)   -\n  arg(5)   grout size z\n  arg(6)   grout size x\n  arg(7)   -\n  arg(8)   z-trans\n  arg(9)   x-trans\n  arg(10)  -\n   arg(11)  noise-func selector (1 - perlin, 2 - fractal)\n  arg(12)  turb. amplitude\n  arg(13)  turb. scale x\n  arg(14)  turb. scale z\n\n\n}\n\n\nPtx = Px-arg(8);\nPtz = Pz-arg(9);\n\n\nPPz = Ptz +  arg(12)*select(arg(11),\nnoise3(Ptx/arg(13),Py/arg(13),Ptz/arg(14)), fnoise3(Ptx/arg(13), Py/arg(13),\nPtz/arg(14)));\nPPx = Ptx +  arg(12)*select(arg(11),\nnoise3(Ptx/arg(13),Py/arg(13),Ptz/arg(14)), fnoise3(Ptx/arg(13), Py/arg(13),\nPtz/arg(14)));\n\n\npr = PPz/arg(1);\nevpt = frac(pr)*arg(1);               {eval points}\nstp = floor(pr);\n\n\nevx = arg(2)*frac((PPx-stp*arg(3))/arg(2));\n\n\ndelfa5 = evpt-arg(5);\n\n\ndelfa6  = evx-arg(6);\n\n\nfore = if(delfa5, if(delfa6, 1,0),0);\n\n\n################################################################\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2006-September/003932.html).</sup>", "id": "radiance-general_003932", "created_by": "Cristiano_Guarnaschelli"}