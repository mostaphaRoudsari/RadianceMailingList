{"topic": "IES2Rad questions", "category": "radiance-general", "attachments": [], "created_by_name": "Zack Rogers", "created_at": "September 21, 2007 at 08:39PM", "body": "Hello,\n\n\nI am trying to simulate a window optical daylighting system (LightLouver) in Radiance and am seeing some weird behaviour.\n\n\nThe IES file I am modeling is completely asymmetric and it appears as if Radiance treats the horizontal angles in a clockwise fashion whereas the IESNA standard is to treat the horizontal angles in a counter-clockwise fashion.\u00a0 A photometric representation of the file can be seen here:\n\n\nhttp://home.comcast.net/~z.rogers/LiLo_photometric1.jpg\n\n\nand here:\n\n\nhttp://home.comcast.net/~z.rogers/LiLo_photometric2.jpg\n\n\nThis is an IES file that I made for a daylighting system that sits vertically in a window using a forward ray-tracing program (TracePro).\u00a0 I defined it with Type C photometry; the 0 vertical angle is perpendicular to the window pointing into the room and the 0 horizontal angle is up (+Z).\u00a0 The window is roughly 5' wide by 2' high and can be seen in these images as the blue rectangle.\u00a0 It is apparent that the main daylight distribution is entering the room, above the horizontal and angled to the left as it enters the space.\u00a0 This is as expected as this is for a south-west facade at noon.\u00a0 This illustrates that the IES file was defined with the horizontal angles proceeding in a counter-clockwise fashion according to a right-hand rule.\u00a0 And the the 0 horizontal angle is defined as up or in the direction of the smaller window dimension.\n\n\nI then attempted to place this IES file into the room I am modeling, seen here:\n\n\nhttp://home.comcast.net/~z.rogers/Lilo_room.jpg\n\n\nwhich gives me this rendering (low quality but the distribution of light is apparent):\n\n\nhttp://home.comcast.net/~z.rogers/lilo_e12pm_bad.gif\n\n\nSo my first question is relative to the 0 horizontal angle and which axis IES2RAD assumes for this.\u00a0 It reads in the source.cal file that +x axis is the 0 horizontal angle and the -y is the 90 deg angle.\u00a0 However, to get the rendering shown above I had to have my replmarks marker with +y up which seems to disagree with the header of the source.cal file.\u00a0 I also have to define the longer dimension as x and the shorter dimension as y, similarly in disagreement with the source.cal file header.\u00a0 When I try rendering it with +x as up I get a strange and obviously incorrect rendering.\u00a0 Is this a bug or am I mis-interpreting this?\n\n\nMy second question is relative the progression of horizontal angles.\u00a0 The rendering obviously disagrees with the photometric illustration as the light is entering the room to the right rather than to the left as it was in the photometric view and as it should be given my daylight conditions.\u00a0 Does Radiance treat the horizontal angles in a clockwise (left-hand rule) fashion or am I mis-interpretting this?\u00a0 IESNA does define the other way.\n\n\nThe fix I figured out for this second issue is in the source.cal file.\u00a0 Instead of this:\n\n\nsrc_phi = mod( Atan2(Dy, -Dx) / DEGREE, 360 );\u00a0\u00a0\u00a0 { 0-360 }\n\n\nI made the -Dx a positive like this:\n\n\nsrc_phi = mod( Atan2(Dy, Dx) / DEGREE, 360 );\u00a0\u00a0\u00a0 { 0-360 }\n\n\nand this gave me a rendering with the light going in the direction I was expecting.\n\n\nOne final question; anybody have a way to get Type B photometry into Radiance?\u00a0 It seems like IES2Rad does not like this type.\n\n\nI hope all that made sense.\u00a0 Any help is much appreciated!\u00a0 I hope to see some of you at the upcoming conference!\n\n\nRegards,\nZack\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2007-September/004443.html).</sup>", "id": "radiance-general_004443", "created_by": "Zack_Rogers"}