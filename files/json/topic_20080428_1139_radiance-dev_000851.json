{"topic": "setting buffer size on octree reads (setvbuf)", "category": "radiance-dev", "attachments": [], "created_by_name": "Peter Apian-Bennewitz", "created_at": "April 28, 2008 at 11:39AM", "body": "Hi Greg,\n\n\nregarding the long time it takes reading octrees (multiple with sizes > 50MB):\n\n\nI've tested with setvbuf calls after the fopen in readoct and readobj with a \nsize of 2MB (system default is 4kB).\n\n\nWell- the number of reads went down, but the time for reading remained \nunchanged: 2.47min down from 2.48min.\nIt seems truly CPU (Xeon) limited, at least in this case, when reading from \nlocal disk (bandwidth>20MB).\nNevertheless, using a larger buffer than the default 4kB may make sense. E.g. in \nother scenarios (might be usable on NFS reads where mount rsize is larger than \n4k), with a minor chance of portability problems (\"The setbuf() and setvbuf() \nfunctions conform to C89 and C99\" it says in the man page). Ah, well, setbuf is \nalready in use for setting up the ambient file. IMHO it might be a good thing to \nadd to readoct, unless rendering is done on systems where an increased buffer \ntakes away a significant part of valuable mem.\n\n\n-Peter\n\n\nPS: Tested on fresh 'head'  -  cc to the dev list in case anyone stumbles \nacross, comments appreciated.\n\n\npab-opto, Freiburg, Germany, http://www.pab-opto.de\n[see web page to check digital email signature]\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-dev/2008-April/000851.html).</sup>", "id": "radiance-dev_000851", "created_by": "Peter_Apian-Bennewitz"}