{"topic": "calculating percentages of a given value in a .dat / .ok file", "category": "radiance-general", "attachments": [], "created_by_name": "Nick Hubof", "created_at": "March 10, 2010 at 10:22AM", "body": "Hi,\nI am trying to do a similar process as below email, but with an illuminance\nplot. \nI would like to know the % above a lighting threshold of 300lux in an\nillumination grid output from radiance.\n\n\nMy office uses Ecotect to build daylight models with 2d analysis grids\n(.pts). After running radiance the analysis grid is populated into a .dat\nfile that is renamed in the Ecotect Batch to a .ok file.\nThe .ok file consists of illumination data by point.\nSo when I open the .ok file in a text editor the values are in exponential\nform, ie.. (1.501146e+000   1.570207e+000   9.277438e-001). \nWhen viewed in the Ecotect grid this value is 270.316 lux. \n\n\nIs there a way to have rtrace give me that percentage while the batch is\nrunning or at least convert the data from exponential form to 'real' values?\n\n\nPlease let me know what to add to the batch, I assume it will be at the\nrtrace section or after in the batch:\nrtrace .rendering settings. gridtest.oct < gridtest.pts > gridtest.dat \n@RENAME gridtest3.dat gridtest3.ok \n\n\nThanks,\nNick\n\n\n\n\n\n\n\n\n\n\n\n\n>From Greg Ward (Mon Oct 20 10:12:17 PDT 2008)_\n\n\nAnd here is one of the many possible standard Radiance tools ways:\n\n\npvalue -h -H -o -b -df input.pic | rcalc -if -of -e '$1=1;$2=if(179* \n$1-THRESHOLD,1,0)' | total -if2\n\n\nYou need to set THRESHOLD to the desired luminance value (in cd/ \nm^2).  This will give you two numbers, the ratio of which is the  \npercentage you seek.  If you want to do it all on the command line,  \nyou can add:\n\n\n        | rcalc -e '$1=100*$2/$1'\n\n\nto the end of the pipe.\n\n\nBest,\n-Greg\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2010-March/006632.html).</sup>", "id": "radiance-general_006632", "created_by": "Nick_Hubof"}