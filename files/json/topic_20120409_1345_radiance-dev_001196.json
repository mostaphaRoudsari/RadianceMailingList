{"topic": "vwright and stereoscopic image generation", "category": "radiance-dev", "attachments": [], "created_by_name": "Lars O. Grobe", "created_at": "April 09, 2012 at 01:45PM", "body": "Hi all,\n\n\nI just found that vwright, which looked like the perfect tool to support\nstereoscopic image pair generation, generates a new view by simply\nmoving the view-point -vp. This does not consider the fact that our eyes\n(hopefully) are able to focus on an object, not looking parallel into\ninfinity. So my resulting frames do not really match (I tried it and it\nlooked ugly...). Paul Bourke provides a great page explaining the\nbackground of such stereo pairs on his website:\n\n\nhttp://paulbourke.net/miscellaneous/stereographics/stereorender/\n\n\nTo correct this, I would propose to manipulate the -vs and -vh\nparameters in the view file generated by vwright. I am not that great in\ndoing reprojections, but from what I understand, this should work. I\nhave made a simple sketch to visually explain what I attempted to do\n(and probably what I did wrong):\n\n\nweb-browsers with svg-support\nhttp://static.larsgrobe.de/stereoscopic_vwright.svg\n\n\npdf of the same sketch\nhttp://static.larsgrobe.de/stereoscopic_vwright.pdf\n\n\nHere is my approach:\n\n\ne [scene units]: eye seperation\nis given as input to vwright, known\n\n\nf [scene units]: distance from either eye point to the image plane\ncan simply be calculated from view direction vector vd_x, vd_y, vd_z:\nf = sqrt(vd_x^2+vd_y^2+vd_z^2)\n\n\nalpha [degrees]: half horizontal view angle\ncan simply be calculated from view's vh: alpha = vh/2\n\n\na [scene units]: alpha projected on the image plane\na = f * tan(alpha)\n\n\n1) Calculate horizontal shift value vs for views:\n\n\nvs [] : shift fraction (eye separation e / projected image width 2*a)\ncan be calculated from above as vs = e / 2*a\n\n\nFor the left view, I modify vs as above, for the right view I use its\nnegative value.\n\n\n2) Correct the horizontal field of view vh for views:\n\n\nThe stereoscopic image can be displayed only the overlapping image area\nfor both views. Thus we need to cut the left border from the left and\nthe right border from the right view.\n\n\nbeta [degrees]: the angle corresponding to this border (having the same\nwidth as the eye separation, but being located in the image plane)\ncalculated as beta = alpha - atan ( (a-e)/f )\n\n\nThis allows calculating the corrected horizontal view angle vh_corr,\nwhich will replace the vh in my view files:\n\n\nvh_corr [degrees]: corrected horizontal field of view\nas vh_corr = vh - beta\n\n\n3) The full procedure:\n\n\n- take a view, derive left and right views from it by running vwright\n(+/-) e/2\n\n\n- calculate vs and vh_corr and replace the corresponding values in both\nviews\n\n\n- render, take on your glasses, and enjoy stereoscopic 3d images....\n\n\nI hope this is correct, for me it gave results looking much better then\nthose by simply using vwright's view parameters. I think that having\nthis in vwright as an option (either active by default, or, to preserve\nbackwards compatibility, switched by e.g. -s as stereographic) would\nmake rendering of stereo pairs with Radiance much more fun.\n\n\nAny comments? Cheers, Lars.\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-dev/2012-April/001196.html).</sup>", "id": "radiance-dev_001196", "created_by": "Lars_O._Grobe"}