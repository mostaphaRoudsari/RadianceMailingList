{"topic": "usage of rtrace within a material", "category": "radiance-general", "attachments": [], "created_by_name": "Wendelin Sprenger", "created_at": "January 31, 2013 at 08:56AM", "body": "Dear Lars,\n\n\nI had the same problem approximately two years ago: rtrace -I does not \ngive you the right answer when being applied after a dielectric surface. \nWith the -i option of rtrace, I do not have any experience.\nI suggest a workaround for your problem. As you did, I would chose a \ndielectric surface followed by a plastic surface. For rtrace -I inside a \nmaterial, in theory the integral\n\n\nE = int [ L cos(theta_m) d Omega_m ]\n\n\nhas to be calculated, m naming the angles inside the material. \nUnfortunately, at least the specular path does not remember the light \nrefraction for the rtrace -I calculation. However, if you substitute the \nangles in the integral by the old ones before the material, rtrace -I \nworks. The substitution theta_m=arcsin(n1/n2*theta), including \ncos(theta_m)=sqrt[1-sin^2(theta_m)], leads to a complicated integral that \nfinally can be simplified to\n\n\nE = n1^2/n2^2 int [ L cos(theta) d Omega ]\n\n\nrtrace -I only calculates this integral. With the correction factor \nn1^2/n2^2, the rtrace -I results can be applied. \nThe ambient path, however, seems to work perfectly without any correction \nfactor.\nI haven't done any research on what is exactly going on in the source \ncodes. However, the results are fine.\nI do not have an answer for your third question.\n\n\nCheers,\nWendelin\n\n\n\n\n\n\n\n\n\n\nOriginal message:\n\n\nDate: Thu, 31 Jan 2013 20:58:57 +0800\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2013-January/009246.html).</sup>", "id": "radiance-general_009246", "created_by": "Wendelin_Sprenger"}