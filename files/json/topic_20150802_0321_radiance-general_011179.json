{"topic": "Integrated photon mapping and material roughness", "category": "radiance-general", "attachments": [], "created_by_name": "Martin Klingler", "created_at": "August 02, 2015 at 03:21AM", "body": "Hello experts,\n\n\n\u00a0\n\n\nplaying around with the new integrated photon mapping I met the following strage effect.\n\n\n\u00a0\n\n\nFirst I am using the old version (Radiance 3.7 and Photon map patch 4.3.1) and this very simple geometry (sorry for the german notes):\n\n\n\u00a0\n\n\n# LED als IES-Verteilung\n\n\n# strahlt in Richtung der x-Achse\n\n\n!xform LED.rad | xform -ry -90 -t -0.2 0 0\n\n\n\u00a0\n\n\n# Umlenkspiegel als Metal\n\n\nvoid metal spiegel\n\n\n0\n\n\n0\n\n\n5\n\n\n0.9 0.9 0.9 1 0\n\n\n\u00a0\n\n\n!gensurf spiegel mir ?-0.25+s*0.5? ?-0.25+t*0.5? ?0? 1 1 | xform -ry -135\n\n\n\u00a0\n\n\n# Testflaeche\n\n\nvoid plastic weiss\n\n\n0\n\n\n0\n\n\n5\n\n\n0.8 0.8 0.8 0 0\n\n\n\u00a0\n\n\n!gensurf weiss test ?-4+s*8? ?-4+t*8? ?-2? 1 1\n\n\n\u00a0\n\n\nA caustic map is generated like this: mkpmap -apc map2 1000000 -dp 50000\n\n\n\u00a0\n\n\nAnd based on that rad file:\n\n\n\u00a0\n\n\n# Rad Input File created by trad Son Aug  2 11:57:29 CEST 2015\n\n\nDETAIL= Medium\n\n\nEYESEP= 1\n\n\nINDIRECT= 1\n\n\nOCTREE= Dir_Pmap.oct\n\n\nPENUMBRAS= True\n\n\nPICTURE= Dir_Pmap\n\n\nQUALITY= Medium\n\n\nRESOLUTION= 1024\n\n\nUP= Z\n\n\nVARIABILITY= High\n\n\nZONE= Interior -4 4 -4 4 -2 0.5\n\n\nrender= -apcb map2 100 2000\n\n\nscene= System_Pmap.rad\n\n\nview= g1 -vtl -vp 0 0 -0.5 -vd 0 0 -1 -vu 0 1 0 -vh 8.5 -vv 8.5\n\n\n\u00a0\n\n\nI get this output: https://dl.dropboxusercontent.com/u/27495200/HGF.jpg\n\n\n\u00a0\n\n\nIf I change the roughness for the \"spiegel\" material to 0.1, I get this output: https://dl.dropboxusercontent.com/u/27495200/RoughF.jpg\n\n\nwhich seem to be quite Ok for me.\n\n\n\u00a0\n\n\nNow I change to the radiance HEAD from the 4th July. I use the same geometry and the following rad file:\n\n\n\u00a0\n\n\n# Rad Input File created by trad Son Aug  2 11:59:05 CEST 2015\n\n\nDETAIL= Medium\n\n\nINDIRECT= 0\n\n\nOCTREE= Pmap1.oct\n\n\nPCMAP= map3 1000000 50\n\n\nPENUMBRAS= True\n\n\nPICTURE= Pmap1rough\n\n\nQUALITY= Medium\n\n\nRESOLUTION= 1024\n\n\nUP= Z\n\n\nVARIABILITY= High\n\n\nZONE= Interior -4 4 -4 4 -2 0.5\n\n\nmkpmap= -dp 50000\n\n\nscene= System_Pmap.rad\n\n\nview= g1 -vtl -vp 0 0 -0.5 -vd 0 0 -1 -vu 0 1 0 -vh 8.5 -vv 8.5\n\n\n\u00a0\n\n\nWith the roughness of 0.0 I get this output: https://dl.dropboxusercontent.com/u/27495200/HGnF.jpg\n\n\nWhich, compared to a run with mirror material, seems to be even better than the old result.\n\n\n\u00a0\n\n\nBut when I change to the roughness 0.1 I get this output: https://dl.dropboxusercontent.com/u/27495200/RoughnF.jpg\n\n\n\u00a0\n\n\nI already tried differend setting for the bandwidth parameter but the were no fundamental chages.\n\n\n\u00a0\n\n\nMay thanks for any ideas\n\n\nMartin Klingler\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2015-August/011179.html).</sup>", "id": "radiance-general_011179", "created_by": "Martin_Klingler"}