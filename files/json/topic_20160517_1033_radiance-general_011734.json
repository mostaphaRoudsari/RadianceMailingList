{"topic": "transfunc with measured data (poor man's BSDF)", "category": "radiance-general", "attachments": [], "created_by_name": "Stephen Wasilewski", "created_at": "May 17, 2016 at 10:33AM", "body": "I'm trying to set up a transfunc material to approximate some rough\nmeasured data I have.  Assume my material is isotropic and I have a\nunscaled transmission profile from 0-90 degrees.\n\n\nhere is my material:\n\n\nvoid transfunc pane\n2 tdis distribution.cal\n0\n7 .9 .9 .9 0 .8 1 12\n\n\n.8 is my measured total VLT, and 12 is a magical factor that fits the\nsimulation with a physical model (this number is different for every\nmaterial, which is why I know I'm missing something, mostly likely math\nskills)\n\n\nand here is the contents of distribution.cal:\n\n\ntcoef = .5*90*A7;\n\n\nang(x,y,z) = acos(x*Dx+y*Dy+z*Dz)/DEGREE;\n\n\nbound2(x,y,z) = if(ang(x,y,z)-90,90,ang(x,y,z));\n\n\ntdis(ix,iy,iz) = tcoef*tdat(91-floor(bound2(ix,iy,iz)));\n\n\ntdat(i) : select(i,\n0.000310656,\n0.000312042,\n0.000315021,\n0.00032472,\n0.000326868,\n0.000330262,\n0.000332341,\n0.000343634,\n0.00034689,\n0.000354026,\n0.00035749,\n0.000359083,\n0.000361647,\n0.00036906,\n0.000371554,\n0.000377512,\n0.000380076,\n0.000389082,\n0.000392061,\n0.000394902,\n0.000402315,\n0.000408758,\n0.000407857,\n0.000420743,\n0.000421228,\n0.000429542,\n0.0004346,\n0.000436401,\n0.000447971,\n0.000449356,\n0.000454414,\n0.000458086,\n0.000478385,\n0.000477,\n0.00048947,\n0.000499585,\n0.000507414,\n0.000521339,\n0.000536512,\n0.000545726,\n0.000556811,\n0.000570598,\n0.000586741,\n0.000594084,\n0.000607941,\n0.000625399,\n0.000634129,\n0.000651241,\n0.000673411,\n0.000703202,\n0.000728143,\n0.000735071,\n0.000774561,\n0.000804352,\n0.000824444,\n0.000845921,\n0.000895803,\n0.000942914,\n0.000982404,\n0.001031594,\n0.001085633,\n0.001198561,\n0.001237358,\n0.00129694,\n0.00136345,\n0.001465293,\n0.001581685,\n0.001673136,\n0.001792299,\n0.001928783,\n0.002159488,\n0.002343776,\n0.002594573,\n0.002836364,\n0.003092703,\n0.00343218,\n0.003813226,\n0.004396572,\n0.005160741,\n0.006019825,\n0.006495786,\n0.008431496,\n0.009456855,\n0.011265089,\n0.013821557,\n0.017729005,\n0.022952792,\n0.052383356,\n0.11064174,\n0.238534447,\n0.426770895)\n\n\nIm getting the expected distribution for direct light sources (at least for\nnear normal incidence, which is all I am worried about for now), but glows\nand indirect light seem to revert to a lambertian.   I have no idea how to\nscale these values to insure the right transmittance or as the reference\nmanual puts it \"The function brtd should integrate to 1 over each projected\nhemisphere\".\n\n\nHelp with integration, what is going on with diffuse transmission, anything\nelse I may be missing and/or that I am barking up the wrong tree entirely\nwould be greatly appreciated.\n\n\nThanks,\n\n\nStephen Wasilewski\n*LOISOS *+* UBBELOHDE*\n- - - - - - - - - - - - - - - - - - - - - - - - - - -\n1917 Clement Avenue  Building 10A\nAlameda, CA  94501 USA\n- - - - - - - - - - - - - - - - - - - - - - - - - - -\n510 521 3800 VOICE\n510 521 3820 FAX\n- - - - - - - - - - - - - - - - - - - - - - - - - - -\nwww.coolshadow.com\n___\n<sup>Automatically generated content from [radiance mailing-list](https://radiance-online.org/pipermail/radiance-general/2016-May/011734.html).</sup>", "id": "radiance-general_011734", "created_by": "Stephen_Wasilewski"}