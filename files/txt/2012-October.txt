From RFritz at lbl.gov  Mon Oct  1 12:53:35 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Mon, 1 Oct 2012 12:53:35 -0700
Subject: [Radiance-general] GenBSDF rcontrib options
Message-ID: <k4csbt$jnc$1@ger.gmane.org>

What rcontrib options do I have to specify when running genBSDF?  Are 
there defaults for binning, data formats and so on?  Or do I need to 
specify them as well as the rpict options?

-- 
Randolph M. Fritz ? RFritz at lbl.gov
Environmental Energy Technologies Division ? Lawrence Berkeley Labs




From gregoryjward at gmail.com  Mon Oct  1 13:42:22 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Mon, 1 Oct 2012 13:42:22 -0700
Subject: [Radiance-general] GenBSDF rcontrib options
In-Reply-To: <k4csbt$jnc$1@ger.gmane.org>
References: <k4csbt$jnc$1@ger.gmane.org>
Message-ID: <A940DA1F-FF82-4063-8706-0D458EA769E0@lmi.net>

Hi Randolph,

I'm not sure I understand your question, but normally, genBSDF sets all the rcontrib options for you.  The current defaults are "-ab 5 -ad 700 -lw 3e-6".  If you have specific ray sampling options you want to use in addition or as overrides, you can use the genBSDF -r option, e.g.:

	genBSDF -r "other rendering options" ...

Be sure to use quotes, so genBSDF gets it as one argument.

Hope this helps.
-Greg

> From: "Randolph M. Fritz" <RFritz at lbl.gov>
> Date: October 1, 2012 12:53:35 PM PDT
> 
> What rcontrib options do I have to specify when running genBSDF?  Are there defaults for binning, data formats and so on?  Or do I need to specify them as well as the rpict options?
> 
> -- 
> Randolph M. Fritz ? RFritz at lbl.gov
> Environmental Energy Technologies Division ? Lawrence Berkeley Labs


From RFritz at lbl.gov  Mon Oct  1 14:31:16 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Mon, 1 Oct 2012 14:31:16 -0700
Subject: [Radiance-general] GenBSDF rcontrib options
References: <k4csbt$jnc$1@ger.gmane.org>
	<A940DA1F-FF82-4063-8706-0D458EA769E0@lmi.net>
Message-ID: <k4d233$9dh$1@ger.gmane.org>

Great, thanks!  I'll use the defaults as a starting point, then.

Randolph

On 2012-10-01 20:42:22 +0000, Greg Ward said:

> Hi Randolph,
> 
> I'm not sure I understand your question, but normally, genBSDF sets all 
> the rcontrib options for you.  The current defaults are "-ab 5 -ad 700 
> -lw 3e-6".  If you have specific ray sampling options you want to use 
> in addition or as overrides, you can use the genBSDF -r option, e.g.:
> 
> 	genBSDF -r "other rendering options" ...
> 
> Be sure to use quotes, so genBSDF gets it as one argument.
> 
> Hope this helps.
> -Greg
> 
>> From: "Randolph M. Fritz" <RFritz at lbl.gov>
>> Date: October 1, 2012 12:53:35 PM PDT
>> 
>> What rcontrib options do I have to specify when running genBSDF?  Are 
>> there defaults for binning, data formats and so on?  Or do I need to 
>> specify them as well as the rpict options?
>> 
>> --
>> Randolph M. Fritz ? RFritz at lbl.gov
>> Environmental Energy Technologies Division ? Lawrence Berkeley Labs


-- 
Randolph M. Fritz ? RFritz at lbl.gov
Environmental Energy Technologies Division ? Lawrence Berkeley Labs




From sh.zareiy at gmail.com  Tue Oct  2 10:15:06 2012
From: sh.zareiy at gmail.com (shailan zareiy)
Date: Tue, 2 Oct 2012 20:45:06 +0330
Subject: [Radiance-general] radiance problems
Message-ID: <CABNGNZLa7VAMW+Up-f206U50tQ8jUrgweCJuxRd8ZORs4B_u8w@mail.gmail.com>

dear all
hi,i am a building physics university student,doing my thesis on
daylighting. i have a problem using radiance in my analysis,  i draw my
simulation zone on ecotect and then export it to radiance,the problem is,
each time i do the analysis the result is different. do you know what can i
do?
thanks
sincerely
Shailan Zareiy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121002/1025cacc/attachment.html>

From amcneil at lbl.gov  Tue Oct  2 10:44:24 2012
From: amcneil at lbl.gov (Andrew McNeil)
Date: Tue, 2 Oct 2012 10:44:24 -0700
Subject: [Radiance-general] radiance problems
In-Reply-To: <CABNGNZLa7VAMW+Up-f206U50tQ8jUrgweCJuxRd8ZORs4B_u8w@mail.gmail.com>
References: <CABNGNZLa7VAMW+Up-f206U50tQ8jUrgweCJuxRd8ZORs4B_u8w@mail.gmail.com>
Message-ID: <CAOG+NixPr756Yt0AXOQJAKpJwsWLVhN3vq6Hk2juXdtDmta2=w@mail.gmail.com>

Hi Shailan,
Radiance uses probabilistic sampling of the model, which means that sample
rays are different for each run.  You will never be able to get exactly the
same result every time, but by tightening the simulation parameters you can
reduce the difference between runs considerably.  Better simulation
parameters means longer simulation times - it's a typical tradeoff between
precision and duration (you can have noisy results quickly or precise
results tomorrow).

I suggest looking at the descriptions of simulation parameters in this
tutorial:
http://www.jaloxa.eu/resources/radiance/documentation/docs/radiance_tutorial.pdf
and those starting on page 10 of this tutorial:
http://www.radiance-online.org/learning/tutorials/radiance-primer.pdf
and playing with your results.

I'm a big fan of convergence testing of simulation parameters to build
confidence in results.  Without convergence testing I have no way of
knowing what parameters are good for a model.  John Mardaljevic did some
convergence testing in his thesis (see figure 3-26 & 3-30):
http://www.iesd.dmu.ac.uk/~jm/lib/exe/fetch.php?media=resources:mardaljevic_chap3.pdf

It also helps to look at your model interactively in Radiance with rvu to
make sure that everything is how you expect.  I think there is a version of
rvu that works on windows in the NREL radiance package:
https://openstudio.nrel.gov/getting-started-developer/getting-started-radiance

Best,
Andy

On Tue, Oct 2, 2012 at 10:15 AM, shailan zareiy <sh.zareiy at gmail.com> wrote:

>
> dear all
> hi,i am a building physics university student,doing my thesis on
> daylighting. i have a problem using radiance in my analysis,  i draw my
> simulation zone on ecotect and then export it to radiance,the problem is,
> each time i do the analysis the result is different. do you know what can i
> do?
> thanks
> sincerely
> Shailan Zareiy
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121002/40c7bd80/attachment.html>

From amaliemomme at gmail.com  Wed Oct  3 06:27:04 2012
From: amaliemomme at gmail.com (Amalie Momme)
Date: Wed, 3 Oct 2012 15:27:04 +0200
Subject: [Radiance-general] Asymmetry in Daylight Factor Results and
	modification of UDI
Message-ID: <0A2D5ADD-7C16-4295-890A-66CFBDFD377D@gmail.com>


 Hello all,

I am new to Radiance / Daysim, so I hope you can help help out with a few questions.

I am using DAYSIM via Ecotect to simulate the daylight conditions for an office, 4 x 5 m, symmetrical geometry, with one window. I noticed that the Daylight Factor results were not completely symmetrical. Deviations are typically around 0.1-0.3 % DF. I tried increasing the number of ambient bounces from 6-8-10 which did not eliminate the asymmetry. I contacted an engineer who has been using Daysim via Ecotect in his ph.d. study, and he wrote that his Daylight Factors were also a bit asymmetrical. Can anyone explain why this is the case? In theory the Daylight Factor should be completely symmetrical, as the CIE Standard Sky is symmetrical. Does this have anything to do with Daysim using the Daylight Coefficient Method?

Another thing is that I would like to modify the UDI to make it case dependent. So instead of using 2000 as the upper limit for useful daylight, I would like to insert a sensor point, calculate the DGP (Daylight Glare Probability), and use this as the upper limit. Does anyone know if it is possible to extract the results for each hour, for each sensor point, to count the hours of useful daylight based on this?

Thank you in advance,
Amalie Momme
 
 
 


From rob.guglielmetti at gmail.com  Wed Oct  3 07:49:58 2012
From: rob.guglielmetti at gmail.com (Rob Guglielmetti)
Date: Wed, 3 Oct 2012 08:49:58 -0600
Subject: [Radiance-general] New OpenStudio Version, New Radiance Installers
Message-ID: <295249CD-8881-4000-906B-21D88D44FFBC@gmail.com>

Hi Folks,

Just a quick note to let you know that we have updated the Radiance installers to coincide with the new 0.9.0 release of OpenStudio. 

Radiance installers here:
https://openstudio.nrel.gov/getting-started-developer/getting-started-radiance

News on the new OpenStudio release here:
http://openstudio.nrel.gov/content/openstudio-090-release

I tried statically linking to the tiff libraries so hopefully this version of the Mac installer will work on 10.5, I just don't have a 10.5 system to test it out on. Let us know!

- Rob

From Robert.Guglielmetti at nrel.gov  Wed Oct  3 08:28:10 2012
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Wed, 3 Oct 2012 09:28:10 -0600
Subject: [Radiance-general] Asymmetry in Daylight Factor Results and
 modification of UDI
In-Reply-To: <0A2D5ADD-7C16-4295-890A-66CFBDFD377D@gmail.com>
References: <0A2D5ADD-7C16-4295-890A-66CFBDFD377D@gmail.com>
Message-ID: <FFF56A6D37A3A54F91A03601AC22DA3225FDC07C04@MAILBOX2.nrel.gov>

Hi Amalie,

Deviations from point to point are to be expected. Radiance uses stochastic sampling, which will result in different "answers" from one run to the next. Further, I assume you are using a CIE standard overcast sky for your DF calculations? THat is not "symmetrical" either. That sky increases in radiance as you increase the altitude from the horizon to the zenith. It might help to have more details about your model and your results to help diagnose this.

Regarding your UDI question, using the latest version of OpenStudio (v0.9.0), you could perform a DGP-based UDI analysis like you are trying to do. OpenStudio now reports out DA, cDA, and UDI for each space's illuminance map to a .csv file. There is also a glare sensor object now that reports DGP(simplified). You could write a Ruby script that takes the UDI and DGP values and for each timestep makes an evaluation about the UDI, using the DGP value as the trigger for the high end of UDI, instead of 2000 lux.

The glare sensor also can have one or multiple "glare views", as well; the max, min and mean are always reported in the .csv file, allowing you to evaluate DGP for a range of views, a la Jacubiec and Reinhart's "adaptive zone" idea.  Let me know if you want help writing a script that does what you want. 

- Rob

________________________________________
From: Amalie Momme [amaliemomme at gmail.com]
Sent: Wednesday, October 03, 2012 7:27 AM
To: Radiance-general at radiance-online.org
Subject: [Radiance-general] Asymmetry in Daylight Factor Results and    modification of UDI

 Hello all,

I am new to Radiance / Daysim, so I hope you can help help out with a few questions.

I am using DAYSIM via Ecotect to simulate the daylight conditions for an office, 4 x 5 m, symmetrical geometry, with one window. I noticed that the Daylight Factor results were not completely symmetrical. Deviations are typically around 0.1-0.3 % DF. I tried increasing the number of ambient bounces from 6-8-10 which did not eliminate the asymmetry. I contacted an engineer who has been using Daysim via Ecotect in his ph.d. study, and he wrote that his Daylight Factors were also a bit asymmetrical. Can anyone explain why this is the case? In theory the Daylight Factor should be completely symmetrical, as the CIE Standard Sky is symmetrical. Does this have anything to do with Daysim using the Daylight Coefficient Method?

Another thing is that I would like to modify the UDI to make it case dependent. So instead of using 2000 as the upper limit for useful daylight, I would like to insert a sensor point, calculate the DGP (Daylight Glare Probability), and use this as the upper limit. Does anyone know if it is possible to extract the results for each hour, for each sensor point, to count the hours of useful daylight based on this?

Thank you in advance,
Amalie Momme




_______________________________________________
Radiance-general mailing list
Radiance-general at radiance-online.org
http://www.radiance-online.org/mailman/listinfo/radiance-general

From amcneil at lbl.gov  Wed Oct  3 09:41:19 2012
From: amcneil at lbl.gov (Andrew McNeil)
Date: Wed, 3 Oct 2012 09:41:19 -0700
Subject: [Radiance-general] Asymmetry in Daylight Factor Results and
 modification of UDI
In-Reply-To: <FFF56A6D37A3A54F91A03601AC22DA3225FDC07C04@MAILBOX2.nrel.gov>
References: <0A2D5ADD-7C16-4295-890A-66CFBDFD377D@gmail.com>
	<FFF56A6D37A3A54F91A03601AC22DA3225FDC07C04@MAILBOX2.nrel.gov>
Message-ID: <CAOG+NiyrXtF7nqRuJQh3+1Y3e7UgBjm8S2Zpy806U92n2SYTJA@mail.gmail.com>

Hi Amalie,

Increasing the number of samples should get you closer to the symmetry you
expect. The best way to do this is by increasing -ad.  You should also try
reducing ambient interpolation by increasing -ar and/or decreasing -aa.

It is common for beginner (and intermediate, and expert) users to focus on
the -ab parameter, but I find adjusting other ambient parameters is
typically more effective.

Best,
Andy


On Wed, Oct 3, 2012 at 8:28 AM, Guglielmetti, Robert <
Robert.Guglielmetti at nrel.gov> wrote:

> Hi Amalie,
>
> Deviations from point to point are to be expected. Radiance uses
> stochastic sampling, which will result in different "answers" from one run
> to the next. Further, I assume you are using a CIE standard overcast sky
> for your DF calculations? THat is not "symmetrical" either. That sky
> increases in radiance as you increase the altitude from the horizon to the
> zenith. It might help to have more details about your model and your
> results to help diagnose this.
>
> Regarding your UDI question, using the latest version of OpenStudio
> (v0.9.0), you could perform a DGP-based UDI analysis like you are trying to
> do. OpenStudio now reports out DA, cDA, and UDI for each space's
> illuminance map to a .csv file. There is also a glare sensor object now
> that reports DGP(simplified). You could write a Ruby script that takes the
> UDI and DGP values and for each timestep makes an evaluation about the UDI,
> using the DGP value as the trigger for the high end of UDI, instead of 2000
> lux.
>
> The glare sensor also can have one or multiple "glare views", as well; the
> max, min and mean are always reported in the .csv file, allowing you to
> evaluate DGP for a range of views, a la Jacubiec and Reinhart's "adaptive
> zone" idea.  Let me know if you want help writing a script that does what
> you want.
>
> - Rob
>
> ________________________________________
> From: Amalie Momme [amaliemomme at gmail.com]
> Sent: Wednesday, October 03, 2012 7:27 AM
> To: Radiance-general at radiance-online.org
> Subject: [Radiance-general] Asymmetry in Daylight Factor Results and
>  modification of UDI
>
>  Hello all,
>
> I am new to Radiance / Daysim, so I hope you can help help out with a few
> questions.
>
> I am using DAYSIM via Ecotect to simulate the daylight conditions for an
> office, 4 x 5 m, symmetrical geometry, with one window. I noticed that the
> Daylight Factor results were not completely symmetrical. Deviations are
> typically around 0.1-0.3 % DF. I tried increasing the number of ambient
> bounces from 6-8-10 which did not eliminate the asymmetry. I contacted an
> engineer who has been using Daysim via Ecotect in his ph.d. study, and he
> wrote that his Daylight Factors were also a bit asymmetrical. Can anyone
> explain why this is the case? In theory the Daylight Factor should be
> completely symmetrical, as the CIE Standard Sky is symmetrical. Does this
> have anything to do with Daysim using the Daylight Coefficient Method?
>
> Another thing is that I would like to modify the UDI to make it case
> dependent. So instead of using 2000 as the upper limit for useful daylight,
> I would like to insert a sensor point, calculate the DGP (Daylight Glare
> Probability), and use this as the upper limit. Does anyone know if it is
> possible to extract the results for each hour, for each sensor point, to
> count the hours of useful daylight based on this?
>
> Thank you in advance,
> Amalie Momme
>
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121003/ba5bc1ed/attachment.html>

From sh.zareiy at gmail.com  Wed Oct  3 11:16:46 2012
From: sh.zareiy at gmail.com (shailan zareiy)
Date: Wed, 3 Oct 2012 21:46:46 +0330
Subject: [Radiance-general] radiance problems
In-Reply-To: <CAOG+NixPr756Yt0AXOQJAKpJwsWLVhN3vq6Hk2juXdtDmta2=w@mail.gmail.com>
References: <CABNGNZLa7VAMW+Up-f206U50tQ8jUrgweCJuxRd8ZORs4B_u8w@mail.gmail.com>
	<CAOG+NixPr756Yt0AXOQJAKpJwsWLVhN3vq6Hk2juXdtDmta2=w@mail.gmail.com>
Message-ID: <CABNGNZJVp7Xf8UjjtraWqWYpgyno4hkJ0iLUD6v-+CgpOEV_-w@mail.gmail.com>

Thank you very much andy. I think your answer solved the problem.

On Tue, Oct 2, 2012 at 9:14 PM, Andrew McNeil <amcneil at lbl.gov> wrote:

> Hi Shailan,
> Radiance uses probabilistic sampling of the model, which means that sample
> rays are different for each run.  You will never be able to get exactly the
> same result every time, but by tightening the simulation parameters you can
> reduce the difference between runs considerably.  Better simulation
> parameters means longer simulation times - it's a typical tradeoff between
> precision and duration (you can have noisy results quickly or precise
> results tomorrow).
>
> I suggest looking at the descriptions of simulation parameters in this
> tutorial:
>
> http://www.jaloxa.eu/resources/radiance/documentation/docs/radiance_tutorial.pdf
> and those starting on page 10 of this tutorial:
> http://www.radiance-online.org/learning/tutorials/radiance-primer.pdf
> and playing with your results.
>
> I'm a big fan of convergence testing of simulation parameters to build
> confidence in results.  Without convergence testing I have no way of
> knowing what parameters are good for a model.  John Mardaljevic did some
> convergence testing in his thesis (see figure 3-26 & 3-30):
>
> http://www.iesd.dmu.ac.uk/~jm/lib/exe/fetch.php?media=resources:mardaljevic_chap3.pdf
>
> It also helps to look at your model interactively in Radiance with rvu to
> make sure that everything is how you expect.  I think there is a version of
> rvu that works on windows in the NREL radiance package:
>
> https://openstudio.nrel.gov/getting-started-developer/getting-started-radiance
>
> Best,
> Andy
>
> On Tue, Oct 2, 2012 at 10:15 AM, shailan zareiy <sh.zareiy at gmail.com>wrote:
>
>>
>> dear all
>> hi,i am a building physics university student,doing my thesis on
>> daylighting. i have a problem using radiance in my analysis,  i draw my
>> simulation zone on ecotect and then export it to radiance,the problem is,
>> each time i do the analysis the result is different. do you know what can i
>> do?
>> thanks
>> sincerely
>> Shailan Zareiy
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121003/a1ffe855/attachment-0001.html>

From hujia06 at gmail.com  Wed Oct  3 12:53:22 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Wed, 3 Oct 2012 15:53:22 -0400
Subject: [Radiance-general] Problem of DaylightSim.rb in Window 7
Message-ID: <CABzgtwqUGfXLWtepZLe6MJPLj+UKYxzykSxwk+SiWQ=oh2W5AA@mail.gmail.com>

Hi all:

I made a preliminary run using OpenStudio V 0.9 DaylightSim.rb in Window 7.

The #{outPath} in DaylightSim.rb uses forward slash which is OK for
most commands, but I find the following code shows incorrect syntax
because of using forward slash in outPath and "type" (i.e.,
catCommand) command..

system("#{catCommand} #{outPath}/materials/materials_vmx.rad
#{outPath}/scene/glazing/#{space_name}_glaz_#{aziVector}.rad >
window_temp.rad")

Thanks,

Jia


From babboushi at email.arizona.edu  Wed Oct  3 12:58:20 2012
From: babboushi at email.arizona.edu (Belal Khalid Abboushi)
Date: Wed, 3 Oct 2012 12:58:20 -0700
Subject: [Radiance-general] Daysim monthly daylight and electric lighting
	data
Message-ID: <CAJ6rF0bNpqH6EpiNAQcftq8FY+e1gpf=5ouV-gAv2K1hpGxRvw@mail.gmail.com>

Hello everybody,

I'm trying to use Daysim to simulate different configurations for a dynamic
shading system. My understanding is that Daysim produces daylight and
electric lighting data for the whole year. So my intention is to create a
separate Daysim project for each case. And then assemble the 12 monthly
data manually to get one *.ill file for the whole year.
Does anyone know how can i use the new *.ill file to generate daylight and
electric lighting data for the whole year ? is there a way to import it
into daysim to show the results? if not, how can i do that manually ?

Thanks a lot,
Belal Abboushi

-- 
*Belal Khalid Abboushi*

M.Sc.Arch Candidate - Design & Energy Conservation

College of Architecture and Landscape Architecture
The University of Arizona - U.S.A.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121003/84d8635e/attachment.html>

From hujia06 at gmail.com  Wed Oct  3 15:09:29 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Wed, 3 Oct 2012 18:09:29 -0400
Subject: [Radiance-general] Problem of DaylightSim.rb in Window 7
In-Reply-To: <CABzgtwqUGfXLWtepZLe6MJPLj+UKYxzykSxwk+SiWQ=oh2W5AA@mail.gmail.com>
References: <CABzgtwqUGfXLWtepZLe6MJPLj+UKYxzykSxwk+SiWQ=oh2W5AA@mail.gmail.com>
Message-ID: <CABzgtwptwM8DsvQxS_P-XoXCf4y0n-kn_GM_m7kKC_UHq-cBjA@mail.gmail.com>

Hi all

Another question about the DaylightSim.rb.  In Window 7, view matrix for
the three phase method is not generated using "--dc --z", and I add the
following code in line #590 for generating the view matrix.

#add following code in line #590:
exec_statement("type #{outPath}\\numeric\\#{space_name}.map | rcontrib
#{rtrace_args} -f klems_int.cal -bn Nkbins -I+ -fa  -o
#{outPath}\\output\\dc\\#{space_name}\\maps\\%s_#{space_name}.vmx
#{binPairs} #{outPath}\\octrees\\model_dc.oct")

Besides, the following code in Line # 581:

binPairs << " -b
'kbin(#{viewVectorX.round_to_str(2)},#{viewVectorY.round_to_str(2)},0,0,0,1)'
-m glaz_#{aziVector}_#{glazingTransmissivity}"

is changed to:

binPairs << " -b
 kbin(#{viewVectorX.round_to_str(2)},#{viewVectorY.round_to_str(2)},0,0,0,1)
-m glaz_#{aziVector}_#{glazingTransmissivity}"

Thanks,

Jia

On Wed, Oct 3, 2012 at 3:53 PM, Jia Hu <hujia06 at gmail.com> wrote:
> Hi all:
>
> I made a preliminary run using OpenStudio V 0.9 DaylightSim.rb in Window
7.
>
> The #{outPath} in DaylightSim.rb uses forward slash which is OK for
> most commands, but I find the following code shows incorrect syntax
> because of using forward slash in outPath and "type" (i.e.,
> catCommand) command..
>
> system("#{catCommand} #{outPath}/materials/materials_vmx.rad
> #{outPath}/scene/glazing/#{space_name}_glaz_#{aziVector}.rad >
> window_temp.rad")
>
> Thanks,
>
> Jia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121003/0ed8d58d/attachment.html>

From amcneil at lbl.gov  Wed Oct  3 15:38:39 2012
From: amcneil at lbl.gov (Andrew McNeil)
Date: Wed, 3 Oct 2012 15:38:39 -0700
Subject: [Radiance-general] Daysim and Open Studio mailing lists
Message-ID: <CAOG+Niw448fHamcKEu+mxYA_4Y2RAE+mmk4xkgDGnY1xZPWU3A@mail.gmail.com>

I want to issue a friendly reminder that radiance-online now
has separate mailing lists for Open Studio and Daysim discussion.  Let's
try to keep topics on the appropriate lists so that radiance-general
subscribers aren't spammed with Daysim and Open Studio discussion topics.

radiance-openstudio at radiance-online.org
radiance-daysim at radiance-online.org

you can subscribe to these mailing lists here:
http://www.radiance-online.org/community/mailing-lists

Thanks,
Andy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121003/d2714012/attachment.html>

From bayanda at pjc.co.za  Thu Oct  4 03:52:38 2012
From: bayanda at pjc.co.za (Bayanda Mpauli)
Date: Thu, 4 Oct 2012 12:52:38 +0200
Subject: [Radiance-general] Daylight Autonomy Benchmarks
Message-ID: <001a01cda21e$60e56f60$22b04e20$@pjc.co.za>

Dear All 

 

I am looking for papers/research for DA thresholds related to good indoor
environmental quality that can be referenced in our South African version of
LEED and was wondering if anyone might be able to point me in the right
direction? 

 

The Green Building Council of South Africa is considering using Daylight
Autonomy as an indicator for their Daylight Credit for the Greenstar SA
Public and Education Building Tool - our version of LEED. They currently use
DF. The credit falls under the Indoor and Environmental Quality section and
so is about the positive impact of daylight on the occupants rather than
energy savings. They have a separate glare related credit and so this does
not have to be considered within this credit. 

 

At the moment the proposal for inclusion of DA includes the following
thresholds. 

 

A DA of 80%  for 160lux with

1)      1 Point awarded for 30% of the occupied area

2)      2 points awarded for 60% of the occupied area

3)      3 points awarded for 90% of the occupied area

 

They are trying to find out from the Green building Council of Australia
(who has put the DA credit out for review in their industry and is the basis
of the South Africa credtit) where the 80% and 160lux threshold has
originated from and in the meantime have requested South Africa consultants
to review these figures to determine what threshold would be considered
appropriate and indicated of good indoor environmental daylight quality.
Something to note is that the certification is for the building being handed
over to tenants and it assumes no furniture nor portioning as that is not in
the control of the landlord - in order for it to be representative  we would
be proposing quite a low reflectance floor level to try and build in at
least some representation of what might happen in the space if a daylight
conscious tenant fitted out the space - alternatively we might up the 160
lux threshold to something higher also to accommodate for furniture.  It is
currently undefined whether it be incremental or continuous DA but I think
this will just impact on the threshold selected. 

 

Ideally we would like to have the threshold based on some form of researched
data already performed that can then be referenced. We are not in a position
nor have the time to perform this research now. As the tools do get updated
over time, it would be possible to review the figure and align it with the
most current research or even review the applicability of DA itself and
substitute it with future indicators that are more representative of
daylight quality. 

 

 

Regards,

Bayanda

BAS (UCT)

Green Star SA Accredited Professional

 

PJ Carew Consulting

3rd floor 71 buitengraght Cape Town 8001

tel: 021 426 4051  fax: 021 426 5050  cell: 083 335 9365

 <mailto:bayanda at pjc.co.za> bayanda at pjc.co.za    <http://www.pjc.co.za/>
www.pjc.co.za 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121004/398fdd77/attachment-0001.html>

From grobe at gmx.net  Thu Oct  4 04:12:50 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Thu, 04 Oct 2012 13:12:50 +0200
Subject: [Radiance-general] Daylight Autonomy Benchmarks
In-Reply-To: <001a01cda21e$60e56f60$22b04e20$@pjc.co.za>
References: <001a01cda21e$60e56f60$22b04e20$@pjc.co.za>
Message-ID: <506D6F32.8030008@gmx.net>

Hi Bayanda,

are you aware of John Mardaljevic's works on dynamic daylight
performance metrics, and especially his proposed UDI system (which has
been refined)? Other then DA, it also includes an upper limit of
acceptable illuminance, wich would probably trigger shading. On the
other hand, the upper limit has been discussed as obviously, it depends
on the individual preferrence of occupants as well as on tasks.

Cheers, Lars.


From amaliemomme at gmail.com  Thu Oct  4 07:48:29 2012
From: amaliemomme at gmail.com (Amalie Momme)
Date: Thu, 4 Oct 2012 16:48:29 +0200
Subject: [Radiance-general] Asymmetry in Daylight Factor Results and
 modification of UDI
In-Reply-To: <CAOG+NiyrXtF7nqRuJQh3+1Y3e7UgBjm8S2Zpy806U92n2SYTJA@mail.gmail.com>
References: <0A2D5ADD-7C16-4295-890A-66CFBDFD377D@gmail.com>
	<FFF56A6D37A3A54F91A03601AC22DA3225FDC07C04@MAILBOX2.nrel.gov>
	<CAOG+NiyrXtF7nqRuJQh3+1Y3e7UgBjm8S2Zpy806U92n2SYTJA@mail.gmail.com>
Message-ID: <CAOs1TpZb2MpAvirWR_tzTaWTtqjKWBswMC3pKvj1wDCZi5xS+w@mail.gmail.com>

Hi Rob and Andy,
Thank you very much for your quick answers!
@Rob: My model is a square office (A box), room depth 5 m, facade length 4
m and height 3 m. It has a window with height 1.8 m, length 2.8 m placed in
the center of the facade, with the bottom 0.9 m above the floor. The
analysis grid is placed 0.9 m above the floor parallel to the xy plane. The
location is Copenhagen, Denmark. So far, there are no exterior obstructions
in the model, but there will be in the final model as the office is in an
urban environment. When I noticed the asymmetrical DF results I thought I
might have done something wrong when building up the model, and I wanted to
fix this before creating a more complex one. The asymmetry is along the
center axis of the room, but if you say this is to be expected due to the
stochastic sampling, then I will accept the deviations and try to decrease
them by playing with the other simulation parameters Andy suggested. Thank
you for your offer regarding help with the script for OpenStudio, that is
very kind of you! However, I think I will stick to Ecotect/Daysim, and skip
the modification of the UDI for now as my experience with OpenStudio is
very limited and I have a deadline. I might return to this later for
fun though.

@Andy: Thank you very much, I will try playing with the other
parameters. (And post future Daysim questions on the Daysim mailing list
:-))

Amalie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121004/87357cff/attachment.html>

From tim.v2.0 at gmail.com  Thu Oct  4 10:37:47 2012
From: tim.v2.0 at gmail.com (Tim Perry)
Date: Thu, 4 Oct 2012 10:37:47 -0700
Subject: [Radiance-general] Daylight Autonomy Benchmarks
In-Reply-To: <001a01cda21e$60e56f60$22b04e20$@pjc.co.za>
References: <001a01cda21e$60e56f60$22b04e20$@pjc.co.za>
Message-ID: <CAFVgASXm_gXkCqoC5Yi1XcUpdNerzD_WKR4YcO7v9QfNySRw5Q@mail.gmail.com>

Dear Buyanda,

I'd recommend the Daylight Pattern Guide.
http://patternguide.advancedbuildings.net/using-this-guide/analysis-methods/daylight-autonomy

Enjoy,
Tim


On Thu, Oct 4, 2012 at 3:52 AM, Bayanda Mpauli <bayanda at pjc.co.za> wrote:
> Dear All
>
>
>
> I am looking for papers/research for DA thresholds related to good indoor
> environmental quality that can be referenced in our South African version of
> LEED and was wondering if anyone might be able to point me in the right
> direction?
>
>
>
> The Green Building Council of South Africa is considering using Daylight
> Autonomy as an indicator for their Daylight Credit for the Greenstar SA
> Public and Education Building Tool ? our version of LEED. They currently use
> DF. The credit falls under the Indoor and Environmental Quality section and
> so is about the positive impact of daylight on the occupants rather than
> energy savings. They have a separate glare related credit and so this does
> not have to be considered within this credit.
>
>
>
> At the moment the proposal for inclusion of DA includes the following
> thresholds.
>
>
>
> A DA of 80%  for 160lux with
>
> 1)      1 Point awarded for 30% of the occupied area
>
> 2)      2 points awarded for 60% of the occupied area
>
> 3)      3 points awarded for 90% of the occupied area
>
>
>
> They are trying to find out from the Green building Council of Australia
> (who has put the DA credit out for review in their industry and is the basis
> of the South Africa credtit) where the 80% and 160lux threshold has
> originated from and in the meantime have requested South Africa consultants
> to review these figures to determine what threshold would be considered
> appropriate and indicated of good indoor environmental daylight quality.
> Something to note is that the certification is for the building being handed
> over to tenants and it assumes no furniture nor portioning as that is not in
> the control of the landlord ? in order for it to be representative  we would
> be proposing quite a low reflectance floor level to try and build in at
> least some representation of what might happen in the space if a daylight
> conscious tenant fitted out the space ? alternatively we might up the 160
> lux threshold to something higher also to accommodate for furniture.  It is
> currently undefined whether it be incremental or continuous DA but I think
> this will just impact on the threshold selected.
>
>
>
> Ideally we would like to have the threshold based on some form of researched
> data already performed that can then be referenced. We are not in a position
> nor have the time to perform this research now. As the tools do get updated
> over time, it would be possible to review the figure and align it with the
> most current research or even review the applicability of DA itself and
> substitute it with future indicators that are more representative of
> daylight quality.
>
>
>
>
>
> Regards,
>
> Bayanda
>
> BAS (UCT)
>
> Green Star SA Accredited Professional
>
>
>
> PJ Carew Consulting
>
> 3rd floor 71 buitengraght Cape Town 8001
>
> tel: 021 426 4051  fax: 021 426 5050  cell: 083 335 9365
>
> bayanda at pjc.co.za   www.pjc.co.za
>
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>


From iabel at iebele.nl  Sat Oct  6 12:15:24 2012
From: iabel at iebele.nl (Iebele)
Date: Sat, 6 Oct 2012 22:15:24 +0300
Subject: [Radiance-general] pcomb question
Message-ID: <D913B06F-045B-4504-A2FF-5B1B24F49774@iebele.nl>

Hi, 

I have a couple of Radiance images which are almost the same. These images are combined using pcomb:

pcomb img01.hdr img02.hdr img03.hdr ? > combined.hdr 

Using pcomb this way, the resulting image has higher radiance values as the input images. What I want is that the resulting image has the same radiance values as the input files. How can I do that? 

Any hints are most welcome, 

Cheers, 

- iebele 

 

From gregoryjward at gmail.com  Sat Oct  6 12:24:38 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Sat, 6 Oct 2012 12:24:38 -0700
Subject: [Radiance-general] pcomb question
In-Reply-To: <D913B06F-045B-4504-A2FF-5B1B24F49774@iebele.nl>
References: <D913B06F-045B-4504-A2FF-5B1B24F49774@iebele.nl>
Message-ID: <3DC6D26D-0499-4A70-90DB-B691727F9FEA@lmi.net>

Try:

	pcomb -s .3333 img01.hdr -s .3333 img02.hdr -s .3333 img03.hdr > combined.hdr

You'll need to adjust the scale factor based on the number of images (of course).  If you care about the absolute values and exposures have been applied to your image, you should add a "-o" option before each input file as well.

Cheers,
-Greg

> From: Iebele <iabel at iebele.nl>
> Date: October 6, 2012 12:15:24 PM PDT
> 
> Hi, 
> 
> I have a couple of Radiance images which are almost the same. These images are combined using pcomb:
> 
> pcomb img01.hdr img02.hdr img03.hdr ? > combined.hdr 
> 
> Using pcomb this way, the resulting image has higher radiance values as the input images. What I want is that the resulting image has the same radiance values as the input files. How can I do that? 
> 
> Any hints are most welcome, 
> 
> Cheers, 
> 
> - iebele 
> 


From iabel at iebele.nl  Sat Oct  6 14:01:22 2012
From: iabel at iebele.nl (Iebele)
Date: Sun, 7 Oct 2012 00:01:22 +0300
Subject: [Radiance-general] pcomb question
In-Reply-To: <3DC6D26D-0499-4A70-90DB-B691727F9FEA@lmi.net>
References: <D913B06F-045B-4504-A2FF-5B1B24F49774@iebele.nl>
	<3DC6D26D-0499-4A70-90DB-B691727F9FEA@lmi.net>
Message-ID: <11330988-4033-49A6-B6CA-905BD08F9EC5@iebele.nl>

Great! 

This is exactly what I needed. I didn't get it from the manage, though :) 

Thanks, 

- iebele 


Op 6 okt. 2012, om 22:24 heeft Greg Ward het volgende geschreven:

> Try:
> 
> 	pcomb -s .3333 img01.hdr -s .3333 img02.hdr -s .3333 img03.hdr > combined.hdr
> 
> You'll need to adjust the scale factor based on the number of images (of course).  If you care about the absolute values and exposures have been applied to your image, you should add a "-o" option before each input file as well.
> 
> Cheers,
> -Greg
> 
>> From: Iebele <iabel at iebele.nl>
>> Date: October 6, 2012 12:15:24 PM PDT
>> 
>> Hi, 
>> 
>> I have a couple of Radiance images which are almost the same. These images are combined using pcomb:
>> 
>> pcomb img01.hdr img02.hdr img03.hdr ? > combined.hdr 
>> 
>> Using pcomb this way, the resulting image has higher radiance values as the input images. What I want is that the resulting image has the same radiance values as the input files. How can I do that? 
>> 
>> Any hints are most welcome, 
>> 
>> Cheers, 
>> 
>> - iebele 
>> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general



From sh.zareiy at gmail.com  Sun Oct  7 13:18:08 2012
From: sh.zareiy at gmail.com (shailan zareiy)
Date: Sun, 7 Oct 2012 23:48:08 +0330
Subject: [Radiance-general] weather data in radiance
Message-ID: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>

dear all
hi,i have a question about the weather data in radiance simulation. i want
to know which items of weather data is used in a daylight simulation by the
radiance software.
thanks for your help
Sincerely
Shailan Zareiy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121007/ed3ef03f/attachment.html>

From iabel at iebele.nl  Sun Oct  7 13:57:38 2012
From: iabel at iebele.nl (Iebele)
Date: Sun, 7 Oct 2012 23:57:38 +0300
Subject: [Radiance-general] Monte Carlo sampling setting
In-Reply-To: <11330988-4033-49A6-B6CA-905BD08F9EC5@iebele.nl>
References: <D913B06F-045B-4504-A2FF-5B1B24F49774@iebele.nl>
	<3DC6D26D-0499-4A70-90DB-B691727F9FEA@lmi.net>
	<11330988-4033-49A6-B6CA-905BD08F9EC5@iebele.nl>
Message-ID: <DF1DA428-C7A0-40B8-8924-B92B62411DDB@iebele.nl>

Hi Greg,  

I need a test with true Monte Carlo sampling (in the contrary as many earlier requests, I need as much variance in different runs of rpiece as possible).
I assume rpiece takes the same default values as rpict (?)

"rpict -defaults" gives: 

-u-  # correlated quasi-Monte Carlo sampling

It is not clear to me how to set true Monte Carlo sampling on. 

-u+ ? 

Cheers, 

- iebele






From gregoryjward at gmail.com  Sun Oct  7 14:42:20 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Sun, 7 Oct 2012 14:42:20 -0700
Subject: [Radiance-general] Monte Carlo sampling setting
In-Reply-To: <DF1DA428-C7A0-40B8-8924-B92B62411DDB@iebele.nl>
References: <D913B06F-045B-4504-A2FF-5B1B24F49774@iebele.nl>
	<3DC6D26D-0499-4A70-90DB-B691727F9FEA@lmi.net>
	<11330988-4033-49A6-B6CA-905BD08F9EC5@iebele.nl>
	<DF1DA428-C7A0-40B8-8924-B92B62411DDB@iebele.nl>
Message-ID: <BCF5B7A0-C3AC-413B-BAFB-86B0FDC651A1@lmi.net>

Yes and yes.  You can use the -u+ option in rpiece, along with all the other rpict options.  I recommend setting "-ps 1" as well for pure MC.

-Greg

> From: Iebele <iabel at iebele.nl>
> Date: October 7, 2012 1:57:38 PM PDT
> 
> Hi Greg,  
> 
> I need a test with true Monte Carlo sampling (in the contrary as many earlier requests, I need as much variance in different runs of rpiece as possible).
> I assume rpiece takes the same default values as rpict (?)
> 
> "rpict -defaults" gives: 
> 
> -u-  # correlated quasi-Monte Carlo sampling
> 
> It is not clear to me how to set true Monte Carlo sampling on. 
> 
> -u+ ? 
> 
> Cheers, 
> 
> - iebele


From gregoryjward at gmail.com  Sun Oct  7 14:44:20 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Sun, 7 Oct 2012 14:44:20 -0700
Subject: [Radiance-general] weather data in radiance
In-Reply-To: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
Message-ID: <76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>

Radiance doesn't take weather data directly.  The gensky and gendaylit programs in Radiance can use some information from weather tapes to adjust their sky models, but there aren't any built-in utilities to handle weather tapes.

Daysim does have such utilities, and we are hoping to add some facilities in the next year or so.

-Greg

> From: shailan zareiy <sh.zareiy at gmail.com>
> Date: October 7, 2012 1:18:08 PM PDT
> 
> dear all
> hi,i have a question about the weather data in radiance simulation. i want to know which items of weather data is used in a daylight simulation by the radiance software.
> thanks for your help
> Sincerely
> Shailan Zareiy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121007/d025d3ce/attachment.html>

From grobe at gmx.net  Mon Oct  8 02:32:17 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Mon, 08 Oct 2012 11:32:17 +0200
Subject: [Radiance-general] weather data in radiance
In-Reply-To: <76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
	<76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
Message-ID: <50729DA1.2030803@gmx.net>

Hi,

just one hint - if you need to process weather data, tr (to replace 
separators) and awk (to select and reformat fields of records) will be 
helpful to load the relevant fields into gendaylit. Both are standard 
tools in any Unix-like system, includig Mac OS X and Linux.

Cheers, Lars.


From nynassif at gmail.com  Mon Oct  8 03:22:03 2012
From: nynassif at gmail.com (nassif nassif)
Date: Mon, 8 Oct 2012 12:22:03 +0200
Subject: [Radiance-general] photomapping example
Message-ID: <CAOQvQd=Xv2i14tda4O6AYNbQ7h5ZUEd5WjkQr_u0mdPVde_OHw@mail.gmail.com>

hallo people,

I am planning to simulate a simple geometry using photomapping.

Is there any simple script of how photo-mapping works? my aim is to check
the output for different material (glass, prism, trans...) feeded with a
narrow beam Fixture which results different outputs.

thanks in advance!

-- 
*N.Nassif

Lighting Designer***
*PLDA Member

Neue Str. 55
21073, Hamburg
Deutschland

+49 162 6050060
nynassif at gmail.com*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121008/efd6b2fc/attachment.html>

From grobe at gmx.net  Mon Oct  8 03:43:47 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Mon, 08 Oct 2012 12:43:47 +0200
Subject: [Radiance-general] photomapping example
In-Reply-To: <CAOQvQd=Xv2i14tda4O6AYNbQ7h5ZUEd5WjkQr_u0mdPVde_OHw@mail.gmail.com>
References: <CAOQvQd=Xv2i14tda4O6AYNbQ7h5ZUEd5WjkQr_u0mdPVde_OHw@mail.gmail.com>
Message-ID: <5072AE63.2030702@gmx.net>

Hi Nassif!
> I am planning to simulate a simple geometry using photomapping.
>
> Is there any simple script of how photo-mapping works? my aim is to 
> check the output for different material (glass, prism, trans...) 
> feeded with a narrow beam Fixture which results different outputs.
Start with Roland's documentation of the pmap extension for Radiance. It 
explains most. Especially look for the supported / unsupported 
primitives. Than, vary the number of photon in the distribution pass 
(try up to 2,000,000 photons) and the bandwith in the photon gather 
pass. Basically, pmap is not too different from using Radiance, you just 
create the photon maps with mkpmap first and use them instead of the 
ambient calculation in rpcit / rtrace. Don't forget to manually delete 
the photon maps, they are not overwritten by mkpmap (adding a --force / 
-f option for overwriting would be a useful add-on...).

I showed some examples at a presentation two years ago:
http://www.radiance-online.org/community/workshops/2010-freiburg/PDF/PmapAppsPresentation-20100922.pdf

There are several presentations on the pmap around for the recent 
workshops, all available at radiance-online.org.

Cheers, Lars.


From sh.zareiy at gmail.com  Mon Oct  8 04:05:05 2012
From: sh.zareiy at gmail.com (shailan zareiy)
Date: Mon, 8 Oct 2012 14:35:05 +0330
Subject: [Radiance-general] weather data in radiance
In-Reply-To: <76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
	<76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
Message-ID: <CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw@mail.gmail.com>

so you mean that radiance extracts the sky conditions such as sky clearness
from the weather data not just altitude and longitude of the city?

On Mon, Oct 8, 2012 at 1:14 AM, Greg Ward <gregoryjward at gmail.com> wrote:

>  Radiance doesn't take weather data directly.  The gensky and gendaylit
> programs in Radiance can use some information from weather tapes to adjust
> their sky models, but there aren't any built-in utilities to handle weather
> tapes.
>
> Daysim does have such utilities, and we are hoping to add some facilities
> in the next year or so.
>
> -Greg
>
>  *From: *shailan zareiy <sh.zareiy at gmail.com>
>
> *Date: *October 7, 2012 1:18:08 PM PDT
>
> *
> *
>
>  dear all
> hi,i have a question about the weather data in radiance simulation. i want
> to know which items of weather data is used in a daylight simulation by the
> radiance software.
> thanks for your help
> Sincerely
> Shailan Zareiy
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121008/3c12fad9/attachment-0001.html>

From grobe at gmx.net  Mon Oct  8 04:54:47 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Mon, 08 Oct 2012 13:54:47 +0200
Subject: [Radiance-general] weather data in radiance
In-Reply-To: <CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw@mail.gmail.com>
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
	<76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
	<CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw@mail.gmail.com>
Message-ID: <5072BF07.50602@gmx.net>

Hi Shailan!
> so you mean that radiance extracts the sky conditions such as sky 
> clearness from the weather data not just altitude and longitude of the 
> city?
That is what gendaylit is typically used for. Please check the manpage 
at http://radsite.lbl.gov/radiance/man_html/gendaylit.1.html :

" /Gendaylit/ produces a RADIANCE scene description based on an angular 
distribution of the daylight sources (direct+diffuse) for the given 
atmospheric conditions (direct and diffuse component of the solar 
radiation), date and local standard time. The default output is the 
radiance of the sun (direct) and the sky (diffus) integrated over the 
visible spectral range (380-780 nm). We have used the calculation of the 
sun's position and the ground brightness models which were programmed in 
/gensky. (...)"

/Cheers, Lars./
/


From iabel at iebele.nl  Mon Oct  8 05:17:56 2012
From: iabel at iebele.nl (Iebele)
Date: Mon, 8 Oct 2012 15:17:56 +0300
Subject: [Radiance-general] IBM pSeries 575
In-Reply-To: <5072BF07.50602@gmx.net>
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
	<76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
	<CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw@mail.gmail.com>
	<5072BF07.50602@gmx.net>
Message-ID: <9F30169B-973E-4D6A-9E8D-D16D44DEFF3D@iebele.nl>

Hi, 

Did anyone ever used a IBM pSeries 575 (clustered SMP  system) ? 

I might have access to such a machine, but I don't know if Radiance will compile and run on it. The system administrators warned me that this system differs from normal computers, so I thought I better check it with you first, 

Cheers, 

- iebele




From perhaugaard at yahoo.dk  Wed Oct 10 02:17:50 2012
From: perhaugaard at yahoo.dk (Per Haugaard)
Date: Wed, 10 Oct 2012 10:17:50 +0100 (BST)
Subject: [Radiance-general] How to describe a diffuse illuminating pane?
Message-ID: <1349860670.54406.YahooMailNeo@web171204.mail.ir2.yahoo.com>

Dear group,

A quick question.?
Which material can be used to describe a diffuse illuminating pane, cf.?http://www.optilite.dk/ovenlyskupler/pc-ovenlys.html?(hv?lvet opal polycarbonat)?


Best regards

Per Haugaard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121010/ae380d49/attachment.html>

From grobe at gmx.net  Wed Oct 10 02:39:25 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Wed, 10 Oct 2012 11:39:25 +0200
Subject: [Radiance-general] How to describe a diffuse illuminating pane?
In-Reply-To: <1349860670.54406.YahooMailNeo@web171204.mail.ir2.yahoo.com>
References: <1349860670.54406.YahooMailNeo@web171204.mail.ir2.yahoo.com>
Message-ID: <5075424D.5040604@gmx.net>

Hi Per!

This is a translucent, diffusing panel. There have been lots of 
discussions on this on the mailing list, as well as a bunch of 
presentations on workshops and even papers. The basic answer would be - 
use the trans material in Radiance.

However, the material model for trans is very generic, while translucent 
panels are made applying very different approaches. There is volume 
scattering, scattering by etching / sanding / ... a surface (outer or 
inner), laminating films on or in between panes, ... and all show 
different characteristics. In your case, it is probably volume 
scattering, so I would guess reflection to have a strong specular peak 
due to the clear, smooth surface, with a strong diffuse component from 
light scattered back, and probably a nice diffuse transmission. However, 
it is difficult to know before having any data on it. Can you see a 
light source through it, when holding it in fron of e.g. a strong lamp? 
Or does the brightness appear more or less flat? Peter is offering 
measurements using his goniophotometer, as well as others do. Christoph 
Reinhart described modeling a translucent panel in his paper:

Reinhart C F, Andersen M, "Development and validation of a Radiance 
model for a translucent panel", Energy and Buildings 38:7 pp. 890-904, 2006

which can be found at EPFL:

http://infoscience.epfl.ch/record/88112/files/Development%20and%20validation%20of%20a%20Radiance%20model.pdf

and presented on a workshop:

http://www.radiance-online.org/community/workshops/2005-montreal/PDF/TranslucentPanelValidation.pdf

So a wide field to work on... Cheers, Lars.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121010/e6821bca/attachment.html>

From oga6ya at yahoo.co.jp  Wed Oct 10 19:22:36 2012
From: oga6ya at yahoo.co.jp (oga6ya at yahoo.co.jp)
Date: Thu, 11 Oct 2012 11:22:36 +0900 (JST)
Subject: [Radiance-general] distribution of short wave radiation with
	Radiance
Message-ID: <245253.28433.qm@web100717.mail.kks.yahoo.co.jp>

Hi,all
?
I'm trying to make the distribution of short wave radiation with Radiance.
?
I used gensky command to make the sky. 
?
The bellow is gensky command I use.
?
! gensky 1 15 15:0 +i -B 57 -R 455 -a 43.0528 -o -143.2123 -m -150.0
?
After that, I made hemisphericalimage by -vv 180 -vh 180 in the below command.
?
rview rvu -vth -vp 0 0 0 -vd -0.546722 -0.779656 0.305337 -vu 0.175306 0.249997 0.952244 -vv 180 -vh 180 -vo 0.0 -va 0.0
?
Also, I getthe pixel value bypvalue command.

pvalue -h -H -o filename.pic | rcalc -e '$1=$1;$2=$2;$3=$3;$4=$4;$5=$5;$6=$3+$4+$5;$7=$3*47+$4*117+$5*15'>filename.dat

?
Then I integrated the pixcels of the image to get the direct solar radiation and horizontal solar radiation.
?
But, Those values are different with the values that I defined on the gensky command-B and -R.
?
Please advise me something about this.

Regards,

Ogata
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121011/8ccb768c/attachment.html>

From gregoryjward at gmail.com  Wed Oct 10 23:01:10 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Thu, 11 Oct 2012 08:01:10 +0200
Subject: [Radiance-general] distribution of short wave radiation with
	Radiance
In-Reply-To: <245253.28433.qm@web100717.mail.kks.yahoo.co.jp>
References: <245253.28433.qm@web100717.mail.kks.yahoo.co.jp>
Message-ID: <5C0CE6BE-2225-43A3-ADAB-37AFD1EABCF1@lmi.net>

It is really very difficult to do what you are attempting without running into multiple errors.  For one thing, integrating the sun, which will cover only a few pixels in an image, is problematic.  Also, you can neither add together R+G+B nor use the luminance factor 179 (built into your 47, 117, 15 scalars) in your conversion.  That said, the following should work for the sky component (-i option):

( oconv - | rpict -vd 0 0 1 -vu 0 1 0 -vth -vh 180 -vv 180 -x 1024 -y 1024 | pvalue -h -H -b -d | total -m | rcalc -e '$1=$1*4' ) << _EOF_

!gensky 1 15 15:00 -i -B 57 -a 43.0528 -o -143.2123 -m -150.0

skyfunc glow skyglow
0
0
4 1 1 1 0

skyglow source sky
0
0
4 0 0 1 180
_EOF_

The final multiplier of 4 is perhaps difficult to understand.  Because the image covers a square area, whereas you only want the circle in the center, you need to multiply the average by 4/pi.  However, you also need to multiply the averaged result by pi to get irradiance (rather than averaged radiance).  Hence, you need to multiply by pi*4/pi, which is just 4.  Using this, I get back a value of 56.736 (rather than 57.0), showing the normalization is not perfect.

If I try to compute the output of the sun only, I can do this by leaving off the sky description and going to a much higher resolution image:

gensky 1 15 15:0 +i -R 455 -a 43.0528 -o -143.2123 -m -150.0 \
	| oconv - | rpict -vd 0 0 1 -vu 0 1 0 -vth -vh 180 -vv 180 -x 10000 -y 10000 \
	| pvalue -h -H -b -d | total -m | rcalc -e '$1=$1*4'

The above yields a result of 444.1, which is a higher relative error than the sky calculation most likely due to the difficult of integrating such a small source using a full hemispherical image.

I hope this helps.
-Greg

> From: oga6ya at yahoo.co.jp
> Date: October 11, 2012 4:22:36 AM GMT+02:00
> 
> Hi,all
>  
> I'm trying to make the distribution of short wave radiation with Radiance.
>  
> I used gensky command to make the sky.
>  
> The bellow is gensky command I use.
>  
> ! gensky 1 15 15:0 +i -B 57 -R 455 -a 43.0528 -o -143.2123 -m -150.0
>  
> After that, I made hemispherical image by -vv 180 -vh 180 in the below command.
>  
> rview rvu -vth -vp 0 0 0 -vd -0.546722 -0.779656 0.305337 -vu 0.175306 0.249997 0.952244 -vv 180 -vh 180 -vo 0.0 -va 0.0
>  
> Also, I getthe pixel value by pvalue command.
> 
> pvalue -h -H -o filename.pic | rcalc -e '$1=$1;$2=$2;$3=$3;$4=$4;$5=$5;$6=$3+$4+$5;$7=$3*47+$4*117+$5*15'>filename.dat
>  
> Then I integrated the pixcels of the image to get the direct solar radiation and horizontal solar radiation.
>  
> But, Those values are different with the values that I defined on the gensky command -B and -R.
>  
> Please advise me something about this.
> 
> Regards,
> Ogata
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121011/4e4e762a/attachment.html>

From hujia06 at gmail.com  Fri Oct 12 02:50:18 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Fri, 12 Oct 2012 05:50:18 -0400
Subject: [Radiance-general] genBSDF: illegal variable name
Message-ID: <CABzgtwqFvRB_xSdP=6YDQur5BmXY9hX3eNa7fboHu6W74zRDvw@mail.gmail.com>

Hi all:

I use Radiance window version and create a simple file to generate BSDF
file:

####################### file: glazingBase.rad
void glass glazingRef_0.2
0
0
3
0.218166162012 0.218166162012 0.218166162012


######################## file: bsdf.rad
void plastic blindRef_0.2
0
0
5
0.2 0.2 0.2 0 0

glazingRef_0.2 polygon glazing_1
0
0
12
2  0.0   3
0.0   0.0   3
0.0   0.0   0.0
2  0.0   0.0

!genblinds blindRef_0.2 blinds_0.2 0.5 2 3 60 60 | xform -rz -90 -rx 90
!xform -rx 90 -t 0 0 -0.6 glazingBase.rad

##################### end ########################

I run "genBSDF.pl bsdf.rad > temp.xml", and got the error here (link:
https://dl.dropbox.com/u/15562376/error.gif) . Do you know how to correct
this error?

Thank you in advance,

Jia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121012/96b6e2ad/attachment.html>

From gregoryjward at gmail.com  Fri Oct 12 03:04:51 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Fri, 12 Oct 2012 12:04:51 +0200
Subject: [Radiance-general] genBSDF: illegal variable name
In-Reply-To: <CABzgtwqFvRB_xSdP=6YDQur5BmXY9hX3eNa7fboHu6W74zRDvw@mail.gmail.com>
References: <CABzgtwqFvRB_xSdP=6YDQur5BmXY9hX3eNa7fboHu6W74zRDvw@mail.gmail.com>
Message-ID: <3A347928-EEAD-4467-B27D-F241C8F21996@lmi.net>

The problem is that genBSDF.pl is not Windows-compatible.  We have it on our "to-do" list, but no promises when we'll get to it.

Cheers,
-Greg

> From: Jia Hu <hujia06 at gmail.com>
> Date: October 12, 2012 11:50:18 AM GMT+02:00
> 
> Hi all:
> 
> I use Radiance window version and create a simple file to generate BSDF file:
>  
> ####################### file: glazingBase.rad  
> void glass glazingRef_0.2 
> 0
> 0
> 3
> 0.218166162012 0.218166162012 0.218166162012
> 
> 
> ######################## file: bsdf.rad
> void plastic blindRef_0.2 
> 0
> 0
> 5
> 0.2 0.2 0.2 0 0
> 
> glazingRef_0.2 polygon glazing_1
> 0
> 0
> 12
> 2  0.0   3
> 0.0   0.0   3
> 0.0   0.0   0.0 
> 2  0.0   0.0 
> 
> !genblinds blindRef_0.2 blinds_0.2 0.5 2 3 60 60 | xform -rz -90 -rx 90
> !xform -rx 90 -t 0 0 -0.6 glazingBase.rad
> 
> ##################### end ########################
> 
> I run "genBSDF.pl bsdf.rad > temp.xml", and got the error here (link:https://dl.dropbox.com/u/15562376/error.gif) . Do you know how to correct this error?
> 
> Thank you in advance,
> 
> Jia


From hujia06 at gmail.com  Fri Oct 12 09:37:53 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Fri, 12 Oct 2012 12:37:53 -0400
Subject: [Radiance-general] genBSDF: illegal variable name
In-Reply-To: <3A347928-EEAD-4467-B27D-F241C8F21996@lmi.net>
References: <CABzgtwqFvRB_xSdP=6YDQur5BmXY9hX3eNa7fboHu6W74zRDvw@mail.gmail.com>
	<3A347928-EEAD-4467-B27D-F241C8F21996@lmi.net>
Message-ID: <CABzgtwpyqy8w2=noEaKBp42bz+PTvLUu08UNvBCT_O4-gwLVdQ@mail.gmail.com>

Thanks, Greg. I am not familiar with Perl. Could you point out some reasons
why the code is not compatible? so that I may revise some codes by myself
if there is not too much work...

Thanks,

Jia

On Fri, Oct 12, 2012 at 6:04 AM, Greg Ward <gregoryjward at gmail.com> wrote:

> The problem is that genBSDF.pl is not Windows-compatible.  We have it on
> our "to-do" list, but no promises when we'll get to it.
>
> Cheers,
> -Greg
>
> > From: Jia Hu <hujia06 at gmail.com>
> > Date: October 12, 2012 11:50:18 AM GMT+02:00
> >
> > Hi all:
> >
> > I use Radiance window version and create a simple file to generate BSDF
> file:
> >
> > ####################### file: glazingBase.rad
> > void glass glazingRef_0.2
> > 0
> > 0
> > 3
> > 0.218166162012 0.218166162012 0.218166162012
> >
> >
> > ######################## file: bsdf.rad
> > void plastic blindRef_0.2
> > 0
> > 0
> > 5
> > 0.2 0.2 0.2 0 0
> >
> > glazingRef_0.2 polygon glazing_1
> > 0
> > 0
> > 12
> > 2  0.0   3
> > 0.0   0.0   3
> > 0.0   0.0   0.0
> > 2  0.0   0.0
> >
> > !genblinds blindRef_0.2 blinds_0.2 0.5 2 3 60 60 | xform -rz -90 -rx 90
> > !xform -rx 90 -t 0 0 -0.6 glazingBase.rad
> >
> > ##################### end ########################
> >
> > I run "genBSDF.pl bsdf.rad > temp.xml", and got the error here (link:
> https://dl.dropbox.com/u/15562376/error.gif) . Do you know how to correct
> this error?
> >
> > Thank you in advance,
> >
> > Jia
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121012/d764a526/attachment.html>

From RFritz at lbl.gov  Fri Oct 12 11:08:22 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Fri, 12 Oct 2012 11:08:22 -0700
Subject: [Radiance-general] IBM pSeries 575
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
	<76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
	<CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw@mail.gmail.com>
	<5072BF07.50602@gmx.net>
	<9F30169B-973E-4D6A-9E8D-D16D44DEFF3D@iebele.nl>
Message-ID: <k59mal$j34$1@ger.gmane.org>

On 2012-10-08 12:17:56 +0000, Iebele said:

> pSeries 575

It runs Unix, so I expect Radiance will compile and run on it, but it 
uses IBM POWER5+ processors, rather than x86s, so there may be some 
surprises.

Do you know what operating system the system administrators are using?  
According to IBM, administrators have a choice of AIX, Red Hat Linux, 
and SUSE Linux, or possibly all three in a virtualization mode.

Ref: 
http://www-03.ibm.com/systems/power/hardware/systemp/highend/575/index.html 

-- 
Randolph M. Fritz ? RFritz at lbl.gov
Environmental Energy Technologies Division ? Lawrence Berkeley Labs




From iabel at iebele.nl  Sat Oct 13 02:47:46 2012
From: iabel at iebele.nl (Iebele)
Date: Sat, 13 Oct 2012 12:47:46 +0300
Subject: [Radiance-general] IBM pSeries 575
In-Reply-To: <k59mal$j34$1@ger.gmane.org>
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
	<76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
	<CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw@mail.gmail.com>
	<5072BF07.50602@gmx.net>
	<9F30169B-973E-4D6A-9E8D-D16D44DEFF3D@iebele.nl>
	<k59mal$j34$1@ger.gmane.org>
Message-ID: <626212D0-03B5-48AB-9883-D80CBEE97BA3@iebele.nl>

Hi Randolph, 

Thanks for your reply and the reference. 

I have no access to the system now. The documentation says:
"Each node runs under one operating system (Linux: SLES11 SP1) and show a single memory image to the user programs."

I'' ll forward this message to one of the administrators, to find out whether they use Red Had or Suse.

- iebele 




Op 12 okt. 2012, om 21:08 heeft Randolph M. Fritz het volgende geschreven:

> On 2012-10-08 12:17:56 +0000, Iebele said:
> 
>> pSeries 575
> 
> It runs Unix, so I expect Radiance will compile and run on it, but it uses IBM POWER5+ processors, rather than x86s, so there may be some surprises.
> 
> Do you know what operating system the system administrators are using?  According to IBM, administrators have a choice of AIX, Red Hat Linux, and SUSE Linux, or possibly all three in a virtualization mode.
> 
> Ref: http://www-03.ibm.com/systems/power/hardware/systemp/highend/575/index.html 
> -- 
> Randolph M. Fritz ? RFritz at lbl.gov
> Environmental Energy Technologies Division ? Lawrence Berkeley Labs



From grobe at gmx.net  Sat Oct 13 04:12:39 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Sat, 13 Oct 2012 13:12:39 +0200
Subject: [Radiance-general] IBM pSeries 575
In-Reply-To: <k59mal$j34$1@ger.gmane.org>
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
	<76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
	<CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw@mail.gmail.com>
	<5072BF07.50602@gmx.net>
	<9F30169B-973E-4D6A-9E8D-D16D44DEFF3D@iebele.nl>
	<k59mal$j34$1@ger.gmane.org>
Message-ID: <50794CA7.8090205@gmx.net>

Hi Randolph,

the Power architecture is well supported, both by Linux (e.g. Debian) 
and IBM's propietary systems. Radiance has been developed on a similar 
architecture (Power G4,G5) over the years, it is happy with 
Little/Big-endianess, so I would not expect problems.

I do not know how the virtualization is solved, probably you can get 
either one node with many available cores or many separate cores. Both 
is fine, as Radiance supports forking processes on one node (-N NCPUs) 
as well as distributing among machines (using e.g. ssh and shared 
ambient files). I have used ranimate in the past for cluster rendering 
(without ssh), which may be a possible (but not required) approach here:

http://larsgrobe.de/content/distributed-rendering-ranimate

Cheers, Lars.
> It runs Unix, so I expect Radiance will compile and run on it, but it 
> uses IBM POWER5+ processors, rather than x86s, so there may be some 
> surprises.
>
> Do you know what operating system the system administrators are 
> using?  According to IBM, administrators have a choice of AIX, Red Hat 
> Linux, and SUSE Linux, or possibly all three in a virtualization mode.
>
> Ref: 
> http://www-03.ibm.com/systems/power/hardware/systemp/highend/575/index.html 
>



From kskonis at gmail.com  Sun Oct 14 03:13:00 2012
From: kskonis at gmail.com (kyle konis)
Date: Sun, 14 Oct 2012 03:13:00 -0700
Subject: [Radiance-general] Attempt to illuminate Paul Debevec's
 rnl_scene.rad with a hemispherical HDR image of the sky
Message-ID: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>

Dear list,

I am attempting to illuminate Paul Debevec's rnl_scene.rad with a
hemispherical HDR image of a dynamic sky.

After the tutorial in http://www.pauldebevec.com/RNL/Source/

I have succeeded in simply substituting in my image, but because it is
a 180-degree fisheye image (zenith view of sky) rather than a light
probe, i am encountering some issues with the resulting "reality" of
the output image.

I would appreciate suggestions for how to properly map this image data
to a hemisphere (i.e. sky) in radiance to enable the image to serve
properly as a light source.

I have included the relevant code below, and sample images on a
temporary webpage:

https://sites.google.com/site/konisskytemp/


I would appreciate any suggestions!

-Kyle


### Here is the relevant description of the lighting environment ( i
have only changed the image file name to source my 1350 x 1350 px
cropped sky image)

################################################################
#
#  Lighting Environment
#
################################################################

# specify the probe image and how it is mapped onto geometry

void colorpict hdr_env
7 red green blue cropped.hdr angmap.cal sb_u sb_v
0
0

# specify a "glow" material that will use this image

hdr_env glow env_glow
0
0
4 1 1 1 0

# specify a large inward-pointing box to be mapped with the HDR environment

!genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250





################################################################
### and here is angmap.cal
################################################################

{
angmap.cal

Convert from directions in the world to coordinates on the angular sphere image

-z is forward (outer edge of sphere)
+z is backward (center of sphere)
+y is up (toward top of sphere)
}

sb_u = 0.5 + DDx * r;
sb_v = 0.5 + DDy * r;

r = 0.159154943*acos(DDz)/sqrt(DDx*DDx + DDy*DDy);

DDy = Py*norm;
DDx = Px*norm;
DDz = Pz*norm;

norm = 1/sqrt(Py*Py + Px*Px + Pz*Pz);




### Any suggestions for solutions would be appreciated

I assume that i need to map the image to a hemisphere (representing
the sky dome) rather than a box

perhaps passing the image as a glow rather than the standard sky glow?

skyfunc glow skyglow
0
0
4 1.000 1.000 1.000 0
skyglow source sky
0
0
4 0 0 1 180

Or to a sphere?



And i assume that i need a different angmap.cal file, given that this
was written to interpret light probe images . . . and not
hemispherical fisheye images


From cbm at create.aau.dk  Sun Oct 14 12:23:25 2012
From: cbm at create.aau.dk (=?iso-8859-1?Q?Claus_Br=F8ndgaard_Madsen?=)
Date: Sun, 14 Oct 2012 19:23:25 +0000
Subject: [Radiance-general] Attempt to illuminate Paul Debevec's
 rnl_scene.rad with a hemispherical HDR image of the sky
In-Reply-To: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>
References: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>
Message-ID: <91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>



Hi Kyle,

Solving your problem is easy and not so easy.

There will be some overlap between this response and my response To your other post, but for completeness...

The easiest solution would be to re-map your hemispherical sky image to angular mapping that Debevec always prefers. I, myself, prefer the lat-long mapping, so I have written my own mapping .cal file. Writing such a .Cal is easy but you have to know what you are doing and there can be some debugging (trial and error) involved. 

In order to remap you sky view to an angular mapping it would be simple and easy to use the HDRshop progam (www.hdrshop.com), but there is no longer a free 1.0 version. Versions for academia are not too expensive though. 

Best
Claus




Claus B. Madsen
AD:MT/AAU


On 14/10/2012, at 12.17, "kyle konis" <kskonis at gmail.com> wrote:

> Dear list,
> 
> I am attempting to illuminate Paul Debevec's rnl_scene.rad with a
> hemispherical HDR image of a dynamic sky.
> 
> After the tutorial in http://www.pauldebevec.com/RNL/Source/
> 
> I have succeeded in simply substituting in my image, but because it is
> a 180-degree fisheye image (zenith view of sky) rather than a light
> probe, i am encountering some issues with the resulting "reality" of
> the output image.
> 
> I would appreciate suggestions for how to properly map this image data
> to a hemisphere (i.e. sky) in radiance to enable the image to serve
> properly as a light source.
> 
> I have included the relevant code below, and sample images on a
> temporary webpage:
> 
> https://sites.google.com/site/konisskytemp/
> 
> 
> I would appreciate any suggestions!
> 
> -Kyle
> 
> 
> ### Here is the relevant description of the lighting environment ( i
> have only changed the image file name to source my 1350 x 1350 px
> cropped sky image)
> 
> ################################################################
> #
> #  Lighting Environment
> #
> ################################################################
> 
> # specify the probe image and how it is mapped onto geometry
> 
> void colorpict hdr_env
> 7 red green blue cropped.hdr angmap.cal sb_u sb_v
> 0
> 0
> 
> # specify a "glow" material that will use this image
> 
> hdr_env glow env_glow
> 0
> 0
> 4 1 1 1 0
> 
> # specify a large inward-pointing box to be mapped with the HDR environment
> 
> !genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250
> 
> 
> 
> 
> 
> ################################################################
> ### and here is angmap.cal
> ################################################################
> 
> {
> angmap.cal
> 
> Convert from directions in the world to coordinates on the angular sphere image
> 
> -z is forward (outer edge of sphere)
> +z is backward (center of sphere)
> +y is up (toward top of sphere)
> }
> 
> sb_u = 0.5 + DDx * r;
> sb_v = 0.5 + DDy * r;
> 
> r = 0.159154943*acos(DDz)/sqrt(DDx*DDx + DDy*DDy);
> 
> DDy = Py*norm;
> DDx = Px*norm;
> DDz = Pz*norm;
> 
> norm = 1/sqrt(Py*Py + Px*Px + Pz*Pz);
> 
> 
> 
> 
> ### Any suggestions for solutions would be appreciated
> 
> I assume that i need to map the image to a hemisphere (representing
> the sky dome) rather than a box
> 
> perhaps passing the image as a glow rather than the standard sky glow?
> 
> skyfunc glow skyglow
> 0
> 0
> 4 1.000 1.000 1.000 0
> skyglow source sky
> 0
> 0
> 4 0 0 1 180
> 
> Or to a sphere?
> 
> 
> 
> And i assume that i need a different angmap.cal file, given that this
> was written to interpret light probe images . . . and not
> hemispherical fisheye images
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general


From gbetti at fosterandpartners.com  Mon Oct 15 02:19:40 2012
From: gbetti at fosterandpartners.com (Giovanni Betti)
Date: Mon, 15 Oct 2012 10:19:40 +0100
Subject: [Radiance-general] Preetham sky in Radiance
In-Reply-To: <91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>
References: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>
	<91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>
Message-ID: <6F5225D6E15F954BB4E58EC25F6736C309A67673@corp3005.CORPORATE.FOSTER.NETWORK>

Dear All,

I was wondering if anyone had ever tried to generate a sky description
for radiance based on the 'Practical Analytic Model for Daylight'
suggested by Preetham et al.
Particularly I was wondering if anyone tried to solve the equations in
such a way that (like the Perez sky model in Gendaylit) all parameter
can be derived from a standard weather file and the turbidity calculated
from the ratio of direct and diffuse illuminace (or irradiance)
I seem to remember the GenUtah sky by Mark Stock went some way in this
direction but the format of inputs wasn't amenable to submit climatic
data.

Thanks in advance for your help,

Regards,

Giovanni


From gbetti at fosterandpartners.com  Mon Oct 15 09:58:10 2012
From: gbetti at fosterandpartners.com (Giovanni Betti)
Date: Mon, 15 Oct 2012 17:58:10 +0100
Subject: [Radiance-general] remapping HDR projections
Message-ID: <6F5225D6E15F954BB4E58EC25F6736C309A676EE@corp3005.CORPORATE.FOSTER.NETWORK>

Hi All, 

 

I have some 360deg HDR images in equirectangular format. Does anyone
know how to extract 180degrees equiangular fisheye images out of those?

I am guessing is some magic combination of pcomb command lines.

Any thoughts anyone?

 

Thanks,


Giovanni

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121015/a7422b05/attachment.html>

From kskonis at gmail.com  Mon Oct 15 10:30:08 2012
From: kskonis at gmail.com (kyle konis)
Date: Mon, 15 Oct 2012 10:30:08 -0700
Subject: [Radiance-general] Attempt to illuminate Paul Debevec's
 rnl_scene.rad with a hemispherical HDR image of the sky
In-Reply-To: <91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>
References: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>
	<91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>
Message-ID: <CAAzVHq3yNs=DCg0K2i6Y7_cJ5sScXPRxtBVXcKSiuZJsoZVrSQ@mail.gmail.com>

Hello Claus,

Thanks for the response, both on the HDRI list and here. I've never
got into custom .cal files, but looks like the place to start to get
exactly what i want.

I quickly read through some of the HDRshop tutorials on: http://www.hdrshop.com/

There are many interesting and useful tools (including scripting) ....
And perhaps the "Panoramic Image Conversion" tool is what you are
referring to?

....At the conceptual level, the step i am confused with is
identifying the appropriate virtual object in Radiance to map my HDR
environment to.

Paul uses an inward-pointing box, as in:

###############################################################
# specify a large inward-pointing box to be mapped with the HDR environment

!genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250
###############################################################

All surfaces of the box contribute light.

Because i only have captured light data from the horizon up, and dont
care (at this stage) about the group plane, it would seem that i
should start with a box that encompasses a hemisphere that is
positioned on the xy plane.

Assuming this step is correct, i would then aim to map the non-zero
pixels in my hemispherical image to the surfaces of that box
(effectively stretching the circle into a rectangle).

Alternatively, i could also try to map to a hemisphere, but then there
is the issue of what to do with the "black" pixels which make up the
corners of the HDR image.

best,

-Kyle




On Sun, Oct 14, 2012 at 12:23 PM, Claus Br?ndgaard Madsen
<cbm at create.aau.dk> wrote:
>
>
> Hi Kyle,
>
> Solving your problem is easy and not so easy.
>
> There will be some overlap between this response and my response To your other post, but for completeness...
>
> The easiest solution would be to re-map your hemispherical sky image to angular mapping that Debevec always prefers. I, myself, prefer the lat-long mapping, so I have written my own mapping .cal file. Writing such a .Cal is easy but you have to know what you are doing and there can be some debugging (trial and error) involved.
>
> In order to remap you sky view to an angular mapping it would be simple and easy to use the HDRshop progam (www.hdrshop.com), but there is no longer a free 1.0 version. Versions for academia are not too expensive though.
>
> Best
> Claus
>
>
>
>
> Claus B. Madsen
> AD:MT/AAU
>
>
> On 14/10/2012, at 12.17, "kyle konis" <kskonis at gmail.com> wrote:
>
>> Dear list,
>>
>> I am attempting to illuminate Paul Debevec's rnl_scene.rad with a
>> hemispherical HDR image of a dynamic sky.
>>
>> After the tutorial in http://www.pauldebevec.com/RNL/Source/
>>
>> I have succeeded in simply substituting in my image, but because it is
>> a 180-degree fisheye image (zenith view of sky) rather than a light
>> probe, i am encountering some issues with the resulting "reality" of
>> the output image.
>>
>> I would appreciate suggestions for how to properly map this image data
>> to a hemisphere (i.e. sky) in radiance to enable the image to serve
>> properly as a light source.
>>
>> I have included the relevant code below, and sample images on a
>> temporary webpage:
>>
>> https://sites.google.com/site/konisskytemp/
>>
>>
>> I would appreciate any suggestions!
>>
>> -Kyle
>>
>>
>> ### Here is the relevant description of the lighting environment ( i
>> have only changed the image file name to source my 1350 x 1350 px
>> cropped sky image)
>>
>> ################################################################
>> #
>> #  Lighting Environment
>> #
>> ################################################################
>>
>> # specify the probe image and how it is mapped onto geometry
>>
>> void colorpict hdr_env
>> 7 red green blue cropped.hdr angmap.cal sb_u sb_v
>> 0
>> 0
>>
>> # specify a "glow" material that will use this image
>>
>> hdr_env glow env_glow
>> 0
>> 0
>> 4 1 1 1 0
>>
>> # specify a large inward-pointing box to be mapped with the HDR environment
>>
>> !genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250
>>
>>
>>
>>
>>
>> ################################################################
>> ### and here is angmap.cal
>> ################################################################
>>
>> {
>> angmap.cal
>>
>> Convert from directions in the world to coordinates on the angular sphere image
>>
>> -z is forward (outer edge of sphere)
>> +z is backward (center of sphere)
>> +y is up (toward top of sphere)
>> }
>>
>> sb_u = 0.5 + DDx * r;
>> sb_v = 0.5 + DDy * r;
>>
>> r = 0.159154943*acos(DDz)/sqrt(DDx*DDx + DDy*DDy);
>>
>> DDy = Py*norm;
>> DDx = Px*norm;
>> DDz = Pz*norm;
>>
>> norm = 1/sqrt(Py*Py + Px*Px + Pz*Pz);
>>
>>
>>
>>
>> ### Any suggestions for solutions would be appreciated
>>
>> I assume that i need to map the image to a hemisphere (representing
>> the sky dome) rather than a box
>>
>> perhaps passing the image as a glow rather than the standard sky glow?
>>
>> skyfunc glow skyglow
>> 0
>> 0
>> 4 1.000 1.000 1.000 0
>> skyglow source sky
>> 0
>> 0
>> 4 0 0 1 180
>>
>> Or to a sphere?
>>
>>
>>
>> And i assume that i need a different angmap.cal file, given that this
>> was written to interpret light probe images . . . and not
>> hemispherical fisheye images
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general


From rob.guglielmetti at gmail.com  Mon Oct 15 10:30:19 2012
From: rob.guglielmetti at gmail.com (Rob Guglielmetti)
Date: Mon, 15 Oct 2012 11:30:19 -0600
Subject: [Radiance-general] Preetham sky in Radiance
In-Reply-To: <6F5225D6E15F954BB4E58EC25F6736C309A67673@corp3005.CORPORATE.FOSTER.NETWORK>
References: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>
	<91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>
	<6F5225D6E15F954BB4E58EC25F6736C309A67673@corp3005.CORPORATE.FOSTER.NETWORK>
Message-ID: <BC6F023B-4448-4808-A688-1A1167044BFD@gmail.com>

As far as I know, Mark Stock's attempt is the only one I know of in the Radiance world?

- Rob

On Oct 15, 2012, at 3:19 AM, "Giovanni Betti" <gbetti at fosterandpartners.com> wrote:

> Dear All,
> 
> I was wondering if anyone had ever tried to generate a sky description
> for radiance based on the 'Practical Analytic Model for Daylight'
> suggested by Preetham et al.
> Particularly I was wondering if anyone tried to solve the equations in
> such a way that (like the Perez sky model in Gendaylit) all parameter
> can be derived from a standard weather file and the turbidity calculated
> from the ratio of direct and diffuse illuminace (or irradiance)
> I seem to remember the GenUtah sky by Mark Stock went some way in this
> direction but the format of inputs wasn't amenable to submit climatic
> data.
> 
> Thanks in advance for your help,
> 
> Regards,
> 
> Giovanni
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general



From cbm at create.aau.dk  Mon Oct 15 12:40:16 2012
From: cbm at create.aau.dk (=?iso-8859-1?Q?Claus_Br=F8ndgaard_Madsen?=)
Date: Mon, 15 Oct 2012 19:40:16 +0000
Subject: [Radiance-general] Attempt to illuminate Paul Debevec's
 rnl_scene.rad with a hemispherical HDR image of the sky
In-Reply-To: <CAAzVHq3yNs=DCg0K2i6Y7_cJ5sScXPRxtBVXcKSiuZJsoZVrSQ@mail.gmail.com>
References: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>
	<91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>,
	<CAAzVHq3yNs=DCg0K2i6Y7_cJ5sScXPRxtBVXcKSiuZJsoZVrSQ@mail.gmail.com>
Message-ID: <7AEAEFDD-D8B6-40E4-88A1-49263982A5D2@create.aau.dk>


Oops ... I didn't notice two threads were involved:-)

Yep, panoramic conversion tools in HDRshop are second to none. 

At the conceptual level: it makes absolutely no difference what geometry your light probe is mapped to. It can be sphere, box, super quad, tetrahedron, whatever, as long as it totally encompasses the scene. 

The .cal you had in your other post would work for any geometry provided you had the correct mapping (image format) of the env map. 

That cal file is called whenever a light ray intersects the sky box (it is a box in Debevecs example, but could just as well be a sphere). The cal file takes the coordinates of that intersection and converts it to a spherical coordinate and subsequently transforms this spherical direction to a look-up in an angular mapping of the env map. 

Therefor it does not make any difference what geometry you are using because it is just a proxy geometry used to generate some intersection of which only the directions, not distances, are relevant. Hence the requirement for a big box in Debvecs example. Had the object/scene to be illuminated been 10000 by 10000 units large the box would have had to be an order of magnitude larger than that at least. 

Your sky images naturally only cover a hemisphere. If done correctly in HDRshop your env maps when remapped to angular mapping would result in everything BELOW the horizon, below the xy-plane, would return black. 

If you go ahead a try to make your own cal file that suits your cropped fish eye images then you don't have to worry about the black corners of the square image outside the spherical projection of the sky. Those pixels would never be looked up because they correspond to impossible ray directions. 

As you can see (also from the typos) I am writing from my iPod as I am on vacation. I may be able to provide more direct technical assistance once I'm back in my office next week. I can probably find some image examples and a cal file we can tweak to your needs. 


Best
Claus

Sent from my iPod

On 15/10/2012, at 19.32, "kyle konis" <kskonis at gmail.com> wrote:

> Hello Claus,
> 
> Thanks for the response, both on the HDRI list and here. I've never
> got into custom .cal files, but looks like the place to start to get
> exactly what i want.
> 
> I quickly read through some of the HDRshop tutorials on: http://www.hdrshop.com/
> 
> There are many interesting and useful tools (including scripting) ....
> And perhaps the "Panoramic Image Conversion" tool is what you are
> referring to?
> 
> ....At the conceptual level, the step i am confused with is
> identifying the appropriate virtual object in Radiance to map my HDR
> environment to.
> 
> Paul uses an inward-pointing box, as in:
> 
> ###############################################################
> # specify a large inward-pointing box to be mapped with the HDR environment
> 
> !genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250
> ###############################################################
> 
> All surfaces of the box contribute light.
> 
> Because i only have captured light data from the horizon up, and dont
> care (at this stage) about the group plane, it would seem that i
> should start with a box that encompasses a hemisphere that is
> positioned on the xy plane.
> 
> Assuming this step is correct, i would then aim to map the non-zero
> pixels in my hemispherical image to the surfaces of that box
> (effectively stretching the circle into a rectangle).
> 
> Alternatively, i could also try to map to a hemisphere, but then there
> is the issue of what to do with the "black" pixels which make up the
> corners of the HDR image.
> 
> best,
> 
> -Kyle
> 
> 
> 
> 
> On Sun, Oct 14, 2012 at 12:23 PM, Claus Br?ndgaard Madsen
> <cbm at create.aau.dk> wrote:
>> 
>> 
>> Hi Kyle,
>> 
>> Solving your problem is easy and not so easy.
>> 
>> There will be some overlap between this response and my response To your other post, but for completeness...
>> 
>> The easiest solution would be to re-map your hemispherical sky image to angular mapping that Debevec always prefers. I, myself, prefer the lat-long mapping, so I have written my own mapping .cal file. Writing such a .Cal is easy but you have to know what you are doing and there can be some debugging (trial and error) involved.
>> 
>> In order to remap you sky view to an angular mapping it would be simple and easy to use the HDRshop progam (www.hdrshop.com), but there is no longer a free 1.0 version. Versions for academia are not too expensive though.
>> 
>> Best
>> Claus
>> 
>> 
>> 
>> 
>> Claus B. Madsen
>> AD:MT/AAU
>> 
>> 
>> On 14/10/2012, at 12.17, "kyle konis" <kskonis at gmail.com> wrote:
>> 
>>> Dear list,
>>> 
>>> I am attempting to illuminate Paul Debevec's rnl_scene.rad with a
>>> hemispherical HDR image of a dynamic sky.
>>> 
>>> After the tutorial in http://www.pauldebevec.com/RNL/Source/
>>> 
>>> I have succeeded in simply substituting in my image, but because it is
>>> a 180-degree fisheye image (zenith view of sky) rather than a light
>>> probe, i am encountering some issues with the resulting "reality" of
>>> the output image.
>>> 
>>> I would appreciate suggestions for how to properly map this image data
>>> to a hemisphere (i.e. sky) in radiance to enable the image to serve
>>> properly as a light source.
>>> 
>>> I have included the relevant code below, and sample images on a
>>> temporary webpage:
>>> 
>>> https://sites.google.com/site/konisskytemp/
>>> 
>>> 
>>> I would appreciate any suggestions!
>>> 
>>> -Kyle
>>> 
>>> 
>>> ### Here is the relevant description of the lighting environment ( i
>>> have only changed the image file name to source my 1350 x 1350 px
>>> cropped sky image)
>>> 
>>> ################################################################
>>> #
>>> #  Lighting Environment
>>> #
>>> ################################################################
>>> 
>>> # specify the probe image and how it is mapped onto geometry
>>> 
>>> void colorpict hdr_env
>>> 7 red green blue cropped.hdr angmap.cal sb_u sb_v
>>> 0
>>> 0
>>> 
>>> # specify a "glow" material that will use this image
>>> 
>>> hdr_env glow env_glow
>>> 0
>>> 0
>>> 4 1 1 1 0
>>> 
>>> # specify a large inward-pointing box to be mapped with the HDR environment
>>> 
>>> !genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250
>>> 
>>> 
>>> 
>>> 
>>> 
>>> ################################################################
>>> ### and here is angmap.cal
>>> ################################################################
>>> 
>>> {
>>> angmap.cal
>>> 
>>> Convert from directions in the world to coordinates on the angular sphere image
>>> 
>>> -z is forward (outer edge of sphere)
>>> +z is backward (center of sphere)
>>> +y is up (toward top of sphere)
>>> }
>>> 
>>> sb_u = 0.5 + DDx * r;
>>> sb_v = 0.5 + DDy * r;
>>> 
>>> r = 0.159154943*acos(DDz)/sqrt(DDx*DDx + DDy*DDy);
>>> 
>>> DDy = Py*norm;
>>> DDx = Px*norm;
>>> DDz = Pz*norm;
>>> 
>>> norm = 1/sqrt(Py*Py + Px*Px + Pz*Pz);
>>> 
>>> 
>>> 
>>> 
>>> ### Any suggestions for solutions would be appreciated
>>> 
>>> I assume that i need to map the image to a hemisphere (representing
>>> the sky dome) rather than a box
>>> 
>>> perhaps passing the image as a glow rather than the standard sky glow?
>>> 
>>> skyfunc glow skyglow
>>> 0
>>> 0
>>> 4 1.000 1.000 1.000 0
>>> skyglow source sky
>>> 0
>>> 0
>>> 4 0 0 1 180
>>> 
>>> Or to a sphere?
>>> 
>>> 
>>> 
>>> And i assume that i need a different angmap.cal file, given that this
>>> was written to interpret light probe images . . . and not
>>> hemispherical fisheye images
>>> 
>>> _______________________________________________
>>> Radiance-general mailing list
>>> Radiance-general at radiance-online.org
>>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>> 
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general


From kskonis at gmail.com  Mon Oct 15 13:18:15 2012
From: kskonis at gmail.com (kyle konis)
Date: Mon, 15 Oct 2012 13:18:15 -0700
Subject: [Radiance-general] Attempt to illuminate Paul Debevec's
 rnl_scene.rad with a hemispherical HDR image of the sky
In-Reply-To: <7AEAEFDD-D8B6-40E4-88A1-49263982A5D2@create.aau.dk>
References: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>
	<91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>
	<CAAzVHq3yNs=DCg0K2i6Y7_cJ5sScXPRxtBVXcKSiuZJsoZVrSQ@mail.gmail.com>
	<7AEAEFDD-D8B6-40E4-88A1-49263982A5D2@create.aau.dk>
Message-ID: <CAAzVHq3DOc25GXBOiH=hyrvvdjGgfom06_y3NwUbb5rGXemDOQ@mail.gmail.com>

Claus, thanks for the detailed explanation.

RE: > Your sky images naturally only cover a hemisphere. If done
correctly in HDRshop your env maps when remapped to angular mapping
would result in everything BELOW the horizon, below the xy-plane,
would return black.

I found sample sky probes with this mapping on
http://projects.ict.usc.edu/graphics/skyprobes/

When i initially looked at these images, i had assumed they were
acquired using a chrome sphere (with the ground portion cropped)
rather than a fisheye lens, due to their "half-sphere" appearance.

I'll give these a try using Paul's .cal file and method. Assuming that
works, i will try to transform my hemispherical sky images to match
this angular mapping using HDRshop.

Thanks for taking a break from vacation to push this along!

-Kyle



On Mon, Oct 15, 2012 at 12:40 PM, Claus Br?ndgaard Madsen
<cbm at create.aau.dk> wrote:
>
> Oops ... I didn't notice two threads were involved:-)
>
> Yep, panoramic conversion tools in HDRshop are second to none.
>
> At the conceptual level: it makes absolutely no difference what geometry your light probe is mapped to. It can be sphere, box, super quad, tetrahedron, whatever, as long as it totally encompasses the scene.
>
> The .cal you had in your other post would work for any geometry provided you had the correct mapping (image format) of the env map.
>
> That cal file is called whenever a light ray intersects the sky box (it is a box in Debevecs example, but could just as well be a sphere). The cal file takes the coordinates of that intersection and converts it to a spherical coordinate and subsequently transforms this spherical direction to a look-up in an angular mapping of the env map.
>
> Therefor it does not make any difference what geometry you are using because it is just a proxy geometry used to generate some intersection of which only the directions, not distances, are relevant. Hence the requirement for a big box in Debvecs example. Had the object/scene to be illuminated been 10000 by 10000 units large the box would have had to be an order of magnitude larger than that at least.
>
> Your sky images naturally only cover a hemisphere. If done correctly in HDRshop your env maps when remapped to angular mapping would result in everything BELOW the horizon, below the xy-plane, would return black.
>
> If you go ahead a try to make your own cal file that suits your cropped fish eye images then you don't have to worry about the black corners of the square image outside the spherical projection of the sky. Those pixels would never be looked up because they correspond to impossible ray directions.
>
> As you can see (also from the typos) I am writing from my iPod as I am on vacation. I may be able to provide more direct technical assistance once I'm back in my office next week. I can probably find some image examples and a cal file we can tweak to your needs.
>
>
> Best
> Claus
>
> Sent from my iPod
>
> On 15/10/2012, at 19.32, "kyle konis" <kskonis at gmail.com> wrote:
>
>> Hello Claus,
>>
>> Thanks for the response, both on the HDRI list and here. I've never
>> got into custom .cal files, but looks like the place to start to get
>> exactly what i want.
>>
>> I quickly read through some of the HDRshop tutorials on: http://www.hdrshop.com/
>>
>> There are many interesting and useful tools (including scripting) ....
>> And perhaps the "Panoramic Image Conversion" tool is what you are
>> referring to?
>>
>> ....At the conceptual level, the step i am confused with is
>> identifying the appropriate virtual object in Radiance to map my HDR
>> environment to.
>>
>> Paul uses an inward-pointing box, as in:
>>
>> ###############################################################
>> # specify a large inward-pointing box to be mapped with the HDR environment
>>
>> !genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250
>> ###############################################################
>>
>> All surfaces of the box contribute light.
>>
>> Because i only have captured light data from the horizon up, and dont
>> care (at this stage) about the group plane, it would seem that i
>> should start with a box that encompasses a hemisphere that is
>> positioned on the xy plane.
>>
>> Assuming this step is correct, i would then aim to map the non-zero
>> pixels in my hemispherical image to the surfaces of that box
>> (effectively stretching the circle into a rectangle).
>>
>> Alternatively, i could also try to map to a hemisphere, but then there
>> is the issue of what to do with the "black" pixels which make up the
>> corners of the HDR image.
>>
>> best,
>>
>> -Kyle
>>
>>
>>
>>
>> On Sun, Oct 14, 2012 at 12:23 PM, Claus Br?ndgaard Madsen
>> <cbm at create.aau.dk> wrote:
>>>
>>>
>>> Hi Kyle,
>>>
>>> Solving your problem is easy and not so easy.
>>>
>>> There will be some overlap between this response and my response To your other post, but for completeness...
>>>
>>> The easiest solution would be to re-map your hemispherical sky image to angular mapping that Debevec always prefers. I, myself, prefer the lat-long mapping, so I have written my own mapping .cal file. Writing such a .Cal is easy but you have to know what you are doing and there can be some debugging (trial and error) involved.
>>>
>>> In order to remap you sky view to an angular mapping it would be simple and easy to use the HDRshop progam (www.hdrshop.com), but there is no longer a free 1.0 version. Versions for academia are not too expensive though.
>>>
>>> Best
>>> Claus
>>>
>>>
>>>
>>>
>>> Claus B. Madsen
>>> AD:MT/AAU
>>>
>>>
>>> On 14/10/2012, at 12.17, "kyle konis" <kskonis at gmail.com> wrote:
>>>
>>>> Dear list,
>>>>
>>>> I am attempting to illuminate Paul Debevec's rnl_scene.rad with a
>>>> hemispherical HDR image of a dynamic sky.
>>>>
>>>> After the tutorial in http://www.pauldebevec.com/RNL/Source/
>>>>
>>>> I have succeeded in simply substituting in my image, but because it is
>>>> a 180-degree fisheye image (zenith view of sky) rather than a light
>>>> probe, i am encountering some issues with the resulting "reality" of
>>>> the output image.
>>>>
>>>> I would appreciate suggestions for how to properly map this image data
>>>> to a hemisphere (i.e. sky) in radiance to enable the image to serve
>>>> properly as a light source.
>>>>
>>>> I have included the relevant code below, and sample images on a
>>>> temporary webpage:
>>>>
>>>> https://sites.google.com/site/konisskytemp/
>>>>
>>>>
>>>> I would appreciate any suggestions!
>>>>
>>>> -Kyle
>>>>
>>>>
>>>> ### Here is the relevant description of the lighting environment ( i
>>>> have only changed the image file name to source my 1350 x 1350 px
>>>> cropped sky image)
>>>>
>>>> ################################################################
>>>> #
>>>> #  Lighting Environment
>>>> #
>>>> ################################################################
>>>>
>>>> # specify the probe image and how it is mapped onto geometry
>>>>
>>>> void colorpict hdr_env
>>>> 7 red green blue cropped.hdr angmap.cal sb_u sb_v
>>>> 0
>>>> 0
>>>>
>>>> # specify a "glow" material that will use this image
>>>>
>>>> hdr_env glow env_glow
>>>> 0
>>>> 0
>>>> 4 1 1 1 0
>>>>
>>>> # specify a large inward-pointing box to be mapped with the HDR environment
>>>>
>>>> !genbox env_glow boxenv 500 500 500 -i | xform -t -250 -18 -250
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> ################################################################
>>>> ### and here is angmap.cal
>>>> ################################################################
>>>>
>>>> {
>>>> angmap.cal
>>>>
>>>> Convert from directions in the world to coordinates on the angular sphere image
>>>>
>>>> -z is forward (outer edge of sphere)
>>>> +z is backward (center of sphere)
>>>> +y is up (toward top of sphere)
>>>> }
>>>>
>>>> sb_u = 0.5 + DDx * r;
>>>> sb_v = 0.5 + DDy * r;
>>>>
>>>> r = 0.159154943*acos(DDz)/sqrt(DDx*DDx + DDy*DDy);
>>>>
>>>> DDy = Py*norm;
>>>> DDx = Px*norm;
>>>> DDz = Pz*norm;
>>>>
>>>> norm = 1/sqrt(Py*Py + Px*Px + Pz*Pz);
>>>>
>>>>
>>>>
>>>>
>>>> ### Any suggestions for solutions would be appreciated
>>>>
>>>> I assume that i need to map the image to a hemisphere (representing
>>>> the sky dome) rather than a box
>>>>
>>>> perhaps passing the image as a glow rather than the standard sky glow?
>>>>
>>>> skyfunc glow skyglow
>>>> 0
>>>> 0
>>>> 4 1.000 1.000 1.000 0
>>>> skyglow source sky
>>>> 0
>>>> 0
>>>> 4 0 0 1 180
>>>>
>>>> Or to a sphere?
>>>>
>>>>
>>>>
>>>> And i assume that i need a different angmap.cal file, given that this
>>>> was written to interpret light probe images . . . and not
>>>> hemispherical fisheye images
>>>>
>>>> _______________________________________________
>>>> Radiance-general mailing list
>>>> Radiance-general at radiance-online.org
>>>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>>
>>> _______________________________________________
>>> Radiance-general mailing list
>>> Radiance-general at radiance-online.org
>>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general


From RFritz at lbl.gov  Mon Oct 15 16:54:59 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Mon, 15 Oct 2012 16:54:59 -0700
Subject: [Radiance-general] IBM pSeries 575
References: <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw@mail.gmail.com>
	<76D314B2-66B7-442A-A52F-ED940AB8E982@lmi.net>
	<CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw@mail.gmail.com>
	<5072BF07.50602@gmx.net>
	<9F30169B-973E-4D6A-9E8D-D16D44DEFF3D@iebele.nl>
	<k59mal$j34$1@ger.gmane.org>
	<626212D0-03B5-48AB-9883-D80CBEE97BA3@iebele.nl>
Message-ID: <k5i7oe$q4n$1@ger.gmane.org>

SLES11 SP1 = SUSE Linux Enterprise Server 11, Service Pack one.  It 
runs some patch of the 2.6.32 Linux kernel.

Lars, I know Radiance used to be extensively used on the PowerPC, but 
I'm wondering how much it still is.  Is anyone running Radiance 4.1 or 
4.2a on a POWER or PowerPC  system?

Randolph

On 2012-10-13 09:47:46 +0000, Iebele said:

> Hi Randolph,
> Thanks for your reply and the reference.
> I have no access to the system now. The documentation says:
> "Each node runs under one operating system (Linux: SLES11 SP1) and show 
> a single memory image to the user programs."
> 
> I'' ll forward this message to one of the administrators, to find out 
> whether they use Red Had or Suse.
> 
> - iebele
> 
> 
> 
> Op 12 okt. 2012, om 21:08 heeft Randolph M. Fritz het volgende geschreven:
> 
>> On 2012-10-08 12:17:56 +0000, Iebele said:
>> 
>>> pSeries 575
>> 
>> It runs Unix, so I expect Radiance will compile and run on it, but it 
>> uses IBM POWER5+ processors, rather than x86s, so there may be some 
>> surprises.
>> 
>> Do you know what operating system the system administrators are using?  
>> According to IBM, administrators have a choice of AIX, Red Hat Linux, 
>> and SUSE Linux, or possibly all three in a virtualization mode.
>> 
>> Ref: 
>> http://www-03.ibm.com/systems/power/hardware/systemp/highend/575/index.html> 
>> --> Randolph M. Fritz ? RFritz at lbl.gov
>> Environmental Energy Technologies Division ? Lawrence Berkeley Labs


-- 
Randolph M. Fritz ? RFritz at lbl.gov
Environmental Energy Technologies Division ? Lawrence Berkeley Labs




From hujia06 at gmail.com  Mon Oct 15 20:49:42 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Mon, 15 Oct 2012 23:49:42 -0400
Subject: [Radiance-general] front and back transmission in BSDF
Message-ID: <CABzgtwpKsKQfax7D4Qd8xR8E6YY_OowtNaXs0=0w83A52rtK8A@mail.gmail.com>

Hello:

What is the definition of "front" and "back" transmission in the BSDF xml
file? I  test using BSDF files of Window 6 and genBSDF,  and find that it
uses "Transmission Back" to calculate radiance. "genBSDF +forward -backward
test.rad > test.xml" gave zero illuminance.  So "back"  denotes from
outside to inside (towards inside the room)?  that is, the incident ray
falls on the outside window surface?

However, the three-phase daylight coefficient method  tutorial mentions
that Radiance uses "front transmission" data. In addition, in source code:
bsdf.c, line 1343:

                    # line 1343
if (!strcasecmp(ezxml_txt(ezxml_child(wdb,
"WavelengthDataDirection")),
"Transmission Front"))
break;

It looks using "transmission front".

Which (front or back) transmission does Radiance use?

Thanks,

Jia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121015/635605ac/attachment-0001.html>

From gregoryjward at gmail.com  Mon Oct 15 21:47:47 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Mon, 15 Oct 2012 21:47:47 -0700
Subject: [Radiance-general] front and back transmission in BSDF
In-Reply-To: <CABzgtwpKsKQfax7D4Qd8xR8E6YY_OowtNaXs0=0w83A52rtK8A@mail.gmail.com>
References: <CABzgtwpKsKQfax7D4Qd8xR8E6YY_OowtNaXs0=0w83A52rtK8A@mail.gmail.com>
Message-ID: <94E468D4-E4B1-4C01-BEEF-759972BBC99F@lmi.net>

Hi Jia,

It is confusing, because WINDOW 6 defines the front of a window as the outward-looking face, whereas Radiance faces window surfaces inwards when they are used as light sources.  Thus, the notion of front and back get reversed between the WINDOW 6 XML file and Radiance.

In addition to this, there is the fact that Radiance generally follows rays backwards from their destination (the point of measurement) to their source.  Therefore, calculations in the interior of the space trace light rays backwards to the window surface, then use the WINDOW 6 "Transmission Back" data to compute light contributions from the other side.

One more thing that bears mentioning is that if only one of "Front Transmission" or "Back Transmission" is available in the XML file, the BSDF library knows how to apply reciprocity to estimate the opposite direction.  Thus, using only one of "+forward" or "+backward" in genBSDF still works for transmission.  For reflection, you need to compute the distribution for the side(s) in which you are interested.

To be absolutely clear, the "+forward" computes the WINDOW 6 "Front Transmission" and "Front Reflection" components, whereas the "+backward" option computes "Back Transmission" and "Back Reflection."  The back/front confusion is why I chose to call these options "forward" and "backward" rather than "front" and "back," which would be ambiguous.  Forward means rays entering the space from the outside, and backward means they are going the other way, which is generally what we are interested in with Radiance (hence the default "+backward" and "-forward" options.)

I hope this helps.
-Greg

> From: Jia Hu <hujia06 at gmail.com>
> Date: October 15, 2012 8:49:42 PM PDT
> 
> Hello:
> 
> What is the definition of "front" and "back" transmission in the BSDF xml file? I  test using BSDF files of Window 6 and genBSDF,  and find that it uses "Transmission Back" to calculate radiance. "genBSDF +forward -backward test.rad > test.xml" gave zero illuminance.  So "back"  denotes from outside to inside (towards inside the room)?  that is, the incident ray falls on the outside window surface?  
> 
> However, the three-phase daylight coefficient method  tutorial mentions that Radiance uses "front transmission" data. In addition, in source code: bsdf.c, line 1343:
>  
>                     # line 1343
> 			if (!strcasecmp(ezxml_txt(ezxml_child(wdb,
> 					"WavelengthDataDirection")),
> 					"Transmission Front"))
> 				break;
> 
> It looks using "transmission front". 
> 
> Which (front or back) transmission does Radiance use?
> 
> Thanks,
> 
> Jia 


From grobe at gmx.net  Tue Oct 16 00:12:50 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Tue, 16 Oct 2012 09:12:50 +0200
Subject: [Radiance-general] Attempt to illuminate Paul Debevec's
	rnl_scene.rad with a hemispherical HDR image of the sky
In-Reply-To: <7AEAEFDD-D8B6-40E4-88A1-49263982A5D2@create.aau.dk>
References: <CAAzVHq2=j=eLM-0r1wb+GSNDxYKApeyi1tHmhLz2Ejj6=Bb+6w@mail.gmail.com>
	<91355210-820E-408D-ADB4-C3DEDDE0EEA1@create.aau.dk>,
	<CAAzVHq3yNs=DCg0K2i6Y7_cJ5sScXPRxtBVXcKSiuZJsoZVrSQ@mail.gmail.com>
	<7AEAEFDD-D8B6-40E4-88A1-49263982A5D2@create.aau.dk>
Message-ID: <322DD1C9-A7F9-4E8A-ACE1-3F6D7BA8854C@gmx.net>

Hi,

just one idea for those trying to reproject light probes. Hugin has support for HDR, and can derive lens parameters from stitching partially overlapping images. As any real lens differs from a perfect projection model, this may be helpful to map from photographs to a "perfect" fisheye projection.

Cheers, Lars.

From grobe at gmx.net  Tue Oct 16 00:26:56 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Tue, 16 Oct 2012 09:26:56 +0200
Subject: [Radiance-general] gendaylit and epw weather files, minutes field
Message-ID: <FD5C4A73-1E3D-4F4C-B719-5772C0C0BE4A@gmx.net>

Hi all,

while working around reading in values from an epw file for gendaylit for climate based simulation, I found some really weird time values in my data. The epw file should contain hourly data from 01:00 to 24:00. However, I found that the "minutes" field was set to 60 for every record, so the last record was 24:60. I tried to figure out what this could mean (I was first guessing that the timezone may have been applied by adding 60 minutes).

In the end, I got an answer that was rather surprising to me, and that I would like to share. The value "60" in the minutes field does NOT refer to the time when the measurement was recorded, but to the recording interval (hourly). In other words, it has nothing to do with the time stamp, but is an integration time. So 24:60 is the value for 00:00, and, if I understand this correctly, the values of the record should be the average of measurements from 23:30 to 00:30.

For using the data with gendaylit, this means that I sed the minutes fields and set it to zero (without incrementing the hours field). Did anyone else get stuck with this before? I hope I got it right now...

Cheers, Lars.

From jan.wienold at ise.fraunhofer.de  Tue Oct 16 01:10:01 2012
From: jan.wienold at ise.fraunhofer.de (Jan Wienold)
Date: Tue, 16 Oct 2012 10:10:01 +0200
Subject: [Radiance-general] gendaylit and epw weather files,
	minutes field
In-Reply-To: <FD5C4A73-1E3D-4F4C-B719-5772C0C0BE4A@gmx.net>
References: <FD5C4A73-1E3D-4F4C-B719-5772C0C0BE4A@gmx.net>
Message-ID: <b6034098bc536904f1b1a8e76c90dcee@ise.fhg.de>

Hi Lars,

usually radiation data in weather files is the sum for one hour and not 
the current irradiation for a given time-stamp.

That means e.g. hour no. 8 is the hour between 7:00 and 8:00, the value 
is usually the total sum in Wh between 7 and 8..

Daysim is using the sun position of the middle of the time step, in 
that case would be 7:30.

Be careful about sunset and sunrise!

In case the sunrise would be at 7:40 you run into trouble regarding sun 
position, in that case you might use the middle between sunrise and next 
time step (in that case 7:50). This is also implemented into Daysim.

Cheers,

Jan


Am 16.10.2012 09:26, schrieb Lars O. Grobe:
> Hi all,
>
> while working around reading in values from an epw file for gendaylit
> for climate based simulation, I found some really weird time values 
> in
> my data. The epw file should contain hourly data from 01:00 to 24:00.
> However, I found that the "minutes" field was set to 60 for every
> record, so the last record was 24:60. I tried to figure out what this
> could mean (I was first guessing that the timezone may have been
> applied by adding 60 minutes).
>
> In the end, I got an answer that was rather surprising to me, and
> that I would like to share. The value "60" in the minutes field does
> NOT refer to the time when the measurement was recorded, but to the
> recording interval (hourly). In other words, it has nothing to do 
> with
> the time stamp, but is an integration time. So 24:60 is the value for
> 00:00, and, if I understand this correctly, the values of the record
> should be the average of measurements from 23:30 to 00:30.
>
> For using the data with gendaylit, this means that I sed the minutes
> fields and set it to zero (without incrementing the hours field). Did
> anyone else get stuck with this before? I hope I got it right now...
>
> Cheers, Lars.
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general



From hujia06 at gmail.com  Tue Oct 16 08:27:17 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Tue, 16 Oct 2012 11:27:17 -0400
Subject: [Radiance-general] front and back transmission in BSDF
In-Reply-To: <94E468D4-E4B1-4C01-BEEF-759972BBC99F@lmi.net>
References: <CABzgtwpKsKQfax7D4Qd8xR8E6YY_OowtNaXs0=0w83A52rtK8A@mail.gmail.com>
	<94E468D4-E4B1-4C01-BEEF-759972BBC99F@lmi.net>
Message-ID: <CABzgtwrUOYeqPAbybhszizo20ifcLwn3riucMWmVkpZvsC=Jfw@mail.gmail.com>

Thank you very much for your detailed explanation. From WINDOW 6 manual,
 Incoming and outgoing ray direction in XML is defined as this:
https://dl.dropbox.com/u/15562376/angle.gif    So,  simply speaking
(without considering RGB channels), in the formula E = VTDs, T ("back" in
WINOW 6 convention) is actually transposed from the XML file then
multiplied by solid angle for each direction?

Thanks,

Jia

On Tue, Oct 16, 2012 at 12:47 AM, Greg Ward <gregoryjward at gmail.com> wrote:

> Hi Jia,
>
> It is confusing, because WINDOW 6 defines the front of a window as the
> outward-looking face, whereas Radiance faces window surfaces inwards when
> they are used as light sources.  Thus, the notion of front and back get
> reversed between the WINDOW 6 XML file and Radiance.
>
> In addition to this, there is the fact that Radiance generally follows
> rays backwards from their destination (the point of measurement) to their
> source.  Therefore, calculations in the interior of the space trace light
> rays backwards to the window surface, then use the WINDOW 6 "Transmission
> Back" data to compute light contributions from the other side.
>
> One more thing that bears mentioning is that if only one of "Front
> Transmission" or "Back Transmission" is available in the XML file, the BSDF
> library knows how to apply reciprocity to estimate the opposite direction.
>  Thus, using only one of "+forward" or "+backward" in genBSDF still works
> for transmission.  For reflection, you need to compute the distribution for
> the side(s) in which you are interested.
>
> To be absolutely clear, the "+forward" computes the WINDOW 6 "Front
> Transmission" and "Front Reflection" components, whereas the "+backward"
> option computes "Back Transmission" and "Back Reflection."  The back/front
> confusion is why I chose to call these options "forward" and "backward"
> rather than "front" and "back," which would be ambiguous.  Forward means
> rays entering the space from the outside, and backward means they are going
> the other way, which is generally what we are interested in with Radiance
> (hence the default "+backward" and "-forward" options.)
>
> I hope this helps.
> -Greg
>
> > From: Jia Hu <hujia06 at gmail.com>
> > Date: October 15, 2012 8:49:42 PM PDT
> >
> > Hello:
> >
> > What is the definition of "front" and "back" transmission in the BSDF
> xml file? I  test using BSDF files of Window 6 and genBSDF,  and find that
> it uses "Transmission Back" to calculate radiance. "genBSDF +forward
> -backward test.rad > test.xml" gave zero illuminance.  So "back"  denotes
> from outside to inside (towards inside the room)?  that is, the incident
> ray falls on the outside window surface?
> >
> > However, the three-phase daylight coefficient method  tutorial mentions
> that Radiance uses "front transmission" data. In addition, in source code:
> bsdf.c, line 1343:
> >
> >                     # line 1343
> >                       if (!strcasecmp(ezxml_txt(ezxml_child(wdb,
> >                                       "WavelengthDataDirection")),
> >                                       "Transmission Front"))
> >                               break;
> >
> > It looks using "transmission front".
> >
> > Which (front or back) transmission does Radiance use?
> >
> > Thanks,
> >
> > Jia
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121016/b3c4e874/attachment.html>

From gregoryjward at gmail.com  Tue Oct 16 08:54:31 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Tue, 16 Oct 2012 08:54:31 -0700
Subject: [Radiance-general] front and back transmission in BSDF
In-Reply-To: <CABzgtwrUOYeqPAbybhszizo20ifcLwn3riucMWmVkpZvsC=Jfw@mail.gmail.com>
References: <CABzgtwpKsKQfax7D4Qd8xR8E6YY_OowtNaXs0=0w83A52rtK8A@mail.gmail.com>
	<94E468D4-E4B1-4C01-BEEF-759972BBC99F@lmi.net>
	<CABzgtwrUOYeqPAbybhszizo20ifcLwn3riucMWmVkpZvsC=Jfw@mail.gmail.com>
Message-ID: <CD32262F-1D44-421E-83D9-12542B394E2D@lmi.net>

You can think of it that way.  In fact, the reversal of axes on front and back surfaces means that it is not necessary to transpose the data in the matrix.  This is the way Joe Klems designed the system, for easy multiplication of layer matrices.

Best,
-Greg

> From: Jia Hu <hujia06 at gmail.com>
> Date: October 16, 2012 8:27:17 AM PDT
> 
> Thank you very much for your detailed explanation. From WINDOW 6 manual,  Incoming and outgoing ray direction in XML is defined as this: https://dl.dropbox.com/u/15562376/angle.gif    So,  simply speaking (without considering RGB channels), in the formula E = VTDs, T ("back" in WINOW 6 convention) is actually transposed from the XML file then multiplied by solid angle for each direction? 
> 
> Thanks,
> 
> Jia
> 
> On Tue, Oct 16, 2012 at 12:47 AM, Greg Ward <gregoryjward at gmail.com> wrote:
> Hi Jia,
> 
> It is confusing, because WINDOW 6 defines the front of a window as the outward-looking face, whereas Radiance faces window surfaces inwards when they are used as light sources.  Thus, the notion of front and back get reversed between the WINDOW 6 XML file and Radiance.
> 
> In addition to this, there is the fact that Radiance generally follows rays backwards from their destination (the point of measurement) to their source.  Therefore, calculations in the interior of the space trace light rays backwards to the window surface, then use the WINDOW 6 "Transmission Back" data to compute light contributions from the other side.
> 
> One more thing that bears mentioning is that if only one of "Front Transmission" or "Back Transmission" is available in the XML file, the BSDF library knows how to apply reciprocity to estimate the opposite direction.  Thus, using only one of "+forward" or "+backward" in genBSDF still works for transmission.  For reflection, you need to compute the distribution for the side(s) in which you are interested.
> 
> To be absolutely clear, the "+forward" computes the WINDOW 6 "Front Transmission" and "Front Reflection" components, whereas the "+backward" option computes "Back Transmission" and "Back Reflection."  The back/front confusion is why I chose to call these options "forward" and "backward" rather than "front" and "back," which would be ambiguous.  Forward means rays entering the space from the outside, and backward means they are going the other way, which is generally what we are interested in with Radiance (hence the default "+backward" and "-forward" options.)
> 
> I hope this helps.
> -Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121016/fdfe0f6f/attachment-0001.html>

From tbleicher at googlemail.com  Tue Oct 16 19:16:20 2012
From: tbleicher at googlemail.com (Thomas Bleicher)
Date: Tue, 16 Oct 2012 21:16:20 -0500
Subject: [Radiance-general] remapping HDR projections
In-Reply-To: <6F5225D6E15F954BB4E58EC25F6736C309A676EE@corp3005.CORPORATE.FOSTER.NETWORK>
References: <6F5225D6E15F954BB4E58EC25F6736C309A676EE@corp3005.CORPORATE.FOSTER.NETWORK>
Message-ID: <CAKGV-k04S-ZUmojZeRrXw=b2MdWq1=y=AMVSv0wx01Hn1=VJtA@mail.gmail.com>

I think I used Imagemagick for this. Somewhere in the IM online examples I
found a command to do it and buried it in my scripts. Will take me a bit to
find it but you can try the IM online docs and examples yourself.

Regards,
Thomas

On Mon, Oct 15, 2012 at 11:58 AM, Giovanni Betti <
gbetti at fosterandpartners.com> wrote:

> Hi All, ****
>
> ** **
>
> I have some 360deg HDR images in equirectangular format. Does anyone know
> how to extract 180degrees equiangular fisheye images out of those?****
>
> I am guessing is some magic combination of pcomb command lines.****
>
> Any thoughts anyone?****
>
> ** **
>
> Thanks,****
>
>
> Giovanni****
>
> ** **
>
> ** **
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121016/ca1701e6/attachment.html>

From tbleicher at googlemail.com  Wed Oct 17 06:11:11 2012
From: tbleicher at googlemail.com (Thomas Bleicher)
Date: Wed, 17 Oct 2012 08:11:11 -0500
Subject: [Radiance-general] remapping HDR projections
In-Reply-To: <CAKGV-k04S-ZUmojZeRrXw=b2MdWq1=y=AMVSv0wx01Hn1=VJtA@mail.gmail.com>
References: <6F5225D6E15F954BB4E58EC25F6736C309A676EE@corp3005.CORPORATE.FOSTER.NETWORK>
	<CAKGV-k04S-ZUmojZeRrXw=b2MdWq1=y=AMVSv0wx01Hn1=VJtA@mail.gmail.com>
Message-ID: <CAKGV-k2+Jx5xUFrjmr9d=R3k14_XYpq5uRpKz7Mjca+bgRmJ7w@mail.gmail.com>

The IM documentation is here:

http://www.imagemagick.org/Usage/distorts/#circular_distorts

Of course you have to use the HDR capable version of ImageMagick and you
need to experiment a bit to make it fit your needs.

Regards,
Thomas

On Tue, Oct 16, 2012 at 9:16 PM, Thomas Bleicher
<tbleicher at googlemail.com>wrote:

> I think I used Imagemagick for this. Somewhere in the IM online examples I
> found a command to do it and buried it in my scripts. Will take me a bit to
> find it but you can try the IM online docs and examples yourself.
>
> Regards,
> Thomas
>
> On Mon, Oct 15, 2012 at 11:58 AM, Giovanni Betti <
> gbetti at fosterandpartners.com> wrote:
>
>> Hi All, ****
>>
>> ** **
>>
>> I have some 360deg HDR images in equirectangular format. Does anyone know
>> how to extract 180degrees equiangular fisheye images out of those?****
>>
>> I am guessing is some magic combination of pcomb command lines.****
>>
>> Any thoughts anyone?****
>>
>> ** **
>>
>> Thanks,****
>>
>>
>> Giovanni****
>>
>> ** **
>>
>> ** **
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121017/5a9ec1ac/attachment.html>

From gbetti at fosterandpartners.com  Wed Oct 17 07:06:58 2012
From: gbetti at fosterandpartners.com (Giovanni Betti)
Date: Wed, 17 Oct 2012 15:06:58 +0100
Subject: [Radiance-general] remapping HDR projections
In-Reply-To: <CAKGV-k2+Jx5xUFrjmr9d=R3k14_XYpq5uRpKz7Mjca+bgRmJ7w@mail.gmail.com>
References: <6F5225D6E15F954BB4E58EC25F6736C309A676EE@corp3005.CORPORATE.FOSTER.NETWORK><CAKGV-k04S-ZUmojZeRrXw=b2MdWq1=y=AMVSv0wx01Hn1=VJtA@mail.gmail.com>
	<CAKGV-k2+Jx5xUFrjmr9d=R3k14_XYpq5uRpKz7Mjca+bgRmJ7w@mail.gmail.com>
Message-ID: <6F5225D6E15F954BB4E58EC25F6736C309A6788F@corp3005.CORPORATE.FOSTER.NETWORK>

Thanks for the pointer, I never tried ImageMagik but seems worth playing
around with!

I'll let you know if I succeed (or fail!)

 

 

 

 

From: Thomas Bleicher [mailto:tbleicher at googlemail.com] 
Sent: 17 October 2012 14:11
To: Radiance general discussion
Subject: Re: [Radiance-general] remapping HDR projections

 

The IM documentation is here:

 

http://www.imagemagick.org/Usage/distorts/#circular_distorts

 

Of course you have to use the HDR capable version of ImageMagick and you
need to experiment a bit to make it fit your needs.

 

Regards,

Thomas

 

On Tue, Oct 16, 2012 at 9:16 PM, Thomas Bleicher
<tbleicher at googlemail.com> wrote:



I think I used Imagemagick for this. Somewhere in the IM online examples
I found a command to do it and buried it in my scripts. Will take me a
bit to find it but you can try the IM online docs and examples yourself.

 

Regards,

Thomas 

On Mon, Oct 15, 2012 at 11:58 AM, Giovanni Betti
<gbetti at fosterandpartners.com> wrote:

	Hi All, 

	 

	I have some 360deg HDR images in equirectangular format. Does
anyone know how to extract 180degrees equiangular fisheye images out of
those?

	I am guessing is some magic combination of pcomb command lines.

	Any thoughts anyone?

	 

	Thanks,

	
	Giovanni

	 

	 

	 

	_______________________________________________
	Radiance-general mailing list
	Radiance-general at radiance-online.org
	http://www.radiance-online.org/mailman/listinfo/radiance-general

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121017/a521c0f5/attachment.html>

From akrickx at integralgroup.com  Thu Oct 18 09:22:02 2012
From: akrickx at integralgroup.com (Alex Krickx)
Date: Thu, 18 Oct 2012 09:22:02 -0700
Subject: [Radiance-general] Problems with RAD
Message-ID: <CAJhox8Q-f8VWdy=3YfsP1BsOQG6oPVi6cd8CS_iw5ps4rFVO_g@mail.gmail.com>

Hi everyone,

I am having a weird issue with the RAD command. Radiance is running on my
machine: I checked my scene before and had no issue with using oconv on my
scenes and then using rvu to check out the octree. But once I set set up my
.rif file and run "rad summer.rif" I get the following error:

oconv mod3.rad summer_sky.rad > summer.oct
oconv: system - cannot open scene file "mod3.rad": No such file or directory
rad: error generating octree
summer.oct removed

If I change the filename in my .rif for mod3.rad I get a different error
("no such file") so it should be pointing to the right file. Any
suggestions? I'm running radiance on a Windows7 machine. I'm pretty sure I
downloaded the files from NREL's openstudio site. Any suggestions? I've
attached my files - they're pretty simple.

Thanks,
Alex Krickx

*
*

*Alex Krickx, LEED AP*
Project Engineer**

*________________________________*****

I N T E G R A L****

*                         ** **GROUP*****

** **

427 13th Street, Oakland CA 94612
510 663 2070 x 247****

akrickx at integralgroup.com
www.integralgroup.com****

** **

*DEEP GREEN Engineering.*

*_______________________________*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121018/3f3d0cd4/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mod3.rad
Type: application/octet-stream
Size: 12810 bytes
Desc: not available
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121018/3f3d0cd4/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: summer.rif
Type: application/octet-stream
Size: 375 bytes
Desc: not available
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121018/3f3d0cd4/attachment-0001.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: summer_sky.rad
Type: application/octet-stream
Size: 357 bytes
Desc: not available
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121018/3f3d0cd4/attachment-0002.obj>

From Robert.Guglielmetti at nrel.gov  Thu Oct 18 09:36:54 2012
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Thu, 18 Oct 2012 10:36:54 -0600
Subject: [Radiance-general] Problems with RAD
In-Reply-To: <CAJhox8Q-f8VWdy=3YfsP1BsOQG6oPVi6cd8CS_iw5ps4rFVO_g@mail.gmail.com>
Message-ID: <CCA58BF8.15EF2%robert.guglielmetti@nrel.gov>

At first blush, that looks like maybe you don't have your current directory (".") in your search path. Assuming those two files are in your current dir, try:

oconv ./mod3.rad ./summer_sky.rad > summer.oct

If that works, then you can add "." to your path.



Rob Guglielmetti
National Renewable Energy Laboratory (NREL)
Commercial Buildings Research Group
15013 Denver West Parkway MS:RSF202
Golden, CO 80401
303.275.4319
robert.guglielmetti at nrel.gov



On 10/18/12 10:22 AM, "Alex Krickx" <akrickx at integralgroup.com<mailto:akrickx at integralgroup.com>> wrote:

Hi everyone,

I am having a weird issue with the RAD command. Radiance is running on my machine: I checked my scene before and had no issue with using oconv on my scenes and then using rvu to check out the octree. But once I set set up my .rif file and run "rad summer.rif" I get the following error:

oconv mod3.rad summer_sky.rad > summer.oct
oconv: system - cannot open scene file "mod3.rad": No such file or directory
rad: error generating octree
summer.oct removed

If I change the filename in my .rif for mod3.rad I get a different error ("no such file") so it should be pointing to the right file. Any suggestions? I'm running radiance on a Windows7 machine. I'm pretty sure I downloaded the files from NREL's openstudio site. Any suggestions? I've attached my files - they're pretty simple.

Thanks,
Alex Krickx


Alex Krickx, LEED AP
Project Engineer

________________________________

I N T E G R A L

                          GROUP



427 13th Street, Oakland CA 94612
510 663 2070 x 247

akrickx at integralgroup.com<mailto:akrickx at integralgroup.com>
www.integralgroup.com<http://www.integralgroup.com/>



DEEP GREEN Engineering.

_______________________________



From akrickx at integralgroup.com  Thu Oct 18 09:49:04 2012
From: akrickx at integralgroup.com (Alex Krickx)
Date: Thu, 18 Oct 2012 09:49:04 -0700
Subject: [Radiance-general] Problems with RAD
In-Reply-To: <CCA58BF8.15EF2%robert.guglielmetti@nrel.gov>
References: <CAJhox8Q-f8VWdy=3YfsP1BsOQG6oPVi6cd8CS_iw5ps4rFVO_g@mail.gmail.com>
	<CCA58BF8.15EF2%robert.guglielmetti@nrel.gov>
Message-ID: <CAJhox8QJYoW1VqXs-7zF4dX7_RdSbnZkDPA5Cj2_46tZKkwnWQ@mail.gmail.com>

Hi Rob,

Thanks for your response. The files are indeed in my current directory - I
thought the path was ok because when I type in "oconv mod3.rad
summer_sky.rad > summer.oct" without "./"s into the command editor I
generate the octree correctly - am I mistaken?

Thanks,
Alex

*Alex Krickx, LEED AP*
Project Engineer**

*________________________________*****

I N T E G R A L****

*                         ** **GROUP*****

** **

427 13th Street, Oakland CA 94612
510 663 2070 x 247****

akrickx at integralgroup.com
www.integralgroup.com****

** **

*DEEP GREEN Engineering.*

*_______________________________*



On Thu, Oct 18, 2012 at 9:36 AM, Guglielmetti, Robert <
Robert.Guglielmetti at nrel.gov> wrote:

> At first blush, that looks like maybe you don't have your current
> directory (".") in your search path. Assuming those two files are in your
> current dir, try:
>
> oconv ./mod3.rad ./summer_sky.rad > summer.oct
>
> If that works, then you can add "." to your path.
>
>
>
> Rob Guglielmetti
> National Renewable Energy Laboratory (NREL)
> Commercial Buildings Research Group
> 15013 Denver West Parkway MS:RSF202
> Golden, CO 80401
> 303.275.4319
> robert.guglielmetti at nrel.gov
>
>
>
> On 10/18/12 10:22 AM, "Alex Krickx" <akrickx at integralgroup.com<mailto:
> akrickx at integralgroup.com>> wrote:
>
> Hi everyone,
>
> I am having a weird issue with the RAD command. Radiance is running on my
> machine: I checked my scene before and had no issue with using oconv on my
> scenes and then using rvu to check out the octree. But once I set set up my
> .rif file and run "rad summer.rif" I get the following error:
>
> oconv mod3.rad summer_sky.rad > summer.oct
> oconv: system - cannot open scene file "mod3.rad": No such file or
> directory
> rad: error generating octree
> summer.oct removed
>
> If I change the filename in my .rif for mod3.rad I get a different error
> ("no such file") so it should be pointing to the right file. Any
> suggestions? I'm running radiance on a Windows7 machine. I'm pretty sure I
> downloaded the files from NREL's openstudio site. Any suggestions? I've
> attached my files - they're pretty simple.
>
> Thanks,
> Alex Krickx
>
>
> Alex Krickx, LEED AP
> Project Engineer
>
> ________________________________
>
> I N T E G R A L
>
>                           GROUP
>
>
>
> 427 13th Street, Oakland CA 94612
> 510 663 2070 x 247
>
> akrickx at integralgroup.com<mailto:akrickx at integralgroup.com>
> www.integralgroup.com<http://www.integralgroup.com/>
>
>
>
> DEEP GREEN Engineering.
>
> _______________________________
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121018/bcd82bd1/attachment.html>

From gregoryjward at gmail.com  Thu Oct 18 09:51:20 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Thu, 18 Oct 2012 09:51:20 -0700
Subject: [Radiance-general] Problems with RAD
In-Reply-To: <CCA58BF8.15EF2%robert.guglielmetti@nrel.gov>
References: <CCA58BF8.15EF2%robert.guglielmetti@nrel.gov>
Message-ID: <2D299514-1410-4AAD-B105-48287AEF9A33@lmi.net>

You can try Rob's suggestion, but I checked the code, and there is no search going on by oconv for input files.  Therefore, I suspect something is wrong with your file permissions.  If you can "cat" the file using "cat mod3.rad" in the same directory, then try running oconv by hand to see if that works -- just copy and paste what rad produces before the error.

This won't solve your problem, but it may help to figure out what's going wrong.

-Greg

> From: "Guglielmetti, Robert" <Robert.Guglielmetti at nrel.gov>
> Date: October 18, 2012 9:36:54 AM PDT
> 
> At first blush, that looks like maybe you don't have your current directory (".") in your search path. Assuming those two files are in your current dir, try:
> 
> oconv ./mod3.rad ./summer_sky.rad > summer.oct
> 
> If that works, then you can add "." to your path.
> 
> Rob Guglielmetti
> 
> On 10/18/12 10:22 AM, "Alex Krickx" <akrickx at integralgroup.com<mailto:akrickx at integralgroup.com>> wrote:
> 
> Hi everyone,
> 
> I am having a weird issue with the RAD command. Radiance is running on my machine: I checked my scene before and had no issue with using oconv on my scenes and then using rvu to check out the octree. But once I set set up my .rif file and run "rad summer.rif" I get the following error:
> 
> oconv mod3.rad summer_sky.rad > summer.oct
> oconv: system - cannot open scene file "mod3.rad": No such file or directory
> rad: error generating octree
> summer.oct removed
> 
> If I change the filename in my .rif for mod3.rad I get a different error ("no such file") so it should be pointing to the right file. Any suggestions? I'm running radiance on a Windows7 machine. I'm pretty sure I downloaded the files from NREL's openstudio site. Any suggestions? I've attached my files - they're pretty simple.
> 
> Thanks,
> Alex Krickx
> 
> 
> Alex Krickx, LEED AP
> Project Engineer


From gregoryjward at gmail.com  Thu Oct 18 10:08:35 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Thu, 18 Oct 2012 10:08:35 -0700
Subject: [Radiance-general] Problems with RAD
In-Reply-To: <CAJhox8QJYoW1VqXs-7zF4dX7_RdSbnZkDPA5Cj2_46tZKkwnWQ@mail.gmail.com>
References: <CAJhox8Q-f8VWdy=3YfsP1BsOQG6oPVi6cd8CS_iw5ps4rFVO_g@mail.gmail.com>
	<CCA58BF8.15EF2%robert.guglielmetti@nrel.gov>
	<CAJhox8QJYoW1VqXs-7zF4dX7_RdSbnZkDPA5Cj2_46tZKkwnWQ@mail.gmail.com>
Message-ID: <E1DD7FCE-A250-4EBE-AD0B-E16D78B9AD5B@lmi.net>

This doesn't really make sense, since rad calls system() with the same command line.  If you can cut and paste from the rad output to the command prompt and that works, then rad should work, also.  It works fine on my Unix system.  I'm stumped.

-Greg

> From: Alex Krickx <akrickx at integralgroup.com>
> Date: October 18, 2012 9:49:04 AM PDT
> 
> Hi Rob,
> 
> Thanks for your response. The files are indeed in my current directory - I thought the path was ok because when I type in "oconv mod3.rad summer_sky.rad > summer.oct" without "./"s into the command editor I generate the octree correctly - am I mistaken? 
> 
> Thanks,
> Alex
> 
> Alex Krickx, LEED AP 
> Project Engineer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121018/3781cbbb/attachment.html>

From akrickx at integralgroup.com  Thu Oct 18 16:40:20 2012
From: akrickx at integralgroup.com (Alex Krickx)
Date: Thu, 18 Oct 2012 16:40:20 -0700
Subject: [Radiance-general] Problems with RAD
In-Reply-To: <E1DD7FCE-A250-4EBE-AD0B-E16D78B9AD5B@lmi.net>
References: <CAJhox8Q-f8VWdy=3YfsP1BsOQG6oPVi6cd8CS_iw5ps4rFVO_g@mail.gmail.com>
	<CCA58BF8.15EF2%robert.guglielmetti@nrel.gov>
	<CAJhox8QJYoW1VqXs-7zF4dX7_RdSbnZkDPA5Cj2_46tZKkwnWQ@mail.gmail.com>
	<E1DD7FCE-A250-4EBE-AD0B-E16D78B9AD5B@lmi.net>
Message-ID: <CAJhox8RDvLcHVMdQz=pWjZbaPaxNKjh4ZZnDrXJPH8w6OaT70w@mail.gmail.com>

Thanks to Greg and Rob,

Turns out it was a Windows OS issue (surprise surprise). Just to share what
I learned with the list - Windows can have certain permissions issues that
prevent Radiance from running correctly. We also found a weird Registry
value (yikes!) that was the main culprit.

Adding a "." to my path also may have solved my problem - in any case I'm
keeping it in there for good measure. Now to do some scene rendering...

Cheers,
Alex Krickx

*
*

*Alex Krickx, LEED AP*
Project Engineer**

*________________________________*****

I N T E G R A L****

*                         ** **GROUP*****

** **

427 13th Street, Oakland CA 94612
510 663 2070 x 247****

akrickx at integralgroup.com
www.integralgroup.com****

** **

*DEEP GREEN Engineering.*

*_______________________________*



On Thu, Oct 18, 2012 at 10:08 AM, Greg Ward <gregoryjward at gmail.com> wrote:

> This doesn't really make sense, since rad calls system() with the same
> command line.  If you can cut and paste from the rad output to the command
> prompt and that works, then rad should work, also.  It works fine on my
> Unix system.  I'm stumped.
>
> -Greg
>
> *From: *Alex Krickx <akrickx at integralgroup.com>
>
> *Date: *October 18, 2012 9:49:04 AM PDT
>
> *
> *
>
> Hi Rob,
>
> Thanks for your response. The files are indeed in my current directory - I
> thought the path was ok because when I type in "oconv mod3.rad
> summer_sky.rad > summer.oct" without "./"s into the command editor I
> generate the octree correctly - am I mistaken?
>
> Thanks,
> Alex
>
> *Alex Krickx, LEED AP*
> Project Engineer
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121018/a43739a7/attachment.html>

From rob.guglielmetti at gmail.com  Thu Oct 18 18:10:17 2012
From: rob.guglielmetti at gmail.com (Rob Guglielmetti)
Date: Thu, 18 Oct 2012 19:10:17 -0600
Subject: [Radiance-general] Problems with RAD
In-Reply-To: <CAJhox8RDvLcHVMdQz=pWjZbaPaxNKjh4ZZnDrXJPH8w6OaT70w@mail.gmail.com>
References: <CAJhox8Q-f8VWdy=3YfsP1BsOQG6oPVi6cd8CS_iw5ps4rFVO_g@mail.gmail.com>
	<CCA58BF8.15EF2%robert.guglielmetti@nrel.gov>
	<CAJhox8QJYoW1VqXs-7zF4dX7_RdSbnZkDPA5Cj2_46tZKkwnWQ@mail.gmail.com>
	<E1DD7FCE-A250-4EBE-AD0B-E16D78B9AD5B@lmi.net>
	<CAJhox8RDvLcHVMdQz=pWjZbaPaxNKjh4ZZnDrXJPH8w6OaT70w@mail.gmail.com>
Message-ID: <9F354FEC-2402-411D-84C4-62C20091739C@gmail.com>

Thanks for the update, Alex, and glad you got it going. I'd be *really* interested in hearing what this registry value is all about, because the NREL installers do not touch the registry at all?

- Rob


On Oct 18, 2012, at 5:40 PM, Alex Krickx <akrickx at integralgroup.com> wrote:

> Thanks to Greg and Rob,
> 
> Turns out it was a Windows OS issue (surprise surprise). Just to share what I learned with the list - Windows can have certain permissions issues that prevent Radiance from running correctly. We also found a weird Registry value (yikes!) that was the main culprit.
> 
> Adding a "." to my path also may have solved my problem - in any case I'm keeping it in there for good measure. Now to do some scene rendering...
> 
> Cheers,
> Alex Krickx
> 
> 
> Alex Krickx, LEED AP 
> Project Engineer
> 
> ________________________________
> 
> I N T E G R A L
> 
>                           GROUP
> 
>  
> 
> 427 13th Street, Oakland CA 94612
> 510 663 2070 x 247
> 
> akrickx at integralgroup.com
> www.integralgroup.com
> 
>  
> 
> DEEP GREEN Engineering.
> 
> _______________________________
> 
> 
> 
> 
> On Thu, Oct 18, 2012 at 10:08 AM, Greg Ward <gregoryjward at gmail.com> wrote:
> This doesn't really make sense, since rad calls system() with the same command line.  If you can cut and paste from the rad output to the command prompt and that works, then rad should work, also.  It works fine on my Unix system.  I'm stumped.
> 
> -Greg
> 
>> From: Alex Krickx <akrickx at integralgroup.com>
>> Date: October 18, 2012 9:49:04 AM PDT
>> 
>> Hi Rob,
>> 
>> Thanks for your response. The files are indeed in my current directory - I thought the path was ok because when I type in "oconv mod3.rad summer_sky.rad > summer.oct" without "./"s into the command editor I generate the octree correctly - am I mistaken? 
>> 
>> Thanks,
>> Alex
>> 
>> Alex Krickx, LEED AP 
>> Project Engineer
>> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general



From hope.zh at gmail.com  Fri Oct 19 08:02:47 2012
From: hope.zh at gmail.com (Ji Zhang)
Date: Fri, 19 Oct 2012 23:02:47 +0800
Subject: [Radiance-general] why the rtrace "-n" option doesn't reduce
	simulation time ?
Message-ID: <CAD83LVJRUQ1v+Y4euFZPp0OOMmgJipbcM31OaHovuTsj8pVUcA@mail.gmail.com>

I did the same Radiance simulation, one without specifying the "-n" option
for rtrace, the other with "-n 8" specified for rtrace. The former took 9
min to finish, whereas the latter used 13 min ...


I was quite happy to see all the 8 cores of the CPU are fully utilized in
the beginning, but I was quite upset when the results turned out to be
worse than not specifying anything ...


Why the -n option didn't reduce the simulation time but increases it ? ...


Did I miss something obvious here regarding Radiance parallel rendering ?


The two bash scripts are something like:

oconv ./Sky_m3_d21_h13.rad ./materials.mat ./Context.rad >
./Octree_files_m3_d21_h13.oct

cat ./sensor.txt | rtrace -I -h -w -oov -u- -aa 0.1 -ab 6 -ad 1024 -ar 256
-as 512 ./Octree_files_.oct > ./Results_m3_d21_h13_ir_RGB.txt


and:


oconv ./Sky_m3_d21_h13.rad ./materials.mat ./Context.rad >
./Octree_files_m3_d21_h13.oct

cat ./sensor.txt | rtrace -I -h -w -oov -u- -aa 0.1 -ab 6 -ad 1024 -ar 256
-as 512 -n 8 ./Octree_files_.oct > ./Results_m3_d21_h13_ir_RGB.txt


The test was done on a Macbook Pro, OS X 10.8.2, 2.3 GHz Intel Core i7 (8
cores), with 8GB REM.


The images showing the CPU core usage for the two simulations are put at:

http://episode-hopezh.blogspot.sg/2012/10/rtrace-parallel-rendering-myth.html


Advices are appreciated! and thanks in advance!

- Ji
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121019/009cc77d/attachment.html>

From gregoryjward at gmail.com  Fri Oct 19 08:18:16 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Fri, 19 Oct 2012 08:18:16 -0700
Subject: [Radiance-general] why the rtrace "-n" option doesn't reduce
	simulation time ?
In-Reply-To: <CAD83LVJRUQ1v+Y4euFZPp0OOMmgJipbcM31OaHovuTsj8pVUcA@mail.gmail.com>
References: <CAD83LVJRUQ1v+Y4euFZPp0OOMmgJipbcM31OaHovuTsj8pVUcA@mail.gmail.com>
Message-ID: <C6138FF4-C728-4D00-A062-5F3CAC577D6B@lmi.net>

Hi Ji,

This has been discussed before in an earlier thread -- some months ago, I guess.  You don't get a speed-up from parallel processing if you fail to set the -af option to share indirect values.  This is because you force each process to recompute the same values redundantly.  Add a -af option and see what happens.

Cheers,
-Greg

> From: Ji Zhang <hope.zh at gmail.com>
> Date: October 19, 2012 8:02:47 AM PDT
> 
> I did the same Radiance simulation, one without specifying the "-n" option for rtrace, the other with "-n 8" specified for rtrace. The former took 9 min to finish, whereas the latter used 13 min ...
> 
> 
> 
> I was quite happy to see all the 8 cores of the CPU are fully utilized in the beginning, but I was quite upset when the results turned out to be worse than not specifying anything ... 
> 
> 
> 
> Why the -n option didn't reduce the simulation time but increases it ? ...
> 
> 
> 
> Did I miss something obvious here regarding Radiance parallel rendering ? 
> 
> 
> The two bash scripts are something like:
> 
> oconv ./Sky_m3_d21_h13.rad ./materials.mat ./Context.rad > ./Octree_files_m3_d21_h13.oct
> 
> cat ./sensor.txt | rtrace -I -h -w -oov -u- -aa 0.1 -ab 6 -ad 1024 -ar 256 -as 512 ./Octree_files_.oct > ./Results_m3_d21_h13_ir_RGB.txt
> 
> 
> 
> and:
> 
> 
> 
> oconv ./Sky_m3_d21_h13.rad ./materials.mat ./Context.rad > ./Octree_files_m3_d21_h13.oct
> 
> cat ./sensor.txt | rtrace -I -h -w -oov -u- -aa 0.1 -ab 6 -ad 1024 -ar 256 -as 512 -n 8 ./Octree_files_.oct > ./Results_m3_d21_h13_ir_RGB.txt
> 
> 
> 
> The test was done on a Macbook Pro, OS X 10.8.2, 2.3 GHz Intel Core i7 (8 cores), with 8GB REM.
> 
> 
> 
> The images showing the CPU core usage for the two simulations are put at:
> 
> http://episode-hopezh.blogspot.sg/2012/10/rtrace-parallel-rendering-myth.html
> 
> 
> 
> Advices are appreciated! and thanks in advance!
> - Ji


From hope.zh at gmail.com  Fri Oct 19 08:49:16 2012
From: hope.zh at gmail.com (Ji Zhang)
Date: Fri, 19 Oct 2012 23:49:16 +0800
Subject: [Radiance-general] why the rtrace "-n" option doesn't reduce
	simulation time ?
In-Reply-To: <C6138FF4-C728-4D00-A062-5F3CAC577D6B@lmi.net>
References: <CAD83LVJRUQ1v+Y4euFZPp0OOMmgJipbcM31OaHovuTsj8pVUcA@mail.gmail.com>
	<C6138FF4-C728-4D00-A062-5F3CAC577D6B@lmi.net>
Message-ID: <CAD83LVKPTcpatGty8UcX4N=dZNwZGpLE3u8kb75Cvk0eig9siw@mail.gmail.com>

Thank you very much, Greg!

Following your advice, the simulation time is reduced from 9 min to just 3
min !

The bash script is:
cat ./sensor.txt | rtrace -I -h -w -oov -u- -aa 0.1 -ab 6 -ad 1024 -ar 256
-as 512 -af ./ambient_file.amb -n 8 ./Octree_files_.oct > ./Results.txt
(I'm very eager to test it on our HPC later ! )

I think this can be one of the FAQs of Radiance.

Thank you again! And have a nice weekend!

-Ji


On Friday, October 19, 2012, Greg Ward wrote:

> Hi Ji,
>
> This has been discussed before in an earlier thread -- some months ago, I
> guess.  You don't get a speed-up from parallel processing if you fail to
> set the -af option to share indirect values.  This is because you force
> each process to recompute the same values redundantly.  Add a -af option
> and see what happens.
>
> Cheers,
> -Greg
>
> > From: Ji Zhang <hope.zh at gmail.com <javascript:;>>
> > Date: October 19, 2012 8:02:47 AM PDT
> >
> > I did the same Radiance simulation, one without specifying the "-n"
> option for rtrace, the other with "-n 8" specified for rtrace. The former
> took 9 min to finish, whereas the latter used 13 min ...
> >
> >
> >
> > I was quite happy to see all the 8 cores of the CPU are fully utilized
> in the beginning, but I was quite upset when the results turned out to be
> worse than not specifying anything ...
> >
> >
> >
> > Why the -n option didn't reduce the simulation time but increases it ?
> ...
> >
> >
> >
> > Did I miss something obvious here regarding Radiance parallel rendering ?
> >
> >
> > The two bash scripts are something like:
> >
> > oconv ./Sky_m3_d21_h13.rad ./materials.mat ./Context.rad >
> ./Octree_files_m3_d21_h13.oct
> >
> > cat ./sensor.txt | rtrace -I -h -w -oov -u- -aa 0.1 -ab 6 -ad 1024 -ar
> 256 -as 512 ./Octree_files_.oct > ./Results_m3_d21_h13_ir_RGB.txt
> >
> >
> >
> > and:
> >
> >
> >
> > oconv ./Sky_m3_d21_h13.rad ./materials.mat ./Context.rad >
> ./Octree_files_m3_d21_h13.oct
> >
> > cat ./sensor.txt | rtrace -I -h -w -oov -u- -aa 0.1 -ab 6 -ad 1024 -ar
> 256 -as 512 -n 8 ./Octree_files_.oct > ./Results_m3_d21_h13_ir_RGB.txt
> >
> >
> >
> > The test was done on a Macbook Pro, OS X 10.8.2, 2.3 GHz Intel Core i7
> (8 cores), with 8GB REM.
> >
> >
> >
> > The images showing the CPU core usage for the two simulations are put at:
> >
> >
> http://episode-hopezh.blogspot.sg/2012/10/rtrace-parallel-rendering-myth.html
> >
> >
> >
> > Advices are appreciated! and thanks in advance!
> > - Ji
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org <javascript:;>
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121019/fb27fac6/attachment-0001.html>

From patrick at janssen.name  Sat Oct 20 00:45:07 2012
From: patrick at janssen.name (Patrick Janssen)
Date: Sat, 20 Oct 2012 15:45:07 +0800
Subject: [Radiance-general] sky visibility
Message-ID: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>

Hi all,

I have an urban model with many windows, and I would like to calculate %
visible sky for each window. I define a point at the centre of the window
with a viewing direction normal to the window, and I would like to
calculate how much (i.e. what %) of the sky dome is visible from that
point, assuming a 180 degree cone of vision.  Note that I do not want to
apply the cosine-law, and I want to treat each part of the sky dome
equally. For a vertical window, the maximum value should be 50%, which
would mean that there are no obstructions.

What is the best (i.e. fastest) way of calculating this?

I tried rtrace (1 bounce, uniform sky)  but that applies the cosine law. I
have been looking at rsensor, but if I have lots of windows, it seems  I
would have to run rsensor lots of times, which would be rather slow. Any
suggestions?

Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/5f44c2d1/attachment.html>

From grobe at gmx.net  Sat Oct 20 01:05:03 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Sat, 20 Oct 2012 10:05:03 +0200
Subject: [Radiance-general] sky visibility
In-Reply-To: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
Message-ID: <50825B2F.7040505@gmx.net>

Hi Patrick,

Did you consider genklemsamp?

If you just want to not apply the cosine but get either 1 or 0 for rays 
hitting the sky or not, pipe the output from rtrace to rcalc. E.g. sum 
the rays that are above the treshold (0.00001 here) and total number of 
rays traced, and then get the fraction of rays over the treshold using 
rtrace again:

<your rtrace command> | rcalc -e ?$1=if($1-.00001,1,0); $2=1? | total | 
rcalc -e ?$1=$1/$2?

That could be done using binary floats instead of ascii to make it a bit 
more efficient using proper -if3, -of options for all commands. The same 
can be done on e.g. fisheye images using pcomb.

A general hint, you can also get the surface identifier (-os) at the 
first ray intersection instead of e.g. the radiance value from rtrace 
and pass that through grep.

Cheers, Lars.


From hope.zh at gmail.com  Sat Oct 20 02:56:17 2012
From: hope.zh at gmail.com (Ji Zhang)
Date: Sat, 20 Oct 2012 17:56:17 +0800
Subject: [Radiance-general] sky visibility
In-Reply-To: <50825B2F.7040505@gmx.net>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
Message-ID: <CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>

Hi, Lars,

I agree with your suggestion: calculating the number of rays shooting out
from a sensor that can reach the sky directly, and divide the value
obtained by the total number of rays shot. This will give us the percentage
of visible sky or sky exposure for a given sensor.

However, if I understand correctly, the output of rtrace is a file, within
which each row indicating the xyz coordinates and rgb irradiance of a given
sensor.

Is the output of rtrace which is supposed to be piped to rcalc as shown in
your script has only one column of data and each row is the irradiance
value of one of the sensors?

So, the script might be something like:

cat sensors.txt | rtrace -I  -aa XXX  -ab XXX -ad XXX -h -w scene.oct |
rcalc -e '$1=if($1-.00001,1,0); $2=1' | total | rcalc -e '$1=$1/$2' >
results.txt

If that's the case, you're calculating the percentage of sensors that can
see the sky (regardless of the size of sky visible to each sensor), am I
correct?

... or I miss something critical here ...

- Ji



On Sat, Oct 20, 2012 at 4:05 PM, Lars O. Grobe <grobe at gmx.net> wrote:

> Hi Patrick,
>
> Did you consider genklemsamp?
>
> If you just want to not apply the cosine but get either 1 or 0 for rays
> hitting the sky or not, pipe the output from rtrace to rcalc. E.g. sum the
> rays that are above the treshold (0.00001 here) and total number of rays
> traced, and then get the fraction of rays over the treshold using rtrace
> again:
>
> <your rtrace command> | rcalc -e ?$1=if($1-.00001,1,0); $2=1? | total |
> rcalc -e ?$1=$1/$2?
>
> That could be done using binary floats instead of ascii to make it a bit
> more efficient using proper -if3, -of options for all commands. The same
> can be done on e.g. fisheye images using pcomb.
>
> A general hint, you can also get the surface identifier (-os) at the first
> ray intersection instead of e.g. the radiance value from rtrace and pass
> that through grep.
>
> Cheers, Lars.
>
> ______________________________**_________________
> Radiance-general mailing list
> Radiance-general at radiance-**online.org<Radiance-general at radiance-online.org>
> http://www.radiance-online.**org/mailman/listinfo/radiance-**general<http://www.radiance-online.org/mailman/listinfo/radiance-general>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/784fbe81/attachment.html>

From antonutto at yahoo.it  Sat Oct 20 03:09:29 2012
From: antonutto at yahoo.it (giulio antonutto)
Date: Sat, 20 Oct 2012 11:09:29 +0100
Subject: [Radiance-general] sky visibility
In-Reply-To: <CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
Message-ID: <6E464133-FEB5-4DE2-BE5A-CFC47DCE0EEA@yahoo.it>

what about vwrays and an angular view?
then -av 1 1 1, no sky and total - positive = sky
g

On 20 Oct 2012, at 10:56, Ji Zhang <hope.zh at gmail.com> wrote:

> Hi, Lars,
> 
> I agree with your suggestion: calculating the number of rays shooting out from a sensor that can reach the sky directly, and divide the value obtained by the total number of rays shot. This will give us the percentage of visible sky or sky exposure for a given sensor. 
> 
> However, if I understand correctly, the output of rtrace is a file, within which each row indicating the xyz coordinates and rgb irradiance of a given sensor.
> 
> Is the output of rtrace which is supposed to be piped to rcalc as shown in your script has only one column of data and each row is the irradiance value of one of the sensors? 
> 
> So, the script might be something like:
> 
> cat sensors.txt | rtrace -I  -aa XXX  -ab XXX -ad XXX -h -w scene.oct | rcalc -e '$1=if($1-.00001,1,0); $2=1' | total | rcalc -e '$1=$1/$2' > results.txt
> 
> If that's the case, you're calculating the percentage of sensors that can see the sky (regardless of the size of sky visible to each sensor), am I correct? 
> 
> ... or I miss something critical here ... 
> 
> - Ji
> 
> 
> 
> On Sat, Oct 20, 2012 at 4:05 PM, Lars O. Grobe <grobe at gmx.net> wrote:
> Hi Patrick,
> 
> Did you consider genklemsamp?
> 
> If you just want to not apply the cosine but get either 1 or 0 for rays hitting the sky or not, pipe the output from rtrace to rcalc. E.g. sum the rays that are above the treshold (0.00001 here) and total number of rays traced, and then get the fraction of rays over the treshold using rtrace again:
> 
> <your rtrace command> | rcalc -e ?$1=if($1-.00001,1,0); $2=1? | total | rcalc -e ?$1=$1/$2?
> 
> That could be done using binary floats instead of ascii to make it a bit more efficient using proper -if3, -of options for all commands. The same can be done on e.g. fisheye images using pcomb.
> 
> A general hint, you can also get the surface identifier (-os) at the first ray intersection instead of e.g. the radiance value from rtrace and pass that through grep.
> 
> Cheers, Lars.
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/8f27d790/attachment.html>

From hujia06 at gmail.com  Sat Oct 20 05:11:57 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Sat, 20 Oct 2012 08:11:57 -0400
Subject: [Radiance-general] possible inconsistency of bin numbers between
	BSDF and kelms_int.cal
Message-ID: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>

Hi all:

I have a question about the bin number.

To calculate view matrix:  (south-facing window)
$ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b kbinS -bn Nkbins -m
window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx

kbinS uses the (0, 1, 0) as normal (pointing to inside room).

For a ray direction (-1, -1, 0), using klems_int.cal to calculate the bin
number, the bin number is about #57 (I did it manually).

Klems_int.cal (download
Klems_init.cal<https://dl.dropbox.com/u/15562376/klems_int.cal>)
seems use "z" hemisphere (see this figure:
https://dl.dropbox.com/u/15562376/coordinate.jpg). From the figure, we can
see "z" hemisphere points to the room (that is, the hemisphere is located
in the room) "zr" (z reverse) hemisphere is towards outside (the hemisphere
is outside the room).

The possible inconsistency is:

(1) Klems_int.cal uses "z" hemisphere to calculate the bin number, for
example,  for ray direction (-1, -1, 0), the bin number is #57 for "z"
hemisphere coordinate. (see this figure:
https://dl.dropbox.com/u/15562376/bin.jpg)

(2) The "Transmission Back" data in the BSDF .XML is used in the three
phase DC method (see Greg's
explanation<http://permalink.gmane.org/gmane.comp.graphics.radiance.general/2729>),
and thus the calculation is based on "zr" (z reverse) hemisphere , for ray
direction (-1, -1, 0), the bin number is about #69 according to the "z
reverse" hemisphere coordinate (see this figure:
https://dl.dropbox.com/u/15562376/bin.jpg).

So my questions are:

(a) Given the ray direction, which hemisphere ( "z" or "zr" ) does
 "Klems_init.cal" use?

(b) whether the bin numbers (for the same ray direction) between
"Klems_int.cal" and BSDF .xml  are inconsistent or not?

(c) if they are using different bin numbers, how to handle ViewMatrix *
BSDF in the calculation?

Thank you in advance,

Jia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/8a2a339b/attachment-0001.html>

From hope.zh at gmail.com  Sat Oct 20 05:46:53 2012
From: hope.zh at gmail.com (Ji Zhang)
Date: Sat, 20 Oct 2012 20:46:53 +0800
Subject: [Radiance-general] sky visibility
In-Reply-To: <6E464133-FEB5-4DE2-BE5A-CFC47DCE0EEA@yahoo.it>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<6E464133-FEB5-4DE2-BE5A-CFC47DCE0EEA@yahoo.it>
Message-ID: <CAD83LVK-HatL0q68J4fvgd3hpXH2_wh0OmxOHzUA4j_0_xLRxA@mail.gmail.com>

Dear Giulio, appreciate if you can kindly elaborate more on your
suggestions !

- Ji


On Sat, Oct 20, 2012 at 6:09 PM, giulio antonutto <antonutto at yahoo.it>wrote:

> what about vwrays and an angular view?
> then -av 1 1 1, no sky and total - positive = sky
> g
>
> On 20 Oct 2012, at 10:56, Ji Zhang <hope.zh at gmail.com> wrote:
>
> Hi, Lars,
>
> I agree with your suggestion: calculating the number of rays shooting out
> from a sensor that can reach the sky directly, and divide the value
> obtained by the total number of rays shot. This will give us the percentage
> of visible sky or sky exposure for a given sensor.
>
> However, if I understand correctly, the output of rtrace is a file, within
> which each row indicating the xyz coordinates and rgb irradiance of a given
> sensor.
>
> Is the output of rtrace which is supposed to be piped to rcalc as shown in
> your script has only one column of data and each row is the irradiance
> value of one of the sensors?
>
> So, the script might be something like:
>
> cat sensors.txt | rtrace -I  -aa XXX  -ab XXX -ad XXX -h -w scene.oct |
> rcalc -e '$1=if($1-.00001,1,0); $2=1' | total | rcalc -e '$1=$1/$2' >
> results.txt
>
> If that's the case, you're calculating the percentage of sensors that can
> see the sky (regardless of the size of sky visible to each sensor), am I
> correct?
>
> ... or I miss something critical here ...
>
> - Ji
>
>
>
> On Sat, Oct 20, 2012 at 4:05 PM, Lars O. Grobe <grobe at gmx.net> wrote:
>
>> Hi Patrick,
>>
>> Did you consider genklemsamp?
>>
>> If you just want to not apply the cosine but get either 1 or 0 for rays
>> hitting the sky or not, pipe the output from rtrace to rcalc. E.g. sum the
>> rays that are above the treshold (0.00001 here) and total number of rays
>> traced, and then get the fraction of rays over the treshold using rtrace
>> again:
>>
>> <your rtrace command> | rcalc -e ?$1=if($1-.00001,1,0); $2=1? | total |
>> rcalc -e ?$1=$1/$2?
>>
>> That could be done using binary floats instead of ascii to make it a bit
>> more efficient using proper -if3, -of options for all commands. The same
>> can be done on e.g. fisheye images using pcomb.
>>
>> A general hint, you can also get the surface identifier (-os) at the
>> first ray intersection instead of e.g. the radiance value from rtrace and
>> pass that through grep.
>>
>> Cheers, Lars.
>>
>> ______________________________**_________________
>> Radiance-general mailing list
>> Radiance-general at radiance-**online.org<Radiance-general at radiance-online.org>
>> http://www.radiance-online.**org/mailman/listinfo/radiance-**general<http://www.radiance-online.org/mailman/listinfo/radiance-general>
>>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/55affd63/attachment.html>

From hujia06 at gmail.com  Sat Oct 20 10:25:49 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Sat, 20 Oct 2012 13:25:49 -0400
Subject: [Radiance-general] sky visibility
In-Reply-To: <CAD83LVK-HatL0q68J4fvgd3hpXH2_wh0OmxOHzUA4j_0_xLRxA@mail.gmail.com>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<6E464133-FEB5-4DE2-BE5A-CFC47DCE0EEA@yahoo.it>
	<CAD83LVK-HatL0q68J4fvgd3hpXH2_wh0OmxOHzUA4j_0_xLRxA@mail.gmail.com>
Message-ID: <CABzgtwpdPQXPBjbvn9hMrGhHKpxLwT-T+o_vCPocBCvXoS=M8w@mail.gmail.com>

Hi Ji:

What Lars might want to say is to pipe the following output into
rtrace: genklemsample -vd 0 -1 0 window.rad, where vd is the normal of
window.

Best,
Jia



On Sat, Oct 20, 2012 at 8:46 AM, Ji Zhang <hope.zh at gmail.com> wrote:

> Dear Giulio, appreciate if you can kindly elaborate more on your
> suggestions !
>
> - Ji
>
>
>
> On Sat, Oct 20, 2012 at 6:09 PM, giulio antonutto <antonutto at yahoo.it>wrote:
>
>> what about vwrays and an angular view?
>> then -av 1 1 1, no sky and total - positive = sky
>> g
>>
>> On 20 Oct 2012, at 10:56, Ji Zhang <hope.zh at gmail.com> wrote:
>>
>> Hi, Lars,
>>
>> I agree with your suggestion: calculating the number of rays shooting out
>> from a sensor that can reach the sky directly, and divide the value
>> obtained by the total number of rays shot. This will give us the percentage
>> of visible sky or sky exposure for a given sensor.
>>
>> However, if I understand correctly, the output of rtrace is a file,
>> within which each row indicating the xyz coordinates and rgb irradiance of
>> a given sensor.
>>
>> Is the output of rtrace which is supposed to be piped to rcalc as shown
>> in your script has only one column of data and each row is the irradiance
>> value of one of the sensors?
>>
>> So, the script might be something like:
>>
>> cat sensors.txt | rtrace -I  -aa XXX  -ab XXX -ad XXX -h -w scene.oct |
>> rcalc -e '$1=if($1-.00001,1,0); $2=1' | total | rcalc -e '$1=$1/$2' >
>> results.txt
>>
>> If that's the case, you're calculating the percentage of sensors that can
>> see the sky (regardless of the size of sky visible to each sensor), am I
>> correct?
>>
>> ... or I miss something critical here ...
>>
>> - Ji
>>
>>
>>
>> On Sat, Oct 20, 2012 at 4:05 PM, Lars O. Grobe <grobe at gmx.net> wrote:
>>
>>> Hi Patrick,
>>>
>>> Did you consider genklemsamp?
>>>
>>> If you just want to not apply the cosine but get either 1 or 0 for rays
>>> hitting the sky or not, pipe the output from rtrace to rcalc. E.g. sum the
>>> rays that are above the treshold (0.00001 here) and total number of rays
>>> traced, and then get the fraction of rays over the treshold using rtrace
>>> again:
>>>
>>> <your rtrace command> | rcalc -e ?$1=if($1-.00001,1,0); $2=1? | total |
>>> rcalc -e ?$1=$1/$2?
>>>
>>> That could be done using binary floats instead of ascii to make it a bit
>>> more efficient using proper -if3, -of options for all commands. The same
>>> can be done on e.g. fisheye images using pcomb.
>>>
>>> A general hint, you can also get the surface identifier (-os) at the
>>> first ray intersection instead of e.g. the radiance value from rtrace and
>>> pass that through grep.
>>>
>>> Cheers, Lars.
>>>
>>> ______________________________**_________________
>>> Radiance-general mailing list
>>> Radiance-general at radiance-**online.org<Radiance-general at radiance-online.org>
>>> http://www.radiance-online.**org/mailman/listinfo/radiance-**general<http://www.radiance-online.org/mailman/listinfo/radiance-general>
>>>
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/7e83f643/attachment.html>

From hujia06 at gmail.com  Sat Oct 20 13:01:27 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Sat, 20 Oct 2012 16:01:27 -0400
Subject: [Radiance-general] possible inconsistency of bin numbers
	between BSDF and kelms_int.cal
In-Reply-To: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
Message-ID: <CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>

Hi all:

In the Klems_init.cal file, for south window (using kbinS), the Klems
coordinate is defined as:

z+: pointing to inside (that is, (0,1, 0)  )
x+: pointing to West ( that is (-1, 0, 0) )
y+: pointing to Up (0,0,1)

This coordinate is consistent with the Klems coordinate system used in
WINDOW 6 (see this: https://dl.dropbox.com/u/15562376/coordinate.jpg). In
the figure, Klems coordinate system defines: x or xr points to (-1, 0, 0)
and  y or yr points to (0, 0, 1).

However, if using this command to calculate view matrix:

$ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b *kbinS* -bn Nkbins -m
window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx

where, kbinS defines z axis in the Klems coordinate system as (0 1 0), that
is, pointing to room interior.

Thus, the bin number calculated by Klems_init.cal is actually based on z
hemisphere <https://dl.dropbox.com/u/15562376/coordinate.jpg> (the
hemisphere protrudes towards room). the bin number corresponds with
"Transmittance Front" in BSDF xml file. For example, ray direction (-1, -1,
0) (backward, ray travels from inside to outside room) hits the bin
58<https://dl.dropbox.com/u/15562376/bin.jpg>
defined in z hemisphere because the hemisphere protrudes towards (0 1 0).
 But ray direction (-1 -1 0) hits bin
46<https://dl.dropbox.com/u/15562376/bin.jpg> defined in
z reverse (i.e., zr) coordinate because the hemisphere protrudes towards (0
-1 0) (towards outside).

When calculating Daylighting Matrix, it still uses Klems_init.cal and
kbinS, that is, z hemisphere coordinate system, therefore, Radiance seems
needing to use "Transmission Front", which is defined in z hemisphere.  But
currently Radiance uses "Transmission Back" (from inside to outside), which
defined in zr hemisphere,

So, should we need to

 (a) use "*kbinN*" (defining z axis of Klems coordinate towards (0 -1 0) )
 and "Transmission Back" for south window,  or
 (b) use "Transmission Front" and *kbinS*?

 I am very confused about this. Does anyone know the possible reasons?

Thank you !

Jia


On Sat, Oct 20, 2012 at 8:11 AM, Jia Hu <hujia06 at gmail.com> wrote:

> Hi all:
>
> I have a question about the bin number.
>
> To calculate view matrix:  (south-facing window)
> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b kbinS -bn Nkbins -m
> window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>
> kbinS uses the (0, 1, 0) as normal (pointing to inside room).
>
> For a ray direction (-1, -1, 0), using klems_int.cal to calculate the bin
> number, the bin number is about #57 (I did it manually).
>
> Klems_int.cal (download Klems_init.cal<https://dl.dropbox.com/u/15562376/klems_int.cal>)
> seems use "z" hemisphere (see this figure:
> https://dl.dropbox.com/u/15562376/coordinate.jpg). From the figure, we
> can see "z" hemisphere points to the room (that is, the hemisphere is
> located in the room) "zr" (z reverse) hemisphere is towards outside (the
> hemisphere is outside the room).
>
> The possible inconsistency is:
>
> (1) Klems_int.cal uses "z" hemisphere to calculate the bin number, for
> example,  for ray direction (-1, -1, 0), the bin number is #57 for "z"
> hemisphere coordinate. (see this figure:
> https://dl.dropbox.com/u/15562376/bin.jpg)
>
> (2) The "Transmission Back" data in the BSDF .XML is used in the three
> phase DC method (see Greg's explanation<http://permalink.gmane.org/gmane.comp.graphics.radiance.general/2729>),
> and thus the calculation is based on "zr" (z reverse) hemisphere , for ray
> direction (-1, -1, 0), the bin number is about #69 according to the "z
> reverse" hemisphere coordinate (see this figure:
> https://dl.dropbox.com/u/15562376/bin.jpg).
>
> So my questions are:
>
> (a) Given the ray direction, which hemisphere ( "z" or "zr" ) does
>  "Klems_init.cal" use?
>
> (b) whether the bin numbers (for the same ray direction) between
> "Klems_int.cal" and BSDF .xml  are inconsistent or not?
>
> (c) if they are using different bin numbers, how to handle ViewMatrix *
> BSDF in the calculation?
>
> Thank you in advance,
>
> Jia
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/f8332024/attachment.html>

From antonutto at yahoo.it  Sat Oct 20 15:09:18 2012
From: antonutto at yahoo.it (giulio antonutto)
Date: Sat, 20 Oct 2012 23:09:18 +0100
Subject: [Radiance-general] sky visibility
In-Reply-To: <CAD83LVK-HatL0q68J4fvgd3hpXH2_wh0OmxOHzUA4j_0_xLRxA@mail.gmail.com>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<6E464133-FEB5-4DE2-BE5A-CFC47DCE0EEA@yahoo.it>
	<CAD83LVK-HatL0q68J4fvgd3hpXH2_wh0OmxOHzUA4j_0_xLRxA@mail.gmail.com>
Message-ID: <68346A97-8605-4D39-9CFA-F0C3797FAE5B@yahoo.it>

ok,
setup a view out of the window, with -a.
save the view file.
use vwrays to generate the vectors and starting point to sample the sky
shoot with rtrace
use -av 1 1 1 so that you do not need to have a sky but all glows.
then pipe the rtrace to rcalc and use if($1,1,0)  then total.
the overall number of hits that are recorded is the number of intersection to the model
you need then to check the overall resolution of your image and account for the fact that you should be considering the inner 180 deg. circle.
Sorry have no time to write up this for you, 
but to be fair there is already (and below too) a lot that you could try.
If you have no time to experiment or are simply looking for the easy copy/paste solution amen.
I meant differently.
in any case, all the best
G



On 20 Oct 2012, at 13:46, Ji Zhang <hope.zh at gmail.com> wrote:

> Dear Giulio, appreciate if you can kindly elaborate more on your suggestions ! 
> 
> - Ji
> 
> 
> On Sat, Oct 20, 2012 at 6:09 PM, giulio antonutto <antonutto at yahoo.it> wrote:
> what about vwrays and an angular view?
> then -av 1 1 1, no sky and total - positive = sky
> g
> 
> On 20 Oct 2012, at 10:56, Ji Zhang <hope.zh at gmail.com> wrote:
> 
>> Hi, Lars,
>> 
>> I agree with your suggestion: calculating the number of rays shooting out from a sensor that can reach the sky directly, and divide the value obtained by the total number of rays shot. This will give us the percentage of visible sky or sky exposure for a given sensor. 
>> 
>> However, if I understand correctly, the output of rtrace is a file, within which each row indicating the xyz coordinates and rgb irradiance of a given sensor.
>> 
>> Is the output of rtrace which is supposed to be piped to rcalc as shown in your script has only one column of data and each row is the irradiance value of one of the sensors? 
>> 
>> So, the script might be something like:
>> 
>> cat sensors.txt | rtrace -I  -aa XXX  -ab XXX -ad XXX -h -w scene.oct | rcalc -e '$1=if($1-.00001,1,0); $2=1' | total | rcalc -e '$1=$1/$2' > results.txt
>> 
>> If that's the case, you're calculating the percentage of sensors that can see the sky (regardless of the size of sky visible to each sensor), am I correct? 
>> 
>> ... or I miss something critical here ... 
>> 
>> - Ji
>> 
>> 
>> 
>> On Sat, Oct 20, 2012 at 4:05 PM, Lars O. Grobe <grobe at gmx.net> wrote:
>> Hi Patrick,
>> 
>> Did you consider genklemsamp?
>> 
>> If you just want to not apply the cosine but get either 1 or 0 for rays hitting the sky or not, pipe the output from rtrace to rcalc. E.g. sum the rays that are above the treshold (0.00001 here) and total number of rays traced, and then get the fraction of rays over the treshold using rtrace again:
>> 
>> <your rtrace command> | rcalc -e ?$1=if($1-.00001,1,0); $2=1? | total | rcalc -e ?$1=$1/$2?
>> 
>> That could be done using binary floats instead of ascii to make it a bit more efficient using proper -if3, -of options for all commands. The same can be done on e.g. fisheye images using pcomb.
>> 
>> A general hint, you can also get the surface identifier (-os) at the first ray intersection instead of e.g. the radiance value from rtrace and pass that through grep.
>> 
>> Cheers, Lars.
>> 
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>> 
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/b8f40fd0/attachment.html>

From hujia06 at gmail.com  Sat Oct 20 17:38:24 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Sat, 20 Oct 2012 20:38:24 -0400
Subject: [Radiance-general] possible inconsistency of bin numbers
	between BSDF and kelms_int.cal
In-Reply-To: <CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
	<CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>
Message-ID: <CABzgtwp0nzUTB0zdaW96WdGwOhcy3Ay-+5z572UAbV_T+gBX4g@mail.gmail.com>

Sorry to keep bothering you...  Just add some additional information. I
search "transmission back" and "transmission front" in the code and find
"Transmission Front" is more likely used according to the code.  The
following two code snippets from bsdf_m.c and bsdf.c shows "Transmission
Front" data will be loaded or preferred ?

Another issue,  I remember Greg mention that even if only "Transmission
Front" is present, the BSDF library in Radiance can still computer
Transmission matrix. But my simple test case (download
here<https://dl.dropbox.com/u/15562376/test_10_21.zip>)
did not show that.  If you change "Transmission Back" in the .xml file to
"Transmission Front". The results will be zero.


*//  ray/src/common/bsdf_m.c*
/*
 * Remember that front and back are reversed from WINDOW 6 orientations
 * *Favor their "Front" (incoming light) since that's more often valid*
 */
 tfront = !strcasecmp(sdata, "Transmission Back");
if (!strcasecmp(sdata, "Transmission Front") ||
 tfront & (sd->tf == NULL)) {
if (sd->tf != NULL)
SDfreeSpectralDF(sd->tf);
 if ((sd->tf = SDnewSpectralDF(1)) == NULL)
return RC_MEMERR;
df = sd->tf;

*// ray/src/common/bsdf.c*

for (wld = ezxml_child(wtl, "WavelengthData");
wld != NULL; wld = wld->next) {
 if (strcasecmp(ezxml_txt(ezxml_child(wld,"Wavelength")),
"Visible"))
 continue;
for (wdb = ezxml_child(wld, "WavelengthDataBlock");
 wdb != NULL; wdb = wdb->next)
if (!strcasecmp(ezxml_txt(ezxml_child(wdb,
 "WavelengthDataDirection")),
*"Transmission Front"))*
 break;
if (wdb != NULL) { */* load front BTDF */*
 load_bsdf_data(dp, wdb);
break; /* ignore the rest */
 }
}

Thanks,

Jia

On Sat, Oct 20, 2012 at 4:01 PM, Jia Hu <hujia06 at gmail.com> wrote:

> Hi all:
>
> In the Klems_init.cal file, for south window (using kbinS), the Klems
> coordinate is defined as:
>
> z+: pointing to inside (that is, (0,1, 0)  )
> x+: pointing to West ( that is (-1, 0, 0) )
> y+: pointing to Up (0,0,1)
>
> This coordinate is consistent with the Klems coordinate system used in
> WINDOW 6 (see this: https://dl.dropbox.com/u/15562376/coordinate.jpg). In
> the figure, Klems coordinate system defines: x or xr points to (-1, 0, 0)
> and  y or yr points to (0, 0, 1).
>
> However, if using this command to calculate view matrix:
>
> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b *kbinS* -bn Nkbins
> -m window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>
> where, kbinS defines z axis in the Klems coordinate system as (0 1 0),
> that is, pointing to room interior.
>
> Thus, the bin number calculated by Klems_init.cal is actually based on z
> hemisphere <https://dl.dropbox.com/u/15562376/coordinate.jpg> (the
> hemisphere protrudes towards room). the bin number corresponds with
> "Transmittance Front" in BSDF xml file. For example, ray direction (-1, -1,
> 0) (backward, ray travels from inside to outside room) hits the bin 58<https://dl.dropbox.com/u/15562376/bin.jpg>
> defined in z hemisphere because the hemisphere protrudes towards (0 1 0).
>  But ray direction (-1 -1 0) hits bin 46<https://dl.dropbox.com/u/15562376/bin.jpg> defined in
> z reverse (i.e., zr) coordinate because the hemisphere protrudes towards (0
> -1 0) (towards outside).
>
> When calculating Daylighting Matrix, it still uses Klems_init.cal and
> kbinS, that is, z hemisphere coordinate system, therefore, Radiance seems
> needing to use "Transmission Front", which is defined in z hemisphere.  But
> currently Radiance uses "Transmission Back" (from inside to outside), which
> defined in zr hemisphere,
>
> So, should we need to
>
>  (a) use "*kbinN*" (defining z axis of Klems coordinate towards (0 -1 0)
> )  and "Transmission Back" for south window,  or
>   (b) use "Transmission Front" and *kbinS*?
>
>  I am very confused about this. Does anyone know the possible reasons?
>
> Thank you !
>
> Jia
>
>
> On Sat, Oct 20, 2012 at 8:11 AM, Jia Hu <hujia06 at gmail.com> wrote:
>
>> Hi all:
>>
>> I have a question about the bin number.
>>
>> To calculate view matrix:  (south-facing window)
>> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b kbinS -bn Nkbins -m
>> window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>>
>> kbinS uses the (0, 1, 0) as normal (pointing to inside room).
>>
>> For a ray direction (-1, -1, 0), using klems_int.cal to calculate the bin
>> number, the bin number is about #57 (I did it manually).
>>
>> Klems_int.cal (download Klems_init.cal<https://dl.dropbox.com/u/15562376/klems_int.cal>)
>> seems use "z" hemisphere (see this figure:
>> https://dl.dropbox.com/u/15562376/coordinate.jpg). From the figure, we
>> can see "z" hemisphere points to the room (that is, the hemisphere is
>> located in the room) "zr" (z reverse) hemisphere is towards outside (the
>> hemisphere is outside the room).
>>
>> The possible inconsistency is:
>>
>> (1) Klems_int.cal uses "z" hemisphere to calculate the bin number, for
>> example,  for ray direction (-1, -1, 0), the bin number is #57 for "z"
>> hemisphere coordinate. (see this figure:
>> https://dl.dropbox.com/u/15562376/bin.jpg)
>>
>> (2) The "Transmission Back" data in the BSDF .XML is used in the three
>> phase DC method (see Greg's explanation<http://permalink.gmane.org/gmane.comp.graphics.radiance.general/2729>),
>> and thus the calculation is based on "zr" (z reverse) hemisphere , for ray
>> direction (-1, -1, 0), the bin number is about #69 according to the "z
>> reverse" hemisphere coordinate (see this figure:
>> https://dl.dropbox.com/u/15562376/bin.jpg).
>>
>> So my questions are:
>>
>> (a) Given the ray direction, which hemisphere ( "z" or "zr" ) does
>>  "Klems_init.cal" use?
>>
>> (b) whether the bin numbers (for the same ray direction) between
>> "Klems_int.cal" and BSDF .xml  are inconsistent or not?
>>
>> (c) if they are using different bin numbers, how to handle ViewMatrix *
>> BSDF in the calculation?
>>
>> Thank you in advance,
>>
>> Jia
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121020/e0764fb7/attachment-0001.html>

From hope.zh at gmail.com  Sat Oct 20 20:37:59 2012
From: hope.zh at gmail.com (Ji Zhang)
Date: Sun, 21 Oct 2012 11:37:59 +0800
Subject: [Radiance-general] sky visibility
In-Reply-To: <68346A97-8605-4D39-9CFA-F0C3797FAE5B@yahoo.it>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<6E464133-FEB5-4DE2-BE5A-CFC47DCE0EEA@yahoo.it>
	<CAD83LVK-HatL0q68J4fvgd3hpXH2_wh0OmxOHzUA4j_0_xLRxA@mail.gmail.com>
	<68346A97-8605-4D39-9CFA-F0C3797FAE5B@yahoo.it>
Message-ID: <CAD83LVLonuQmAECbfwFLfx8+5VgbXL0Wu_szLSFrOxqSjTMLEQ@mail.gmail.com>

Thank you very much, Giulio! will digest ur suggestions and give it a try
on the combined use of vwray + rtrace + rcalc.
- Cheers, Ji.

On Sun, Oct 21, 2012 at 6:09 AM, giulio antonutto <antonutto at yahoo.it>wrote:

> ok,
> setup a view out of the window, with -a.
> save the view file.
> use vwrays to generate the vectors and starting point to sample the sky
> shoot with rtrace
> use -av 1 1 1 so that you do not need to have a sky but all glows.
> then pipe the rtrace to rcalc and use if($1,1,0)  then total.
> the overall number of hits that are recorded is the number of intersection
> to the model
> you need then to check the overall resolution of your image and account
> for the fact that you should be considering the inner 180 deg. circle.
> Sorry have no time to write up this for you,
> but to be fair there is already (and below too) a lot that you could try.
> If you have no time to experiment or are simply looking for the easy
> copy/paste solution amen.
> I meant differently.
> in any case, all the best
> G
>
>
>
> On 20 Oct 2012, at 13:46, Ji Zhang <hope.zh at gmail.com> wrote:
>
> Dear Giulio, appreciate if you can kindly elaborate more on your
> suggestions !
>
> - Ji
>
>
> On Sat, Oct 20, 2012 at 6:09 PM, giulio antonutto <antonutto at yahoo.it>wrote:
>
>> what about vwrays and an angular view?
>> then -av 1 1 1, no sky and total - positive = sky
>> g
>>
>> On 20 Oct 2012, at 10:56, Ji Zhang <hope.zh at gmail.com> wrote:
>>
>> Hi, Lars,
>>
>> I agree with your suggestion: calculating the number of rays shooting out
>> from a sensor that can reach the sky directly, and divide the value
>> obtained by the total number of rays shot. This will give us the percentage
>> of visible sky or sky exposure for a given sensor.
>>
>> However, if I understand correctly, the output of rtrace is a file,
>> within which each row indicating the xyz coordinates and rgb irradiance of
>> a given sensor.
>>
>> Is the output of rtrace which is supposed to be piped to rcalc as shown
>> in your script has only one column of data and each row is the irradiance
>> value of one of the sensors?
>>
>> So, the script might be something like:
>>
>> cat sensors.txt | rtrace -I  -aa XXX  -ab XXX -ad XXX -h -w scene.oct |
>> rcalc -e '$1=if($1-.00001,1,0); $2=1' | total | rcalc -e '$1=$1/$2' >
>> results.txt
>>
>> If that's the case, you're calculating the percentage of sensors that can
>> see the sky (regardless of the size of sky visible to each sensor), am I
>> correct?
>>
>> ... or I miss something critical here ...
>>
>> - Ji
>>
>>
>>
>> On Sat, Oct 20, 2012 at 4:05 PM, Lars O. Grobe <grobe at gmx.net> wrote:
>>
>>> Hi Patrick,
>>>
>>> Did you consider genklemsamp?
>>>
>>> If you just want to not apply the cosine but get either 1 or 0 for rays
>>> hitting the sky or not, pipe the output from rtrace to rcalc. E.g. sum the
>>> rays that are above the treshold (0.00001 here) and total number of rays
>>> traced, and then get the fraction of rays over the treshold using rtrace
>>> again:
>>>
>>> <your rtrace command> | rcalc -e ?$1=if($1-.00001,1,0); $2=1? | total |
>>> rcalc -e ?$1=$1/$2?
>>>
>>> That could be done using binary floats instead of ascii to make it a bit
>>> more efficient using proper -if3, -of options for all commands. The same
>>> can be done on e.g. fisheye images using pcomb.
>>>
>>> A general hint, you can also get the surface identifier (-os) at the
>>> first ray intersection instead of e.g. the radiance value from rtrace and
>>> pass that through grep.
>>>
>>> Cheers, Lars.
>>>
>>> ______________________________**_________________
>>> Radiance-general mailing list
>>> Radiance-general at radiance-**online.org<Radiance-general at radiance-online.org>
>>> http://www.radiance-online.**org/mailman/listinfo/radiance-**general<http://www.radiance-online.org/mailman/listinfo/radiance-general>
>>>
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121021/63b06a95/attachment.html>

From grobe at gmx.net  Sun Oct 21 07:34:36 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Sun, 21 Oct 2012 16:34:36 +0200
Subject: [Radiance-general] sky visibility
In-Reply-To: <CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
Message-ID: <508407FC.8040408@gmx.net>

Hi!
> However, if I understand correctly, the output of rtrace is a file, 
> within which each row indicating the xyz coordinates and rgb 
> irradiance of a given sensor.
I'd suggest to any Radiance user to thoroughly read the rtrace manpage. 
Especially the part about output (-o...). rtrace is NOT only returning 
radiance, irradiance or contribution coefficients. It can output 
information about the first ray intersection, as well as intersection of 
daughter rays, with geometry in your scene. This may be coordinates, 
directions, lengths, surface identifiers, materials and modifiers, ... 
And the output is not a file but a stream of data, which, piped into 
other tools such as rcalc, grep, sed, ... can be processed further. 
Maybe even into input for the next rtrace process.

Giulio was proposing something similar, but relying on an image format. 
You could, again, use my rcalc line with his approach to get both the 
number of rays intersecting with geometry and the total number of rays:

$1=if($1,1,0) sets all pixels (rays) to one if they are above 0 (meaning 
they hit some geometry, as you have no light source but only 
self-glowing geometry).

$2=1 sets the second value to 1 for any pixels (rays) regardless they 
hit geometry or not.

So rcalc -e ?$1=if($1,1,0); $2=1? | total would result in two values, 
first the number of pixels (rays) hitting geometry, second the total 
number of pixels sent. The fraction is what you need. The input for this 
rcalc command can be from vwrays | racalc, rpict or anything else 
shooting rays into a hemisphere...

The more interesting question may be whether it is enough to trace from 
only one point on your window. Maybe you want several random sampling 
positions on the window pane.

Cheers, Lars.


From Santiago.Torres at arup.com  Sun Oct 21 20:38:53 2012
From: Santiago.Torres at arup.com (Santiago Torres)
Date: Mon, 22 Oct 2012 03:38:53 +0000
Subject: [Radiance-general] sky visibility
In-Reply-To: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
Message-ID: <F680DBC15ACC484FA2089674923B4C8920517104@EURXMBS05.global.arup.com>

Hi all,

I found the reply below from an old thread (12-15-2011). Would this help?

Also, how about defining a sensor with all coefficients 1, and getting the weighted illuminance, would that work?

Regards,
Santiago


=========


Hi Minki,



If this quantity is equal to the integral of luminance over the full sphere, then it would be the same as 4*PI times the average luminance in all directions.  You can compute the latter quantity by averaging the output of an appropriate rtrace calculation of random rays over the sphere.  Something like the following should work:



set N=10000

set orig=(0 0 0)

cnt $N | rcalc -of -e 'Dz=1-2*($1+rand(.77-.61*recno))/'$N -e 'phi=2*PI*($1+rand(-.10+.39*recno))'/$N \

            -e 'rxy=sqrt(1-Dz*Dz);Dx=rxy*cos(phi);Dy=rxy*sin(phi)' \

            -e "Ox:$orig[1];Oy:$orig[2];Oz:$orig[3]" \

            -e '$1=Ox;$2=Oy;$3=Oz;$4=Dx;$5=Dy;$6=Dz' \

      | rtrace -h -ff [options] scene.oct \

      | total -if3 -m \

      | rcalc -e '$1=179*4*PI*($1*.265+$2*.670+$3*.065)'



This should take ray samples in a stratified random spiral over the sphere.  The 3 averaged radiance values (RGB) output should be multiplied by 179 and 4*PI as above, unless I misunderstand the definition of spherical illuminance.



Best,

-Greg




From: Patrick Janssen [mailto:patrick at janssen.name]
Sent: 2012?10?20? 15:45
To: radiance-general at radiance-online.org
Subject: [Radiance-general] sky visibility

Hi all,

I have an urban model with many windows, and I would like to calculate % visible sky for each window. I define a point at the centre of the window with a viewing direction normal to the window, and I would like to calculate how much (i.e. what %) of the sky dome is visible from that point, assuming a 180 degree cone of vision.  Note that I do not want to apply the cosine-law, and I want to treat each part of the sky dome equally. For a vertical window, the maximum value should be 50%, which would mean that there are no obstructions.

What is the best (i.e. fastest) way of calculating this?

I tried rtrace (1 bounce, uniform sky)  but that applies the cosine law. I have been looking at rsensor, but if I have lots of windows, it seems  I would have to run rsensor lots of times, which would be rather slow. Any suggestions?

Patrick
____________________________________________________________
Electronic mail messages entering and leaving Arup  business
systems are scanned for acceptability of content and viruses
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121022/a78b144e/attachment.html>

From hope.zh at gmail.com  Mon Oct 22 02:29:44 2012
From: hope.zh at gmail.com (Ji Zhang)
Date: Mon, 22 Oct 2012 17:29:44 +0800
Subject: [Radiance-general] sky visibility
In-Reply-To: <508407FC.8040408@gmx.net>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<508407FC.8040408@gmx.net>
Message-ID: <CAD83LVLba8_qYttjoM2f=2E6SJBhx5o4CJXqePuH6nozhfkJkQ@mail.gmail.com>

Thank you very much, Lars and Giulio!

I did some test and seem to be able to make it work following your
suggestion.

However, my major concern is that this is NOT the so called Sky Exposure
Factor we'd like to calculate, and the value thus obtained may vary as the
view type changes (e.g. -vts or -vta) which is not suppose to happen if the
scene geometry remains the same.


Allow me to explain the script, and pls kindly help to verify if it is
doing what you suggested.

The bash script below calculate the proportion of visible sky based on
counting pixels in a "virtual fisheye rendering":

#### the script #####################
oconv ./plastic_mat.rad ./geom1.rad > ./scene1.oct
vwrays -fd -vf ./view_vta.vf -x 800 -y 800 | rtrace -av 1 1 1 -w -h -fda
-opdv ./scene1.oct > ./zzz_vta_pts_P_N_v_1.txt
vwrays -fd -vf ./view_vta.vf -x 800 -y 800 | rtrace -av 1 1 1 -w -h -fda
-opdv ./scene1.oct | rcalc -e '$1=if($7,1,0); $2=1' | total >
./zzz_vta_pts_total_1.txt
oconv ./plastic_mat.rad ./geom2.rad > ./scene2.oct
vwrays -fd -vf ./view_vta.vf -x 800 -y 800 | rtrace -av 1 1 1 -w -h -fda
-opdv ./scene2.oct > ./zzz_vta_pts_P_N_v_2.txt
vwrays -fd -vf ./view_vta.vf -x 800 -y 800 | rtrace -av 1 1 1 -w -h -fda
-opdv ./scene2.oct | rcalc -e '$1=if($7,1,0); $2=1' | total >
./zzz_vta_pts_total_2.txt
rlam ./zzz_vta_pts_total_1.txt ./zzz_vta_pts_total_2.txt >
./zzz_vta_pts_total_temp.txt
rcalc -e '$1=($3-$1)/$3' ./zzz_vta_pts_total_temp.txt >
./zzz_vta_pts_total_final.txt
#################################

1. scene1.oct describes a cylinder like geometry (diameter=2, height=1)
with its top and bottom open. This is suppose to be the obstruction for the
view point, and from which the sky exposure factor is to be calculated

2. scene2.oct describes a cone in the same position as the cylinder, in the
same height and with the same bottom circle diameter. It is to obstruct the
view entirely so that we can "ironically" calculate the total number of
rays that may reach the sky if there's no obstruction to the view.

3. view_vta.vf defines an upward angular fisheye view of 180 degrees
located at the centre of the bottom circle of the cylinder

4. in the 2nd line of the script, the "-opdv" option in the rtrace outputs
the xyz coordinates, xyz normal vectors, and radiance value for each point
as a result of the intersection of a ray and the cylinder geometry to a
text file. If a ray didn't hit any geometry, it will return seven zeros: "0
0 0 0 0 0 0".

5. in the 3rd line of script, an evaluation is conducted: if the 7th value
as output for each ray is a positive value (which means the ray hits the
geometry and return a value as a results of the -av 1 1 1 option), that ray
will be marked as "1", otherwise, it'll be marked as "0". The "total" in
this line sums all the values and outputs the two values to
"zzz_vta_pts_total_1.txt": the first value is the total number of rays hit
the inner side of the cylinder (or the total number of pixels in the
400x400 virtual fisheye rendering that is in grey color), and the second
value is the total number of pixels in the "virtual fisheye rendering"
which in this case is 400*400=640000

6. similarly, in the 6th line of script, the two values output to
"zzz_vta_pts_total_2.txt" is the total number of rays that may reach the
sky (which is also the total number of the rays hit the inner side of the
cone which block the view completely in this case), and the total number of
pixels.

7. in the last line of script, the "$3-$1" part is to calculate in scene1
the actual number of rays that may reach the sky (or in the virtual fisheye
image the number of pixels representing the visible sky patch)

8. finally, the ratio of the visible sky path to the unobstructed sky dome
is calculated...

9. Validation:
We have a similar in-house approach to calculate the Sky Exposure Factor
(SkyEF) built on a 3D modeling software, in which we literally shoot out a
bunch of points evenly spaced in a 2*PI upward solid angle from the
viewpoint towards a sky hemisphere surface. We than calculate the ratio
between the number of points reaching the sky dome surface and the total
number of points shot to get the SkyEF. For the cylinder scenario tested
here, the SkyEF should be 0.2929 or 29.29%, which is actually the ratio
between the solid angle subtended by the view to sky: 2*PI*(1-cos45) to the
solid angle of an unobstructed sky hemisphere: 2*PI. However, the
vrways+rtrace approach as described here can't get the this value. I've
visualized the all the intersection points based on the
zzz_vta_pts_P_N_v_1.txt file, and I found that the total number of points
hitting obstructing geometry is different for different view type
specifications. I assume it's related to how the nature of the fisheye
image distortion...

I apologize if I didn't explain clearly. I'd appreciate if both of you and
the list can further advise on an appropriate view-type-independent
Radiance approach to calculate Sky Exposure Factor !

- Cheers, Ji



On Sun, Oct 21, 2012 at 10:34 PM, Lars O. Grobe <grobe at gmx.net> wrote:

> Hi!
>
>  However, if I understand correctly, the output of rtrace is a file,
>> within which each row indicating the xyz coordinates and rgb irradiance of
>> a given sensor.
>>
> I'd suggest to any Radiance user to thoroughly read the rtrace manpage.
> Especially the part about output (-o...). rtrace is NOT only returning
> radiance, irradiance or contribution coefficients. It can output
> information about the first ray intersection, as well as intersection of
> daughter rays, with geometry in your scene. This may be coordinates,
> directions, lengths, surface identifiers, materials and modifiers, ... And
> the output is not a file but a stream of data, which, piped into other
> tools such as rcalc, grep, sed, ... can be processed further. Maybe even
> into input for the next rtrace process.
>
> Giulio was proposing something similar, but relying on an image format.
> You could, again, use my rcalc line with his approach to get both the
> number of rays intersecting with geometry and the total number of rays:
>
> $1=if($1,1,0) sets all pixels (rays) to one if they are above 0 (meaning
> they hit some geometry, as you have no light source but only self-glowing
> geometry).
>
> $2=1 sets the second value to 1 for any pixels (rays) regardless they hit
> geometry or not.
>
> So rcalc -e ?$1=if($1,1,0); $2=1? | total would result in two values,
> first the number of pixels (rays) hitting geometry, second the total number
> of pixels sent. The fraction is what you need. The input for this rcalc
> command can be from vwrays | racalc, rpict or anything else shooting rays
> into a hemisphere...
>
> The more interesting question may be whether it is enough to trace from
> only one point on your window. Maybe you want several random sampling
> positions on the window pane.
>
>
> Cheers, Lars.
>
> ______________________________**_________________
> Radiance-general mailing list
> Radiance-general at radiance-**online.org<Radiance-general at radiance-online.org>
> http://www.radiance-online.**org/mailman/listinfo/radiance-**general<http://www.radiance-online.org/mailman/listinfo/radiance-general>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121022/1a58fddd/attachment-0001.html>

From amcneil at lbl.gov  Mon Oct 22 09:45:24 2012
From: amcneil at lbl.gov (Andrew McNeil)
Date: Mon, 22 Oct 2012 09:45:24 -0700
Subject: [Radiance-general] possible inconsistency of bin numbers
 between BSDF and kelms_int.cal
In-Reply-To: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
Message-ID: <CAOG+Nix_+A_ZU3GzRp8fSzeLyVmWSmTgTivpR=7z3we2oLRVpg@mail.gmail.com>

Jia,
This diagram: https://dl.dropbox.com/u/15562376/bin.jpg is wrong.
You should look at klems_int.cal to determine what the patch numbers are.
 My bad.
Andy

On Sat, Oct 20, 2012 at 5:11 AM, Jia Hu <hujia06 at gmail.com> wrote:

> Hi all:
>
> I have a question about the bin number.
>
> To calculate view matrix:  (south-facing window)
> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b kbinS -bn Nkbins -m
> window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>
> kbinS uses the (0, 1, 0) as normal (pointing to inside room).
>
> For a ray direction (-1, -1, 0), using klems_int.cal to calculate the bin
> number, the bin number is about #57 (I did it manually).
>
> Klems_int.cal (download Klems_init.cal<https://dl.dropbox.com/u/15562376/klems_int.cal>)
> seems use "z" hemisphere (see this figure:
> https://dl.dropbox.com/u/15562376/coordinate.jpg). From the figure, we
> can see "z" hemisphere points to the room (that is, the hemisphere is
> located in the room) "zr" (z reverse) hemisphere is towards outside (the
> hemisphere is outside the room).
>
> The possible inconsistency is:
>
> (1) Klems_int.cal uses "z" hemisphere to calculate the bin number, for
> example,  for ray direction (-1, -1, 0), the bin number is #57 for "z"
> hemisphere coordinate. (see this figure:
> https://dl.dropbox.com/u/15562376/bin.jpg)
>
> (2) The "Transmission Back" data in the BSDF .XML is used in the three
> phase DC method (see Greg's explanation<http://permalink.gmane.org/gmane.comp.graphics.radiance.general/2729>),
> and thus the calculation is based on "zr" (z reverse) hemisphere , for ray
> direction (-1, -1, 0), the bin number is about #69 according to the "z
> reverse" hemisphere coordinate (see this figure:
> https://dl.dropbox.com/u/15562376/bin.jpg).
>
> So my questions are:
>
> (a) Given the ray direction, which hemisphere ( "z" or "zr" ) does
>  "Klems_init.cal" use?
>
> (b) whether the bin numbers (for the same ray direction) between
> "Klems_int.cal" and BSDF .xml  are inconsistent or not?
>
> (c) if they are using different bin numbers, how to handle ViewMatrix *
> BSDF in the calculation?
>
> Thank you in advance,
>
> Jia
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121022/0c83b7f7/attachment.html>

From amcneil at lbl.gov  Mon Oct 22 09:50:09 2012
From: amcneil at lbl.gov (Andrew McNeil)
Date: Mon, 22 Oct 2012 09:50:09 -0700
Subject: [Radiance-general] possible inconsistency of bin numbers
 between BSDF and kelms_int.cal
In-Reply-To: <CABzgtwp0nzUTB0zdaW96WdGwOhcy3Ay-+5z572UAbV_T+gBX4g@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
	<CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>
	<CABzgtwp0nzUTB0zdaW96WdGwOhcy3Ay-+5z572UAbV_T+gBX4g@mail.gmail.com>
Message-ID: <CAOG+NiwbriQ-qA+8hPy0CQxxUQhhACimqCAUbU0=839iua4X-Q@mail.gmail.com>

dctimestep originally used just the front transmission data, and if front
transmission data were missing the result was zero.  I think Greg has
recently made changes so that it can us back transmission too.  Try with
the HEAD.

Andy


On Sat, Oct 20, 2012 at 5:38 PM, Jia Hu <hujia06 at gmail.com> wrote:

> Sorry to keep bothering you...  Just add some additional information. I
> search "transmission back" and "transmission front" in the code and find
> "Transmission Front" is more likely used according to the code.  The
> following two code snippets from bsdf_m.c and bsdf.c shows "Transmission
> Front" data will be loaded or preferred ?
>
> Another issue,  I remember Greg mention that even if only "Transmission
> Front" is present, the BSDF library in Radiance can still computer
> Transmission matrix. But my simple test case (download here<https://dl.dropbox.com/u/15562376/test_10_21.zip>)
> did not show that.  If you change "Transmission Back" in the .xml file to
> "Transmission Front". The results will be zero.
>
>
> *//  ray/src/common/bsdf_m.c*
> /*
>  * Remember that front and back are reversed from WINDOW 6 orientations
>  * *Favor their "Front" (incoming light) since that's more often valid*
>  */
>  tfront = !strcasecmp(sdata, "Transmission Back");
> if (!strcasecmp(sdata, "Transmission Front") ||
>  tfront & (sd->tf == NULL)) {
> if (sd->tf != NULL)
> SDfreeSpectralDF(sd->tf);
>  if ((sd->tf = SDnewSpectralDF(1)) == NULL)
> return RC_MEMERR;
> df = sd->tf;
>
> *// ray/src/common/bsdf.c*
>
> for (wld = ezxml_child(wtl, "WavelengthData");
> wld != NULL; wld = wld->next) {
>  if (strcasecmp(ezxml_txt(ezxml_child(wld,"Wavelength")),
> "Visible"))
>  continue;
> for (wdb = ezxml_child(wld, "WavelengthDataBlock");
>  wdb != NULL; wdb = wdb->next)
> if (!strcasecmp(ezxml_txt(ezxml_child(wdb,
>  "WavelengthDataDirection")),
> *"Transmission Front"))*
>  break;
> if (wdb != NULL) { */* load front BTDF */*
>  load_bsdf_data(dp, wdb);
> break; /* ignore the rest */
>  }
> }
>
> Thanks,
>
> Jia
>
> On Sat, Oct 20, 2012 at 4:01 PM, Jia Hu <hujia06 at gmail.com> wrote:
>
>> Hi all:
>>
>> In the Klems_init.cal file, for south window (using kbinS), the Klems
>> coordinate is defined as:
>>
>> z+: pointing to inside (that is, (0,1, 0)  )
>> x+: pointing to West ( that is (-1, 0, 0) )
>> y+: pointing to Up (0,0,1)
>>
>> This coordinate is consistent with the Klems coordinate system used in
>> WINDOW 6 (see this: https://dl.dropbox.com/u/15562376/coordinate.jpg).
>> In the figure, Klems coordinate system defines: x or xr points to (-1, 0,
>> 0) and  y or yr points to (0, 0, 1).
>>
>> However, if using this command to calculate view matrix:
>>
>> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b *kbinS* -bn Nkbins
>> -m window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>>
>> where, kbinS defines z axis in the Klems coordinate system as (0 1 0),
>> that is, pointing to room interior.
>>
>> Thus, the bin number calculated by Klems_init.cal is actually based on z
>> hemisphere <https://dl.dropbox.com/u/15562376/coordinate.jpg> (the
>> hemisphere protrudes towards room). the bin number corresponds with
>> "Transmittance Front" in BSDF xml file. For example, ray direction (-1, -1,
>> 0) (backward, ray travels from inside to outside room) hits the bin 58<https://dl.dropbox.com/u/15562376/bin.jpg>
>> defined in z hemisphere because the hemisphere protrudes towards (0 1 0).
>>  But ray direction (-1 -1 0) hits bin 46<https://dl.dropbox.com/u/15562376/bin.jpg> defined in
>> z reverse (i.e., zr) coordinate because the hemisphere protrudes towards (0
>> -1 0) (towards outside).
>>
>> When calculating Daylighting Matrix, it still uses Klems_init.cal and
>> kbinS, that is, z hemisphere coordinate system, therefore, Radiance seems
>> needing to use "Transmission Front", which is defined in z hemisphere.  But
>> currently Radiance uses "Transmission Back" (from inside to outside), which
>> defined in zr hemisphere,
>>
>> So, should we need to
>>
>>  (a) use "*kbinN*" (defining z axis of Klems coordinate towards (0 -1 0)
>> )  and "Transmission Back" for south window,  or
>>   (b) use "Transmission Front" and *kbinS*?
>>
>>  I am very confused about this. Does anyone know the possible reasons?
>>
>> Thank you !
>>
>> Jia
>>
>>
>> On Sat, Oct 20, 2012 at 8:11 AM, Jia Hu <hujia06 at gmail.com> wrote:
>>
>>> Hi all:
>>>
>>> I have a question about the bin number.
>>>
>>> To calculate view matrix:  (south-facing window)
>>> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b kbinS -bn Nkbins
>>> -m window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>>>
>>> kbinS uses the (0, 1, 0) as normal (pointing to inside room).
>>>
>>> For a ray direction (-1, -1, 0), using klems_int.cal to calculate the
>>> bin number, the bin number is about #57 (I did it manually).
>>>
>>> Klems_int.cal (download Klems_init.cal<https://dl.dropbox.com/u/15562376/klems_int.cal>)
>>> seems use "z" hemisphere (see this figure:
>>> https://dl.dropbox.com/u/15562376/coordinate.jpg). From the figure, we
>>> can see "z" hemisphere points to the room (that is, the hemisphere is
>>> located in the room) "zr" (z reverse) hemisphere is towards outside (the
>>> hemisphere is outside the room).
>>>
>>> The possible inconsistency is:
>>>
>>> (1) Klems_int.cal uses "z" hemisphere to calculate the bin number, for
>>> example,  for ray direction (-1, -1, 0), the bin number is #57 for "z"
>>> hemisphere coordinate. (see this figure:
>>> https://dl.dropbox.com/u/15562376/bin.jpg)
>>>
>>> (2) The "Transmission Back" data in the BSDF .XML is used in the three
>>> phase DC method (see Greg's explanation<http://permalink.gmane.org/gmane.comp.graphics.radiance.general/2729>),
>>> and thus the calculation is based on "zr" (z reverse) hemisphere , for ray
>>> direction (-1, -1, 0), the bin number is about #69 according to the "z
>>> reverse" hemisphere coordinate (see this figure:
>>> https://dl.dropbox.com/u/15562376/bin.jpg).
>>>
>>> So my questions are:
>>>
>>> (a) Given the ray direction, which hemisphere ( "z" or "zr" ) does
>>>  "Klems_init.cal" use?
>>>
>>> (b) whether the bin numbers (for the same ray direction) between
>>> "Klems_int.cal" and BSDF .xml  are inconsistent or not?
>>>
>>> (c) if they are using different bin numbers, how to handle ViewMatrix *
>>> BSDF in the calculation?
>>>
>>> Thank you in advance,
>>>
>>> Jia
>>>
>>
>>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121022/7cfaacdb/attachment-0001.html>

From amcneil at lbl.gov  Mon Oct 22 09:51:41 2012
From: amcneil at lbl.gov (Andrew McNeil)
Date: Mon, 22 Oct 2012 09:51:41 -0700
Subject: [Radiance-general] possible inconsistency of bin numbers
 between BSDF and kelms_int.cal
In-Reply-To: <CAOG+Nix_+A_ZU3GzRp8fSzeLyVmWSmTgTivpR=7z3we2oLRVpg@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
	<CAOG+Nix_+A_ZU3GzRp8fSzeLyVmWSmTgTivpR=7z3we2oLRVpg@mail.gmail.com>
Message-ID: <CAOG+Niw=4OR44_4rebUVaFHBrKhuuFxAU=KSur3zSomV=TaGoQ@mail.gmail.com>

One more thing, the patch numbers will be different for incident and
exiting hemispheres.  one side uses left handed numbering the other uses
right handed numbering.  Energy that is transmitted specularly will have
the same incident and exiting patch number.

Andy

On Mon, Oct 22, 2012 at 9:45 AM, Andrew McNeil <amcneil at lbl.gov> wrote:

> Jia,
> This diagram: https://dl.dropbox.com/u/15562376/bin.jpg is wrong.
> You should look at klems_int.cal to determine what the patch numbers are.
>  My bad.
> Andy
>
> On Sat, Oct 20, 2012 at 5:11 AM, Jia Hu <hujia06 at gmail.com> wrote:
>
>>  Hi all:
>>
>> I have a question about the bin number.
>>
>> To calculate view matrix:  (south-facing window)
>> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b kbinS -bn Nkbins -m
>> window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>>
>> kbinS uses the (0, 1, 0) as normal (pointing to inside room).
>>
>> For a ray direction (-1, -1, 0), using klems_int.cal to calculate the bin
>> number, the bin number is about #57 (I did it manually).
>>
>> Klems_int.cal (download Klems_init.cal<https://dl.dropbox.com/u/15562376/klems_int.cal>)
>> seems use "z" hemisphere (see this figure:
>> https://dl.dropbox.com/u/15562376/coordinate.jpg). From the figure, we
>> can see "z" hemisphere points to the room (that is, the hemisphere is
>> located in the room) "zr" (z reverse) hemisphere is towards outside (the
>> hemisphere is outside the room).
>>
>> The possible inconsistency is:
>>
>> (1) Klems_int.cal uses "z" hemisphere to calculate the bin number, for
>> example,  for ray direction (-1, -1, 0), the bin number is #57 for "z"
>> hemisphere coordinate. (see this figure:
>> https://dl.dropbox.com/u/15562376/bin.jpg)
>>
>> (2) The "Transmission Back" data in the BSDF .XML is used in the three
>> phase DC method (see Greg's explanation<http://permalink.gmane.org/gmane.comp.graphics.radiance.general/2729>),
>> and thus the calculation is based on "zr" (z reverse) hemisphere , for ray
>> direction (-1, -1, 0), the bin number is about #69 according to the "z
>> reverse" hemisphere coordinate (see this figure:
>> https://dl.dropbox.com/u/15562376/bin.jpg).
>>
>> So my questions are:
>>
>> (a) Given the ray direction, which hemisphere ( "z" or "zr" ) does
>>  "Klems_init.cal" use?
>>
>> (b) whether the bin numbers (for the same ray direction) between
>> "Klems_int.cal" and BSDF .xml  are inconsistent or not?
>>
>> (c) if they are using different bin numbers, how to handle ViewMatrix *
>> BSDF in the calculation?
>>
>> Thank you in advance,
>>
>> Jia
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121022/5aa463ca/attachment.html>

From hujia06 at gmail.com  Mon Oct 22 10:23:07 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Mon, 22 Oct 2012 13:23:07 -0400
Subject: [Radiance-general] possible inconsistency of bin numbers
 between BSDF and kelms_int.cal
In-Reply-To: <CAOG+Nix_+A_ZU3GzRp8fSzeLyVmWSmTgTivpR=7z3we2oLRVpg@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
	<CAOG+Nix_+A_ZU3GzRp8fSzeLyVmWSmTgTivpR=7z3we2oLRVpg@mail.gmail.com>
Message-ID: <CABzgtwqbLAX2FzNHGsQPkaHDF=LH+ibLcdCFLBYfc9eAoTHHhA@mail.gmail.com>

Hi Andy:

"the patch numbers will be different for incident and exiting hemispheres.
 one side uses left handed numbering the other uses right handed numbering."
------
Yes, from this figure  https://dl.dropbox.com/u/15562376/coordinate.jpg, Z
hemisphere coordinate uses right handed and Zr uses left handed, but for
forward rays (both incoming and outgoing rays whose direction is from
inside room to outside), these rays will only use Z hemisphere, Zr
hemisphere does not exist for those forward rays, and thus no left handed
coordinate in this sense. Thus outgoing rays still uses Z hemisphere patch
number.

To make it clear, you may read this report
http://windows.lbl.gov/software/window/6/Venetian%20Technical%20Document.pdf ,
*Page 6, 7, 10 and 47 -50*, the report shows that both incoming and exiting
rays' patch numbers are based on only one Hemisphere, either Z or Zr
hemisphere but not both, that is why, *if you see the page 49 in the report
*( or https://dl.dropbox.com/u/15562376/PDF_page_49.jpg*)*, the incoming
patch number is 31 and the outgoing patch is still 31 because they are
using the same hemisphere. In the outgoing side, there is no hemisphere and
outgoing ray still uses the hemisphere in the incoming ray side to
determine the patch number. That is why they have the same patch numbers if
their directions are the same.

I think you figure is correct if you stand inside the room and look at the
window. Klems_int.cal uses Z hemisphere to determine the patch number.

My concern is that Radiance loads "Transmission Back" data which uses Zr
hemisphere but VewMatrix and DaylightMatrix uses Z hemisphere. In other
words, when Radiance loads "Transmission Back" data, it assumes all the
patch number is determined based on Zr hemisphere (both incoming and
outgoing rays patch number is based on this Zr hemisphere). But V and D,
the patch numbers of both incoming and outgoing rays  determine patch
numbers based on Z hemisphere (right hemisphere in the figure).

Thanks,

Jia

On Mon, Oct 22, 2012 at 12:45 PM, Andrew McNeil <amcneil at lbl.gov> wrote:

> Jia,
> This diagram: https://dl.dropbox.com/u/15562376/bin.jpg is wrong.
> You should look at klems_int.cal to determine what the patch numbers are.
>  My bad.
> Andy
>
> On Sat, Oct 20, 2012 at 5:11 AM, Jia Hu <hujia06 at gmail.com> wrote:
>
>> Hi all:
>>
>> I have a question about the bin number.
>>
>> To calculate view matrix:  (south-facing window)
>> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b kbinS -bn Nkbins -m
>> window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>>
>> kbinS uses the (0, 1, 0) as normal (pointing to inside room).
>>
>> For a ray direction (-1, -1, 0), using klems_int.cal to calculate the bin
>> number, the bin number is about #57 (I did it manually).
>>
>> Klems_int.cal (download Klems_init.cal<https://dl.dropbox.com/u/15562376/klems_int.cal>)
>> seems use "z" hemisphere (see this figure:
>> https://dl.dropbox.com/u/15562376/coordinate.jpg). From the figure, we
>> can see "z" hemisphere points to the room (that is, the hemisphere is
>> located in the room) "zr" (z reverse) hemisphere is towards outside (the
>> hemisphere is outside the room).
>>
>> The possible inconsistency is:
>>
>> (1) Klems_int.cal uses "z" hemisphere to calculate the bin number, for
>> example,  for ray direction (-1, -1, 0), the bin number is #57 for "z"
>> hemisphere coordinate. (see this figure:
>> https://dl.dropbox.com/u/15562376/bin.jpg)
>>
>> (2) The "Transmission Back" data in the BSDF .XML is used in the three
>> phase DC method (see Greg's explanation<http://permalink.gmane.org/gmane.comp.graphics.radiance.general/2729>),
>> and thus the calculation is based on "zr" (z reverse) hemisphere , for ray
>> direction (-1, -1, 0), the bin number is about #69 according to the "z
>> reverse" hemisphere coordinate (see this figure:
>> https://dl.dropbox.com/u/15562376/bin.jpg).
>>
>> So my questions are:
>>
>> (a) Given the ray direction, which hemisphere ( "z" or "zr" ) does
>>  "Klems_init.cal" use?
>>
>> (b) whether the bin numbers (for the same ray direction) between
>> "Klems_int.cal" and BSDF .xml  are inconsistent or not?
>>
>> (c) if they are using different bin numbers, how to handle ViewMatrix *
>> BSDF in the calculation?
>>
>> Thank you in advance,
>>
>> Jia
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121022/0f618c30/attachment.html>

From hujia06 at gmail.com  Mon Oct 22 10:28:52 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Mon, 22 Oct 2012 13:28:52 -0400
Subject: [Radiance-general] possible inconsistency of bin numbers
 between BSDF and kelms_int.cal
In-Reply-To: <CAOG+NiwbriQ-qA+8hPy0CQxxUQhhACimqCAUbU0=839iua4X-Q@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
	<CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>
	<CABzgtwp0nzUTB0zdaW96WdGwOhcy3Ay-+5z572UAbV_T+gBX4g@mail.gmail.com>
	<CAOG+NiwbriQ-qA+8hPy0CQxxUQhhACimqCAUbU0=839iua4X-Q@mail.gmail.com>
Message-ID: <CABzgtwr8agwpYGBhECDkkfy65+PNeZW=1XqqDkH7NSbmRFJPCg@mail.gmail.com>

Hi Andy:

Yes. But currently the fact is that if the back transmission data is
missing, the results are zero even if there are front transmission data.
That is why I am confused.

Thanks,

Jia

On Mon, Oct 22, 2012 at 12:50 PM, Andrew McNeil <amcneil at lbl.gov> wrote:

> dctimestep originally used just the front transmission data, and if front
> transmission data were missing the result was zero.  I think Greg has
> recently made changes so that it can us back transmission too.  Try with
> the HEAD.
>
> Andy
>
>
> On Sat, Oct 20, 2012 at 5:38 PM, Jia Hu <hujia06 at gmail.com> wrote:
>
>> Sorry to keep bothering you...  Just add some additional information. I
>> search "transmission back" and "transmission front" in the code and find
>> "Transmission Front" is more likely used according to the code.  The
>> following two code snippets from bsdf_m.c and bsdf.c shows "Transmission
>> Front" data will be loaded or preferred ?
>>
>> Another issue,  I remember Greg mention that even if only "Transmission
>> Front" is present, the BSDF library in Radiance can still computer
>> Transmission matrix. But my simple test case (download here<https://dl.dropbox.com/u/15562376/test_10_21.zip>)
>> did not show that.  If you change "Transmission Back" in the .xml file to
>> "Transmission Front". The results will be zero.
>>
>>
>> *//  ray/src/common/bsdf_m.c*
>> /*
>>  * Remember that front and back are reversed from WINDOW 6 orientations
>>  * *Favor their "Front" (incoming light) since that's more often valid*
>>  */
>>  tfront = !strcasecmp(sdata, "Transmission Back");
>> if (!strcasecmp(sdata, "Transmission Front") ||
>>  tfront & (sd->tf == NULL)) {
>> if (sd->tf != NULL)
>> SDfreeSpectralDF(sd->tf);
>>  if ((sd->tf = SDnewSpectralDF(1)) == NULL)
>> return RC_MEMERR;
>> df = sd->tf;
>>
>> *// ray/src/common/bsdf.c*
>>
>> for (wld = ezxml_child(wtl, "WavelengthData");
>> wld != NULL; wld = wld->next) {
>>  if (strcasecmp(ezxml_txt(ezxml_child(wld,"Wavelength")),
>> "Visible"))
>>  continue;
>> for (wdb = ezxml_child(wld, "WavelengthDataBlock");
>>  wdb != NULL; wdb = wdb->next)
>> if (!strcasecmp(ezxml_txt(ezxml_child(wdb,
>>  "WavelengthDataDirection")),
>> *"Transmission Front"))*
>>  break;
>> if (wdb != NULL) { */* load front BTDF */*
>>  load_bsdf_data(dp, wdb);
>> break; /* ignore the rest */
>>  }
>> }
>>
>> Thanks,
>>
>> Jia
>>
>> On Sat, Oct 20, 2012 at 4:01 PM, Jia Hu <hujia06 at gmail.com> wrote:
>>
>>> Hi all:
>>>
>>> In the Klems_init.cal file, for south window (using kbinS), the Klems
>>> coordinate is defined as:
>>>
>>> z+: pointing to inside (that is, (0,1, 0)  )
>>> x+: pointing to West ( that is (-1, 0, 0) )
>>> y+: pointing to Up (0,0,1)
>>>
>>> This coordinate is consistent with the Klems coordinate system used in
>>> WINDOW 6 (see this: https://dl.dropbox.com/u/15562376/coordinate.jpg).
>>> In the figure, Klems coordinate system defines: x or xr points to (-1, 0,
>>> 0) and  y or yr points to (0, 0, 1).
>>>
>>> However, if using this command to calculate view matrix:
>>>
>>> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b *kbinS* -bn
>>> Nkbins -m window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>>>
>>>
>>> where, kbinS defines z axis in the Klems coordinate system as (0 1 0),
>>> that is, pointing to room interior.
>>>
>>> Thus, the bin number calculated by Klems_init.cal is actually based on z
>>> hemisphere <https://dl.dropbox.com/u/15562376/coordinate.jpg> (the
>>> hemisphere protrudes towards room). the bin number corresponds with
>>> "Transmittance Front" in BSDF xml file. For example, ray direction (-1, -1,
>>> 0) (backward, ray travels from inside to outside room) hits the bin 58<https://dl.dropbox.com/u/15562376/bin.jpg>
>>> defined in z hemisphere because the hemisphere protrudes towards (0 1 0).
>>>  But ray direction (-1 -1 0) hits bin 46<https://dl.dropbox.com/u/15562376/bin.jpg> defined in
>>> z reverse (i.e., zr) coordinate because the hemisphere protrudes towards (0
>>> -1 0) (towards outside).
>>>
>>> When calculating Daylighting Matrix, it still uses Klems_init.cal and
>>> kbinS, that is, z hemisphere coordinate system, therefore, Radiance seems
>>> needing to use "Transmission Front", which is defined in z hemisphere.  But
>>> currently Radiance uses "Transmission Back" (from inside to outside), which
>>> defined in zr hemisphere,
>>>
>>> So, should we need to
>>>
>>>  (a) use "*kbinN*" (defining z axis of Klems coordinate towards (0 -1
>>> 0) )  and "Transmission Back" for south window,  or
>>>   (b) use "Transmission Front" and *kbinS*?
>>>
>>>  I am very confused about this. Does anyone know the possible reasons?
>>>
>>> Thank you !
>>>
>>> Jia
>>>
>>>
>>> On Sat, Oct 20, 2012 at 8:11 AM, Jia Hu <hujia06 at gmail.com> wrote:
>>>
>>>> Hi all:
>>>>
>>>> I have a question about the bin number.
>>>>
>>>> To calculate view matrix:  (south-facing window)
>>>> $ rtcontrib < test.pts -f klems_int.cal -bn Nkbins -b kbinS -bn Nkbins
>>>> -m window_mat -I+ -ab 3 -ad 2000 -lw 1e-4 interior.oct > south.vmx
>>>>
>>>> kbinS uses the (0, 1, 0) as normal (pointing to inside room).
>>>>
>>>> For a ray direction (-1, -1, 0), using klems_int.cal to calculate the
>>>> bin number, the bin number is about #57 (I did it manually).
>>>>
>>>> Klems_int.cal (download Klems_init.cal<https://dl.dropbox.com/u/15562376/klems_int.cal>)
>>>> seems use "z" hemisphere (see this figure:
>>>> https://dl.dropbox.com/u/15562376/coordinate.jpg). From the figure, we
>>>> can see "z" hemisphere points to the room (that is, the hemisphere is
>>>> located in the room) "zr" (z reverse) hemisphere is towards outside (the
>>>> hemisphere is outside the room).
>>>>
>>>> The possible inconsistency is:
>>>>
>>>> (1) Klems_int.cal uses "z" hemisphere to calculate the bin number, for
>>>> example,  for ray direction (-1, -1, 0), the bin number is #57 for "z"
>>>> hemisphere coordinate. (see this figure:
>>>> https://dl.dropbox.com/u/15562376/bin.jpg)
>>>>
>>>> (2) The "Transmission Back" data in the BSDF .XML is used in the three
>>>> phase DC method (see Greg's explanation<http://permalink.gmane.org/gmane.comp.graphics.radiance.general/2729>),
>>>> and thus the calculation is based on "zr" (z reverse) hemisphere , for ray
>>>> direction (-1, -1, 0), the bin number is about #69 according to the "z
>>>> reverse" hemisphere coordinate (see this figure:
>>>> https://dl.dropbox.com/u/15562376/bin.jpg).
>>>>
>>>> So my questions are:
>>>>
>>>> (a) Given the ray direction, which hemisphere ( "z" or "zr" ) does
>>>>  "Klems_init.cal" use?
>>>>
>>>> (b) whether the bin numbers (for the same ray direction) between
>>>> "Klems_int.cal" and BSDF .xml  are inconsistent or not?
>>>>
>>>> (c) if they are using different bin numbers, how to handle ViewMatrix *
>>>> BSDF in the calculation?
>>>>
>>>> Thank you in advance,
>>>>
>>>> Jia
>>>>
>>>
>>>
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121022/542f5019/attachment-0001.html>

From grobe at gmx.net  Tue Oct 23 01:40:11 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Tue, 23 Oct 2012 10:40:11 +0200
Subject: [Radiance-general] sky visibility
In-Reply-To: <CAD83LVLba8_qYttjoM2f=2E6SJBhx5o4CJXqePuH6nozhfkJkQ@mail.gmail.com>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<508407FC.8040408@gmx.net>
	<CAD83LVLba8_qYttjoM2f=2E6SJBhx5o4CJXqePuH6nozhfkJkQ@mail.gmail.com>
Message-ID: <845F404E-414E-49AC-BD4E-BF707FF4AFE7@gmx.net>

Hi Ji Zhang!

> vwrays -fd -vf ./view_vta.vf -x 800 -y 800 | rtrace -av 1 1 1 -w -h -fda -opdv ./scene1.oct > ./zzz_vta_pts_P_N_v_1.txt
> vwrays -fd -vf ./view_vta.vf -x 800 -y 800 | rtrace -av 1 1 1 -w -h -fda -opdv ./scene1.oct | rcalc -e '$1=if($7,1,0); $2=1' | total > ./zzz_vta_pts_total_1.txt

The problem here probably is, that your fisheye view -vta produces pixel values outside the circular image you would expect. These get counted in the total number of pixels. So if you are using -vta, you need  way to filter pixels lying outside the circle. Several approaches to do so come to my mind. A generic one is:

1) vwrays -vta into a scene consisting only of a source, corresponding to the hemisphere you want to sample
2) pipe the output to rtrace, check for intersections with the source and get origin and direction vectors
3) pipe that into rtrace again, this time checking for your pixel values as above...

Still, there is a problem with the -vta (equiangular) fisheye not being a equisolid fisheye, so pixels do not represent equal solid angles.... for sky view factors, that is what you would want, but for your definition, you want the ration (solid angle visible sky) / (solid angle sky without obstructions). So either calculate the solid angle of the pixel depending on the distance from view centre, or go with rpict, create a fisheye image (-vta), and use the S and T functions to filter pixels outside the view and to weigh pixels by their solid angle. So in above commands, you would not set the pixel value to 0 or 1, but to 0 or S(n).

Again, I could not try out all this and send a complete example, just trying to point you to some direction.

Cheers, Lars.



From gregoryjward at gmail.com  Tue Oct 23 15:28:49 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Tue, 23 Oct 2012 15:28:49 -0700
Subject: [Radiance-general] possible inconsistency of bin numbers
	between BSDF and kelms_int.cal
In-Reply-To: <CABzgtwr8agwpYGBhECDkkfy65+PNeZW=1XqqDkH7NSbmRFJPCg@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
	<CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>
	<CABzgtwp0nzUTB0zdaW96WdGwOhcy3Ay-+5z572UAbV_T+gBX4g@mail.gmail.com>
	<CAOG+NiwbriQ-qA+8hPy0CQxxUQhhACimqCAUbU0=839iua4X-Q@mail.gmail.com>
	<CABzgtwr8agwpYGBhECDkkfy65+PNeZW=1XqqDkH7NSbmRFJPCg@mail.gmail.com>
Message-ID: <54C23B28-40A6-4965-BEFA-522B86CDAA5D@lmi.net>

Hi Jia,

There was a bug in the recently-added reciprocity calculation in dctimestep, which I hope I have now corrected.  Please try this again with the copy of dctimestep.c from the current HEAD.

Thanks for pointing out the problem.

Best,
-Greg

> From: Jia Hu <hujia06 at gmail.com>
> Date: October 22, 2012 10:28:52 AM PDT
> 
> Hi Andy:
> 
> Yes. But currently the fact is that if the back transmission data is missing, the results are zero even if there are front transmission data. That is why I am confused.
> 
> Thanks,
> 
> Jia
> 
> On Mon, Oct 22, 2012 at 12:50 PM, Andrew McNeil <amcneil at lbl.gov> wrote:
> dctimestep originally used just the front transmission data, and if front transmission data were missing the result was zero.  I think Greg has recently made changes so that it can us back transmission too.  Try with the HEAD.
> 
> Andy
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121023/57373eb7/attachment.html>

From hujia06 at gmail.com  Tue Oct 23 20:45:32 2012
From: hujia06 at gmail.com (Jia Hu)
Date: Tue, 23 Oct 2012 23:45:32 -0400
Subject: [Radiance-general] possible inconsistency of bin numbers
 between BSDF and kelms_int.cal
In-Reply-To: <54C23B28-40A6-4965-BEFA-522B86CDAA5D@lmi.net>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
	<CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>
	<CABzgtwp0nzUTB0zdaW96WdGwOhcy3Ay-+5z572UAbV_T+gBX4g@mail.gmail.com>
	<CAOG+NiwbriQ-qA+8hPy0CQxxUQhhACimqCAUbU0=839iua4X-Q@mail.gmail.com>
	<CABzgtwr8agwpYGBhECDkkfy65+PNeZW=1XqqDkH7NSbmRFJPCg@mail.gmail.com>
	<54C23B28-40A6-4965-BEFA-522B86CDAA5D@lmi.net>
Message-ID: <CABzgtwos31=JmxnwaHa=O6CYaJYk61R+0w0ZJgOURxRmxM74JQ@mail.gmail.com>

Hi Greg,

Thanks for your updating! I looked at the code, which seems to prefer
"Front Transmission" (WINDOW 6 convention) data and if it is NULL, then the
back transmission data will be used?

Thank you !

Jia

On Tue, Oct 23, 2012 at 6:28 PM, Greg Ward <gregoryjward at gmail.com> wrote:

> Hi Jia,
>
> There was a bug in the recently-added reciprocity calculation in
> dctimestep, which I hope I have now corrected.  Please try this again with
> the copy of dctimestep.c from the current HEAD.
>
> Thanks for pointing out the problem.
>
> Best,
> -Greg
>
> *From: *Jia Hu <hujia06 at gmail.com>
>
> *Date: *October 22, 2012 10:28:52 AM PDT
>
> *
> *
>
> Hi Andy:
>
> Yes. But currently the fact is that if the back transmission data is
> missing, the results are zero even if there are front transmission data.
> That is why I am confused.
>
> Thanks,
>
> Jia
>
> On Mon, Oct 22, 2012 at 12:50 PM, Andrew McNeil <amcneil at lbl.gov> wrote:
>
>> dctimestep originally used just the front transmission data, and if front
>> transmission data were missing the result was zero.  I think Greg has
>> recently made changes so that it can us back transmission too.  Try with
>> the HEAD.
>>
>> Andy
>>
>>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121023/05b01a6b/attachment.html>

From gregoryjward at gmail.com  Tue Oct 23 20:57:04 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Tue, 23 Oct 2012 20:57:04 -0700
Subject: [Radiance-general] possible inconsistency of bin numbers
	between BSDF and kelms_int.cal
In-Reply-To: <CABzgtwos31=JmxnwaHa=O6CYaJYk61R+0w0ZJgOURxRmxM74JQ@mail.gmail.com>
References: <CABzgtwpW5PoM5-QNh0SE-2MhT5__cs5X3BCrPivKvyzU7mQXiQ@mail.gmail.com>
	<CABzgtwq1WwQ8zXaND6O8=3A3p3AnWc1i1dEAuDcmRr5DgK9WiQ@mail.gmail.com>
	<CABzgtwp0nzUTB0zdaW96WdGwOhcy3Ay-+5z572UAbV_T+gBX4g@mail.gmail.com>
	<CAOG+NiwbriQ-qA+8hPy0CQxxUQhhACimqCAUbU0=839iua4X-Q@mail.gmail.com>
	<CABzgtwr8agwpYGBhECDkkfy65+PNeZW=1XqqDkH7NSbmRFJPCg@mail.gmail.com>
	<54C23B28-40A6-4965-BEFA-522B86CDAA5D@lmi.net>
	<CABzgtwos31=JmxnwaHa=O6CYaJYk61R+0w0ZJgOURxRmxM74JQ@mail.gmail.com>
Message-ID: <F47728C6-0B67-403C-82ED-1E42DE831646@lmi.net>

Yes, that's correct.  Reciprocity means that you can reverse the direction for a BTDF if you manage all of the angles correctly, which I wasn't doing before.

Cheers,
-Greg

> From: Jia Hu <hujia06 at gmail.com>
> Date: October 23, 2012 8:45:32 PM PDT
> 
> Hi Greg, 
> 
> Thanks for your updating! I looked at the code, which seems to prefer "Front Transmission" (WINDOW 6 convention) data and if it is NULL, then the back transmission data will be used? 
> 
> Thank you !
> 
> Jia
> 
> On Tue, Oct 23, 2012 at 6:28 PM, Greg Ward <gregoryjward at gmail.com> wrote:
> Hi Jia,
> 
> There was a bug in the recently-added reciprocity calculation in dctimestep, which I hope I have now corrected.  Please try this again with the copy of dctimestep.c from the current HEAD.
> 
> Thanks for pointing out the problem.
> 
> Best,
> -Greg
> 
>> From: Jia Hu <hujia06 at gmail.com>
>> Date: October 22, 2012 10:28:52 AM PDT
>> 
>> Hi Andy:
>> 
>> Yes. But currently the fact is that if the back transmission data is missing, the results are zero even if there are front transmission data. That is why I am confused.
>> 
>> Thanks,
>> 
>> Jia
>> 
>> On Mon, Oct 22, 2012 at 12:50 PM, Andrew McNeil <amcneil at lbl.gov> wrote:
>> dctimestep originally used just the front transmission data, and if front transmission data were missing the result was zero.  I think Greg has recently made changes so that it can us back transmission too.  Try with the HEAD.
>> 
>> Andy
>> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121023/4bd0cf17/attachment.html>

From hope.zh at gmail.com  Wed Oct 24 19:52:41 2012
From: hope.zh at gmail.com (Ji Zhang)
Date: Thu, 25 Oct 2012 10:52:41 +0800
Subject: [Radiance-general] sky visibility
In-Reply-To: <845F404E-414E-49AC-BD4E-BF707FF4AFE7@gmx.net>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<508407FC.8040408@gmx.net>
	<CAD83LVLba8_qYttjoM2f=2E6SJBhx5o4CJXqePuH6nozhfkJkQ@mail.gmail.com>
	<845F404E-414E-49AC-BD4E-BF707FF4AFE7@gmx.net>
Message-ID: <CAD83LV+wVgcY-bg_z-g4-LDbqVZJbpYKq-VdNm0xgz28L76O3Q@mail.gmail.com>

Hi, Lars, thanks a lot for your advices!

May I ask the references on the S and T function as you suggested to look
up? (I didn't find any relevant infor via Radiance forum search...)

May I also ask what the "n" in the "S(n)" denotes?

Thanks again!

- Cheers, Ji


On Tue, Oct 23, 2012 at 4:40 PM, Lars O. Grobe <grobe at gmx.net> wrote:

> Hi Ji Zhang!
>
> > vwrays -fd -vf ./view_vta.vf -x 800 -y 800 | rtrace -av 1 1 1 -w -h -fda
> -opdv ./scene1.oct > ./zzz_vta_pts_P_N_v_1.txt
> > vwrays -fd -vf ./view_vta.vf -x 800 -y 800 | rtrace -av 1 1 1 -w -h -fda
> -opdv ./scene1.oct | rcalc -e '$1=if($7,1,0); $2=1' | total >
> ./zzz_vta_pts_total_1.txt
>
> The problem here probably is, that your fisheye view -vta produces pixel
> values outside the circular image you would expect. These get counted in
> the total number of pixels. So if you are using -vta, you need  way to
> filter pixels lying outside the circle. Several approaches to do so come to
> my mind. A generic one is:
>
> 1) vwrays -vta into a scene consisting only of a source, corresponding to
> the hemisphere you want to sample
> 2) pipe the output to rtrace, check for intersections with the source and
> get origin and direction vectors
> 3) pipe that into rtrace again, this time checking for your pixel values
> as above...
>
> Still, there is a problem with the -vta (equiangular) fisheye not being a
> equisolid fisheye, so pixels do not represent equal solid angles.... for
> sky view factors, that is what you would want, but for your definition, you
> want the ration (solid angle visible sky) / (solid angle sky without
> obstructions). So either calculate the solid angle of the pixel depending
> on the distance from view centre, or go with rpict, create a fisheye image
> (-vta), and use the S and T functions to filter pixels outside the view and
> to weigh pixels by their solid angle. So in above commands, you would not
> set the pixel value to 0 or 1, but to 0 or S(n).
>
> Again, I could not try out all this and send a complete example, just
> trying to point you to some direction.
>
> Cheers, Lars.
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121025/720f23ff/attachment.html>

From grobe at gmx.net  Thu Oct 25 01:20:54 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Thu, 25 Oct 2012 10:20:54 +0200
Subject: [Radiance-general] sky visibility
In-Reply-To: <CAD83LV+wVgcY-bg_z-g4-LDbqVZJbpYKq-VdNm0xgz28L76O3Q@mail.gmail.com>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<508407FC.8040408@gmx.net>
	<CAD83LVLba8_qYttjoM2f=2E6SJBhx5o4CJXqePuH6nozhfkJkQ@mail.gmail.com>
	<845F404E-414E-49AC-BD4E-BF707FF4AFE7@gmx.net>
	<CAD83LV+wVgcY-bg_z-g4-LDbqVZJbpYKq-VdNm0xgz28L76O3Q@mail.gmail.com>
Message-ID: <682DD22B-D108-4D5C-8C05-A99EFB2265E3@gmx.net>

Hi Ji!

The functions S(n) and T(n) are available in pcomb. To make an image "solid_angles.hdr" with pixel values (r=g=b) being equal to the solid angle of the pixel in sr, you would do the following:

cat image.hdr |  pcomb -e 'omega=S(1); ro=omega; go=omega; bo=omega' -o - > solid_angles.hdr

So S(n) gives, for each pixel of the n'th input image, its solid angle. To take a look, use falsecolor -m 1 -s .000008 -ip solidangle.hdr | ximage - good way to think about projections...

Cheers, Lars.


> Hi, Lars, thanks a lot for your advices!
> 
> May I ask the references on the S and T function as you suggested to look up? (I didn't find any relevant infor via Radiance forum search...)
> 
> May I also ask what the "n" in the "S(n)" denotes? 
> 
> Thanks again!
> 
> - Cheers, Ji



From hope.zh at gmail.com  Thu Oct 25 11:11:58 2012
From: hope.zh at gmail.com (Ji Zhang)
Date: Fri, 26 Oct 2012 02:11:58 +0800
Subject: [Radiance-general] sky visibility
In-Reply-To: <682DD22B-D108-4D5C-8C05-A99EFB2265E3@gmx.net>
References: <CAMxTbri9-2+CYCjBe0O80GN9NDWvhnsWT=TTheAKi96faYM-uA@mail.gmail.com>
	<50825B2F.7040505@gmx.net>
	<CAD83LVKQ97JZoyCnB=jvPqJUyENxdhtUhxV7UWSbv6yjCrkJww@mail.gmail.com>
	<508407FC.8040408@gmx.net>
	<CAD83LVLba8_qYttjoM2f=2E6SJBhx5o4CJXqePuH6nozhfkJkQ@mail.gmail.com>
	<845F404E-414E-49AC-BD4E-BF707FF4AFE7@gmx.net>
	<CAD83LV+wVgcY-bg_z-g4-LDbqVZJbpYKq-VdNm0xgz28L76O3Q@mail.gmail.com>
	<682DD22B-D108-4D5C-8C05-A99EFB2265E3@gmx.net>
Message-ID: <CAD83LV+zPYd4NFgBgyvR3hnb8dngve9ZzeVfMf8JhHwDhzabow@mail.gmail.com>

Hi, Lars, Thanks for your detailed explanation!

The following bash script is put up according to the suggestions from all
previous replies to this post. This method is view type independent.
Anyway, I'd appreciate further advices from the list to make it more
succinct and efficient, or point out the loopholes if there are any.

# start__________________________
# calculate Sky Exposure Factor
# which is defined as the ratio between
# the solid angle subtended by visible sky patch/patches
# and that of the unobstructed sky hemisphere (which is 2*PI)
oconv ./plastic_mat.rad ./geom.rad > ./SkyEF_scene.oct
rpict -av 1 1 1 -vf ./view_vts.vf -x 1000 -y 1000 ./SkyEF_scene.oct | pcomb
-e 'solidAngle=S(1);ro=if(ri(1),0,solidAngle); go=if(gi(1),0,solidAngle);
bo=if(bi(1),0,solidAngle)' -o - | pvalue -h -H | rcalc -e '$1=$3' | total |
rcalc -e '$1=$1/2/PI' > ./SkyEF_results.txt
# end__________________________

The contents of "view_vts.vf" (note that the location of the view point is
slightly away from the surface of the scene geometry):
rvu -vts -vp 0 0 0.001 -vd 0 0 1 -vu 0 1 0 -vh 180 -vv 180 -vo 0 -va 0 -vs
0 -vl 0


The following step-by-step break down of the commands might be useful for
debugging purpose.

# start__________________________
oconv ./plastic_mat.rad ./geom.rad > ./SkyEF_scene.oct

rpict -av 1 1 1 -vf ./view_vts.vf -x 800 -y 800 ./SkyEF_scene.oct >
./SkyEF_vts.hdr

cat ./SkyEF_vts.hdr | pcomb -e 'omega=S(1);ro=if(ri(1),0,omega);
go=if(gi(1),0,omega); bo=if(bi(1),0,omega)' -o - > ./SkyEF_solidAngle.hdr

cat ./SkyEF_solidAngle.hdr | pvalue -h -H >
./SkyEF_xpos_ypos_solidAngleVal.txt

cat ./SkyEF_xpos_ypos_solidAngleVal.txt | rcalc -e '$1=$3' | total >
./SkyEF_total_solidAngle_of_visible_sky.txt

cat ./SkyEF_total_solidAngle_of_visible_sky.txt | rcalc -e '$1=$1/2/PI' >
./SkyEF_results.txt
# end__________________________


Thanks again for the help from all of you!
- Ji


On Thu, Oct 25, 2012 at 4:20 PM, Lars O. Grobe <grobe at gmx.net> wrote:

> Hi Ji!
>
> The functions S(n) and T(n) are available in pcomb. To make an image
> "solid_angles.hdr" with pixel values (r=g=b) being equal to the solid angle
> of the pixel in sr, you would do the following:
>
> cat image.hdr |  pcomb -e 'omega=S(1); ro=omega; go=omega; bo=omega' -o -
> > solid_angles.hdr
>
> So S(n) gives, for each pixel of the n'th input image, its solid angle. To
> take a look, use falsecolor -m 1 -s .000008 -ip solidangle.hdr | ximage -
> good way to think about projections...
>
> Cheers, Lars.
>
>
> > Hi, Lars, thanks a lot for your advices!
> >
> > May I ask the references on the S and T function as you suggested to
> look up? (I didn't find any relevant infor via Radiance forum search...)
> >
> > May I also ask what the "n" in the "S(n)" denotes?
> >
> > Thanks again!
> >
> > - Cheers, Ji
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121026/b2e319fc/attachment.html>

From nynassif at gmail.com  Fri Oct 26 00:18:46 2012
From: nynassif at gmail.com (nassif nassif)
Date: Fri, 26 Oct 2012 09:18:46 +0200
Subject: [Radiance-general] 6 - Photon-Mapping
Message-ID: <CAOQvQdkzoM30ajGB7p6yuTR07S=tLoaOEzcoAwMmo-Ca4OZ-PA@mail.gmail.com>

Hallo Lars,

Thanks a lot for your reply, but unfortunately i was not able to work on
it. my administrator (who does the instlalation for us  told me that it
might not work on Radiance version 4.2a; is it true? if yes which version
of radiance i should work with?

thanks a lot again!

- Nassif




On Mon, Oct 8, 2012 at 1:05 PM, <
radiance-general-request at radiance-online.org> wrote:

> Send Radiance-general mailing list submissions to
>         radiance-general at radiance-online.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://www.radiance-online.org/mailman/listinfo/radiance-general
> or, via email, send a message with subject or body 'help' to
>         radiance-general-request at radiance-online.org
>
> You can reach the person managing the list at
>         radiance-general-owner at radiance-online.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Radiance-general digest..."
>
>
> Today's Topics:
>
>    1. weather data in radiance (shailan zareiy)
>    2. Monte Carlo sampling setting (Iebele)
>    3. Re: Monte Carlo sampling setting (Greg Ward)
>    4. Re: weather data in radiance (Greg Ward)
>    5. Re: weather data in radiance (Lars O. Grobe)
>    6. photomapping example (nassif nassif)
>    7. Re: photomapping example (Lars O. Grobe)
>    8. Re: weather data in radiance (shailan zareiy)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Sun, 7 Oct 2012 23:48:08 +0330
> From: shailan zareiy <sh.zareiy at gmail.com>
> To: radiance-general at radiance-online.org
> Subject: [Radiance-general] weather data in radiance
> Message-ID:
>         <CABNGNZJpYU6r+=
> 8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw at mail.gmail.com>
> Content-Type: text/plain; charset="iso-8859-1"
>
> dear all
> hi,i have a question about the weather data in radiance simulation. i want
> to know which items of weather data is used in a daylight simulation by the
> radiance software.
> thanks for your help
> Sincerely
> Shailan Zareiy
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://www.radiance-online.org/pipermail/radiance-general/attachments/20121007/ed3ef03f/attachment-0001.html
> >
>
> ------------------------------
>
> Message: 2
> Date: Sun, 7 Oct 2012 23:57:38 +0300
> From: Iebele <iabel at iebele.nl>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: [Radiance-general] Monte Carlo sampling setting
> Message-ID: <DF1DA428-C7A0-40B8-8924-B92B62411DDB at iebele.nl>
> Content-Type: text/plain; charset=windows-1252
>
> Hi Greg,
>
> I need a test with true Monte Carlo sampling (in the contrary as many
> earlier requests, I need as much variance in different runs of rpiece as
> possible).
> I assume rpiece takes the same default values as rpict (?)
>
> "rpict -defaults" gives:
>
> -u-  # correlated quasi-Monte Carlo sampling
>
> It is not clear to me how to set true Monte Carlo sampling on.
>
> -u+ ?
>
> Cheers,
>
> - iebele
>
>
>
>
>
>
>
> ------------------------------
>
> Message: 3
> Date: Sun, 7 Oct 2012 14:42:20 -0700
> From: Greg Ward <gregoryjward at gmail.com>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] Monte Carlo sampling setting
> Message-ID: <BCF5B7A0-C3AC-413B-BAFB-86B0FDC651A1 at lmi.net>
> Content-Type: text/plain; charset=us-ascii
>
> Yes and yes.  You can use the -u+ option in rpiece, along with all the
> other rpict options.  I recommend setting "-ps 1" as well for pure MC.
>
> -Greg
>
> > From: Iebele <iabel at iebele.nl>
> > Date: October 7, 2012 1:57:38 PM PDT
> >
> > Hi Greg,
> >
> > I need a test with true Monte Carlo sampling (in the contrary as many
> earlier requests, I need as much variance in different runs of rpiece as
> possible).
> > I assume rpiece takes the same default values as rpict (?)
> >
> > "rpict -defaults" gives:
> >
> > -u-  # correlated quasi-Monte Carlo sampling
> >
> > It is not clear to me how to set true Monte Carlo sampling on.
> >
> > -u+ ?
> >
> > Cheers,
> >
> > - iebele
>
>
>
> ------------------------------
>
> Message: 4
> Date: Sun, 7 Oct 2012 14:44:20 -0700
> From: Greg Ward <gregoryjward at gmail.com>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] weather data in radiance
> Message-ID: <76D314B2-66B7-442A-A52F-ED940AB8E982 at lmi.net>
> Content-Type: text/plain; charset="us-ascii"
>
> Radiance doesn't take weather data directly.  The gensky and gendaylit
> programs in Radiance can use some information from weather tapes to adjust
> their sky models, but there aren't any built-in utilities to handle weather
> tapes.
>
> Daysim does have such utilities, and we are hoping to add some facilities
> in the next year or so.
>
> -Greg
>
> > From: shailan zareiy <sh.zareiy at gmail.com>
> > Date: October 7, 2012 1:18:08 PM PDT
> >
> > dear all
> > hi,i have a question about the weather data in radiance simulation. i
> want to know which items of weather data is used in a daylight simulation
> by the radiance software.
> > thanks for your help
> > Sincerely
> > Shailan Zareiy
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://www.radiance-online.org/pipermail/radiance-general/attachments/20121007/d025d3ce/attachment-0001.html
> >
>
> ------------------------------
>
> Message: 5
> Date: Mon, 08 Oct 2012 11:32:17 +0200
> From: "Lars O. Grobe" <grobe at gmx.net>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] weather data in radiance
> Message-ID: <50729DA1.2030803 at gmx.net>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> Hi,
>
> just one hint - if you need to process weather data, tr (to replace
> separators) and awk (to select and reformat fields of records) will be
> helpful to load the relevant fields into gendaylit. Both are standard
> tools in any Unix-like system, includig Mac OS X and Linux.
>
> Cheers, Lars.
>
>
>
> ------------------------------
>
> Message: 6
> Date: Mon, 8 Oct 2012 12:22:03 +0200
> From: nassif nassif <nynassif at gmail.com>
> To: radiance-general at radiance-online.org
> Subject: [Radiance-general] photomapping example
> Message-ID:
>         <CAOQvQd=
> Xv2i14tda4O6AYNbQ7h5ZUEd5WjkQr_u0mdPVde_OHw at mail.gmail.com>
> Content-Type: text/plain; charset="iso-8859-1"
>
> hallo people,
>
> I am planning to simulate a simple geometry using photomapping.
>
> Is there any simple script of how photo-mapping works? my aim is to check
> the output for different material (glass, prism, trans...) feeded with a
> narrow beam Fixture which results different outputs.
>
> thanks in advance!
>
> --
> *N.Nassif
>
> Lighting Designer***
> *PLDA Member
>
> Neue Str. 55
> 21073, Hamburg
> Deutschland
>
> +49 162 6050060
> nynassif at gmail.com*
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://www.radiance-online.org/pipermail/radiance-general/attachments/20121008/efd6b2fc/attachment-0001.html
> >
>
> ------------------------------
>
> Message: 7
> Date: Mon, 08 Oct 2012 12:43:47 +0200
> From: "Lars O. Grobe" <grobe at gmx.net>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] photomapping example
> Message-ID: <5072AE63.2030702 at gmx.net>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> Hi Nassif!
> > I am planning to simulate a simple geometry using photomapping.
> >
> > Is there any simple script of how photo-mapping works? my aim is to
> > check the output for different material (glass, prism, trans...)
> > feeded with a narrow beam Fixture which results different outputs.
> Start with Roland's documentation of the pmap extension for Radiance. It
> explains most. Especially look for the supported / unsupported
> primitives. Than, vary the number of photon in the distribution pass
> (try up to 2,000,000 photons) and the bandwith in the photon gather
> pass. Basically, pmap is not too different from using Radiance, you just
> create the photon maps with mkpmap first and use them instead of the
> ambient calculation in rpcit / rtrace. Don't forget to manually delete
> the photon maps, they are not overwritten by mkpmap (adding a --force /
> -f option for overwriting would be a useful add-on...).
>
> I showed some examples at a presentation two years ago:
>
> http://www.radiance-online.org/community/workshops/2010-freiburg/PDF/PmapAppsPresentation-20100922.pdf
>
> There are several presentations on the pmap around for the recent
> workshops, all available at radiance-online.org.
>
> Cheers, Lars.
>
>
>
> ------------------------------
>
> Message: 8
> Date: Mon, 8 Oct 2012 14:35:05 +0330
> From: shailan zareiy <sh.zareiy at gmail.com>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] weather data in radiance
> Message-ID:
>         <CABNGNZLR2ijk_iLmzJjOHLoWG2=
> 8ipuzfv7HxXuvYiwBWbF+Uw at mail.gmail.com>
> Content-Type: text/plain; charset="iso-8859-1"
>
> so you mean that radiance extracts the sky conditions such as sky clearness
> from the weather data not just altitude and longitude of the city?
>
> On Mon, Oct 8, 2012 at 1:14 AM, Greg Ward <gregoryjward at gmail.com> wrote:
>
> >  Radiance doesn't take weather data directly.  The gensky and gendaylit
> > programs in Radiance can use some information from weather tapes to
> adjust
> > their sky models, but there aren't any built-in utilities to handle
> weather
> > tapes.
> >
> > Daysim does have such utilities, and we are hoping to add some facilities
> > in the next year or so.
> >
> > -Greg
> >
> >  *From: *shailan zareiy <sh.zareiy at gmail.com>
> >
> > *Date: *October 7, 2012 1:18:08 PM PDT
> >
> > *
> > *
> >
> >  dear all
> > hi,i have a question about the weather data in radiance simulation. i
> want
> > to know which items of weather data is used in a daylight simulation by
> the
> > radiance software.
> > thanks for your help
> > Sincerely
> > Shailan Zareiy
> >
> >
> > _______________________________________________
> > Radiance-general mailing list
> > Radiance-general at radiance-online.org
> > http://www.radiance-online.org/mailman/listinfo/radiance-general
> >
> >
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://www.radiance-online.org/pipermail/radiance-general/attachments/20121008/3c12fad9/attachment.html
> >
>
> ------------------------------
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
> End of Radiance-general Digest, Vol 104, Issue 6
> ************************************************
>



-- 
*N.Nassif

Lighting Designer***
*PLDA Member

Neue Str. 55
21073, Hamburg
Deutschland

+49 162 6050060
nynassif at gmail.com*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121026/ecf4e2b0/attachment-0001.html>

From grobe at gmx.net  Sat Oct 27 14:59:04 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Sat, 27 Oct 2012 23:59:04 +0200
Subject: [Radiance-general] 6 - Photon-Mapping
In-Reply-To: <CAOQvQdkzoM30ajGB7p6yuTR07S=tLoaOEzcoAwMmo-Ca4OZ-PA@mail.gmail.com>
References: <CAOQvQdkzoM30ajGB7p6yuTR07S=tLoaOEzcoAwMmo-Ca4OZ-PA@mail.gmail.com>
Message-ID: <69E8FCC6-70D4-4B9A-807F-2A65C8F79DF5@gmx.net>

Hi,

at the moment, you can download only the old 3.7 release, but the pmap has been ported to current releases. Not sure when it will be public available.. Do you need a supported release?

Cheers, Lars.

--
Dipl.-Ing. Architect Lars O. Grobe

On Oct 26, 2012, at 9:18, nassif nassif <nynassif at gmail.com> wrote:

> Hallo Lars,
> 
> Thanks a lot for your reply, but unfortunately i was not able to work on it. my administrator (who does the instlalation for us  told me that it might not work on Radiance version 4.2a; is it true? if yes which version of radiance i should work with?
> 
> thanks a lot again!
> 
> - Nassif
> 
> 
> 
> 
> On Mon, Oct 8, 2012 at 1:05 PM, <radiance-general-request at radiance-online.org> wrote:
> Send Radiance-general mailing list submissions to
>         radiance-general at radiance-online.org
> 
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://www.radiance-online.org/mailman/listinfo/radiance-general
> or, via email, send a message with subject or body 'help' to
>         radiance-general-request at radiance-online.org
> 
> You can reach the person managing the list at
>         radiance-general-owner at radiance-online.org
> 
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Radiance-general digest..."
> 
> 
> Today's Topics:
> 
>    1. weather data in radiance (shailan zareiy)
>    2. Monte Carlo sampling setting (Iebele)
>    3. Re: Monte Carlo sampling setting (Greg Ward)
>    4. Re: weather data in radiance (Greg Ward)
>    5. Re: weather data in radiance (Lars O. Grobe)
>    6. photomapping example (nassif nassif)
>    7. Re: photomapping example (Lars O. Grobe)
>    8. Re: weather data in radiance (shailan zareiy)
> 
> 
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Sun, 7 Oct 2012 23:48:08 +0330
> From: shailan zareiy <sh.zareiy at gmail.com>
> To: radiance-general at radiance-online.org
> Subject: [Radiance-general] weather data in radiance
> Message-ID:
>         <CABNGNZJpYU6r+=8OLKkEvrsVPGLxtdxWH7xQbPj7oU5ganX0Jw at mail.gmail.com>
> Content-Type: text/plain; charset="iso-8859-1"
> 
> dear all
> hi,i have a question about the weather data in radiance simulation. i want
> to know which items of weather data is used in a daylight simulation by the
> radiance software.
> thanks for your help
> Sincerely
> Shailan Zareiy
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121007/ed3ef03f/attachment-0001.html>
> 
> ------------------------------
> 
> Message: 2
> Date: Sun, 7 Oct 2012 23:57:38 +0300
> From: Iebele <iabel at iebele.nl>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: [Radiance-general] Monte Carlo sampling setting
> Message-ID: <DF1DA428-C7A0-40B8-8924-B92B62411DDB at iebele.nl>
> Content-Type: text/plain; charset=windows-1252
> 
> Hi Greg,
> 
> I need a test with true Monte Carlo sampling (in the contrary as many earlier requests, I need as much variance in different runs of rpiece as possible).
> I assume rpiece takes the same default values as rpict (?)
> 
> "rpict -defaults" gives:
> 
> -u-  # correlated quasi-Monte Carlo sampling
> 
> It is not clear to me how to set true Monte Carlo sampling on.
> 
> -u+ ?
> 
> Cheers,
> 
> - iebele
> 
> 
> 
> 
> 
> 
> 
> ------------------------------
> 
> Message: 3
> Date: Sun, 7 Oct 2012 14:42:20 -0700
> From: Greg Ward <gregoryjward at gmail.com>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] Monte Carlo sampling setting
> Message-ID: <BCF5B7A0-C3AC-413B-BAFB-86B0FDC651A1 at lmi.net>
> Content-Type: text/plain; charset=us-ascii
> 
> Yes and yes.  You can use the -u+ option in rpiece, along with all the other rpict options.  I recommend setting "-ps 1" as well for pure MC.
> 
> -Greg
> 
> > From: Iebele <iabel at iebele.nl>
> > Date: October 7, 2012 1:57:38 PM PDT
> >
> > Hi Greg,
> >
> > I need a test with true Monte Carlo sampling (in the contrary as many earlier requests, I need as much variance in different runs of rpiece as possible).
> > I assume rpiece takes the same default values as rpict (?)
> >
> > "rpict -defaults" gives:
> >
> > -u-  # correlated quasi-Monte Carlo sampling
> >
> > It is not clear to me how to set true Monte Carlo sampling on.
> >
> > -u+ ?
> >
> > Cheers,
> >
> > - iebele
> 
> 
> 
> ------------------------------
> 
> Message: 4
> Date: Sun, 7 Oct 2012 14:44:20 -0700
> From: Greg Ward <gregoryjward at gmail.com>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] weather data in radiance
> Message-ID: <76D314B2-66B7-442A-A52F-ED940AB8E982 at lmi.net>
> Content-Type: text/plain; charset="us-ascii"
> 
> Radiance doesn't take weather data directly.  The gensky and gendaylit programs in Radiance can use some information from weather tapes to adjust their sky models, but there aren't any built-in utilities to handle weather tapes.
> 
> Daysim does have such utilities, and we are hoping to add some facilities in the next year or so.
> 
> -Greg
> 
> > From: shailan zareiy <sh.zareiy at gmail.com>
> > Date: October 7, 2012 1:18:08 PM PDT
> >
> > dear all
> > hi,i have a question about the weather data in radiance simulation. i want to know which items of weather data is used in a daylight simulation by the radiance software.
> > thanks for your help
> > Sincerely
> > Shailan Zareiy
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121007/d025d3ce/attachment-0001.html>
> 
> ------------------------------
> 
> Message: 5
> Date: Mon, 08 Oct 2012 11:32:17 +0200
> From: "Lars O. Grobe" <grobe at gmx.net>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] weather data in radiance
> Message-ID: <50729DA1.2030803 at gmx.net>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Hi,
> 
> just one hint - if you need to process weather data, tr (to replace
> separators) and awk (to select and reformat fields of records) will be
> helpful to load the relevant fields into gendaylit. Both are standard
> tools in any Unix-like system, includig Mac OS X and Linux.
> 
> Cheers, Lars.
> 
> 
> 
> ------------------------------
> 
> Message: 6
> Date: Mon, 8 Oct 2012 12:22:03 +0200
> From: nassif nassif <nynassif at gmail.com>
> To: radiance-general at radiance-online.org
> Subject: [Radiance-general] photomapping example
> Message-ID:
>         <CAOQvQd=Xv2i14tda4O6AYNbQ7h5ZUEd5WjkQr_u0mdPVde_OHw at mail.gmail.com>
> Content-Type: text/plain; charset="iso-8859-1"
> 
> hallo people,
> 
> I am planning to simulate a simple geometry using photomapping.
> 
> Is there any simple script of how photo-mapping works? my aim is to check
> the output for different material (glass, prism, trans...) feeded with a
> narrow beam Fixture which results different outputs.
> 
> thanks in advance!
> 
> --
> *N.Nassif
> 
> Lighting Designer***
> *PLDA Member
> 
> Neue Str. 55
> 21073, Hamburg
> Deutschland
> 
> +49 162 6050060
> nynassif at gmail.com*
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121008/efd6b2fc/attachment-0001.html>
> 
> ------------------------------
> 
> Message: 7
> Date: Mon, 08 Oct 2012 12:43:47 +0200
> From: "Lars O. Grobe" <grobe at gmx.net>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] photomapping example
> Message-ID: <5072AE63.2030702 at gmx.net>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Hi Nassif!
> > I am planning to simulate a simple geometry using photomapping.
> >
> > Is there any simple script of how photo-mapping works? my aim is to
> > check the output for different material (glass, prism, trans...)
> > feeded with a narrow beam Fixture which results different outputs.
> Start with Roland's documentation of the pmap extension for Radiance. It
> explains most. Especially look for the supported / unsupported
> primitives. Than, vary the number of photon in the distribution pass
> (try up to 2,000,000 photons) and the bandwith in the photon gather
> pass. Basically, pmap is not too different from using Radiance, you just
> create the photon maps with mkpmap first and use them instead of the
> ambient calculation in rpcit / rtrace. Don't forget to manually delete
> the photon maps, they are not overwritten by mkpmap (adding a --force /
> -f option for overwriting would be a useful add-on...).
> 
> I showed some examples at a presentation two years ago:
> http://www.radiance-online.org/community/workshops/2010-freiburg/PDF/PmapAppsPresentation-20100922.pdf
> 
> There are several presentations on the pmap around for the recent
> workshops, all available at radiance-online.org.
> 
> Cheers, Lars.
> 
> 
> 
> ------------------------------
> 
> Message: 8
> Date: Mon, 8 Oct 2012 14:35:05 +0330
> From: shailan zareiy <sh.zareiy at gmail.com>
> To: Radiance general discussion <radiance-general at radiance-online.org>
> Subject: Re: [Radiance-general] weather data in radiance
> Message-ID:
>         <CABNGNZLR2ijk_iLmzJjOHLoWG2=8ipuzfv7HxXuvYiwBWbF+Uw at mail.gmail.com>
> Content-Type: text/plain; charset="iso-8859-1"
> 
> so you mean that radiance extracts the sky conditions such as sky clearness
> from the weather data not just altitude and longitude of the city?
> 
> On Mon, Oct 8, 2012 at 1:14 AM, Greg Ward <gregoryjward at gmail.com> wrote:
> 
> >  Radiance doesn't take weather data directly.  The gensky and gendaylit
> > programs in Radiance can use some information from weather tapes to adjust
> > their sky models, but there aren't any built-in utilities to handle weather
> > tapes.
> >
> > Daysim does have such utilities, and we are hoping to add some facilities
> > in the next year or so.
> >
> > -Greg
> >
> >  *From: *shailan zareiy <sh.zareiy at gmail.com>
> >
> > *Date: *October 7, 2012 1:18:08 PM PDT
> >
> > *
> > *
> >
> >  dear all
> > hi,i have a question about the weather data in radiance simulation. i want
> > to know which items of weather data is used in a daylight simulation by the
> > radiance software.
> > thanks for your help
> > Sincerely
> > Shailan Zareiy
> >
> >
> > _______________________________________________
> > Radiance-general mailing list
> > Radiance-general at radiance-online.org
> > http://www.radiance-online.org/mailman/listinfo/radiance-general
> >
> >
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121008/3c12fad9/attachment.html>
> 
> ------------------------------
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> 
> End of Radiance-general Digest, Vol 104, Issue 6
> ************************************************
> 
> 
> 
> -- 
> N.Nassif
> 
> Lighting Designer
> PLDA Member
> 
> Neue Str. 55
> 21073, Hamburg
> Deutschland
> 
> +49 162 6050060
> nynassif at gmail.com
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121027/7be6979e/attachment-0001.html>

From sh.zareiy at gmail.com  Sat Oct 27 22:07:33 2012
From: sh.zareiy at gmail.com (shailan zareiy)
Date: Sun, 28 Oct 2012 08:37:33 +0330
Subject: [Radiance-general] annual light exposure in daysim
Message-ID: <CABNGNZ+JDdu=zXP3yOeTATAfCKPQ10eeJzH6zFHaXRh7FjcgCg@mail.gmail.com>

dear all
hi,i have a question about annual light exposure in the daysim.dose this
item considers just direct light for its calculation or it take into
account both reflections and direct light? and is this item calculated for
the work hours we give as input to the software,or it is  for all hours of
the day.i couldnt find any thing about this parameter in the daysim
tutorials.
thank you for you help
Sincerely
Shailan ZAreiy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121028/626d14e1/attachment.html>

From gregoryjward at gmail.com  Sun Oct 28 08:34:19 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Sun, 28 Oct 2012 08:34:19 -0700
Subject: [Radiance-general] annual light exposure in daysim
In-Reply-To: <CABNGNZ+JDdu=zXP3yOeTATAfCKPQ10eeJzH6zFHaXRh7FjcgCg@mail.gmail.com>
References: <CABNGNZ+JDdu=zXP3yOeTATAfCKPQ10eeJzH6zFHaXRh7FjcgCg@mail.gmail.com>
Message-ID: <CC324B94-1444-49B6-A5E2-94AFC6FCA2E8@lmi.net>

Hi Shailan,

I don't really have an answer to your question, but I wanted to remind people that we have a new list dedicated to DaySim discussions:

	adiance-daysim at radiance-online.org

You should probably describe to that list, where I have cross-posted your query.

Best,
-Greg

> From: shailan zareiy <sh.zareiy at gmail.com>
> Date: October 27, 2012 10:07:33 PM PDT
> 
> dear all
> hi,i have a question about annual light exposure in the daysim.dose this item considers just direct light for its calculation or it take into account both reflections and direct light? and is this item calculated for the work hours we give as input to the software,or it is  for all hours of the day.i couldnt find any thing about this parameter in the daysim tutorials.
> thank you for you help 
> Sincerely
> Shailan ZAreiy
> 


From sh.zareiy at gmail.com  Mon Oct 29 06:49:22 2012
From: sh.zareiy at gmail.com (shailan zareiy)
Date: Mon, 29 Oct 2012 17:19:22 +0330
Subject: [Radiance-general] annual light exposure in daysim
In-Reply-To: <CC324B94-1444-49B6-A5E2-94AFC6FCA2E8@lmi.net>
References: <CABNGNZ+JDdu=zXP3yOeTATAfCKPQ10eeJzH6zFHaXRh7FjcgCg@mail.gmail.com>
	<CC324B94-1444-49B6-A5E2-94AFC6FCA2E8@lmi.net>
Message-ID: <CABNGNZKHzg9=VFVL7PUMSq+8vyrUBZxfSQ6n-Xrs5WqYqBNKpw@mail.gmail.com>

I really do appreciate your help

On Sun, Oct 28, 2012 at 7:04 PM, Greg Ward <gregoryjward at gmail.com> wrote:

> Hi Shailan,
>
> I don't really have an answer to your question, but I wanted to remind
> people that we have a new list dedicated to DaySim discussions:
>
>         adiance-daysim at radiance-online.org
>
> You should probably describe to that list, where I have cross-posted your
> query.
>
> Best,
> -Greg
>
> > From: shailan zareiy <sh.zareiy at gmail.com>
> > Date: October 27, 2012 10:07:33 PM PDT
> >
> > dear all
> > hi,i have a question about annual light exposure in the daysim.dose this
> item considers just direct light for its calculation or it take into
> account both reflections and direct light? and is this item calculated for
> the work hours we give as input to the software,or it is  for all hours of
> the day.i couldnt find any thing about this parameter in the daysim
> tutorials.
> > thank you for you help
> > Sincerely
> > Shailan ZAreiy
> >
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121029/caac5afa/attachment.html>

From akilian at princeton.edu  Fri Oct 26 10:25:49 2012
From: akilian at princeton.edu (Axel Kilian)
Date: Fri, 26 Oct 2012 17:25:49 -0000
Subject: [Radiance-general] Position for an assistant professor in
 architecture specializing in energy and sustainability
Message-ID: <456408D4D3AC714CB92CBE6420B116B3042129A2@CSGMBX203W.pu.win.princeton.edu>

SoA/ACEE Search Fall 2012
Assistant Professor in Architecture https://jobs.princeton.edu/applicants/jsp/shared/position/JobDetails_css.jsp?postingId=191809

Dear Radiance community,

The School of Architecture (http://soa.princeton.edu/) and the Andlinger Center for Energy and the Environment (http://www.princeton.edu/acee) seek outstanding applicants for a tenure track appointment at the Assistant Professor level effective as early as September 1, 2013.  The search is open to candidates specializing in energy and sustainability, with research areas ranging from energy-efficient building and urban design, from urban planning to typological analysis of buildings, their material constitution and constructive systems.  Potential areas of research and experience include: urban energy consumption, distribution and production; the interplay of energy and water use and distribution; the interactions of cities, climate, and microclimates, including the influence of buildings, parks and infrastructure and their effects on climate change; the geometrical and physical properties of building envelopes and their energy and climatic performance; the integration of passive energy systems into building typologies; the use of geographic information systems, computational modeling and monitoring using fluid dynamics, experimental analysis and sensors, as well as the use of synthetic techniques and methods for the design of a sustainable environment.

The candidate should have a PhD in Architecture, Building Sciences or Technology, or Civil or Mechanical Engineering or related field, demonstrated excellence in academic research, and a strong commitment to teaching and advising undergraduate and graduate students.  Candidates must complete an online faculty application at https://jobs.princeton.edu<https://jobs.princeton.edu/> position # 1200716; curriculum vitae, detailed descriptions of teaching and research interests, reprints of selected publications, and the names and addresses of at least three references should be attached as PDF documents to the on-line application.  Candidates are encouraged to apply before December 1, 2012.  Princeton University is an equal opportunity employer and complies with applicable EEO and affirmative action regulations.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20121026/511d5fc4/attachment.html>

