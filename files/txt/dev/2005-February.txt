From T.McMinn at exchange.curtin.edu.au  Tue Feb  1 08:05:07 2005
From: T.McMinn at exchange.curtin.edu.au (Terrance Mc Minn)
Date: Tue Feb  1 08:05:59 2005
Subject: [Radiance-dev] Missing File getpagesize
Message-ID: <092BF7A1BC389E489A69DC764F23CD87011CD116@exmsp2.perth.ad.curtin.edu.au>

Some of the various platforms still require the getpagesize.o file, yet it
has been removed from the Head and CVS/src/common directories.

See ray/makeall for further details eg: set compat="bmalloc.o erf.o
getpagesize.o"

Regards 

Terry Mc Minn 
Faculty of Built Environment, Art and Design 
Curtin University of Technology 
GPO Box U 1987 
Perth 6845 
Western Australia 
Email: T.Mcminn@curtin.edu.au 
CRICOS Provider Code: 00301J 

From schorsch at schorsch.com  Tue Feb  1 13:33:24 2005
From: schorsch at schorsch.com (Georg Mischler)
Date: Tue Feb  1 13:33:55 2005
Subject: [Radiance-dev] Missing File getpagesize
In-Reply-To: <092BF7A1BC389E489A69DC764F23CD87011CD116@exmsp2.perth.ad.curtin.edu.au>
References: <092BF7A1BC389E489A69DC764F23CD87011CD116@exmsp2.perth.ad.curtin.edu.au>
Message-ID: <Pine.BSF.4.58.0502010724560.58290@emancholl.pair.com>

Terrance Mc Minn wrote:

> Some of the various platforms still require the getpagesize.o file, yet it
> has been removed from the Head and CVS/src/common directories.
>
> See ray/makeall for further details eg: set compat="bmalloc.o erf.o
> getpagesize.o"

I think that's just a case of makeall being out of sync with the
code. Getpagesize() was previously used only in common/malloc.c,
and both files have been retired together.

In other words, you can just remove all instances of malloc.o and
getpagesize.o from your copy of makeall, and everythging should
work fine (*don't* remove bmalloc.o, though). I don't normally
touch the old build system, so I'll leave it to greg to update
the master copy.


-schorsch

-- 
Georg Mischler  --  simulations developer  --  schorsch at schorsch com
+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/

From gregoryjward at gmail.com  Tue Feb  1 17:06:31 2005
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Tue Feb  1 17:07:22 2005
Subject: [Radiance-dev] Missing File getpagesize
In-Reply-To: <Pine.BSF.4.58.0502010724560.58290@emancholl.pair.com>
References: <092BF7A1BC389E489A69DC764F23CD87011CD116@exmsp2.perth.ad.curtin.edu.au>
	<Pine.BSF.4.58.0502010724560.58290@emancholl.pair.com>
Message-ID: <3D4111F6-746B-11D9-854A-00306540F848@gmail.com>

Hi Terry,

Schorsch is right (as usual).  The module is no longer needed, and 
should have been removed from the makeall script.  I have just done so, 
and tomorrow's HEAD should reflect this change.

Thanks for pointing out the error.
-Greg

> From: Georg Mischler <schorsch@schorsch.com>
> Date: February 1, 2005 4:33:24 AM PST
>
> Terrance Mc Minn wrote:
>
>> Some of the various platforms still require the getpagesize.o file, 
>> yet it
>> has been removed from the Head and CVS/src/common directories.
>>
>> See ray/makeall for further details eg: set compat="bmalloc.o erf.o
>> getpagesize.o"
>
> I think that's just a case of makeall being out of sync with the
> code. Getpagesize() was previously used only in common/malloc.c,
> and both files have been retired together.
>
> In other words, you can just remove all instances of malloc.o and
> getpagesize.o from your copy of makeall, and everythging should
> work fine (*don't* remove bmalloc.o, though). I don't normally
> touch the old build system, so I'll leave it to greg to update
> the master copy.
>
> -schorsch


From jedev at visarc.com  Fri Feb  4 17:12:53 2005
From: jedev at visarc.com (Jack de Valpine)
Date: Fri Feb  4 17:13:31 2005
Subject: [Radiance-dev] Re: [Radiance-general] sharing indirect values for
	parallel processing?
In-Reply-To: <Pine.BSF.4.58.0502040950260.51654@emancholl.pair.com>
References: <B5C4B063-7530-11D9-8104-000A959DDB22@gmx.net>	<68bb737584aec2065da1f49db1b02eeb@gmail.com>	<4201F26F.9030809@familyhealth.com.au>	<Pine.BSF.4.58.0502030812560.40694@emancholl.pair.com>	<A746D2F0-76BB-11D9-8D94-000A959DDB22@gmx.net>
	<Pine.BSF.4.58.0502040950260.51654@emancholl.pair.com>
Message-ID: <42039F05.40103@visarc.com>

Hi all interested,

Cross posting to dev as this is probably a more appropriate space for 
this conversation.

OK, let's see who I can irritate the most...

As a refresher, there have been numerous threads on this topic on 
Radiance Dev (in no order other than my searching through my mail):

    * Before we give up on lock files...
    * multiprocessor systems, Radiance and you
    * as well as others if you want to delve in to the depths of the pre
      radiance-online mailing list archives

In general, I recall that there are a couple of directions to go:

    * network filesystem locking - such as NFS or Samba, where we are
      dependant on either the locking mechanism actually working (eg
      NFS) or the filesystem (Samba) being installed
    * client/server - probably more hairy from a implementation
      standpoint as well as from a porting point of view. Although,
      perhaps guaranteeing the best performance for selected os'?

Not to rehash old stuff, but could one of the more knowledgeable 
developers (Greg, Georg, Peter, Carsten...?) give us a refresher on what 
the options are and perhaps some idea of the time that would be needed 
to implement a workings solution? Locking is a recurring problem. It 
would be nice to figure a consensus solution (ie what direction to 
pursue) and then a strategy for implementation (ie resources, person(s), 
money...), so perhaps we as a community could figure out how to move 
this forward (if as always there is enough interest).

I must admit to having run into this wall on a variety of occasions. NFS 
(v3) on linux is "supposed" to lock correctly (sync mode on the 
mount/fstab), as a test there is a test suite from Sun 
(www.connectathon.org) that is supposed to test the nfs server. I 
remember running this test suite in the past and getting positive 
results on linux. Nevertheless, I have found it extremely difficult to 
get working results with a networked image render (eg rpiece distributed 
over multiple cpu nodes). Either there end up being problems with 
ambient values between image cells and/or with locking of the syncfile 
for distributing image cells to different machines. I even implemented a 
client/server in perl at one point to try to fight this problem with the 
syncfile (with partial success as I recall and perhaps more if my time 
would allow). Not to cause offense... But is it possible that the 
locking code in Radiance needs to be checked itself?

In brief follow-up to Lar's comments about openmosix/mosix. As 
understand it the msf filesystem, is supposed to implement locking 
correctly. There are also other more sophisticated network filesystems 
such as GFS (Systina, I think and commercial), OpenGFS and many others. 
However these all require separate special install and perhaps 
modification of the kernel or installation of a modified kernel, and 
there is serious question as too whether these are portable to other 
os's such as MS version whatever (as the main offender of portability).

Note also that I tried openmosix at one point. One problem that I found 
is that if you start multiple large (eg memory size) jobs on the master 
node then this can lead to excessive paging and since the master node 
tries to start the jobs at the same time into its own memory space prior 
to migrating them off to other nodes in the cluster. So if your job 
requires 1 Gig of memory to hold the scene and you want to run 10 jobs 
on 5 dual processor nodes with each node having 2 Gig of memory, if you 
start all the jobs on one node then you are hosed. If you start them on 
individual nodes, then you should be using a different clustering 
solution since this completely negates the value of the migration 
algorithms in openmosix. Now it has been a while since I used OpenMosix, 
so perhaps things are different...

Note also that named pipes do not work (at least back in mid 2003, you 
can see my brief inquiry to the openmosix list and Moshe Bar's even 
briefer reply back in April of 2003) on OpenMosix. So if you want to do 
memory sharing on multiprocessor nodes you have to roll your own batch 
job distributor.

-Jack de Valpine

Georg Mischler wrote:

>Lars O. Grobe wrote:
>
>  
>
>>>The most straightforward solution to our problem would probably
>>>be to use lock files, as Greg suggested in earlier discussions.
>>>Unfortunately nobody has found the time yet to actually implement
>>>that. If anyone wants to volunteer, please move the discussion of
>>>your proposal to the dev-list.
>>>      
>>>
>>Hi,
>>
>>as I won't be able to help on the implementation, I won't bring this to
>>the dev-list for now ;-) However, I guess the only needed feature of
>>the shared fs used is a working byte range locking, right? So I will
>>find out if the fs provided by openmosix (mfs) has this feature, which
>>would make a set of mosix nodes a great radiance installation.
>>    
>>
>
>Ambient files are only written at the end, so file locking
>and byte range locking have the same effect.
>We also need a solution that works on all platforms and on
>all file systems. Requiring third party software just to get
>reliable file sharing is clearly out of the question.
>
>
>-schorsch
>
>  
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://radiance-online.org/pipermail/radiance-dev/attachments/20050204/11a788c3/attachment.html
From gregoryjward at gmail.com  Fri Feb  4 18:54:15 2005
From: gregoryjward at gmail.com (Greg Ward)
Date: Fri Feb  4 18:54:58 2005
Subject: [Radiance-dev] Re: [Radiance-general] sharing indirect values for
	parallel processing?
In-Reply-To: <42039F05.40103@visarc.com>
References: <B5C4B063-7530-11D9-8104-000A959DDB22@gmx.net>	<68bb737584aec2065da1f49db1b02eeb@gmail.com>	<4201F26F.9030809@familyhealth.com.au>	<Pine.BSF.4.58.0502030812560.40694@emancholl.pair.com>	<A746D2F0-76BB-11D9-8D94-000A959DDB22@gmx.net>
	<Pine.BSF.4.58.0502040950260.51654@emancholl.pair.com>
	<42039F05.40103@visarc.com>
Message-ID: <c3017e23e5697bc067bc29a8eaf73e5a@gmail.com>

The locking requirements for Radiance are really quite minimal:

1) One process says in effect, "I need to have exclusive use of this 
file"
2) Said process waits until other processes are done reading (or 
writing) the file.
3) Process gets lock; all other processes unable to read or write the 
file.
4) Process does its thing, releases lock.
5) Life goes on...

Why is this difficult?  Well, it seems that this sort of behavior gets 
in the way of efficient (i.e., cached) network filesystems, so some 
versions of NFS don't bother with it, or do it badly.  Even 
implementing our own lock mechanism via creating a separate file that 
says our ambient file is in use suffers from race conditions.  These 
race conditions have been worked out by the sendmail developers, but 
the solution is quite complicated.  The good news is that it works and 
has been tested on many different Unix implementations.  So, this looks 
like the easiest path to our goal.

My motivation for doing this work is unfortunately low, because I'm 
using FreeBSD and OS X systems with perfectly adequate NFS lock 
managers.  I don't even have a good way of testing any proposed fix, 
because nothing is currently broken for me.  That's not to say I don't 
care if other people are having problems -- it simply means that I'm 
not in a very good position to help.  What we need is a good programmer 
who uses Radiance on a Linux cluster and can do some testing for us (at 
least).  I also need to free up some time, which has proved 
challenging, lately.  (Hence my short and mistake-ridden replies.)

-Greg


From gvn at retena.com  Tue Feb  8 16:41:40 2005
From: gvn at retena.com (=?iso-8859-1?Q?Ignacio_Mun=E1rriz?=)
Date: Tue Feb  8 16:51:15 2005
Subject: [Radiance-dev] sharing indirect values forparallel processing?
References: <B5C4B063-7530-11D9-8104-000A959DDB22@gmx.net>	<68bb737584aec2065da1f49db1b02eeb@gmail.com>	<4201F26F.9030809@familyhealth.com.au>	<Pine.BSF.4.58.0502030812560.40694@emancholl.pair.com>	<A746D2F0-76BB-11D9-8D94-000A959DDB22@gmx.net><Pine.BSF.4.58.0502040950260.51654@emancholl.pair.com><42039F05.40103@visarc.com>
	<c3017e23e5697bc067bc29a8eaf73e5a@gmail.com>
Message-ID: <001d01c50df4$af0b1e90$53000080@pnac>

I have installed nfs over cygwin(windows xp) in a notebook and a workstation
and i?ve tried a 4000 x 4000 resolution render with rpiece and a syncfile
without any problem, this is the command and the results in each computer:
echo 3 3 >syncfile
echo -F syncfile -x 4000 -y 4000 -t 10 -vf myview -o simple.pic simple.oct
>args
rpiece -v @args

workstation 3ghz

chroma@chr-xeon /usr/local/radiance/ray/obj/rprueba
$ rpiece -v @args
FRAME 1: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15.7224 -vv 15.7224 -vo 0 -va 0 -vs 1 -vl 1
rpict: 0 rays, 0.00% after 0.000u 0.000s 0.000r hours on chr-xeon
2 2 begun
2 2 done
rpict: 629893 rays, 100.00% after 0.002u 0.000s 0.002r hours on chr-xeon
FRAME 2: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15.7224 -vv 15.7224 -vo 0 -va 0 -vs 1 -vl -1
rpict: 629893 rays, 0.00% after 0.002u 0.000s 0.002r hours on chr-xeon
2 0 begun
2 0 done
rpict: 1344740 rays, 100.00% after 0.004u 0.000s 0.004r hours on chr-xeon
FRAME 3: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15.7224 -vv 15.7224 -vo 0 -va 0 -vs 0 -vl 0
rpict: 1344740 rays, 0.00% after 0.004u 0.000s 0.004r hours on chr-xeon
1 1 begun
1 1 done
rpict: 2142578 rays, 100.00% after 0.006u 0.000s 0.007r hours on chr-xeon
FRAME 4: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15.7224 -vv 15.7224 -vo 0 -va 0 -vs 0 -vl -1
rpict: 2142578 rays, 0.00% after 0.006u 0.000s 0.007r hours on chr-xeon
1 0 begun
1 0 done
rpict: 2880210 rays, 100.00% after 0.008u 0.000s 0.009r hours on chr-xeon
FRAME 5: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15.7224 -vv 15.7224 -vo 0 -va 0 -vs -1 -vl 1
rpict: 2880210 rays, 0.00% after 0.008u 0.000s 0.009r hours on chr-xeon
0 2 begun
0 2 done
rpict: 3331412 rays, 100.00% after 0.009u 0.000s 0.010r hours on chr-xeon
FRAME 6: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15.7224 -vv 15.7224 -vo 0 -va 0 -vs -1 -vl -1
rpict: 3331412 rays, 0.00% after 0.009u 0.000s 0.010r hours on chr-xeon
0 0 begun
0 0 done
rpict: 4049724 rays, 100.00% after 0.011u 0.000s 0.012r hours on chr-xeon


notebook 1.7ghz

ignacio@pnac /mnt/xeon
$ rpiece -v @args
FRAME 1: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15
.7224 -vv 15.7224 -vo 0 -va 0 -vs 1 -vl 0
rpict: 5296 rays, 0.00% after 0.000u 0.000s 0.000r hours on pnac
2 1 begun
rpict: 486848 rays, 81.02% after 0.002u 0.000s 0.003r hours on pnac
rpict: 601680 rays, 100.00% after 0.003u 0.000s 0.003r hours on pnac
FRAME 2: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15
.7224 -vv 15.7224 -vo 0 -va 0 -vs 0 -vl 1
rpict: 601680 rays, 0.00% after 0.003u 0.000s 0.003r hours on pnac
1 2 begun
2 1 done
rpict: 1438741 rays, 67.29% after 0.005u 0.000s 0.006r hours on pnac
rpict: 2099130 rays, 100.00% after 0.008u 0.000s 0.008r hours on pnac
FRAME 3: -vtv -vp 2.25 0.375 1 -vd -0.816497 0.408248 -0.408248 -vu 0 0
1 -vh 15
.7224 -vv 15.7224 -vo 0 -va 0 -vs -1 -vl 0
rpict: 2099130 rays, 0.00% after 0.008u 0.000s 0.008r hours on pnac
0 1 begun
1 2 done
rpict: 2554716 rays, 95.65% after 0.010u 0.000s 0.011r hours on pnac
rpict: 2581854 rays, 100.00% after 0.010u 0.000s 0.011r hours on pnac
0 1 done






----- Original Message -----
From: "Greg Ward" <gregoryjward@gmail.com>
To: "code development" <radiance-dev@radiance-online.org>
Sent: Friday, February 04, 2005 6:54 PM
Subject: [Radiance-dev] Re: [Radiance-general] sharing indirect values
forparallel processing?


> The locking requirements for Radiance are really quite minimal:
>
> 1) One process says in effect, "I need to have exclusive use of this
> file"
> 2) Said process waits until other processes are done reading (or
> writing) the file.
> 3) Process gets lock; all other processes unable to read or write the
> file.
> 4) Process does its thing, releases lock.
> 5) Life goes on...
>
> Why is this difficult?  Well, it seems that this sort of behavior gets
> in the way of efficient (i.e., cached) network filesystems, so some
> versions of NFS don't bother with it, or do it badly.  Even
> implementing our own lock mechanism via creating a separate file that
> says our ambient file is in use suffers from race conditions.  These
> race conditions have been worked out by the sendmail developers, but
> the solution is quite complicated.  The good news is that it works and
> has been tested on many different Unix implementations.  So, this looks
> like the easiest path to our goal.
>
> My motivation for doing this work is unfortunately low, because I'm
> using FreeBSD and OS X systems with perfectly adequate NFS lock
> managers.  I don't even have a good way of testing any proposed fix,
> because nothing is currently broken for me.  That's not to say I don't
> care if other people are having problems -- it simply means that I'm
> not in a very good position to help.  What we need is a good programmer
> who uses Radiance on a Linux cluster and can do some testing for us (at
> least).  I also need to free up some time, which has proved
> challenging, lately.  (Hence my short and mistake-ridden replies.)
>
> -Greg
>
>
> _______________________________________________
> Radiance-dev mailing list
> Radiance-dev@radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-dev
>


From a.jacobs at londonmet.ac.uk  Mon Feb 14 12:24:36 2005
From: a.jacobs at londonmet.ac.uk (Axel Jacobs)
Date: Mon Feb 14 12:20:31 2005
Subject: [Radiance-dev] pmap + LEARNIX]
Message-ID: <41150.193.137.43.137.1108380276.squirrel@193.137.43.137>

Dear all,

I am forwarding an e-mail from Roland Schregle (author of pmap) to this
list. I was enquiring whether he intended to make pmap work with R3.6.
Unfortunately, the answer was "no". He doesnt have the time for
maintaining it and considers it abandonware.

THIS IS BAD!

I was actually going to put it on the next LEARNIX, and add a section to
the advanced tutorial, but this is not possible without being able to
compile it...

I personally consider pmap as one of the most useful add-ons to RAD
(although, admittedly I havent used it myself yet)

So I guess my question is this:
Would any of you guys take on the burden of making it work with R3.6? What
are the possible solutions without going back to 3.5? (Well, he DOES
mention on name in his reply, but I am not going to point my finger)

---------------------------- Original Message ----------------------------
Subject: Re: pmap + LEARNIX
From:    "Roland Schregle" <ganjatron@gmx.net>
Date:    Wed, January 19, 2005 20:34
To:      "Axel Jacobs" <a.jacobs@londonmet.ac.uk>
--------------------------------------------------------------------------

Axel Jacobs wrote:
> Hi Roland,
>
> I am about to roll a new LEARNIX and are just wondering if you are going
to port pmap to RAD3.6 any time soon. With your permission, I'd like to
include it in the distribution.
> http://luminance.londonmet.ac.uk/learnix/

Howdy Axel,

glad to hear LEARNIX is still doing fine, which is more than I can say 
for the pmap addon! The pmap code is abandonware, and as such there  won't
be a release based on RAD3.6 forthcoming -- at least from me. I've  moved
on to other stuff, and am no longer actively involved with
RADIANCE, so I hope somebody will volunteer to maintain the code. So far 
no takers, which isn't suprising, since the code is quite tedious in  some
bits.

I'd definitely welcome the inclusion of the pmap in your distro (makes 
for good PR!), but as I assume LEARNIX is 3.6-based you won't get the 
last pmap release (3.28, I believe) compiled. I hope somebody will take 
up where I left off. Carsten Bauer may be a good candidate; I haven't 
tracked his Radzilla development lately, but I assume it's 3.6-based (or 
rewritten from scratch???) and includes the pmap code, so you might want 
to give him a buzz.

Long live LEARNIX! :^)

--Roland





From grobe at gmx.net  Mon Feb 14 16:07:44 2005
From: grobe at gmx.net (Lars O. Grobe)
Date: Mon Feb 14 16:07:49 2005
Subject: [Radiance-dev] Re: [Radiance-general] sharing indirect values for
	parallel processing?
In-Reply-To: <c3017e23e5697bc067bc29a8eaf73e5a@gmail.com>
References: <B5C4B063-7530-11D9-8104-000A959DDB22@gmx.net>	<68bb737584aec2065da1f49db1b02eeb@gmail.com>	<4201F26F.9030809@familyhealth.com.au>	<Pine.BSF.4.58.0502030812560.40694@emancholl.pair.com>	<A746D2F0-76BB-11D9-8D94-000A959DDB22@gmx.net>
	<Pine.BSF.4.58.0502040950260.51654@emancholl.pair.com>
	<42039F05.40103@visarc.com>
	<c3017e23e5697bc067bc29a8eaf73e5a@gmail.com>
Message-ID: <fd9c104db3e2890a97886e314e76a4fb@gmx.net>

Hi,

so after all I decided to use openmosix, start all processes on one 
machine and not to care about network file systems, as these processes 
read their data from the local fs before migrating to other clusters. 
This should work like using a SMP-machine.

But, to get it clear, I have to ask this once again (I read the chapter 
in RwR again): if I start processes on ONE machine (e.g. a SMP 
environment or an openmosix cluster) and all file access is on the 
local fs, will the sharing of ambient data work? The byte range locking 
would have to be done over the local file system, right? Or should I 
just use the -N option of rad (or the -PP of rpict?)?

TIA+CU Lars.


From jedev at visarc.com  Mon Feb 14 17:32:03 2005
From: jedev at visarc.com (Jack de Valpine)
Date: Mon Feb 14 17:32:22 2005
Subject: [Radiance-dev] Re: [Radiance-general] sharing indirect values
	for	parallel processing?
In-Reply-To: <fd9c104db3e2890a97886e314e76a4fb@gmx.net>
References: <B5C4B063-7530-11D9-8104-000A959DDB22@gmx.net>	<68bb737584aec2065da1f49db1b02eeb@gmail.com>	<4201F26F.9030809@familyhealth.com.au>	<Pine.BSF.4.58.0502030812560.40694@emancholl.pair.com>	<A746D2F0-76BB-11D9-8D94-000A959DDB22@gmx.net>	<Pine.BSF.4.58.0502040950260.51654@emancholl.pair.com>	<42039F05.40103@visarc.com>	<c3017e23e5697bc067bc29a8eaf73e5a@gmail.com>
	<fd9c104db3e2890a97886e314e76a4fb@gmx.net>
Message-ID: <4210D283.9080208@visarc.com>

Hi Lars,

I believe that openmosix's omfs filesystems supports locking correctly 
across the networked nodes (open and fcntl). Also you should determine 
if you need to have dfsa enabled on top of omfs. It might be worth 
checking the documentation carefully. Also it looks like they are 
changing to another filesystem mechanism based on openGFS, although it 
looks like this is still in the works. However what does not work (or 
did not as of a year or so ago) are named pipes. These are needed if you 
are going to run multiple processes on each node and require sharing of 
memory (-PP). I think there are some tricks to work around this, but 
these essentially require starting and locking jobs on specific nodes.

You might want to consider a question to the openmosix listserv 
regarding file locking and named pipes. On the other hand you may just 
need to set up some tests and run the renderings to see what works and 
what does not.....

-Jack

Lars O. Grobe wrote:

> Hi,
>
> so after all I decided to use openmosix, start all processes on one 
> machine and not to care about network file systems, as these processes 
> read their data from the local fs before migrating to other clusters. 
> This should work like using a SMP-machine.
>
> But, to get it clear, I have to ask this once again (I read the 
> chapter in RwR again): if I start processes on ONE machine (e.g. a SMP 
> environment or an openmosix cluster) and all file access is on the 
> local fs, will the sharing of ambient data work? The byte range 
> locking would have to be done over the local file system, right? Or 
> should I just use the -N option of rad (or the -PP of rpict?)?
>
> TIA+CU Lars.
>
>
> _______________________________________________
> Radiance-dev mailing list
> Radiance-dev@radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-dev




From cbauer- at t-online.de  Tue Feb 15 01:50:10 2005
From: cbauer- at t-online.de (Carsten Bauer)
Date: Tue Feb 15 00:39:01 2005
Subject: [Radiance-dev] pmap + LEARNIX]
References: <41150.193.137.43.137.1108380276.squirrel@193.137.43.137>
Message-ID: <42114742.5030605@t-online.de>

Axel Jacobs wrote:
> Dear all,
> 
> I am forwarding an e-mail from Roland Schregle (author of pmap) ...

who ? what ? Ro - land ??

Yeeeeeeeah, of course, I know that dude, Grandmasta U-No-Hoo, I've even 
seen him once in RealLife(TM) in Fribourg, man, this was loooong loooong 
ago ...

Howdie, Roland !

ahm, what's the matter? pmap and R3.6? OK, lets lean myself once more 
out of the window, I suppose that it means not *that* much work either,
so I'll do it. Right now I'm quite  busy, but - well, lets better deal 
with the timing question off-list..

I'm already looking forward to another pmap-code reading session
(I mean of course the hidden gems, the special style source code 
comments :-) :-) :-) )

-cb


From ganjatron at gmx.net  Tue Feb 15 17:20:10 2005
From: ganjatron at gmx.net (Roland Schregle)
Date: Tue Feb 15 17:21:26 2005
Subject: [Radiance-dev] pmap + LEARNIX]
In-Reply-To: <42114742.5030605@t-online.de>
References: <41150.193.137.43.137.1108380276.squirrel@193.137.43.137>
	<42114742.5030605@t-online.de>
Message-ID: <4212213A.8050402@gmx.net>

Carsten Bauer wrote:

> ahm, what's the matter? pmap and R3.6? OK, lets lean myself once more 
> out of the window, I suppose that it means not *that* much work either,
> so I'll do it. 

Well I'll be damned! Hail to Carsten the Saviour!!! :^)

I don't think it IS that much of a big deal, it's really just the 
wrapper routines that need to be updated. The core shouldn't need any 
changes, and believe me, you wouldn't want to mess with it unless you're 
well versed in MC.

> I'm already looking forward to another pmap-code reading session
> (I mean of course the hidden gems, the special style source code 
> comments :-) :-) :-) )

Heh. Feel free to add some of your own. :^)

--Roland


-- 
Dr. Roland Schregle

END OF LINE. (MCP)


From schorsch at schorsch.com  Wed Feb 16 01:48:18 2005
From: schorsch at schorsch.com (Georg Mischler)
Date: Wed Feb 16 01:48:28 2005
Subject: [Radiance-dev] pmap
In-Reply-To: <4212213A.8050402@gmx.net>
References: <41150.193.137.43.137.1108380276.squirrel@193.137.43.137>
	<42114742.5030605@t-online.de> <4212213A.8050402@gmx.net>
Message-ID: <Pine.BSF.4.58.0502151944380.86510@emancholl.pair.com>

Roland Schregle wrote:

> Carsten Bauer wrote:
>
> > ahm, what's the matter? pmap and R3.6? OK, lets lean myself once more
> > out of the window, I suppose that it means not *that* much work either,
> > so I'll do it.
>
> Well I'll be damned! Hail to Carsten the Saviour!!! :^)
>
> I don't think it IS that much of a big deal, it's really just the
> wrapper routines that need to be updated. The core shouldn't need any
> changes, and believe me, you wouldn't want to mess with it unless you're
> well versed in MC.


The ultimate goal (well, at least mine) would be to include pmap
with the official Radiance distribution. There are two things
that could help to make this possible.

The first one is that someone who understands the code will have
to be available for continuous maintenance. That needn't
necessarily involve a lot of work, but should be understood as a
serious commitment anyway.

The other thing that I'd like to see is a better seperation
between classic and pmap code. Last time I looked at it, pmap
added a number of function definitions and other code to existing
Radiance source files (eg. xxxPhotonScatter() in rt/normal.c).
An effort to move this code into seperate files would make it
much easier to adapt pmap to future (and current) versions of
Radiance.

In the ideal case, the pmap related code in the existing files
would be reduced to function calls. For one, this would make it
easier to delegate maintenance responsibility to different
people. And a "minimally invasive" integration might also lower
the psychological barrier against a quick (possibly tentative)
inclusion. The fewer and smaller conditional compiles are needed
to build Radiance with or without pmap, the better the chances.

I hope that won't scare you away again, Carsten...


-schorsch

-- 
Georg Mischler  --  simulations developer  --  schorsch at schorsch com
+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/

From T.McMinn at exchange.curtin.edu.au  Wed Feb 16 05:35:01 2005
From: T.McMinn at exchange.curtin.edu.au (Terrance Mc Minn)
Date: Wed Feb 16 05:35:19 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
Message-ID: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>

I read somewhere, though now of course I cannot find the reference, that a
move was being made from the old /usr/tmp to /tmp.

Hope this helps, as it stands currently, utilities such as trad fail without
the /usr/tmp link in place.

A grep for /usr/tmp on today's (February 16, 2005) HEAD and the current
support files gives the following:

rad3R6P1supp
ray/obj/office/anim2.csh:set tempfile=/usr/tmp/pict.$$
ray/obj/office/anim.csh:set tempfile=/usr/tmp/pict.$$
ray/obj/cabin/anim1/script:set tempdir=/usr/tmp/anim1
ray/obj/cabin/anim1/errs:if ( ! -d /usr/tmp/anim1 ) then
ray/obj/cabin/anim1/errs:mkdir /usr/tmp/anim1
ray/obj/cabin/anim1/errs:if ( ! -f /usr/tmp/anim1/583.pic ) then
ray/obj/cabin/anim1/errs:if ( -f /usr/tmp/anim1/583.unf ) then
ray/obj/cabin/anim1/errs:rpict -dr 1 -av .003 .003 .003 -t 3600 -pj .8 -vtv
-vh 60 -vv 49 -x 1024 -y 964 -pa 0 -vp 14.5408 10.9788 4.2 -vd -0.851381
-0.56186 -0.145108 -vu 0 0 1 -z /usr/tmp/anim1/583.z oct/nightcabin
ray/obj/cabin/anim1/errs:mv /usr/tmp/anim1/583.unf /usr/tmp/anim1/583.pic
ray/obj/cabin/anim1/errs:pfilt -1 -x 512 -y 482 -e 120
/usr/tmp/anim1/583.pic
ray/obj/cabin/anim1/errs:ra_t16 /usr/tmp/anim1/583.fin
/usr/tmp/anim1/583.tga
ray/doc/man/cat1/rtrace.1:       /usr/tmp/rtXXXXXX        common header
information for picture sequence
ray/doc/man/cat1/rpict.1:       /usr/tmp/rtXXXXXX        common header
information for picture sequence
ray/doc/man/cat1/psort.1:       /usr/tmp/psXXXXa /usr/tmp/psXXXXb
ray/doc/man/cat1/pfilt.1:       /usr/tmp/rt??????
ray/doc/digest/v2n2:10:43pm  114   /usr/tmp/nfotis/ray/obj/office > make 

radiance-HEAD
ray/src/util/objline.csh:set d=/usr/tmp/ol$$
ray/src/util/do_file.tcl:	if [catch {exec rad -n -w -e $f >&
/usr/tmp/ro[pid]}] {
ray/src/util/do_file.tcl:		set curmess [exec cat
/usr/tmp/ro[pid]]
ray/src/util/do_file.tcl:		exec rm -f /usr/tmp/ro[pid]
ray/src/util/do_file.tcl:	set fi [open /usr/tmp/ro[pid] r]
ray/src/util/do_file.tcl:	exec rm -f /usr/tmp/ro[pid]
ray/src/util/do_action.tcl:	set rfn /usr/tmp/rf[pid]
ray/src/util/do_action.tcl:		set rof /usr/tmp/ro[pid]
ray/src/util/do_action.tcl:	set rfn /usr/tmp/rf[pid]
ray/src/util/dayfact.csh:	xform -e $genskyf > /usr/tmp/gsf$$
ray/src/util/dayfact.csh:	grep '^# gensky ' /usr/tmp/gsf$$
ray/src/util/dayfact.csh:		rm -f /usr/tmp/gsf$$
ray/src/util/dayfact.csh:	set title=$title\ `sed -n 's/^# gensky
*\([0-9][0-9]*  *[0-9][0-9]*  *[0-9][0-9.]*\).*$/\1/p' /usr/tmp/gsf$$`
ray/src/util/dayfact.csh:	set extamb=`sed -n 's/^# Ground ambient
level: //p' /usr/tmp/gsf$$`
ray/src/util/dayfact.csh:	grep -s '^# gensky .* -c' /usr/tmp/gsf$$
ray/src/util/dayfact.csh:	rm -f /usr/tmp/gsf$$
ray/src/util/dayfact.csh:set sctemp=/usr/tmp/sc$$.csh
ray/src/util/dayfact.csh:	set iltemp=/usr/tmp/il$$.pic
ray/src/util/dayfact.csh:set tltemp=/usr/tmp/tl$$.pic
ray/src/util/dayfact.csh:set dstemp=/usr/tmp/ds$$.pic
ray/src/util/dayfact.csh:set temp1=/usr/tmp/tfa$$
ray/src/util/compamb.csh:set tf=/usr/tmp/ca$$
ray/src/px/xyzimage.csh:set td=/usr/tmp/xyz$$
ray/src/px/vlpic.csh:set tc=/usr/tmp/vl$$.cal
ray/src/px/vlpic.csh:set tp1=/usr/tmp/vl$$r1.pic
ray/src/px/vlpic.csh:set tp2=/usr/tmp/vl$$r2.pic
ray/src/px/vlpic.csh:set tp4=/usr/tmp/vl$$r4.pic
ray/src/px/vlpic.csh:set tp8=/usr/tmp/vl$$r8.pic
ray/src/px/phisto.csh:set tf=/usr/tmp/ph$$
ray/src/px/normpat.csh:set td=/usr/tmp/np$$
ray/src/px/falsecolor.csh:set td=/usr/tmp/fc$$
ray/src/gen/genpine.csh:set tree=/usr/tmp/t$$
ray/src/gen/genpine.csh:set oldtree=/usr/tmp/ot$$
ray/doc/man/man1/rtrace.1:/usr/tmp/rtXXXXXX		common header
information for picture sequence
ray/doc/man/man1/rpict.1:/usr/tmp/rtXXXXXX		common header
information for picture sequence
ray/doc/man/man1/psort.1:/usr/tmp/psXXXXa /usr/tmp/psXXXXb
ray/doc/man/man1/pfilt.1:/usr/tmp/rt??????

Regards 

Terry Mc Minn 
Faculty of Built Environment, Art and Design 
Curtin University of Technology 
GPO Box U 1987 
Perth 6845 
Western Australia 
Email: T.Mcminn@curtin.edu.au 
CRICOS Provider Code: 00301J 

From gregoryjward at gmail.com  Wed Feb 16 06:23:36 2005
From: gregoryjward at gmail.com (Greg Ward)
Date: Wed Feb 16 06:23:54 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>
Message-ID: <77182e0b430b6969eaf346239a7b5d1a@gmail.com>

Hi Terry,

Yes, we did start working to replace /usr/tmp with /tmp, but hadn't 
gotten around to all the scripts and things.  Thanks for the 
reminder...  All we've done so far is change the macro used by C 
programs to point to /tmp rather than /usr/tmp.  I'll get to work on 
trad and the C-Shell scripts tonight.

-Greg

> From: Terrance Mc Minn <T.McMinn@exchange.curtin.edu.au>
> Date: February 15, 2005 8:35:01 PM PST
>
> I read somewhere, though now of course I cannot find the reference, 
> that a
> move was being made from the old /usr/tmp to /tmp.
>
> Hope this helps, as it stands currently, utilities such as trad fail 
> without
> the /usr/tmp link in place.
>
> A grep for /usr/tmp on today's (February 16, 2005) HEAD and the current
> support files gives the following:


From schorsch at schorsch.com  Wed Feb 16 12:42:03 2005
From: schorsch at schorsch.com (Georg Mischler)
Date: Wed Feb 16 12:42:08 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <77182e0b430b6969eaf346239a7b5d1a@gmail.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>
	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>
Message-ID: <Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>

Greg Ward wrote:

> Hi Terry,
>
> Yes, we did start working to replace /usr/tmp with /tmp, but hadn't
> gotten around to all the scripts and things.
> Thanks for the
> reminder...  All we've done so far is change the macro used by C
> programs to point to /tmp rather than /usr/tmp.  I'll get to work on
> trad and the C-Shell scripts tonight.

I don't think that all of the C programs use /tmp yet.
What I did a while ago was to add code that would look for
certain directories (depending on platform) and then create
temporary files in the first one found. On posix (unix) systems,
the current sequence is "/var/tmp", "/usr/tmp", "/tmp", ".".

But I haven't had the time to adapt all the programs so they
actually use this code. Consequently, some will find the
alternatives if /usr/tmp is missing or write protected, but
others will still fail. If I remember correctly, then I
changed all the easy cases, where only a string needed to
be replaced. But Radiance does quite tricky things with temp
files in a few places, which will involve more work to update.

So you may get lucky that whatever you need actually works,
but in the general case it's still recommended to have /usr/tmp
available and accessible.


-schorsch

-- 
Georg Mischler  --  simulations developer  --  schorsch at schorsch com
+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/

From cbauer- at t-online.de  Wed Feb 16 16:59:40 2005
From: cbauer- at t-online.de (Carsten Bauer)
Date: Wed Feb 16 15:47:25 2005
Subject: [Radiance-dev] pmap
References: <41150.193.137.43.137.1108380276.squirrel@193.137.43.137>	<42114742.5030605@t-online.de>
	<4212213A.8050402@gmx.net>
	<Pine.BSF.4.58.0502151944380.86510@emancholl.pair.com>
Message-ID: <42136DEC.3080605@t-online.de>

Georg Mischler wrote:

> The other thing that I'd like to see is a better seperation
> between classic and pmap code. 
 >  ......
 > An effort to move this code into seperate files would make it
> much easier to adapt pmap to future (and current) versions of
> Radiance.


I definitely agree on this point (in fact I'm following the same 
approach of separation in my current radzilla restructuring work).


> In the ideal case, the pmap related code in the existing files
> would be reduced to function calls. For one, this would make it
> easier to delegate maintenance responsibility to different
> people. And a "minimally invasive" integration might also lower
> the psychological barrier against a quick (possibly tentative)
> inclusion. The fewer and smaller conditional compiles are needed
> to build Radiance with or without pmap, the better the chances.

I also agree, but the problem is that this point is considerably more 
difficult to solve than the one above.. I had some concepts of 
rearranging in mind which would greatly reduce the number of 
invasion/interface points for additional modules, functions, whatever, 
but I had to put them aside as they would definitely mean quite a lot of 
work.
It's the usual story, at some point one better contents oneself with 
that what's already there.
Let me quote Peters words (ripped from another discussion thread and put 
into a new sentence :-):
  "and given today's abstraction level of the rendering core (or the 
absence of it) " -end of quotation- any additional stuff has to adapt 
itself a bit to this underlying structure.

Which of course doesn't mean that there aren't at least some ways to 
modify the current pmap/Radiance connection in favour of your proposals.

-Carsten





From gregoryjward at gmail.com  Wed Feb 16 18:10:50 2005
From: gregoryjward at gmail.com (Greg Ward)
Date: Wed Feb 16 18:11:07 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>
	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>
	<Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>
Message-ID: <98c2adfc14761be5cf548c4f4ad496a9@gmail.com>

Hi Terry,

I just conferred with Schorsch, and I think we've eliminated use of the 
/usr/tmp directory in tomorrow's HEAD release.  In most cases, we 
aren't searching for a temp directory, just using /tmp and hoping it's 
there.  This is at least an improvement from assuming /usr/tmp is 
available, but not as robust as the searching method Schorsch is 
working on.

-Greg

> From: Georg Mischler <schorsch@schorsch.com>
> Date: February 16, 2005 3:42:03 AM PST
>
> Greg Ward wrote:
>
>> Hi Terry,
>>
>> Yes, we did start working to replace /usr/tmp with /tmp, but hadn't
>> gotten around to all the scripts and things.
>> Thanks for the
>> reminder...  All we've done so far is change the macro used by C
>> programs to point to /tmp rather than /usr/tmp.  I'll get to work on
>> trad and the C-Shell scripts tonight.
>
> I don't think that all of the C programs use /tmp yet.
> What I did a while ago was to add code that would look for
> certain directories (depending on platform) and then create
> temporary files in the first one found. On posix (unix) systems,
> the current sequence is "/var/tmp", "/usr/tmp", "/tmp", ".".
>
> But I haven't had the time to adapt all the programs so they
> actually use this code. Consequently, some will find the
> alternatives if /usr/tmp is missing or write protected, but
> others will still fail. If I remember correctly, then I
> changed all the easy cases, where only a string needed to
> be replaced. But Radiance does quite tricky things with temp
> files in a few places, which will involve more work to update.
>
> So you may get lucky that whatever you need actually works,
> but in the general case it's still recommended to have /usr/tmp
> available and accessible.
>
> -schorsch


From jedev at visarc.com  Wed Feb 16 18:28:41 2005
From: jedev at visarc.com (Jack de Valpine)
Date: Wed Feb 16 18:29:01 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <98c2adfc14761be5cf548c4f4ad496a9@gmail.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>	<Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>
	<98c2adfc14761be5cf548c4f4ad496a9@gmail.com>
Message-ID: <421382C9.9020404@visarc.com>

Hi Greg and Georg,

I guess related to this topic. I know that there are compiler warnings 
that crop up with respect to the use of "mktemp" being dangerous and 
recomending the use of "mkstemp", is this something that needs to be be 
treated or not?

-Jack

Greg Ward wrote:

> Hi Terry,
>
> I just conferred with Schorsch, and I think we've eliminated use of 
> the /usr/tmp directory in tomorrow's HEAD release.  In most cases, we 
> aren't searching for a temp directory, just using /tmp and hoping it's 
> there.  This is at least an improvement from assuming /usr/tmp is 
> available, but not as robust as the searching method Schorsch is 
> working on.
>
> -Greg
>
>> From: Georg Mischler <schorsch@schorsch.com>
>> Date: February 16, 2005 3:42:03 AM PST
>>
>> Greg Ward wrote:
>>
>>> Hi Terry,
>>>
>>> Yes, we did start working to replace /usr/tmp with /tmp, but hadn't
>>> gotten around to all the scripts and things.
>>> Thanks for the
>>> reminder...  All we've done so far is change the macro used by C
>>> programs to point to /tmp rather than /usr/tmp.  I'll get to work on
>>> trad and the C-Shell scripts tonight.
>>
>>
>> I don't think that all of the C programs use /tmp yet.
>> What I did a while ago was to add code that would look for
>> certain directories (depending on platform) and then create
>> temporary files in the first one found. On posix (unix) systems,
>> the current sequence is "/var/tmp", "/usr/tmp", "/tmp", ".".
>>
>> But I haven't had the time to adapt all the programs so they
>> actually use this code. Consequently, some will find the
>> alternatives if /usr/tmp is missing or write protected, but
>> others will still fail. If I remember correctly, then I
>> changed all the easy cases, where only a string needed to
>> be replaced. But Radiance does quite tricky things with temp
>> files in a few places, which will involve more work to update.
>>
>> So you may get lucky that whatever you need actually works,
>> but in the general case it's still recommended to have /usr/tmp
>> available and accessible.
>>
>> -schorsch
>
>
>
> _______________________________________________
> Radiance-dev mailing list
> Radiance-dev@radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-dev
>
>

-- 
#	John E. de Valpine
#	president
#
#	visarc incorporated
#	http://www.visarc.com
#
#	channeling technology for superior design and construction




From gregoryjward at gmail.com  Wed Feb 16 18:36:46 2005
From: gregoryjward at gmail.com (Greg Ward)
Date: Wed Feb 16 18:37:00 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <421382C9.9020404@visarc.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>	<Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>
	<98c2adfc14761be5cf548c4f4ad496a9@gmail.com>
	<421382C9.9020404@visarc.com>
Message-ID: <946eed5f1c575282533620554fe4e01e@gmail.com>

Hi Jack,

The reason for the mktemp() warning is that you can end up with a race 
condition if you have multiple processes trying to create temporary 
files using the same template, which is probably something we don't 
particularly need to worry about.  Unless you have a lot of processes 
running in parallel and creating temp files like mad, the chances of a 
collision are extremely remote.  Altering the code to use mkstemp() in 
some places is impossible, and in other places is just a lot of work.  
In 20 years of using the software, I haven't run across a problem 
related to temp file collisions, so I'm tempted to ignore it.

-Greg

P.S. to Francisco -- I used a command very like this to identify files 
to change, and changed them.  Thanks.

> From: Jack de Valpine <jedev@visarc.com>
> Date: February 16, 2005 9:28:41 AM PST
>
> Hi Greg and Georg,
>
> I guess related to this topic. I know that there are compiler warnings 
> that crop up with respect to the use of "mktemp" being dangerous and 
> recomending the use of "mkstemp", is this something that needs to be 
> be treated or not?
>
> -Jack


From gregoryjward at gmail.com  Wed Feb 16 18:40:44 2005
From: gregoryjward at gmail.com (Greg Ward)
Date: Wed Feb 16 18:41:14 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <421382C9.9020404@visarc.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>	<Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>
	<98c2adfc14761be5cf548c4f4ad496a9@gmail.com>
	<421382C9.9020404@visarc.com>
Message-ID: <6cf37e0a2fe79540cf88f7b8e0070fc0@gmail.com>

A P.S. to my last message -- mktemp() uses the process ID as part of 
the "magic number" used to name the temp file, making collisions among 
competing processes on the same machine impossible.  It's really only 
when a single process is multithreading that one needs to worry, and 
Radiance doesn't use threads.  Different machines with potentially 
colliding process id's could be a problem, but again it is extremely 
unlikely, especially when the files are being created in the /tmp 
directory, which is usually local to each machine.

-G

> From: Jack de Valpine <jedev@visarc.com>
> Date: February 16, 2005 9:28:41 AM PST
>
> Hi Greg and Georg,
>
> I guess related to this topic. I know that there are compiler warnings 
> that crop up with respect to the use of "mktemp" being dangerous and 
> recomending the use of "mkstemp", is this something that needs to be 
> be treated or not?
>
> -Jack


From jedev at visarc.com  Wed Feb 16 18:47:00 2005
From: jedev at visarc.com (Jack de Valpine)
Date: Wed Feb 16 18:47:15 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <6cf37e0a2fe79540cf88f7b8e0070fc0@gmail.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>	<Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>	<98c2adfc14761be5cf548c4f4ad496a9@gmail.com>	<421382C9.9020404@visarc.com>
	<6cf37e0a2fe79540cf88f7b8e0070fc0@gmail.com>
Message-ID: <42138714.4080809@visarc.com>

Hey Greg,

Ok, this makes sense, thanks for the explaination.

-Jack

Greg Ward wrote:

> A P.S. to my last message -- mktemp() uses the process ID as part of 
> the "magic number" used to name the temp file, making collisions among 
> competing processes on the same machine impossible.  It's really only 
> when a single process is multithreading that one needs to worry, and 
> Radiance doesn't use threads.  Different machines with potentially 
> colliding process id's could be a problem, but again it is extremely 
> unlikely, especially when the files are being created in the /tmp 
> directory, which is usually local to each machine.
>
> -G
>
>> From: Jack de Valpine <jedev@visarc.com>
>> Date: February 16, 2005 9:28:41 AM PST
>>
>> Hi Greg and Georg,
>>
>> I guess related to this topic. I know that there are compiler 
>> warnings that crop up with respect to the use of "mktemp" being 
>> dangerous and recomending the use of "mkstemp", is this something 
>> that needs to be be treated or not?
>>
>> -Jack
>
>
>
> _______________________________________________
> Radiance-dev mailing list
> Radiance-dev@radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-dev
>
>

-- 
#	John E. de Valpine
#	president
#
#	visarc incorporated
#	http://www.visarc.com
#
#	channeling technology for superior design and construction




From schorsch at schorsch.com  Wed Feb 16 19:07:31 2005
From: schorsch at schorsch.com (Georg Mischler)
Date: Wed Feb 16 19:07:41 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <946eed5f1c575282533620554fe4e01e@gmail.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>
	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>
	<Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>
	<98c2adfc14761be5cf548c4f4ad496a9@gmail.com>
	<421382C9.9020404@visarc.com>
	<946eed5f1c575282533620554fe4e01e@gmail.com>
Message-ID: <Pine.BSF.4.58.0502161252360.10956@emancholl.pair.com>

Greg Ward wrote:

> Hi Jack,
>
> The reason for the mktemp() warning is that you can end up with a race
> condition if you have multiple processes trying to create temporary
> files using the same template, which is probably something we don't
> particularly need to worry about.

Chances of this causing problems accidentally are remote.

The real reason why the compiler warns about it is that in
very specific scenarios it can be exploited maliciously.
The problem is that the generated names are predictable, and
a rogue process can create eg. a symbolic link where the file
is going to be opened. If done right, then this makes it
possible for a user process to write to files that would
normally only be writeable with root priviledges. Don't ask
me for the exact method, I'd have to look that up too...

For software not running as root, this is mostly of academic
interest. The worst thing an "attacker" could do to you is
corrupt your temp files, thus invalidating your simulation.
Anyone having enough access (a normal user account) on your
system to try this will have many other ways to harm you
with a lot less effort.


-schorsch

-- 
Georg Mischler  --  simulations developer  --  schorsch at schorsch com
+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/

From randolph at panix.com  Thu Feb 17 02:05:24 2005
From: randolph at panix.com (Randolph Fritz)
Date: Thu Feb 17 02:05:30 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <Pine.BSF.4.58.0502161252360.10956@emancholl.pair.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>
	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>
	<Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>
	<98c2adfc14761be5cf548c4f4ad496a9@gmail.com>
	<421382C9.9020404@visarc.com>
	<946eed5f1c575282533620554fe4e01e@gmail.com>
	<Pine.BSF.4.58.0502161252360.10956@emancholl.pair.com>
Message-ID: <20050217010524.GA18094@panix.com>

On Wed, Feb 16, 2005 at 01:07:31PM -0500, Georg Mischler wrote:
> Greg Ward wrote:
> 
> > Hi Jack,
> >
> > The reason for the mktemp() warning is that you can end up with a race
> > condition if you have multiple processes trying to create temporary
> > files using the same template, which is probably something we don't
> > particularly need to worry about.
> 
> Chances of this causing problems accidentally are remote.
> 

My QA experience says that often as not, this means that it will
happens often as not.  ;-)

Randolph


From gregoryjward at gmail.com  Thu Feb 17 07:15:19 2005
From: gregoryjward at gmail.com (Greg Ward)
Date: Thu Feb 17 07:15:44 2005
Subject: [Radiance-dev] /usr/tmp and /tmp
In-Reply-To: <20050217010524.GA18094@panix.com>
References: <092BF7A1BC389E489A69DC764F23CD8701A907C3@exmsp2.perth.ad.curtin.edu.au>
	<77182e0b430b6969eaf346239a7b5d1a@gmail.com>
	<Pine.BSF.4.58.0502160625390.10956@emancholl.pair.com>
	<98c2adfc14761be5cf548c4f4ad496a9@gmail.com>
	<421382C9.9020404@visarc.com>
	<946eed5f1c575282533620554fe4e01e@gmail.com>
	<Pine.BSF.4.58.0502161252360.10956@emancholl.pair.com>
	<20050217010524.GA18094@panix.com>
Message-ID: <b5f85eb65acf3b4aa5a8ef34adac12d7@gmail.com>

Given the U.S.'s flouting of the Kyoto Protocol, I expect we'll all be 
underwater before there's a collision of temp files in Radiance....

-G

> From: Randolph Fritz <randolph@panix.com>
> Date: February 16, 2005 5:05:24 PM PST
>
> On Wed, Feb 16, 2005 at 01:07:31PM -0500, Georg Mischler wrote:
>> Greg Ward wrote:
>>
>>> Hi Jack,
>>>
>>> The reason for the mktemp() warning is that you can end up with a 
>>> race
>>> condition if you have multiple processes trying to create temporary
>>> files using the same template, which is probably something we don't
>>> particularly need to worry about.
>>
>> Chances of this causing problems accidentally are remote.
>>
>
> My QA experience says that often as not, this means that it will
> happens often as not.  ;-)
>
> Randolph


From chriskl at familyhealth.com.au  Tue Feb 22 16:02:14 2005
From: chriskl at familyhealth.com.au (Christopher Kings-Lynne)
Date: Tue Feb 22 16:04:13 2005
Subject: [Radiance-dev] Man page update
Message-ID: <421B4976.9070509@familyhealth.com.au>

Can we add an example of using multiple input files on the mkillum man page?

It took me ages to figure out the "<" business.  I tried it before 
_every_ file name, prepended to each filename, etc, etc.

Cheers,

Chris

From gregoryjward at gmail.com  Tue Feb 22 17:15:13 2005
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Tue Feb 22 17:16:04 2005
Subject: [Radiance-dev] Man page update
In-Reply-To: <421B4976.9070509@familyhealth.com.au>
References: <421B4976.9070509@familyhealth.com.au>
Message-ID: <05fa6e6f6254ab8496029de46bfe56e3@gmail.com>

Good idea, although I have doubts that a single example will really  
illucidate mkillum usage.  It's rather a difficult program to get one's  
head around.

Nevertheless, I have added an example to the man page, which will be in  
tomorrow's head dump, or can be downloaded now if you like from:

	http://www.radiance-online.org/cgi-bin/viewcvs.cgi/*checkout*/ray/doc/ 
man/man1/mkillum.1?rev=1.5

-Greg

> From: Christopher Kings-Lynne <chriskl@familyhealth.com.au>
> Date: February 22, 2005 7:02:14 AM PST
>
> Can we add an example of using multiple input files on the mkillum man  
> page?
>
> It took me ages to figure out the "<" business.  I tried it before  
> _every_ file name, prepended to each filename, etc, etc.
>
> Cheers,
>
> Chris


From chriskl at familyhealth.com.au  Tue Feb 22 17:20:53 2005
From: chriskl at familyhealth.com.au (Christopher Kings-Lynne)
Date: Tue Feb 22 17:22:44 2005
Subject: [Radiance-dev] Man page update
In-Reply-To: <05fa6e6f6254ab8496029de46bfe56e3@gmail.com>
References: <421B4976.9070509@familyhealth.com.au>
	<05fa6e6f6254ab8496029de46bfe56e3@gmail.com>
Message-ID: <421B5BE5.9050605@familyhealth.com.au>

Thanks Greg,

I'm still trying to wrap my head around mkillum at the moment.  It seems 
to produce...odd results for me :(

Chris

Gregory J. Ward wrote:
> Good idea, although I have doubts that a single example will really  
> illucidate mkillum usage.  It's rather a difficult program to get one's  
> head around.
> 
> Nevertheless, I have added an example to the man page, which will be in  
> tomorrow's head dump, or can be downloaded now if you like from:
> 
>     http://www.radiance-online.org/cgi-bin/viewcvs.cgi/*checkout*/ray/doc/ 
> man/man1/mkillum.1?rev=1.5
> 
> -Greg
> 
>> From: Christopher Kings-Lynne <chriskl@familyhealth.com.au>
>> Date: February 22, 2005 7:02:14 AM PST
>>
>> Can we add an example of using multiple input files on the mkillum 
>> man  page?
>>
>> It took me ages to figure out the "<" business.  I tried it before  
>> _every_ file name, prepended to each filename, etc, etc.
>>
>> Cheers,
>>
>> Chris
> 
> 
> 
> _______________________________________________
> Radiance-dev mailing list
> Radiance-dev@radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-dev

From gvn at retena.com  Fri Feb 25 09:58:02 2005
From: gvn at retena.com (=?iso-8859-1?Q?Ignacio_Mun=E1rriz?=)
Date: Fri Feb 25 10:07:27 2005
Subject: [Radiance-dev] windows Borland Makefile for radiance
Message-ID: <003301c51b18$1cd47d60$53000080@pnac>

I would like to export rtace to windows, building it with borland c++ complier, sure anybody has done it yet, can you help me with the makefile &| srcs? thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://radiance-online.org/pipermail/radiance-dev/attachments/20050225/2002722d/attachment.html
From schorsch at schorsch.com  Fri Feb 25 14:36:16 2005
From: schorsch at schorsch.com (Georg Mischler)
Date: Fri Feb 25 14:36:35 2005
Subject: [Radiance-dev] windows Borland Makefile for radiance
In-Reply-To: <003301c51b18$1cd47d60$53000080@pnac>
References: <003301c51b18$1cd47d60$53000080@pnac>
Message-ID: <Pine.BSF.4.58.0502250834180.78325@emancholl.pair.com>

Ignacio Mun?rriz wrote:

> I would like to export rtace to windows, building it with borland c++
> complier, sure anybody has done it yet, can you help me with the makefile &|
> srcs? thanks

You can use the Scons build system. For this to work, you need
Python (www.python.org) and SCons (www.scons.org) installed on
your system. SCons will use the borland compiler, unless it finds
another one installed on the system first (ie. if you also have
VC installed, then that one will be used).

If all the tools are present, you should be able to build most of
Radiance that way on Windows. Open a console window ("DOS box")
and change to the "ray" directory. Then type "scons .", (or just
"scons bin/rtrace.exe") and the system should do the rest
automatically (depending on your installation, you may need to
specify a full path for SCons).

I assume that the borland compiler accepts different command line
arguments than VC though, so you will most likely have to do some
more editing. Copy the file "ray\platform\win32.cfg" to
"ray\platform\win32_custom.cfg" (the "*_custom.cfg" will be used
if present). Open the new file in a text editor, and modify the
CCFLAGS and LINKFLAGS variables in the [build] and [debug]
sections as needed. If you find a combination that works, please
send me the resulting file, and I'll see if I can integrate it in
a way that it gets selected automatically when borland tools are
used.

I haven't tried to build Radiance on Windows for a while, so you
might run into some problems. If you manage to identify the
causes of any stumbling blocks, or even better if you can whip
up some fixes, please send them to me, and I'll try to update the
CVS version accordingly.


-schorsch

-- 
Georg Mischler  --  simulations developer  --  schorsch at schorsch com
+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/

From gvn at retena.com  Sat Feb 26 10:59:24 2005
From: gvn at retena.com (=?iso-8859-1?Q?Ignacio_Mun=E1rriz?=)
Date: Sat Feb 26 11:08:57 2005
Subject: [Radiance-dev] windows Borland Makefile for radiance
References: <003301c51b18$1cd47d60$53000080@pnac>
	<Pine.BSF.4.58.0502250834180.78325@emancholl.pair.com>
Message-ID: <001401c51be9$d99c5b80$53000080@pnac>

Georg, the first error

scons: Reading SConscript files ...
Detected platform "win32" (nt).
Reading configuration "platform\win32_custom.cfg"
Checking for main() in C library GL... no
meta
cv
gen
ot
rt
px
hd
util
cal
scons: done reading SConscript files.
scons: Building targets ...
bcc32 -q -O2 -H -c -D_WIN32 -DNDEBUG -D_CONSOLE -D_MBCS -Isrc\common -c -o
src\cv\mgflib\3ds2mgf.obj src\cv\mgflib\3ds2mgf.c
Error E2194: Could not find file 'src\cv\mgflib\3ds2mgf.obj'
src\cv\mgflib\3ds2mgf.c:
Warning W8004 src\cv\mgflib\3ds2mgf.c 1277: 'spec' is assigned a value that
is never used in function write_pov10_material
Warning W8004 src\cv\mgflib\3ds2mgf.c 1354: 'spec' is assigned a value that
is never used in function write_pov20_material
Warning W8004 src\cv\mgflib\3ds2mgf.c 1565: 'total' is assigned a value that
is never used in function write_mgf_material
Warning W8004 src\cv\mgflib\3ds2mgf.c 1560: 'smag' is assigned a value that
is never used in function write_mgf_material
Warning W8004 src\cv\mgflib\3ds2mgf.c 1776: 'token' is assigned a value that
is never used in function parse_morph
Warning W8004 src\cv\mgflib\3ds2mgf.c 2026: 'frame' is assigned a value that
is never used in function find_frame
scons: building terminated because of errors.

the problem is that -o must be close to the file, ie
bcc32 -q -O2 -H -c -D_WIN32 -DNDEBUG -D_CONSOLE -D_MBCS -Isrc\common -c -osr
c\cv\mgflib\3ds2mgf.obj src\cv\mgflib\3ds2mgf.c

but i dont know where change it



----- Original Message -----
From: "Georg Mischler" <schorsch@schorsch.com>
To: "code development" <radiance-dev@radiance-online.org>
Sent: Friday, February 25, 2005 2:36 PM
Subject: Re: [Radiance-dev] windows Borland Makefile for radiance


Ignacio Mun?rriz wrote:

> I would like to export rtace to windows, building it with borland c++
> complier, sure anybody has done it yet, can you help me with the makefile
&|
> srcs? thanks

You can use the Scons build system. For this to work, you need
Python (www.python.org) and SCons (www.scons.org) installed on
your system. SCons will use the borland compiler, unless it finds
another one installed on the system first (ie. if you also have
VC installed, then that one will be used).

If all the tools are present, you should be able to build most of
Radiance that way on Windows. Open a console window ("DOS box")
and change to the "ray" directory. Then type "scons .", (or just
"scons bin/rtrace.exe") and the system should do the rest
automatically (depending on your installation, you may need to
specify a full path for SCons).

I assume that the borland compiler accepts different command line
arguments than VC though, so you will most likely have to do some
more editing. Copy the file "ray\platform\win32.cfg" to
"ray\platform\win32_custom.cfg" (the "*_custom.cfg" will be used
if present). Open the new file in a text editor, and modify the
CCFLAGS and LINKFLAGS variables in the [build] and [debug]
sections as needed. If you find a combination that works, please
send me the resulting file, and I'll see if I can integrate it in
a way that it gets selected automatically when borland tools are
used.

I haven't tried to build Radiance on Windows for a while, so you
might run into some problems. If you manage to identify the
causes of any stumbling blocks, or even better if you can whip
up some fixes, please send them to me, and I'll try to update the
CVS version accordingly.


-schorsch

--
Georg Mischler  --  simulations developer  --  schorsch at schorsch com
+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/

_______________________________________________
Radiance-dev mailing list
Radiance-dev@radiance-online.org
http://www.radiance-online.org/mailman/listinfo/radiance-dev



From gvn at retena.com  Sat Feb 26 11:20:34 2005
From: gvn at retena.com (=?iso-8859-1?Q?Ignacio_Mun=E1rriz?=)
Date: Sat Feb 26 11:29:59 2005
Subject: [Radiance-dev] windows Borland Makefile for radiance
References: <003301c51b18$1cd47d60$53000080@pnac><Pine.BSF.4.58.0502250834180.78325@emancholl.pair.com>
	<001401c51be9$d99c5b80$53000080@pnac>
Message-ID: <002201c51bec$ced9a8d0$53000080@pnac>

It is fixed changing scons\tool\bcc32.py but i dont know if it's the way.
arggg! now, learning python :-)


----- Original Message -----
From: "Ignacio Mun?rriz" <gvn@retena.com>
To: "code development" <radiance-dev@radiance-online.org>
Sent: Saturday, February 26, 2005 10:59 AM
Subject: Re: [Radiance-dev] windows Borland Makefile for radiance


> Georg, the first error
>
> scons: Reading SConscript files ...
> Detected platform "win32" (nt).
> Reading configuration "platform\win32_custom.cfg"
> Checking for main() in C library GL... no
> meta
> cv
> gen
> ot
> rt
> px
> hd
> util
> cal
> scons: done reading SConscript files.
> scons: Building targets ...
> bcc32 -q -O2 -H -c -D_WIN32 -DNDEBUG -D_CONSOLE -D_MBCS -Isrc\common -c -o
> src\cv\mgflib\3ds2mgf.obj src\cv\mgflib\3ds2mgf.c
> Error E2194: Could not find file 'src\cv\mgflib\3ds2mgf.obj'
> src\cv\mgflib\3ds2mgf.c:
> Warning W8004 src\cv\mgflib\3ds2mgf.c 1277: 'spec' is assigned a value
that
> is never used in function write_pov10_material
> Warning W8004 src\cv\mgflib\3ds2mgf.c 1354: 'spec' is assigned a value
that
> is never used in function write_pov20_material
> Warning W8004 src\cv\mgflib\3ds2mgf.c 1565: 'total' is assigned a value
that
> is never used in function write_mgf_material
> Warning W8004 src\cv\mgflib\3ds2mgf.c 1560: 'smag' is assigned a value
that
> is never used in function write_mgf_material
> Warning W8004 src\cv\mgflib\3ds2mgf.c 1776: 'token' is assigned a value
that
> is never used in function parse_morph
> Warning W8004 src\cv\mgflib\3ds2mgf.c 2026: 'frame' is assigned a value
that
> is never used in function find_frame
> scons: building terminated because of errors.
>
> the problem is that -o must be close to the file, ie
>
bcc32 -q -O2 -H -c -D_WIN32 -DNDEBUG -D_CONSOLE -D_MBCS -Isrc\common -c -osr
> c\cv\mgflib\3ds2mgf.obj src\cv\mgflib\3ds2mgf.c
>
> but i dont know where change it
>
>
>
> ----- Original Message -----
> From: "Georg Mischler" <schorsch@schorsch.com>
> To: "code development" <radiance-dev@radiance-online.org>
> Sent: Friday, February 25, 2005 2:36 PM
> Subject: Re: [Radiance-dev] windows Borland Makefile for radiance
>
>
> Ignacio Mun?rriz wrote:
>
> > I would like to export rtace to windows, building it with borland c++
> > complier, sure anybody has done it yet, can you help me with the
makefile
> &|
> > srcs? thanks
>
> You can use the Scons build system. For this to work, you need
> Python (www.python.org) and SCons (www.scons.org) installed on
> your system. SCons will use the borland compiler, unless it finds
> another one installed on the system first (ie. if you also have
> VC installed, then that one will be used).
>
> If all the tools are present, you should be able to build most of
> Radiance that way on Windows. Open a console window ("DOS box")
> and change to the "ray" directory. Then type "scons .", (or just
> "scons bin/rtrace.exe") and the system should do the rest
> automatically (depending on your installation, you may need to
> specify a full path for SCons).
>
> I assume that the borland compiler accepts different command line
> arguments than VC though, so you will most likely have to do some
> more editing. Copy the file "ray\platform\win32.cfg" to
> "ray\platform\win32_custom.cfg" (the "*_custom.cfg" will be used
> if present). Open the new file in a text editor, and modify the
> CCFLAGS and LINKFLAGS variables in the [build] and [debug]
> sections as needed. If you find a combination that works, please
> send me the resulting file, and I'll see if I can integrate it in
> a way that it gets selected automatically when borland tools are
> used.
>
> I haven't tried to build Radiance on Windows for a while, so you
> might run into some problems. If you manage to identify the
> causes of any stumbling blocks, or even better if you can whip
> up some fixes, please send them to me, and I'll try to update the
> CVS version accordingly.
>
>
> -schorsch
>
> --
> Georg Mischler  --  simulations developer  --  schorsch at schorsch com
> +schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/
>
> _______________________________________________
> Radiance-dev mailing list
> Radiance-dev@radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-dev
>
>
>
> _______________________________________________
> Radiance-dev mailing list
> Radiance-dev@radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-dev
>


From gvn at retena.com  Sat Feb 26 13:54:02 2005
From: gvn at retena.com (=?iso-8859-1?Q?Ignacio_Mun=E1rriz?=)
Date: Sat Feb 26 14:03:30 2005
Subject: [Radiance-dev] windows Borland Makefile for radiance
References: <003301c51b18$1cd47d60$53000080@pnac><Pine.BSF.4.58.0502250834180.78325@emancholl.pair.com><001401c51be9$d99c5b80$53000080@pnac>
	<002201c51bec$ced9a8d0$53000080@pnac>
Message-ID: <002801c51c02$3f5bf2b0$53000080@pnac>

Another error, the libs need the .lib extension
ie
bcc32 -q /Lc:\cpp\ray\src\lib src\cv\arch2rad.obj src\cv\trans.obj
rtcont.lib rtmem.lib
but i dont know where change it (again)


scons: Reading SConscript files ...
Detected platform "win32" (nt).
Reading configuration "platform\win32_custom.cfg"
Checking for main() in C library GL... no
meta
cv
gen
ot
rt
px
hd
util
cal
scons: done reading SConscript files.
scons: Building targets ...
bcc32 -q /Lc:\cpp\ray\src\lib src\cv\mgflib\3ds2mgf.obj
src\cv\mgflib\rayopt.obj src\cv\mgflib\vect.obj src\lib\mgf.lib
bcc32 -q /Lc:\cpp\ray\src\lib src\cv\arch2rad.obj src\cv\trans.obj rtcont
rtmem
Error E2194: Could not find file 'rtcont.cpp'
Error E2194: Could not find file 'rtmem.cpp'
scons: building terminated because of errors.


----- Original Message -----
From: "Ignacio Mun?rriz" <gvn@retena.com>
To: "code development" <radiance-dev@radiance-online.org>
Sent: Saturday, February 26, 2005 11:20 AM
Subject: Re: [Radiance-dev] windows Borland Makefile for radiance


> It is fixed changing scons\tool\bcc32.py but i dont know if it's the way.
> arggg! now, learning python :-)
>
>
> ----- Original Message -----
> From: "Ignacio Mun?rriz" <gvn@retena.com>
> To: "code development" <radiance-dev@radiance-online.org>
> Sent: Saturday, February 26, 2005 10:59 AM
> Subject: Re: [Radiance-dev] windows Borland Makefile for radiance
>
>
> > Georg, the first error
> >
> > scons: Reading SConscript files ...
> > Detected platform "win32" (nt).
> > Reading configuration "platform\win32_custom.cfg"
> > Checking for main() in C library GL... no
> > meta
> > cv
> > gen
> > ot
> > rt
> > px
> > hd
> > util
> > cal
> > scons: done reading SConscript files.
> > scons: Building targets ...
> >
bcc32 -q -O2 -H -c -D_WIN32 -DNDEBUG -D_CONSOLE -D_MBCS -Isrc\common -c -o
> > src\cv\mgflib\3ds2mgf.obj src\cv\mgflib\3ds2mgf.c
> > Error E2194: Could not find file 'src\cv\mgflib\3ds2mgf.obj'
> > src\cv\mgflib\3ds2mgf.c:
> > Warning W8004 src\cv\mgflib\3ds2mgf.c 1277: 'spec' is assigned a value
> that
> > is never used in function write_pov10_material
> > Warning W8004 src\cv\mgflib\3ds2mgf.c 1354: 'spec' is assigned a value
> that
> > is never used in function write_pov20_material
> > Warning W8004 src\cv\mgflib\3ds2mgf.c 1565: 'total' is assigned a value
> that
> > is never used in function write_mgf_material
> > Warning W8004 src\cv\mgflib\3ds2mgf.c 1560: 'smag' is assigned a value
> that
> > is never used in function write_mgf_material
> > Warning W8004 src\cv\mgflib\3ds2mgf.c 1776: 'token' is assigned a value
> that
> > is never used in function parse_morph
> > Warning W8004 src\cv\mgflib\3ds2mgf.c 2026: 'frame' is assigned a value
> that
> > is never used in function find_frame
> > scons: building terminated because of errors.
> >
> > the problem is that -o must be close to the file, ie
> >
>
bcc32 -q -O2 -H -c -D_WIN32 -DNDEBUG -D_CONSOLE -D_MBCS -Isrc\common -c -osr
> > c\cv\mgflib\3ds2mgf.obj src\cv\mgflib\3ds2mgf.c
> >
> > but i dont know where change it
> >
> >
> >
> > ----- Original Message -----
> > From: "Georg Mischler" <schorsch@schorsch.com>
> > To: "code development" <radiance-dev@radiance-online.org>
> > Sent: Friday, February 25, 2005 2:36 PM
> > Subject: Re: [Radiance-dev] windows Borland Makefile for radiance
> >
> >
> > Ignacio Mun?rriz wrote:
> >
> > > I would like to export rtace to windows, building it with borland c++
> > > complier, sure anybody has done it yet, can you help me with the
> makefile
> > &|
> > > srcs? thanks
> >
> > You can use the Scons build system. For this to work, you need
> > Python (www.python.org) and SCons (www.scons.org) installed on
> > your system. SCons will use the borland compiler, unless it finds
> > another one installed on the system first (ie. if you also have
> > VC installed, then that one will be used).
> >
> > If all the tools are present, you should be able to build most of
> > Radiance that way on Windows. Open a console window ("DOS box")
> > and change to the "ray" directory. Then type "scons .", (or just
> > "scons bin/rtrace.exe") and the system should do the rest
> > automatically (depending on your installation, you may need to
> > specify a full path for SCons).
> >
> > I assume that the borland compiler accepts different command line
> > arguments than VC though, so you will most likely have to do some
> > more editing. Copy the file "ray\platform\win32.cfg" to
> > "ray\platform\win32_custom.cfg" (the "*_custom.cfg" will be used
> > if present). Open the new file in a text editor, and modify the
> > CCFLAGS and LINKFLAGS variables in the [build] and [debug]
> > sections as needed. If you find a combination that works, please
> > send me the resulting file, and I'll see if I can integrate it in
> > a way that it gets selected automatically when borland tools are
> > used.
> >
> > I haven't tried to build Radiance on Windows for a while, so you
> > might run into some problems. If you manage to identify the
> > causes of any stumbling blocks, or even better if you can whip
> > up some fixes, please send them to me, and I'll try to update the
> > CVS version accordingly.
> >
> >
> > -schorsch
> >
> > --
> > Georg Mischler  --  simulations developer  --  schorsch at schorsch com
> > +schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/
> >
> > _______________________________________________
> > Radiance-dev mailing list
> > Radiance-dev@radiance-online.org
> > http://www.radiance-online.org/mailman/listinfo/radiance-dev
> >
> >
> >
> > _______________________________________________
> > Radiance-dev mailing list
> > Radiance-dev@radiance-online.org
> > http://www.radiance-online.org/mailman/listinfo/radiance-dev
> >
>
>
> _______________________________________________
> Radiance-dev mailing list
> Radiance-dev@radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-dev
>


From schorsch at schorsch.com  Sat Feb 26 14:21:04 2005
From: schorsch at schorsch.com (Georg Mischler)
Date: Sat Feb 26 14:21:17 2005
Subject: [Radiance-dev] windows Borland Makefile for radiance
In-Reply-To: <001401c51be9$d99c5b80$53000080@pnac>
References: <003301c51b18$1cd47d60$53000080@pnac>
	<Pine.BSF.4.58.0502250834180.78325@emancholl.pair.com>
	<001401c51be9$d99c5b80$53000080@pnac>
Message-ID: <Pine.BSF.4.58.0502260753360.19010@emancholl.pair.com>

Ignacio Mun?rriz wrote:

> Georg, the first error

> the problem is that -o must be close to the file, ie
> bcc32 -q -O2 -H -c -D_WIN32 -DNDEBUG -D_CONSOLE -D_MBCS -Isrc\common -c -osr
> c\cv\mgflib\3ds2mgf.obj src\cv\mgflib\3ds2mgf.c

So you're saying that your version requires this:
 ... -osrc\cv\mgflib\3ds2mgf.obj ...
instead of this:
 ... -o src\cv\mgflib\3ds2mgf.obj ...
?

That seems to be a bug in bcc32.py, although I assume there
must be versions of bcc where it works as implemented.
There already was a bug report about this filed for SCons,
but I've just submitted a patch as well (trivial as it is).

I think you already found the file SCons/Tool/bcc32.py.
You don't really need to understand much of Python to fix it.
The change is in the two strings that contain the -o flag.

    env['CCCOM']     = '$CC -q $CCFLAGS $CPPFLAGS $_CPPDEFFLAGS $_CPPINCFLAGS -c -o$TARGET $SOURCES'

	env['SHCCCOM']   = '$SHCC -WD $SHCCFLAGS $CPPFLAGS $_CPPDEFFLAGS $_CPPINCFLAGS -c -o$TARGET $SOURCES'

The trick is just to remove the offending space character
in those two command line templates. After that, it should
work with your version of bcc too.


-schorsch

-- 
Georg Mischler  --  simulations developer  --  schorsch at schorsch com
+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/

From schorsch at schorsch.com  Sat Feb 26 16:17:02 2005
From: schorsch at schorsch.com (Georg Mischler)
Date: Sat Feb 26 16:17:09 2005
Subject: [Radiance-dev] windows Borland Makefile for radiance
In-Reply-To: <002801c51c02$3f5bf2b0$53000080@pnac>
References: <003301c51b18$1cd47d60$53000080@pnac><Pine.BSF.4.58.0502250834180.78325@emancholl.pair.com><001401c51be9$d99c5b80$53000080@pnac>
	<002201c51bec$ced9a8d0$53000080@pnac>
	<002801c51c02$3f5bf2b0$53000080@pnac>
Message-ID: <Pine.BSF.4.58.0502261014220.19010@emancholl.pair.com>

Ignacio Mun?rriz wrote:

> Another error, the libs need the .lib extension
> ie
> bcc32 -q /Lc:\cpp\ray\src\lib src\cv\arch2rad.obj src\cv\trans.obj
> rtcont.lib rtmem.lib
> but i dont know where change it (again)


My guess would be the ilink32.py file in the same location.
Add a line linke this at the end of the other environment
initializations:

    env['LINKSUFFIX']='.lib'

Make sure that there are exactly four space characters in
front of the "env", because indentation is significant in Python.
If that works, then I'll submit it as another patch to SCons.


-schorsch

-- 
Georg Mischler  --  simulations developer  --  schorsch at schorsch com
+schorsch.com+  --  lighting design tools  --  http://www.schorsch.com/

