From jacobs.axel at gmail.com  Thu Jan 19 07:06:52 2012
From: jacobs.axel at gmail.com (Axel Jacobs)
Date: Thu, 19 Jan 2012 15:06:52 +0000
Subject: [Radiance-dev] warning request: rpiece image resolution
Message-ID: <CA+dqh63S-XPkt3uztkKU6ARWS2jvZWfUjr0H7bgrFMM7sgfZuw@mail.gmail.com>

Dear list,

I appreciate the irony: with the 'no light sources' warning removed
from rpict, I would like to request a new warning, this time for
rpiece.

vwrays and rpict calculate the overall image dimensions from the -v*
parameters and the -x and -y image dimensions. When rpict is run
through rpiece, the image is split up into tiles, each of which is
rendered in a separate thread. The tiles are then pcomposed into the
final image. The width of the final image is xdim = tilex * xdiv,
where tilex is computed by rpiece. Since tilex needs to be an int, it
is actually calculated as floor(xdim / xdiv). If the requested xdim is
not divisible by xdiv, xdim of an image generated by rpiece will be
smaller than xdim of an image with exactly the same -v*, -x and -y
generated by rpict. Same goes for the height of of the image...

I have stumbled across this a few times now. Admittedly, I tend to use
rpictmt from http://www.bakharev.org/index.php?option=com_content&task=view&id=23&Itemid=38,
which is a convenient wrapper around rpiece, although it makes no
difference to the problem at hand.

So my feature request is actually a warning request: Could rpiece
output a warning like:
"warning: requested image size of xdim x ydim reduced to xdim1 x
ydim1" to stderr.
It would be even cooler if the last tile within a row had its tilex
adjusted so that the final image comes out exacly like an rpict one
(ditto for tiley for all tiles within the last row), but this is
probably more difficult to implement, otherwise I guess you would have
done it already.

Many thanks

Axel


From gregoryjward at gmail.com  Thu Jan 19 19:58:02 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Thu, 19 Jan 2012 19:58:02 -0800
Subject: [Radiance-dev] warning request: rpiece image resolution
In-Reply-To: <CA+dqh63S-XPkt3uztkKU6ARWS2jvZWfUjr0H7bgrFMM7sgfZuw@mail.gmail.com>
References: <CA+dqh63S-XPkt3uztkKU6ARWS2jvZWfUjr0H7bgrFMM7sgfZuw@mail.gmail.com>
Message-ID: <CCB8398A-252E-44CC-920B-25A851993C6B@gmail.com>

Hi Axel,

Because I use the -S option to rpict when rpiece calls it, I can't change the output resolution of the tiles -- they all have to match up exactly.

I thought about adding a warning, but I'm muddled as to when to warn the user and when not to.  Oftentimes, a particular view demands that one or the other image side be reduced to fit the desired pixel aspect ratio (1.0 for square pixels by default).  I don't think the user wants to be warned about this standard rpict-like behavior.  You only want to know when the dimensions produced by rpiece will differ from those that would have been produced by calling rpict directly, right?

-Greg

> From: Axel Jacobs <jacobs.axel at gmail.com>
> Date: January 19, 2012 7:06:52 AM PST
> 
> Dear list,
> 
> I appreciate the irony: with the 'no light sources' warning removed
> from rpict, I would like to request a new warning, this time for
> rpiece.
> 
> vwrays and rpict calculate the overall image dimensions from the -v*
> parameters and the -x and -y image dimensions. When rpict is run
> through rpiece, the image is split up into tiles, each of which is
> rendered in a separate thread. The tiles are then pcomposed into the
> final image. The width of the final image is xdim = tilex * xdiv,
> where tilex is computed by rpiece. Since tilex needs to be an int, it
> is actually calculated as floor(xdim / xdiv). If the requested xdim is
> not divisible by xdiv, xdim of an image generated by rpiece will be
> smaller than xdim of an image with exactly the same -v*, -x and -y
> generated by rpict. Same goes for the height of of the image...
> 
> I have stumbled across this a few times now. Admittedly, I tend to use
> rpictmt from http://www.bakharev.org/index.php?option=com_content&task=view&id=23&Itemid=38,
> which is a convenient wrapper around rpiece, although it makes no
> difference to the problem at hand.
> 
> So my feature request is actually a warning request: Could rpiece
> output a warning like:
> "warning: requested image size of xdim x ydim reduced to xdim1 x
> ydim1" to stderr.
> It would be even cooler if the last tile within a row had its tilex
> adjusted so that the final image comes out exacly like an rpict one
> (ditto for tiley for all tiles within the last row), but this is
> probably more difficult to implement, otherwise I guess you would have
> done it already.
> 
> Many thanks
> 
> Axel


From jacobs.axel at gmail.com  Fri Jan 20 00:04:28 2012
From: jacobs.axel at gmail.com (Axel Jacobs)
Date: Fri, 20 Jan 2012 08:04:28 +0000
Subject: [Radiance-dev] warning request: rpiece image resolution
Message-ID: <4F19200C.1020709@gmail.com>

Hello, Greg,

 > Because I use the -S option to rpict when rpiece calls it, I can't
 > change the output resolution of the tiles -- they all have to match
 > up exactly.

Oh, I see...

 > I thought about adding a warning, but I'm muddled as to when to warn
 > the user and when not to.  Oftentimes, a particular view demands that
 > one or the other image side be reduced to fit the desired pixel
 > aspect ratio (1.0 for square pixels by default).  I don't think the
 > user wants to be warned about this standard rpict-like behavior.  You
 > only want to know when the dimensions produced by rpiece will differ
 > from those that would have been produced by calling rpict directly,
 > right?

Yes, only if and when the rpiece image would have different dimensions 
to the rpict image. I don't want to know when rpiece/vwray do their 
normal job. I didn't bring this up in my original post, because the 
aspect ratio adjustment of -x or -y happens all the time. Ideally, the 
warning should output those adjusted image dimensions, not the raw -x -y 
request. Does that make sense?

-Greg

 >> From: Axel Jacobs <jacobs.axel at gmail.com>
 > Date: January 19, 2012 7:06:52 AM PST
 >>
 >> Dear list,
 >>
 >> I appreciate the irony: with the 'no light sources' warning removed
 >> from rpict, I would like to request a new warning, this time for
 >> rpiece.
 >>
 >> vwrays and rpict calculate the overall image dimensions from the -v*
 >> parameters and the -x and -y image dimensions. When rpict is run
 >> through rpiece, the image is split up into tiles, each of which is
 >> rendered in a separate thread. The tiles are then pcomposed into the
 >> final image. The width of the final image is xdim = tilex * xdiv,
 >> where tilex is computed by rpiece. Since tilex needs to be an int, it
 >> is actually calculated as floor(xdim / xdiv). If the requested xdim 
 >> is
 >> not divisible by xdiv, xdim of an image generated by rpiece will be
 >> smaller than xdim of an image with exactly the same -v*, -x and -y
 >> generated by rpict. Same goes for the height of of the image...
 >>
 >> I have stumbled across this a few times now. Admittedly, I tend to
 >> use
 >> rpictmt from 
http://www.bakharev.org/index.php?option=com_content&task=view&id=23&Itemid=38,
 >> which is a convenient wrapper around rpiece, although it makes no
 >> difference to the problem at hand.
 >>
 >> So my feature request is actually a warning request: Could rpiece
 >> output a warning like:
 >> "warning: requested image size of xdim x ydim reduced to xdim1 x
 >> ydim1" to stderr.
 >> It would be even cooler if the last tile within a row had its tilex
 >> adjusted so that the final image comes out exacly like an rpict one
 >> (ditto for tiley for all tiles within the last row), but this is
 >> probably more difficult to implement, otherwise I guess you would
 >> have done it already.



From pejapopovic at yahoo.com  Sat Jan 21 10:39:02 2012
From: pejapopovic at yahoo.com (Predrag Popovic)
Date: Sat, 21 Jan 2012 10:39:02 -0800 (PST)
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 -
	beginner
Message-ID: <1327171142.12338.YahooMailNeo@web122005.mail.ne1.yahoo.com>

Hi,

This is the first open source project that I am attempting to build. I am new to Python development and a hobby user of C and C++. 

I've used a post from Randolph Fritz,? http://www.radiance-online.org/pipermail/radiance-dev/2011-February/001109.html , to download latest HEAD files.
I've downloaded Auxiliary library files from http://www.radiance-online.org/software/non-cvs/rad4R1supp.tar.gz

All the files were downloaded on 2011-01-18.


I've downloaded Radiance binaries from http://www.bozzograo.net/radiance/index.php?module=Downloads&func=display&lid=22 , but the fact that the disclaimer states that some "useful programs" are not available, deters me, as a complete Radiance beginner, to consider that binary.?

I've tried several different approaches and I am stumped as to what the problem could be.


1. The following error appears:
??? C:\Ray\ray>scons
??? ??? scons: Reading SConscript files ...
??? ??? Detected platform "win32" (nt).
??? ??? Reading configuration "platform\mingw.cfg"
??? ??? TypeError: sequence item 0: expected string, function found:
??? ??? ? File "C:\Ray\ray\SConstruct", line 57:
??? ??? ??? load_plat.load_plat(env, ARGUMENTS, platform=None)
??? ??? ? File "C:\Ray\ray\build_utils\load_plat.py", line 78:
??? ??? ??? read_plat(env, args, pfn)
??? ??? ? File "C:\Ray\ray\build_utils\load_plat.py", line 12:
??? ??? ??? cfig.read(fn)
??? ??? ? File "C:\Python27\lib\ConfigParser.py", line 297:
??? ??? ??? self._read(fp, filename)
??? ??? ? File "C:\Python27\lib\ConfigParser.py", line 546:
??? ??? ??? options[name] = '\n'.join(val)

??? ??? C:\Ray\ray>

Where C:\Ray is where I've download the HEAD files

2. I've tried to debug this program but with my limited knowledge of Python, I cannot get the line cfig.read(fn) in load_plat.py

to read the mingw.cfg file.

I've ran 

??? print os.path.isfile(fn) #the file exists
??? print os.path.realpath(fn) #Returns this correctly: C:\Ray\ray\platform\mingw.cfg

before cfig.read(fn) and both output expected result
I've tried also cfig.read('c:\\Ray\\ray\\platform\\mingw.cfg') but that also fails (e.g. the file is not read and is ignored.)

Finally I've inserted 

print cfig.sections() 

statement after the line cfig.read(fn), to check if the file is open. In all cases it returns an empty string.?

In fact when 'print' statement is used with code:
# XXX Check that basedir exists.
??? for k in ['RAD_BINDIR', 'RAD_RLIBDIR', 'RAD_MANDIR']:
??? ??? if (env.has_key('RAD_BASEDIR') and env.has_key(k)
??? ??? ??? ??? and not os.path.isabs(env[k])):
??? ??? ??? env[k] = os.path.join(env['RAD_BASEDIR'],env[k])??? 


The "if statement" is never processed as env.has_key('RAD_BASEDIR') returns False. 



3. My platform is: 

Windows XP, Service Pack 2 

Python 2.7.2
MinGW:
??? MINGWBASEDIR=C:\MinGW
??? gcc version 4.6.1 (GCC)
??? gcc version 4.6.1 (GCC)
??? GNU gdb (GDB) 7.3.1
??? GNU ld (GNU Binutils) 2.21.53.20110804
??? GNU windres (GNU Binutils) 2.21.53.20110804
??? GNU dlltool (GNU Binutils) 2.21.53.20110804
??? GNU Make 3.82
??? #define __MINGW32_VERSION?????????? 3.20
??? #define __W32API_VERSION 3.17

MSYS 1.0
Scons 2.1.0 r5357

My Environment path is configured to include MinGW, MSYS, Python27, Python27/Scripts directories.

Any help in solving this issue is appreciated.

Thank you

Peja
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-dev/attachments/20120121/f1569692/attachment.html>

From gregoryjward at gmail.com  Sat Jan 21 14:01:33 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Sat, 21 Jan 2012 14:01:33 -0800
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 -
	beginner
In-Reply-To: <1327171142.12338.YahooMailNeo@web122005.mail.ne1.yahoo.com>
References: <1327171142.12338.YahooMailNeo@web122005.mail.ne1.yahoo.com>
Message-ID: <F4C63B1D-54EA-48A3-9534-7D9DADF6A2E6@gmail.com>

This is something of a headache.  I don't think the SCONS build system is working at all anymore -- does anyone use it?  Some folks at NREL hired Kitware to replace it with a newer cmake cross-platform build system that is (mostly) ready at this stage.  Rob Guglielmetti will probably chime in with the latest status on that project.

Meanwhile, you should feel free to use the binaries from Francesco you found to begin with.  They may not be complete in the sense that there are a few missing programs, but much of what you need to run Radiance is there.

Please don't spend any of your time trying to repair the SCONS system.  We really should remove it from the repository.  Can I get people's opinions on that?

Best,
-Greg

> From: Predrag Popovic <pejapopovic at yahoo.com>
> Date: January 21, 2012 10:39:02 AM PST
> 
> Hi,
> 
> This is the first open source project that I am attempting to build. I am new to Python development and a hobby user of C and C++. 
> I've used a post from Randolph Fritz,  http://www.radiance-online.org/pipermail/radiance-dev/2011-February/001109.html , to download latest HEAD files.
> I've downloaded Auxiliary library files from http://www.radiance-online.org/software/non-cvs/rad4R1supp.tar.gz
> 
> All the files were downloaded on 2011-01-18.
> 
> I've downloaded Radiance binaries from http://www.bozzograo.net/radiance/index.php?module=Downloads&func=display&lid=22 , but the fact that the disclaimer states that some "useful programs" are not available, deters me, as a complete Radiance beginner, to consider that binary. 
> 
> I've tried several different approaches and I am stumped as to what the problem could be.
> 
> 1. The following error appears:
>     C:\Ray\ray>scons
>         scons: Reading SConscript files ...
>         Detected platform "win32" (nt).
>         Reading configuration "platform\mingw.cfg"
>         TypeError: sequence item 0: expected string, function found:
>           File "C:\Ray\ray\SConstruct", line 57:
>             load_plat.load_plat(env, ARGUMENTS, platform=None)
>           File "C:\Ray\ray\build_utils\load_plat.py", line 78:
>             read_plat(env, args, pfn)
>           File "C:\Ray\ray\build_utils\load_plat.py", line 12:
>             cfig.read(fn)
>           File "C:\Python27\lib\ConfigParser.py", line 297:
>             self._read(fp, filename)
>           File "C:\Python27\lib\ConfigParser.py", line 546:
>             options[name] = '\n'.join(val)
> 
>         C:\Ray\ray>
> 
> Where C:\Ray is where I've download the HEAD files
> 
> 2. I've tried to debug this program but with my limited knowledge of Python, I cannot get the line cfig.read(fn) in load_plat.py 
> to read the mingw.cfg file.
> 
> I've ran 
>     print os.path.isfile(fn) #the file exists
>     print os.path.realpath(fn) #Returns this correctly: C:\Ray\ray\platform\mingw.cfg
> 
> before cfig.read(fn) and both output expected result
> I've tried also cfig.read('c:\\Ray\\ray\\platform\\mingw.cfg') but that also fails (e.g. the file is not read and is ignored.)
> 
> Finally I've inserted 
> print cfig.sections() 
> statement after the line cfig.read(fn), to check if the file is open. In all cases it returns an empty string. 
> 
> In fact when 'print' statement is used with code:
> # XXX Check that basedir exists.
>     for k in ['RAD_BINDIR', 'RAD_RLIBDIR', 'RAD_MANDIR']:
>         if (env.has_key('RAD_BASEDIR') and env.has_key(k)
>                 and not os.path.isabs(env[k])):
>             env[k] = os.path.join(env['RAD_BASEDIR'],env[k])    
> 
> The "if statement" is never processed as env.has_key('RAD_BASEDIR') returns False. 
> 
> 
> 3. My platform is: 
> Windows XP, Service Pack 2 
> Python 2.7.2
> MinGW:
>     MINGWBASEDIR=C:\MinGW
>     gcc version 4.6.1 (GCC)
>     gcc version 4.6.1 (GCC)
>     GNU gdb (GDB) 7.3.1
>     GNU ld (GNU Binutils) 2.21.53.20110804
>     GNU windres (GNU Binutils) 2.21.53.20110804
>     GNU dlltool (GNU Binutils) 2.21.53.20110804
>     GNU Make 3.82
>     #define __MINGW32_VERSION           3.20
>     #define __W32API_VERSION 3.17
> MSYS 1.0
> Scons 2.1.0 r5357
> 
> My Environment path is configured to include MinGW, MSYS, Python27, Python27/Scripts directories.
> 
> Any help in solving this issue is appreciated.
> 
> Thank you
> 
> Peja
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-dev/attachments/20120121/039fcb15/attachment.html>

From gregoryjward at gmail.com  Sat Jan 21 14:09:10 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Sat, 21 Jan 2012 14:09:10 -0800
Subject: [Radiance-dev] warning request: rpiece image resolution
In-Reply-To: <4F1B0003.7040009@gmail.com>
References: <4F19200C.1020709@gmail.com>
	<25B323CF-FF7B-46E5-8AB8-D46E1F9B110B@gmail.com>
	<4F1AC24B.1050901@gmail.com>
	<185DCA74-DD0D-4C19-A4EC-667BA23A627A@gmail.com>
	<4F1B0003.7040009@gmail.com>
Message-ID: <A177ACEB-C533-43D6-856B-395E3CF1429E@gmail.com>

Hi Axel,

Sorry -- I missed the attachment in your previous method.  I see that the spacing in the sync file is as it should be, so it must be the lock manager.  You could try adding a 2-5 second wait (sleep 5) after each spawning of a new rpiece process.  This gives the system time to do its thing before the next one opens the file.

I checked in the new version with warning.

Best,
-Greg

> From: Axel Jacobs <jacobs.axel at gmail.com>
> Date: January 21, 2012 10:12:19 AM PST
> 
> Hi Greg,
> 
> On 01/21/2012 05:55 PM, Gregory J. Ward wrote:
> 
>> Yes, the resolution can go either up or down from what rpict would normally do.
>> It should still stay within the original -x and -y bounds in any case.
>> 
>> Regarding your duplicated and extraneous tiles, I can only suppose
> > that your lock manager isn't behaving well.  I looked over the code again,
>> and I can't see any other way you would get duplicate pieces unless the
>> lock manager wasn't providing exclusive access to the sync file as it should.
>> This could also cause occasional problems reading the dimension limits
> > (generating a piece that's out of range), though that's even harder
> > for me to fathom.
> 
> Hmm, seems to be one of those obscure LINUX-only bugs, that are so hard to track down.
> 
>> Are you running any of your rpiece commands with the -R option
> > rather than -F?  Using multiple rpiece commands with -R is the only
> > time you should end up with duplicate pieces, which is why the man page
> > advises against it.  It also needs to be started when no other rpiece
> > jobs are running.
> 
> It's a straight-forward -F, as in the script that I sent you. I tend to not use -R at all.
> 
>> I'll check your changes in later this weekend.
> 
> Two sync files attached.
> 
> Thanks
> 
> Axel


============
> From: Axel Jacobs <jacobs.axel at gmail.com>
> Date: January 21, 2012 5:48:59 AM PST
> To: "Gregory J. Ward" <gregoryjward at gmail.com>
> Subject: Re: [Radiance-dev] warning request: rpiece image resolution
> 
> Hi Greg,
> 
>> See if the attached does what you want, then:
> 
> The new version of rpiece.c works well. I included the requested, aspectratio-adjusted image dimensions as well (which would be nice to have in the official version):
> 
> 	if (!nowarn && (hr != hres*hmult) | (vr != vres*vmult))
> 		fprintf(stderr, "%s: warning - resolution changed from %dx%d to %dx%d\n",
> 				progname, hr, vr, hres*hmult, vres*vmult);
> 
> and did a few test runs with a scene taken from one of the recipes in the Cookbook. I am attaching this test scene with a BASH script that loops over a number of request dims and compares the resulting image dimensions from an rpict against rpiece.
> 
> I was surprised to find that the rpiece dims can actually be larger than the rpict dims, as shown below. This isn't a problem--I just didn't expect this to happen:
> 
> resolution: 300
> rpict: images/hdr/rpict.hdr: -Y 215 +X 300
> rpiece: warning - resolution changed from 300x215 to 300x216
> rpiece: warning - resolution changed from 300x215 to 300x216
> rpiece: warning - resolution changed from 300x215 to 300x216
> rpiece: warning - resolution changed from 300x215 to 300x216
> rpiece: images/hdr/300.hdr: -Y 216 +X 300
> ...
> 
> man rpiece only mentions that the dims can be smaller:
> "The overall picture dimensions will be xres by yres
> (or smaller, depending on the -pa option and other view options)"
> 
> I also came across a rather obscure behaviour that I have been observing for quite some time, although I have not been able to a) reliably reproduce it, and b) find out why this happens. When I run the script repeatedly, every now and then, it will produce an rpiece warning about a piece being out of range.
> 
> resolution: 302
> rpict: images/rpict.hdr: -Y 217 +X 302
> rpiece: warning - resolution changed from 302x217 to 300x216
> rpiece: warning - resolution changed from 302x217 to 300x216
> rpiece: warning - resolution changed from 302x217 to 300x216
> rpiece: requested piece (3,1) out of range
> rpiece: warning - resolution changed from 302x217 to 300x216
> rpict: signal - Broken pipe
> rpict: 9600 rays, 0.00% after 0.000u 0.000s 0.000r hours on dove.localdomain
> rpiece: images/302.hdr: -Y 216 +X 300
> 
> With XDIV and YDIV both being set to 3, the (3,1) piece would indeed be out of range. This warning crops up with about every fifth to tenth run of rpiece. The image still finishes all right in such a case. I've observed this on three different LINUX machines.
> 
> The syncfiles from the last run are kept under temp/. I noticed that occasionally, a particular piece is requested twice, as seen in this sync file where this is the case wit the (2,1) piece:
> 
>   3    3
>   0    0
> 
>   2    2
>   1    2
>   1    1
>   2    0
>   1    0
>   0    2
>   2    1
>   2    1
>   0    1
>   0    0
> 
> There appears to be no correlation between this happening and the piece-out-of-range warning--either can occur without the other, I think.
> 
> Thank you so much for the new warning. It's kind of an obvious little detail, but the first time I ran into this resolution problem, it took me two hours to work out what's going on. The second time, it still took half an hour for me to fix it, because I had forgotten what the problem was the first time 'round. This is much better now, although admittedly, there can be quite a bit of noise when you run lots of parallel processes (the -w switch works correctly and disables the new res warning).
> 
> Cheers
> 
> Axel
> 
> 
> 
> [The attachment rpiece_warning_testscene.tar.gz has been manually removed]
> 


From guy.vaessen at gmail.com  Sat Jan 21 15:22:27 2012
From: guy.vaessen at gmail.com (Guy Vaessen)
Date: Sun, 22 Jan 2012 00:22:27 +0100
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 -
	beginner
Message-ID: <CAFXPCRZuwoOkWZNMqbMaQg3fyS62erQ+T+t_4mCZ26En5+h47g@mail.gmail.com>

Although Scons 1.3.1 (the old version!) is still able to compile Radiance
4.2a, I do think it's time for the Scons build system to be removed.
If you're new to Radiance I would go for some precompiled binaries to run
Radiance as they also set the right environment variables in Windows.

If I remember correctly the NREL/CMAKE build system has some additional
features planned/implemented compared to the Scons/MinGW system. (rvu for
Windows), although I haven't seen it yet.
So it would be nice to hear the latest status of that project.

Best Regards,

Guy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-dev/attachments/20120122/167cdd25/attachment.html>

From Robert.Guglielmetti at nrel.gov  Sun Jan 22 09:32:02 2012
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Sun, 22 Jan 2012 10:32:02 -0700
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2
	-	beginner
In-Reply-To: <CAFXPCRZuwoOkWZNMqbMaQg3fyS62erQ+T+t_4mCZ26En5+h47g@mail.gmail.com>
References: <CAFXPCRZuwoOkWZNMqbMaQg3fyS62erQ+T+t_4mCZ26En5+h47g@mail.gmail.com>
Message-ID: <FFF56A6D37A3A54F91A03601AC22DA322338CB61B0@MAILBOX2.nrel.gov>

Hi everyone,

I agree with Guy and Greg, the Scons system could probably go away. 

As for NREL's CMake effort, we are just about done. There is a Qt-based rvu that runs on Windows, and all the new three phase daylight coefficient tools compile as well. I have made a bunch of changes to the CMake files throughout the source tree, which I need to coordinate with Kitware and Greg to make them easily patched into the CVS trunk. I am also missing a few programs in the build, which I will fix up this week. Our web goddess will also add an indemnification step to our download links, as which point we can announce the new support page which will offer a variety of binary packages and installers for all three platforms (Greg, this will also obviate the need to add/change the License.txt file; less lawyers = good). We are also testing more relevant, core programs opposed to the Scons test suite. There is little test coverage, and the tests are pretty weak to boot, but it's a start. I'm hoping we can get a help page up soon that will allow others to add their systems to the dashboard, as well as offer guidance on writing your own tests for the Radiance binaries. 

I know I've been promising this for a while now, but we really are very close at this point.

Rob G.
NREL



________________________________________
From: Guy Vaessen [guy.vaessen at gmail.com]
Sent: Saturday, January 21, 2012 4:22 PM
To: radiance-dev at radiance-online.org
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 -  beginner

Although Scons 1.3.1 (the old version!) is still able to compile Radiance 4.2a, I do think it's time for the Scons build system to be removed.
If you're new to Radiance I would go for some precompiled binaries to run Radiance as they also set the right environment variables in Windows.

If I remember correctly the NREL/CMAKE build system has some additional features planned/implemented compared to the Scons/MinGW system. (rvu for Windows), although I haven't seen it yet.
So it would be nice to hear the latest status of that project.

Best Regards,

Guy




From pejapopovic at yahoo.com  Sun Jan 22 09:58:07 2012
From: pejapopovic at yahoo.com (Predrag Popovic)
Date: Sun, 22 Jan 2012 09:58:07 -0800 (PST)
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 -
	beginner
In-Reply-To: <CAFXPCRZuwoOkWZNMqbMaQg3fyS62erQ+T+t_4mCZ26En5+h47g@mail.gmail.com>
References: <CAFXPCRZuwoOkWZNMqbMaQg3fyS62erQ+T+t_4mCZ26En5+h47g@mail.gmail.com>
Message-ID: <1327255087.56405.YahooMailNeo@web122015.mail.ne1.yahoo.com>

Thank you for quick responses Greg and Guy. It's nice to see an active community. 


I've tried using binary packages with tutorial (http://radsite.lbl.gov/radiance/refer/tutorial.html#Intro), but would 
like to be able to see the scene that I've described using the 
interactive viewer rview. This is what motivated me to compile the source code.?

I've managed to compile and install Radiance but without qtrvu. qtrvu did not compile as I did not have QT4 libraries on my computer at the time. I am working on resolving this now.

My understanding from the mailing list is that qtrvu is an alternative to rview for users without Unix/X11 support. Is that correct?


I've read in many posts that old-versions of SCons were required, but most posts were dating back from 2010 and before. It thought that since active development was still being done, that later SCons versions may have been supported. Thank you for clarification Guy. 


In compiling Radiance 4.1a, without qtrvu, I ran into 2 problems: SCons and an Error in "rtcontrib.c"

1.SCons 2.1.0 Resolution to the problem I mentioned in my original post:??? ??? ??? Replace #cfig = ConfigParser.ConfigParser(env.Dictionary()) statement found on line 11, load_plat.py
??? ??? ??? with 
??? ??? ??? cfig = ConfigParser.ConfigParser()

Removing env.Dictionary() does not cause any adverse effects - but someone else may correct me here

2.'ssize_t' variable name in "rtcontrib.c" conflicts with 'ssize_t' in mingw....include/sys/types.h
Since 'ssize_t' is found in 3 places and only in "rtcontrib.c", I've changed the variable to 'sSize_t'


This allowed the compilation to finish without errors.


From C:\MingW\include\sys\types.h

#ifndef _SSIZE_T_
#define _SSIZE_T_
typedef int _ssize_t;

#ifndef??? _NO_OLDNAMES
typedef _ssize_t ssize_t;??? ??? 


AND


Here's the error:
gcc -o src\util\rtcontrib.o -c -O2 -D_WIN32 -DMINGW -DNDEBUG -D_CONSOLE -D_MBCS -DHDSUF=.exe -Dfseeko=fseek -Isrc\common src\util\rtcontrib.c
src\util\rtcontrib.c:20:14: error: conflicting types for 'ssize_t'
c:\mingw\bin\../lib/gcc/mingw32/4.6.1/../../../../include/sys/types.h:118:18: note: previous declaration of 'ssize_t' was here
src\util\rtcontrib.c: In function 'main':
src\util\rtcontrib.c:412:3: warning: passing argument 2 of 'execv' from incompatible pointer type [enabled by default]
c:\mingw\bin\../lib/gcc/mingw32/4.6.1/../../../../include/process.h:118:42: note: expected 'const char * const*' but argument is of type 'char **'
scons: *** [src\util\rtcontrib.o] Error 1
scons: building terminated because of errors.

After changing ssize_t to sSize_t, here's the "affected" part of the output:

gcc -o src\util\rtcontrib.o -c -O2 -D_WIN32 -DMINGW -DNDEBUG -D_CONSOLE -D_MBCS -DHDSUF=.exe -Dfseeko=fseek -Isrc\common src\util\rtcontrib.c
src\util\rtcontrib.c: In function 'main':
src\util\rtcontrib.c:412:3: warning: passing argument 2 of 'execv' from incompatible pointer type [enabled by default]
c:\mingw\bin\../lib/gcc/mingw32/4.6.1/../../../../include/process.h:118:42: note: expected 'const char * const*' but argument is of type 'char **'
gcc -o src\util\setscan.o -c -O2 -D_WIN32 -DMINGW -DNDEBUG -D_CONSOLE -D_MBCS -DHDSUF=.exe -Dfseeko=fseek -Isrc\common src\util\setscan.c



________________________________
 From: Guy Vaessen <guy.vaessen at gmail.com>
To: radiance-dev at radiance-online.org 
Sent: Saturday, January 21, 2012 6:22 PM
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 - beginner
 

Although Scons 1.3.1 (the old version!)?is still able to compile Radiance 4.2a, I do think it's time for the Scons build system to be removed.
If you're new to Radiance I would go for some precompiled binaries to run Radiance as they also set the right environment variables in Windows.
?
If I remember correctly?the NREL/CMAKE build system has some additional features planned/implemented compared to the Scons/MinGW system. (rvu for Windows), although I haven't seen it yet.
So it would be nice to hear the latest status of that project.
?
Best Regards,
?
Guy
?
?
_______________________________________________
Radiance-dev mailing list
Radiance-dev at radiance-online.org
http://www.radiance-online.org/mailman/listinfo/radiance-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-dev/attachments/20120122/f82cf61a/attachment.html>

From Robert.Guglielmetti at nrel.gov  Sun Jan 22 10:29:54 2012
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Sun, 22 Jan 2012 11:29:54 -0700
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2
	-	beginner
In-Reply-To: <1327255087.56405.YahooMailNeo@web122015.mail.ne1.yahoo.com>
References: <CAFXPCRZuwoOkWZNMqbMaQg3fyS62erQ+T+t_4mCZ26En5+h47g@mail.gmail.com>,
	<1327255087.56405.YahooMailNeo@web122015.mail.ne1.yahoo.com>
Message-ID: <FFF56A6D37A3A54F91A03601AC22DA322338CB61B1@MAILBOX2.nrel.gov>

________________________________________
From: Predrag Popovic [pejapopovic at yahoo.com]
Sent: Sunday, January 22, 2012 10:58 AM
To: code development
Subject: Re: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 -      beginner

I've managed to compile and install Radiance but without qtrvu. qtrvu did not compile as I did not have QT4 libraries on my computer at the time. I am working on resolving this now.
My understanding from the mailing list is that qtrvu is an alternative to rview for users without Unix/X11 support. Is that correct?


***Exactly. We (NREL) wanted to be able to offer the full set of Radiance tools, and felt that rvu was an essential piece of the pie. It's important to be able to see your exported Radiance geometry in a native Radiance tool, so you know that everything translated correctly. 

As I said in my previous post, we hope to release these binary installers very soon, hopefully sometime this week. 

- Rob



From pejapopovic at yahoo.com  Sun Jan 22 11:36:43 2012
From: pejapopovic at yahoo.com (Predrag Popovic)
Date: Sun, 22 Jan 2012 11:36:43 -0800 (PST)
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 -
	beginner
In-Reply-To: <C6460F42-F314-45EC-B461-961BF28A157B@gmail.com>
References: <CAFXPCRZuwoOkWZNMqbMaQg3fyS62erQ+T+t_4mCZ26En5+h47g@mail.gmail.com>
	<1327255087.56405.YahooMailNeo@web122015.mail.ne1.yahoo.com>
	<C6460F42-F314-45EC-B461-961BF28A157B@gmail.com>
Message-ID: <1327261003.67852.YahooMailNeo@web122007.mail.ne1.yahoo.com>

That's fantastic to hear.? 

Thank you for the answer Rob.

Peja


________________________________
 From: Rob Guglielmetti <rob.guglielmetti at gmail.com>
To: Predrag Popovic <pejapopovic at yahoo.com>; code development <radiance-dev at radiance-online.org> 
Sent: Sunday, January 22, 2012 1:20 PM
Subject: Re: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 - beginner
 

On Jan 22, 2012, at 10:58 AM, Predrag Popovic wrote:

>
>I've managed to compile and install Radiance but without qtrvu. qtrvu did not compile as I did not have QT4 libraries on my computer at the time. I am working on resolving this now.
>
>My understanding from the mailing list is that qtrvu is an alternative to rview for users without Unix/X11 support. Is that correct?

Exactly. We (NREL) wanted to be able to offer the full set of Radiance tools, and felt that rvu was an essential piece of the pie. It's important to be able to see your exported Radiance geometry in a native Radiance tool, so you know that everything translated correctly.?

As I said in my previous post, we hope to release these binary installers very soon, hopefully sometime this week.?

- Rob
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-dev/attachments/20120122/b3f64e6a/attachment.html>

From RFritz at lbl.gov  Mon Jan 23 10:00:23 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Mon, 23 Jan 2012 10:00:23 -0800
Subject: [Radiance-dev] Cannot build Radiance 4.1a on Windows XP SP2 -
	beginner
References: <CAFXPCRZuwoOkWZNMqbMaQg3fyS62erQ+T+t_4mCZ26En5+h47g@mail.gmail.com>
	<FFF56A6D37A3A54F91A03601AC22DA322338CB61B0@MAILBOX2.nrel.gov>
Message-ID: <jfk77n$65c$1@dough.gmane.org>

On 2012-01-22 17:32:02 +0000, Guglielmetti, Robert said:

> I agree with Guy and Greg, the Scons system could probably go away.

Yes, I agree.

They don't work on any platform at this point--they're of historical 
interest only.

Randolph




From RFritz at lbl.gov  Mon Jan 30 10:26:13 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Mon, 30 Jan 2012 10:26:13 -0800
Subject: [Radiance-dev] NURBS oconv?
Message-ID: <jg6nc5$l2i$1@dough.gmane.org>

Would it be possible, do people think, to do a version of oconv that 
would accept a NURBS model, perhaps in .3dm format, as input?
-- 
Randolph M. Fritz




From gregoryjward at gmail.com  Mon Jan 30 10:52:13 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Mon, 30 Jan 2012 10:52:13 -0800
Subject: [Radiance-dev] NURBS oconv?
In-Reply-To: <jg6nc5$l2i$1@dough.gmane.org>
References: <jg6nc5$l2i$1@dough.gmane.org>
Message-ID: <CALy=WXuLJNTow1f1=iCMNPqT-V-N1gPu_nWhbREhJFKd2P0wDQ@mail.gmail.com>

Hi Fritz,

The usual strategy is to convert to Radiance format, like obj2rad.  I don't
know how often it's used, but the .OBJ format has a NURBS specification,
and it should be easy enough to support it with obj2mesh.  That would have
the advantage of including surface normal smoothing and uv textures.
 Implementing NURBS natively in Radiance would be a major undertaking by
comparison.

-Greg

On Monday, January 30, 2012, Randolph M. Fritz <RFritz at lbl.gov> wrote:
> Would it be possible, do people think, to do a version of oconv that
would accept a NURBS model, perhaps in .3dm format, as input?
> --
> Randolph M. Fritz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-dev/attachments/20120130/69650f0d/attachment.html>

From RFritz at lbl.gov  Mon Jan 30 12:34:39 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Mon, 30 Jan 2012 12:34:39 -0800
Subject: [Radiance-dev] NURBS oconv?
References: <jg6nc5$l2i$1@dough.gmane.org>
	<CALy=WXuLJNTow1f1=iCMNPqT-V-N1gPu_nWhbREhJFKd2P0wDQ@mail.gmail.com>
Message-ID: <jg6usv$fig$1@dough.gmane.org>

On 2012-01-30 18:52:13 +0000, Greg Ward said:

> Hi Fritz,
> 
> The usual strategy is to convert to Radiance format, like obj2rad. ?I 
> don't know how often it's used, but the .OBJ format has a NURBS 
> specification, and it should be easy enough to support it with obj2mesh.

That's an interesting thought.

> ?That would have the advantage of including surface normal smoothing 
> and uv textures. ?Implementing NURBS natively in Radiance would be a 
> major undertaking by comparison.

I suppose it would.

I'm just getting tired of proliferating polygons.  Most curved objects 
these days are either modeled as NURBS objects, or by some subdivision 
method.  And yet--unless I grossly misunderstand Radiance octrees, 
which is possible--octrees don't actually care about polygons at all.

Oh, well.  One more research project.

Randolph




From gregoryjward at gmail.com  Mon Jan 30 14:03:46 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Mon, 30 Jan 2012 17:03:46 -0500
Subject: [Radiance-dev] NURBS oconv?
In-Reply-To: <jg6usv$fig$1@dough.gmane.org>
References: <jg6nc5$l2i$1@dough.gmane.org>
	<CALy=WXuLJNTow1f1=iCMNPqT-V-N1gPu_nWhbREhJFKd2P0wDQ@mail.gmail.com>
	<jg6usv$fig$1@dough.gmane.org>
Message-ID: <F35282D3-4609-4664-AFF7-D90E7317023F@gmail.com>

I've looked at this in the past.  Aside from the programming effort required to intersect voxels and rays with NURBS, there is the fact that most such algorithms end up dynamically subdividing such surfaces down to pixel resolution.  This is a problem for Radiance because pixel size is not known in the general context.  Also, subdividing once at the outset into triangles results (in most cases) in faster rendering times.  I decided it made more sense just to store a NURBS as a mesh object and render that.

It still would be nice to have code in obj2mesh to accept NURBS.  Do you know if anyone actually uses .OBJ format for higher-order surfaces?  I saw it in the specification, but I've never seen any example files.

Cheers,
-Greg

> From: "Randolph M. Fritz" <RFritz at lbl.gov>
> Date: January 30, 2012 3:34:39 PM EST
> 
> On 2012-01-30 18:52:13 +0000, Greg Ward said:
> 
>> Hi Fritz,
>> The usual strategy is to convert to Radiance format, like obj2rad.  I don't know how often it's used, but the .OBJ format has a NURBS specification, and it should be easy enough to support it with obj2mesh.
> 
> That's an interesting thought.
> 
>>  That would have the advantage of including surface normal smoothing and uv textures.  Implementing NURBS natively in Radiance would be a major undertaking by comparison.
> 
> I suppose it would.
> 
> I'm just getting tired of proliferating polygons.  Most curved objects these days are either modeled as NURBS objects, or by some subdivision method.  And yet--unless I grossly misunderstand Radiance octrees, which is possible--octrees don't actually care about polygons at all.
> 
> Oh, well.  One more research project.
> 
> Randolph


From RFritz at lbl.gov  Mon Jan 30 18:41:57 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Mon, 30 Jan 2012 18:41:57 -0800
Subject: [Radiance-dev] NURBS oconv?
References: <jg6nc5$l2i$1@dough.gmane.org>
	<F35282D3-4609-4664-AFF7-D90E7317023F@gmail.com>
Message-ID: <jg7kdl$uth$1@dough.gmane.org>

On 2012-01-30 22:03:46 +0000, Gregory J. Ward said:

> I've looked at this in the past.  Aside from the programming effort 
> required to intersect voxels and rays with NURBS, there is the fact 
> that most such algorithms end up dynamically subdividing such surfaces 
> down to pixel resolution.  This is a problem for Radiance because pixel 
> size is not known in the general context.  Also, subdividing once at 
> the outset into triangles results (in most cases) in faster rendering 
> times.  I decided it made more sense just to store a NURBS as a mesh 
> object and render that.

Oh, I see.

> It still would be nice to have code in obj2mesh to accept NURBS.  Do 
> you know if anyone actually uses .OBJ format for higher-order surfaces? 
>  I saw it in the specification, but I've never seen any example files.

Yes, McNeil's Rhinoceros does for export--I can send you some samples 
if you'd like.  Let me know what shapes to export.  I can also ask some 
of the media people I know if 3ds max and Maya do.

Randolph




From gregoryjward at gmail.com  Mon Jan 30 18:47:45 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Mon, 30 Jan 2012 21:47:45 -0500
Subject: [Radiance-dev] NURBS oconv?
In-Reply-To: <jg7kdl$uth$1@dough.gmane.org>
References: <jg6nc5$l2i$1@dough.gmane.org>
	<F35282D3-4609-4664-AFF7-D90E7317023F@gmail.com>
	<jg7kdl$uth$1@dough.gmane.org>
Message-ID: <A56AF572-545B-4121-8CC5-CD563901A6BA@gmail.com>

If you could export one .OBJ file with NURBS representations, then the same object as an expanded triangle mesh (with normals, preferably), that would be sufficient.

I don't see much point in supporting 3ds or Maya, as those data formats tend to change with new releases.  Not good from a software support standpoint....

Cheers,
-Greg

> From: "Randolph M. Fritz" <RFritz at lbl.gov>
> Date: January 30, 2012 9:41:57 PM EST
> 
> On 2012-01-30 22:03:46 +0000, Gregory J. Ward said:
> 
>> I've looked at this in the past.  Aside from the programming effort required to intersect voxels and rays with NURBS, there is the fact that most such algorithms end up dynamically subdividing such surfaces down to pixel resolution.  This is a problem for Radiance because pixel size is not known in the general context.  Also, subdividing once at the outset into triangles results (in most cases) in faster rendering times.  I decided it made more sense just to store a NURBS as a mesh object and render that.
> 
> Oh, I see.
> 
>> It still would be nice to have code in obj2mesh to accept NURBS.  Do you know if anyone actually uses .OBJ format for higher-order surfaces?  I saw it in the specification, but I've never seen any example files.
> 
> Yes, McNeil's Rhinoceros does for export--I can send you some samples if you'd like.  Let me know what shapes to export.  I can also ask some of the media people I know if 3ds max and Maya do.
> 
> Randolph


