From jan.wienold at epfl.ch  Tue Dec  1 06:44:00 2015
From: jan.wienold at epfl.ch (Jan Wienold)
Date: Tue, 1 Dec 2015 15:44:00 +0100
Subject: [Radiance-general] mirror and mixfunc
Message-ID: <565DB230.6000504@epfl.ch>

Hi all,

I got stuck a bit applying mixfunc and mirror material. It seems that 
the check for secondary light sources is partly disabled when applying 
(at least I assume so).

A simple example:

lets assume an ideal mirror

void mirror testmat1
0
0
3 1 1 1

If I use just this  material on a surface and start an rtrace sending to 
the surface, then I get the correct result for both options - either 
rtrace or rtrace -I. So far so good.

In case I use a (stupid, but simple) mixfunc:

void mixfunc test_mix
4 testmat1 testmat1 0.5 .
0
0

I should get the same result, since I'm mixing the same material with a 
fixed value.
But: rtrace -I delivers only 0, whereas rtrace delivers the correct 
value. So it seems that mixfunc cannot be applied with mirror, when the 
-I option is used. Or I did something wrong?
I used -dr 2 and -dt 0 in both cases.

Of course my ultimate goal is not mixing that simple but mixing two 
different material types, also depending on the angle of incidence, but 
this simple example shows the principle problem.

Is there any solution using mixfunc and mirror when using rtrace -I ?

Jan



-- 
Dr.-Ing.  Jan Wienold
Ecole Polytechnique F?d?rale de Lausanne (EPFL)
EPFL ENAC IA LIPID

http://people.epfl.ch/jan.wienold
LE 1 111 (Office)
Phone    +41 21 69 30849



From gregoryjward at gmail.com  Tue Dec  1 08:51:08 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Tue, 1 Dec 2015 08:51:08 -0800
Subject: [Radiance-general] mirror and mixfunc
In-Reply-To: <565DB230.6000504@epfl.ch>
References: <565DB230.6000504@epfl.ch>
Message-ID: <FE162E8E-0945-478F-BC56-F2A40DCD56AD@lmi.net>

Hi Jan,

As you discovered, the code isn't sophisticated enough to handle virtual source materials (mirror, prism, prism2) through the mixfunc interface.  (BTW, mixfunc also fails for light sources.)  However, you can use the "alternate material" argument to the mirror primitive to specify a different behavior for when the mirror is not directly participating in the virtual source relay calculation.  You could have a chain like this, which would work:

void metal mat1
[arguments]

void plastic mat2
[arguments]

void mixfunc mat1+2
4 mat1 mat2 mixing_var mixit.cal
0
0

void mirror mmat1+2
1 mat1+2
0
3 .5 .5 .5

------
When the mirror material is participating in the virtual source calculation, it reflects everything at 50%.  When it's participating in the interreflection calculation, or you look at it directly, then it switches to the mixfunc mat1+2's behavior.

If one of your goals is to have the mixfunc control the amount of reflected light in the virtual calculation, I'm afraid you will need to use a brightfunc modifier on the mirror material, instead.  You can do this in conjunction with an alternate material to make the behavior consistent if you like.  In the example above, let's say that mat1 is mirror-like with 80% reflectance and mat2 is diffusing.  You could use the same cal file for your brightfunc, modifying the mirror primitive like so:

void brightfunc mir_amt
2 mixing_var mixit.cal
0
0

mir_amt mirror mmat1+2
1 mat1+2
0
3 .8 .8 .8

--------
Does this make sense?

-Greg

> From: Jan Wienold <jan.wienold at epfl.ch>
> Subject: [Radiance-general] mirror and mixfunc
> Date: December 1, 2015 6:44:00 AM PST
> 
> Hi all,
> 
> I got stuck a bit applying mixfunc and mirror material. It seems that the check for secondary light sources is partly disabled when applying (at least I assume so).
> 
> A simple example:
> 
> lets assume an ideal mirror
> 
> void mirror testmat1
> 0
> 0
> 3 1 1 1
> 
> If I use just this  material on a surface and start an rtrace sending to the surface, then I get the correct result for both options - either rtrace or rtrace -I. So far so good.
> 
> In case I use a (stupid, but simple) mixfunc:
> 
> void mixfunc test_mix
> 4 testmat1 testmat1 0.5 .
> 0
> 0
> 
> I should get the same result, since I'm mixing the same material with a fixed value.
> But: rtrace -I delivers only 0, whereas rtrace delivers the correct value. So it seems that mixfunc cannot be applied with mirror, when the -I option is used. Or I did something wrong?
> I used -dr 2 and -dt 0 in both cases.
> 
> Of course my ultimate goal is not mixing that simple but mixing two different material types, also depending on the angle of incidence, but this simple example shows the principle problem.
> 
> Is there any solution using mixfunc and mirror when using rtrace -I ?
> 
> Jan


From rob.guglielmetti at gmail.com  Tue Dec  1 08:56:16 2015
From: rob.guglielmetti at gmail.com (Rob Guglielmetti)
Date: Tue, 1 Dec 2015 09:56:16 -0700
Subject: [Radiance-general] mirror and mixfunc
In-Reply-To: <FE162E8E-0945-478F-BC56-F2A40DCD56AD@lmi.net>
References: <565DB230.6000504@epfl.ch>
	<FE162E8E-0945-478F-BC56-F2A40DCD56AD@lmi.net>
Message-ID: <CAEkFE9isjFC0Kuycb0kBYJN_MZLwmF=FNjRLnK1Ady4ugGU40g@mail.gmail.com>

I love when Greg shares these kung foo tips and deep insights to Radiance's
underbelly, and then closes with "Does this make sense". Yes, it makes
sense, after reading it like five times. Thanks, Greg, as always!

On Tue, Dec 1, 2015 at 9:51 AM, Greg Ward <gregoryjward at gmail.com> wrote:

> Hi Jan,
>
> As you discovered, the code isn't sophisticated enough to handle virtual
> source materials (mirror, prism, prism2) through the mixfunc interface.
> (BTW, mixfunc also fails for light sources.)  However, you can use the
> "alternate material" argument to the mirror primitive to specify a
> different behavior for when the mirror is not directly participating in the
> virtual source relay calculation.  You could have a chain like this, which
> would work:
>
> void metal mat1
> [arguments]
>
> void plastic mat2
> [arguments]
>
> void mixfunc mat1+2
> 4 mat1 mat2 mixing_var mixit.cal
> 0
> 0
>
> void mirror mmat1+2
> 1 mat1+2
> 0
> 3 .5 .5 .5
>
> ------
> When the mirror material is participating in the virtual source
> calculation, it reflects everything at 50%.  When it's participating in the
> interreflection calculation, or you look at it directly, then it switches
> to the mixfunc mat1+2's behavior.
>
> If one of your goals is to have the mixfunc control the amount of
> reflected light in the virtual calculation, I'm afraid you will need to use
> a brightfunc modifier on the mirror material, instead.  You can do this in
> conjunction with an alternate material to make the behavior consistent if
> you like.  In the example above, let's say that mat1 is mirror-like with
> 80% reflectance and mat2 is diffusing.  You could use the same cal file for
> your brightfunc, modifying the mirror primitive like so:
>
> void brightfunc mir_amt
> 2 mixing_var mixit.cal
> 0
> 0
>
> mir_amt mirror mmat1+2
> 1 mat1+2
> 0
> 3 .8 .8 .8
>
> --------
> Does this make sense?
>
> -Greg
>
> > From: Jan Wienold <jan.wienold at epfl.ch>
> > Subject: [Radiance-general] mirror and mixfunc
> > Date: December 1, 2015 6:44:00 AM PST
> >
> > Hi all,
> >
> > I got stuck a bit applying mixfunc and mirror material. It seems that
> the check for secondary light sources is partly disabled when applying (at
> least I assume so).
> >
> > A simple example:
> >
> > lets assume an ideal mirror
> >
> > void mirror testmat1
> > 0
> > 0
> > 3 1 1 1
> >
> > If I use just this  material on a surface and start an rtrace sending to
> the surface, then I get the correct result for both options - either rtrace
> or rtrace -I. So far so good.
> >
> > In case I use a (stupid, but simple) mixfunc:
> >
> > void mixfunc test_mix
> > 4 testmat1 testmat1 0.5 .
> > 0
> > 0
> >
> > I should get the same result, since I'm mixing the same material with a
> fixed value.
> > But: rtrace -I delivers only 0, whereas rtrace delivers the correct
> value. So it seems that mixfunc cannot be applied with mirror, when the -I
> option is used. Or I did something wrong?
> > I used -dr 2 and -dt 0 in both cases.
> >
> > Of course my ultimate goal is not mixing that simple but mixing two
> different material types, also depending on the angle of incidence, but
> this simple example shows the principle problem.
> >
> > Is there any solution using mixfunc and mirror when using rtrace -I ?
> >
> > Jan
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151201/2fd38ccc/attachment-0001.html>

From geotrupes at me.com  Tue Dec  1 08:57:52 2015
From: geotrupes at me.com (giulioandrea antonutto foi)
Date: Tue, 01 Dec 2015 16:57:52 +0000
Subject: [Radiance-general] mirror and mixfunc
In-Reply-To: <FE162E8E-0945-478F-BC56-F2A40DCD56AD@lmi.net>
References: <565DB230.6000504@epfl.ch>
	<FE162E8E-0945-478F-BC56-F2A40DCD56AD@lmi.net>
Message-ID: <420B484A-A560-49EC-A8A5-81B1E382D381@me.com>

From my old blog?.

The idea is to create a simple mirror, a ?caustic? effect and apply a pattern to it, to create holes without having to modify the geometry.
The geometry is a classic:
cap.rad - the cap for the ring
mix ring top
0
0
8
0 0 25
0 0 1
57.29432507 60
scene.rad - a spot light and a plane
void spotlight spot
0
0
7 50000 50000 50000 35 0 -1 -1
spot sphere source
0
0
4 0 200 200 2.5
void plastic white
0
0
5 .5 .5 .5 0 0
white polygon plan
0
0
12
-500 -500 0
-500 500 0
500 500 0
500 -500 0
single.rad - a single sector of the ring, to array
mix polygon int
0
0
12
-.5 -57.29432507 0
-.5 -57.29432507 25
.5 -57.29432507 25
.5 -57.29432507 0
mix polygon ext
0
0
12
-.5237120674 -60 0
.5237120674 -60 0
.5237120674 -60 25
-.5237120674 -60 25
And now the interesting stuff:
To activate secondary sources use -dr N  (N>0).
We will use mirror.
Unfortunately when mirror is nested into a mixfunc material is invisible to the secondary source tracer... but there is a workaround...
model.mat
#alterate the reflectance of the metal - optional
void brightfunc stripes
2  'sin(A1*Pz)' . 
0
1 .8
#metal
stripes metal metal
0
0
5 .8 .8 .8 0.001 0
#mix the metal with void to create holes
void mixfunc strip
4  metal void 'if(sin(A1*Py),0,1)' .
0
1 .2
#alterate the reflectance of mirror, reflectance is 0% for holes
void brightfunc band
2 'if(sin(A1*Py),0,1)' .
0
1 .2
#mirror attached to the metal surface, with holes
band mirror mix
1 strip
0
3 1 1 1


Now, array the single.rad file:
xform -a 360 -rz 1 -i 1 single.rad  > ring.rad


> On 1 Dec 2015, at 16:51, Greg Ward <gregoryjward at gmail.com> wrote:
> 
> Hi Jan,
> 
> As you discovered, the code isn't sophisticated enough to handle virtual source materials (mirror, prism, prism2) through the mixfunc interface.  (BTW, mixfunc also fails for light sources.)  However, you can use the "alternate material" argument to the mirror primitive to specify a different behavior for when the mirror is not directly participating in the virtual source relay calculation.  You could have a chain like this, which would work:
> 
> void metal mat1
> [arguments]
> 
> void plastic mat2
> [arguments]
> 
> void mixfunc mat1+2
> 4 mat1 mat2 mixing_var mixit.cal
> 0
> 0
> 
> void mirror mmat1+2
> 1 mat1+2
> 0
> 3 .5 .5 .5
> 
> ------
> When the mirror material is participating in the virtual source calculation, it reflects everything at 50%.  When it's participating in the interreflection calculation, or you look at it directly, then it switches to the mixfunc mat1+2's behavior.
> 
> If one of your goals is to have the mixfunc control the amount of reflected light in the virtual calculation, I'm afraid you will need to use a brightfunc modifier on the mirror material, instead.  You can do this in conjunction with an alternate material to make the behavior consistent if you like.  In the example above, let's say that mat1 is mirror-like with 80% reflectance and mat2 is diffusing.  You could use the same cal file for your brightfunc, modifying the mirror primitive like so:
> 
> void brightfunc mir_amt
> 2 mixing_var mixit.cal
> 0
> 0
> 
> mir_amt mirror mmat1+2
> 1 mat1+2
> 0
> 3 .8 .8 .8
> 
> --------
> Does this make sense?
> 
> -Greg
> 
>> From: Jan Wienold <jan.wienold at epfl.ch>
>> Subject: [Radiance-general] mirror and mixfunc
>> Date: December 1, 2015 6:44:00 AM PST
>> 
>> Hi all,
>> 
>> I got stuck a bit applying mixfunc and mirror material. It seems that the check for secondary light sources is partly disabled when applying (at least I assume so).
>> 
>> A simple example:
>> 
>> lets assume an ideal mirror
>> 
>> void mirror testmat1
>> 0
>> 0
>> 3 1 1 1
>> 
>> If I use just this  material on a surface and start an rtrace sending to the surface, then I get the correct result for both options - either rtrace or rtrace -I. So far so good.
>> 
>> In case I use a (stupid, but simple) mixfunc:
>> 
>> void mixfunc test_mix
>> 4 testmat1 testmat1 0.5 .
>> 0
>> 0
>> 
>> I should get the same result, since I'm mixing the same material with a fixed value.
>> But: rtrace -I delivers only 0, whereas rtrace delivers the correct value. So it seems that mixfunc cannot be applied with mirror, when the -I option is used. Or I did something wrong?
>> I used -dr 2 and -dt 0 in both cases.
>> 
>> Of course my ultimate goal is not mixing that simple but mixing two different material types, also depending on the angle of incidence, but this simple example shows the principle problem.
>> 
>> Is there any solution using mixfunc and mirror when using rtrace -I ?
>> 
>> Jan
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151201/cf3b7dde/attachment-0001.html>

From gregoryjward at gmail.com  Tue Dec  1 09:11:27 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Tue, 1 Dec 2015 09:11:27 -0800
Subject: [Radiance-general] mirror and mixfunc
In-Reply-To: <420B484A-A560-49EC-A8A5-81B1E382D381@me.com>
References: <565DB230.6000504@epfl.ch>
	<FE162E8E-0945-478F-BC56-F2A40DCD56AD@lmi.net>
	<420B484A-A560-49EC-A8A5-81B1E382D381@me.com>
Message-ID: <9D71682D-B603-4F21-8E0F-C44862BEFED9@lmi.net>

Thanks, Giulio, great stuff!  Do we have a link to your blog from radiance-online?  We should add one if we don't.  Is there an index of any kind?

Cheers,
-Greg

> From: giulioandrea antonutto foi <geotrupes at me.com>
> Subject: Re: [Radiance-general] mirror and mixfunc
> Date: December 1, 2015 8:57:52 AM PST
> 
> From my old blog?.
> 
> The idea is to create a simple mirror, a ?caustic? effect and apply a pattern to it, to create holes without having to modify the geometry.
> The geometry is a classic:
> cap.rad - the cap for the ring
> mix ring top
> 0
> 0
> 8
> 0 0 25
> 0 0 1
> 57.29432507 60
> scene.rad - a spot light and a plane
> void spotlight spot
> 0
> 0
> 7 50000 50000 50000 35 0 -1 -1
> spot sphere source
> 0
> 0
> 4 0 200 200 2.5
> void plastic white
> 0
> 0
> 5 .5 .5 .5 0 0
> white polygon plan
> 0
> 0
> 12
> -500 -500 0
> -500 500 0
> 500 500 0
> 500 -500 0
> single.rad - a single sector of the ring, to array
> mix polygon int
> 0
> 0
> 12
> -.5 -57.29432507 0
> -.5 -57.29432507 25
> .5 -57.29432507 25
> .5 -57.29432507 0
> mix polygon ext
> 0
> 0
> 12
> -.5237120674 -60 0
> .5237120674 -60 0
> .5237120674 -60 25
> -.5237120674 -60 25
> And now the interesting stuff:
> To activate secondary sources use -dr N  (N>0).
> We will use mirror.
> Unfortunately when mirror is nested into a mixfunc material is invisible to the secondary source tracer... but there is a workaround...
> model.mat
> #alterate the reflectance of the metal - optional
> void brightfunc stripes
> 2  'sin(A1*Pz)' . 
> 0
> 1 .8
> #metal
> stripes metal metal
> 0
> 0
> 5 .8 .8 .8 0.001 0
> #mix the metal with void to create holes
> void mixfunc strip
> 4  metal void 'if(sin(A1*Py),0,1)' .
> 0
> 1 .2
> #alterate the reflectance of mirror, reflectance is 0% for holes
> void brightfunc band
> 2 'if(sin(A1*Py),0,1)' .
> 0
> 1 .2
> #mirror attached to the metal surface, with holes
> band mirror mix
> 1 strip
> 0
> 3 1 1 1
> 
> 
> Now, array the single.rad file:
> xform -a 360 -rz 1 -i 1 single.rad  > ring.rad
> 
> ...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151201/3ccf873d/attachment.html>

From jan.wienold at epfl.ch  Tue Dec  1 09:18:08 2015
From: jan.wienold at epfl.ch (Jan Wienold)
Date: Tue, 1 Dec 2015 18:18:08 +0100
Subject: [Radiance-general] mirror and mixfunc
In-Reply-To: <CAEkFE9isjFC0Kuycb0kBYJN_MZLwmF=FNjRLnK1Ady4ugGU40g@mail.gmail.com>
References: <565DB230.6000504@epfl.ch>
	<FE162E8E-0945-478F-BC56-F2A40DCD56AD@lmi.net>
	<CAEkFE9isjFC0Kuycb0kBYJN_MZLwmF=FNjRLnK1Ady4ugGU40g@mail.gmail.com>
Message-ID: <565DD650.3000603@epfl.ch>

Hi Greg and Giulio,

thanks for your cool (kung foo:-) ) tips! And yes it totally makes 
sense! :-)

About the brightfunc I was already aware, but I couldn't find a solution 
to integrate a material for the interreflection calculation. I was 
already thinking of running two times with different material 
definitions, but this is a cool solution!

Jan




Am 12/1/15 um 5:56 PM schrieb Rob Guglielmetti:
> I love when Greg shares these kung foo tips and deep insights to 
> Radiance's underbelly, and then closes with "Does this make sense". 
> Yes, it makes sense, after reading it like five times. Thanks, Greg, 
> as always!
>
> On Tue, Dec 1, 2015 at 9:51 AM, Greg Ward <gregoryjward at gmail.com 
> <mailto:gregoryjward at gmail.com>> wrote:
>
>     Hi Jan,
>
>     As you discovered, the code isn't sophisticated enough to handle
>     virtual source materials (mirror, prism, prism2) through the
>     mixfunc interface.  (BTW, mixfunc also fails for light sources.) 
>     However, you can use the "alternate material" argument to the
>     mirror primitive to specify a different behavior for when the
>     mirror is not directly participating in the virtual source relay
>     calculation.  You could have a chain like this, which would work:
>
>     void metal mat1
>     [arguments]
>
>     void plastic mat2
>     [arguments]
>
>     void mixfunc mat1+2
>     4 mat1 mat2 mixing_var mixit.cal
>     0
>     0
>
>     void mirror mmat1+2
>     1 mat1+2
>     0
>     3 .5 .5 .5
>
>     ------
>     When the mirror material is participating in the virtual source
>     calculation, it reflects everything at 50%.  When it's
>     participating in the interreflection calculation, or you look at
>     it directly, then it switches to the mixfunc mat1+2's behavior.
>
>     If one of your goals is to have the mixfunc control the amount of
>     reflected light in the virtual calculation, I'm afraid you will
>     need to use a brightfunc modifier on the mirror material,
>     instead.  You can do this in conjunction with an alternate
>     material to make the behavior consistent if you like.  In the
>     example above, let's say that mat1 is mirror-like with 80%
>     reflectance and mat2 is diffusing.  You could use the same cal
>     file for your brightfunc, modifying the mirror primitive like so:
>
>     void brightfunc mir_amt
>     2 mixing_var mixit.cal
>     0
>     0
>
>     mir_amt mirror mmat1+2
>     1 mat1+2
>     0
>     3 .8 .8 .8
>
>     --------
>     Does this make sense?
>
>     -Greg
>
>     > From: Jan Wienold <jan.wienold at epfl.ch <mailto:jan.wienold at epfl.ch>>
>     > Subject: [Radiance-general] mirror and mixfunc
>     > Date: December 1, 2015 6:44:00 AM PST
>     >
>     > Hi all,
>     >
>     > I got stuck a bit applying mixfunc and mirror material. It seems
>     that the check for secondary light sources is partly disabled when
>     applying (at least I assume so).
>     >
>     > A simple example:
>     >
>     > lets assume an ideal mirror
>     >
>     > void mirror testmat1
>     > 0
>     > 0
>     > 3 1 1 1
>     >
>     > If I use just this  material on a surface and start an rtrace
>     sending to the surface, then I get the correct result for both
>     options - either rtrace or rtrace -I. So far so good.
>     >
>     > In case I use a (stupid, but simple) mixfunc:
>     >
>     > void mixfunc test_mix
>     > 4 testmat1 testmat1 0.5 .
>     > 0
>     > 0
>     >
>     > I should get the same result, since I'm mixing the same material
>     with a fixed value.
>     > But: rtrace -I delivers only 0, whereas rtrace delivers the
>     correct value. So it seems that mixfunc cannot be applied with
>     mirror, when the -I option is used. Or I did something wrong?
>     > I used -dr 2 and -dt 0 in both cases.
>     >
>     > Of course my ultimate goal is not mixing that simple but mixing
>     two different material types, also depending on the angle of
>     incidence, but this simple example shows the principle problem.
>     >
>     > Is there any solution using mixfunc and mirror when using rtrace
>     -I ?
>     >
>     > Jan
>
>     _______________________________________________
>     Radiance-general mailing list
>     Radiance-general at radiance-online.org
>     <mailto:Radiance-general at radiance-online.org>
>     http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-- 
Dr.-Ing.  Jan Wienold
Ecole Polytechnique F?d?rale de Lausanne (EPFL)
EPFL ENAC IA LIPID

http://people.epfl.ch/jan.wienold
LE 1 111 (Office)
Phone    +41 21 69 30849

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151201/d58f5b2a/attachment-0001.html>

From geotrupes at me.com  Tue Dec  1 10:14:18 2015
From: geotrupes at me.com (giulioandrea antonutto foi)
Date: Tue, 01 Dec 2015 18:14:18 +0000
Subject: [Radiance-general] mirror and mixfunc
In-Reply-To: <9D71682D-B603-4F21-8E0F-C44862BEFED9@lmi.net>
References: <565DB230.6000504@epfl.ch>
	<FE162E8E-0945-478F-BC56-F2A40DCD56AD@lmi.net>
	<420B484A-A560-49EC-A8A5-81B1E382D381@me.com>
	<9D71682D-B603-4F21-8E0F-C44862BEFED9@lmi.net>
Message-ID: <382FF10F-803F-4158-B68C-925F5DA5167A@me.com>

Unfortunately is no more online but I still have some of the entries.
I can probably make a PDF of these and send it to Andy for sharing with the community?
G.

> On 1 Dec 2015, at 17:11, Greg Ward <gregoryjward at gmail.com> wrote:
> 
> Thanks, Giulio, great stuff!  Do we have a link to your blog from radiance-online?  We should add one if we don't.  Is there an index of any kind?
> 
> Cheers,
> -Greg
> 
>> From: giulioandrea antonutto foi <geotrupes at me.com <mailto:geotrupes at me.com>>
>> Subject: Re: [Radiance-general] mirror and mixfunc
>> Date: December 1, 2015 8:57:52 AM PST
>> 
>> From my old blog?.
>> 
>> The idea is to create a simple mirror, a ?caustic? effect and apply a pattern to it, to create holes without having to modify the geometry.
>> The geometry is a classic:
>> cap.rad - the cap for the ring
>> mix ring top
>> 0
>> 0
>> 8
>> 0 0 25
>> 0 0 1
>> 57.29432507 60
>> scene.rad - a spot light and a plane
>> void spotlight spot
>> 0
>> 0
>> 7 50000 50000 50000 35 0 -1 -1
>> spot sphere source
>> 0
>> 0
>> 4 0 200 200 2.5
>> void plastic white
>> 0
>> 0
>> 5 .5 .5 .5 0 0
>> white polygon plan
>> 0
>> 0
>> 12
>> -500 -500 0
>> -500 500 0
>> 500 500 0
>> 500 -500 0
>> single.rad - a single sector of the ring, to array
>> mix polygon int
>> 0
>> 0
>> 12
>> -.5 -57.29432507 0
>> -.5 -57.29432507 25
>> .5 -57.29432507 25
>> .5 -57.29432507 0
>> mix polygon ext
>> 0
>> 0
>> 12
>> -.5237120674 -60 0
>> .5237120674 -60 0
>> .5237120674 -60 25
>> -.5237120674 -60 25
>> And now the interesting stuff:
>> To activate secondary sources use -dr N  (N>0).
>> We will use mirror.
>> Unfortunately when mirror is nested into a mixfunc material is invisible to the secondary source tracer... but there is a workaround...
>> model.mat
>> #alterate the reflectance of the metal - optional
>> void brightfunc stripes
>> 2  'sin(A1*Pz)' . 
>> 0
>> 1 .8
>> #metal
>> stripes metal metal
>> 0
>> 0
>> 5 .8 .8 .8 0.001 0
>> #mix the metal with void to create holes
>> void mixfunc strip
>> 4  metal void 'if(sin(A1*Py),0,1)' .
>> 0
>> 1 .2
>> #alterate the reflectance of mirror, reflectance is 0% for holes
>> void brightfunc band
>> 2 'if(sin(A1*Py),0,1)' .
>> 0
>> 1 .2
>> #mirror attached to the metal surface, with holes
>> band mirror mix
>> 1 strip
>> 0
>> 3 1 1 1
>> 
>> 
>> Now, array the single.rad file:
>> xform -a 360 -rz 1 -i 1 single.rad  > ring.rad
>> 
>> ...
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151201/9a55f952/attachment.html>

From perhaugaard at yahoo.dk  Thu Dec  3 06:34:32 2015
From: perhaugaard at yahoo.dk (Per Haugaard)
Date: Thu, 3 Dec 2015 14:34:32 +0000 (UTC)
Subject: [Radiance-general] Using two clipping boxes in visualization of
	lighting distribution
References: <379352180.24236382.1449153272917.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <379352180.24236382.1449153272917.JavaMail.yahoo@mail.yahoo.com>

Dear group,
I would like to use?two clipping boxes to "cut off" the top and side in my model to better visualize lighting distribution in my design.I have tried to include two clipping boxes in a clipping box octree:
oconv objects/BOX_top.rad objects/BOX_PL2-3.rad > octrees/Clipping_box.oct

I then use vwrays for illustration:
vwrays -fd -vf views/View_perspective.vf -x 1000 -y 1000 | rtrace -w -h -fd -opd octrees/Clipping_box.oct | rtrace -w -ab 1 -fdc `vwrays -d -vf views/View_perspective.vf -x 1000 -y 1000` octrees/office.oct > images/office.pic

My problem is that the only things that seem to be "cut off" is the intersecting part of the two boxes.
Is there a way to work with two clipping boxes to "cut off" the top and side in a model for better visualization of the lighting distribution?
Any input is much appreciated.

Best regards
Per Haugaard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151203/b2d58af3/attachment.html>

From Robert.Guglielmetti at nrel.gov  Thu Dec  3 06:49:18 2015
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Thu, 3 Dec 2015 14:49:18 +0000
Subject: [Radiance-general] Using two clipping boxes in visualization of
 lighting distribution
In-Reply-To: <379352180.24236382.1449153272917.JavaMail.yahoo@mail.yahoo.com>
References: <379352180.24236382.1449153272917.JavaMail.yahoo.ref@mail.yahoo.com>
	<379352180.24236382.1449153272917.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <D285A323.200E6%Robert.Guglielmetti@nrel.gov>

That looks a lot like the technique John M. details here (http://radsite.lbl.gov/radiance/refer/Notes/jm_technote_02.pdf), but it seems like you're using the first technique (used to mask arbitrarily shaped, adjacent obstructions) and really want the second one (used to "peek into" a space while preserving the geometry for the traced rays. Could you post images of the result, as well as images of each octree you're using?

On 12/3/15, 7:34 AM, "Per Haugaard" <perhaugaard at yahoo.dk<mailto:perhaugaard at yahoo.dk>> wrote:

Dear group,

I would like to use two clipping boxes to "cut off" the top and side in my model to better visualize lighting distribution in my design.
I have tried to include two clipping boxes in a clipping box octree:

oconv objects/BOX_top.rad objects/BOX_PL2-3.rad > octrees/Clipping_box.oct

I then use vwrays for illustration:

vwrays -fd -vf views/View_perspective.vf -x 1000 -y 1000 | rtrace -w -h -fd -opd octrees/Clipping_box.oct | rtrace -w -ab 1 -fdc `vwrays -d -vf views/View_perspective.vf -x 1000 -y 1000` octrees/office.oct > images/office.pic

My problem is that the only things that seem to be "cut off" is the intersecting part of the two boxes.

Is there a way to work with two clipping boxes to "cut off" the top and side in a model for better visualization of the lighting distribution?

Any input is much appreciated.


Best regards

Per Haugaard


From perhaugaard at yahoo.dk  Thu Dec  3 23:38:21 2015
From: perhaugaard at yahoo.dk (Per Haugaard)
Date: Fri, 4 Dec 2015 07:38:21 +0000 (UTC)
Subject: [Radiance-general] Radiance-general Digest, Vol 142, Issue 5
In-Reply-To: <mailman.1.1449172800.11788.radiance-general@radiance-online.org>
References: <mailman.1.1449172800.11788.radiance-general@radiance-online.org>
Message-ID: <1011964560.97075.1449214701428.JavaMail.yahoo@mail.yahoo.com>

Hi group,
I have put the octree info and the picture for my rendering at?http://phaugaard.blogspot.dk/2015/12/two-clipping-boxes.html?Both clipping boxes are quite big and cut off one side and the top respectively. The only thing that is removed in the pictere is where the two clipping boxes intersect.
I am not familiar with the second option mentioned in the paper?(used to "peek into" a space while preserving the geometry for the traced rays).
How does the second option work?
Once again thank you for your help.

Best regards
Per Haugaard

 


    Den 21:01 torsdag den 3. december 2015 skrev "radiance-general-request at radiance-online.org" <radiance-general-request at radiance-online.org>:
 

 Send Radiance-general mailing list submissions to
??? radiance-general at radiance-online.org

To subscribe or unsubscribe via the World Wide Web, visit
??? http://www.radiance-online.org/mailman/listinfo/radiance-general
or, via email, send a message with subject or body 'help' to
??? radiance-general-request at radiance-online.org

You can reach the person managing the list at
??? radiance-general-owner at radiance-online.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Radiance-general digest..."


Today's Topics:

? 1. Using two clipping boxes in visualization of??? lighting
? ? ? distribution (Per Haugaard)
? 2. Re: Using two clipping boxes in visualization of lighting
? ? ? distribution (Guglielmetti, Robert)


----------------------------------------------------------------------

Message: 1
Date: Thu, 3 Dec 2015 14:34:32 +0000 (UTC)
From: Per Haugaard <perhaugaard at yahoo.dk>
To: Radiance General Discussion <radiance-general at radiance-online.org>
Subject: [Radiance-general] Using two clipping boxes in visualization
??? of??? lighting distribution
Message-ID:
??? <379352180.24236382.1449153272917.JavaMail.yahoo at mail.yahoo.com>
Content-Type: text/plain; charset="utf-8"

Dear group,
I would like to use?two clipping boxes to "cut off" the top and side in my model to better visualize lighting distribution in my design.I have tried to include two clipping boxes in a clipping box octree:
oconv objects/BOX_top.rad objects/BOX_PL2-3.rad > octrees/Clipping_box.oct

I then use vwrays for illustration:
vwrays -fd -vf views/View_perspective.vf -x 1000 -y 1000 | rtrace -w -h -fd -opd octrees/Clipping_box.oct | rtrace -w -ab 1 -fdc `vwrays -d -vf views/View_perspective.vf -x 1000 -y 1000` octrees/office.oct > images/office.pic

My problem is that the only things that seem to be "cut off" is the intersecting part of the two boxes.
Is there a way to work with two clipping boxes to "cut off" the top and side in a model for better visualization of the lighting distribution?
Any input is much appreciated.

Best regards
Per Haugaard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151203/b2d58af3/attachment-0001.html>

------------------------------

Message: 2
Date: Thu, 3 Dec 2015 14:49:18 +0000
From: "Guglielmetti, Robert" <Robert.Guglielmetti at nrel.gov>
To: Per Haugaard <perhaugaard at yahoo.dk>, Radiance general discussion
??? <radiance-general at radiance-online.org>
Subject: Re: [Radiance-general] Using two clipping boxes in
??? visualization of lighting distribution
Message-ID: <D285A323.200E6%Robert.Guglielmetti at nrel.gov>
Content-Type: text/plain; charset="us-ascii"

That looks a lot like the technique John M. details here (http://radsite.lbl.gov/radiance/refer/Notes/jm_technote_02.pdf), but it seems like you're using the first technique (used to mask arbitrarily shaped, adjacent obstructions) and really want the second one (used to "peek into" a space while preserving the geometry for the traced rays. Could you post images of the result, as well as images of each octree you're using?

On 12/3/15, 7:34 AM, "Per Haugaard" <perhaugaard at yahoo.dk<mailto:perhaugaard at yahoo.dk>> wrote:

Dear group,

I would like to use two clipping boxes to "cut off" the top and side in my model to better visualize lighting distribution in my design.
I have tried to include two clipping boxes in a clipping box octree:

oconv objects/BOX_top.rad objects/BOX_PL2-3.rad > octrees/Clipping_box.oct

I then use vwrays for illustration:

vwrays -fd -vf views/View_perspective.vf -x 1000 -y 1000 | rtrace -w -h -fd -opd octrees/Clipping_box.oct | rtrace -w -ab 1 -fdc `vwrays -d -vf views/View_perspective.vf -x 1000 -y 1000` octrees/office.oct > images/office.pic

My problem is that the only things that seem to be "cut off" is the intersecting part of the two boxes.

Is there a way to work with two clipping boxes to "cut off" the top and side in a model for better visualization of the lighting distribution?

Any input is much appreciated.


Best regards

Per Haugaard



------------------------------

_______________________________________________
Radiance-general mailing list
Radiance-general at radiance-online.org
http://www.radiance-online.org/mailman/listinfo/radiance-general


End of Radiance-general Digest, Vol 142, Issue 5
************************************************


  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151204/1b1bcad3/attachment.html>

From gregoryjward at gmail.com  Fri Dec  4 05:08:11 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Fri, 4 Dec 2015 14:08:11 +0100
Subject: [Radiance-general] Radiance-general Digest, Vol 142, Issue 5
In-Reply-To: <1011964560.97075.1449214701428.JavaMail.yahoo@mail.yahoo.com>
References: <mailman.1.1449172800.11788.radiance-general@radiance-online.org>
	<1011964560.97075.1449214701428.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <56548A57-B90C-4F68-9AAF-5887022A7A2A@lmi.net>

Hi Per,

You should try using a single box, setting it up so that the sides visible from your viewpoint are just inside the wall and ceiling of your space.  That way, your rays will start in the appropriate place.  Your rays are probably starting outside your space with your current box placements.

Cheers,
-Greg

> From: Per Haugaard <perhaugaard at yahoo.dk>
> Subject: Re: [Radiance-general] Radiance-general Digest, Vol 142, Issue 5
> Date: December 4, 2015 8:38:21 AM GMT+01:00
> 
> Hi group,
> 
> I have put the octree info and the picture for my rendering at http://phaugaard.blogspot.dk/2015/12/two-clipping-boxes.html Both clipping boxes are quite big and cut off one side and the top respectively. The only thing that is removed in the pictere is where the two clipping boxes intersect.
> 
> I am not familiar with the second option mentioned in the paper (used to "peek into" a space while preserving the geometry for the traced rays).
> 
> How does the second option work?
> 
> Once again thank you for your help.
> 
> 
> Best regards
> 
> Per Haugaard
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151204/db9a6d20/attachment-0001.html>

From tbleicher at gmail.com  Fri Dec  4 05:34:28 2015
From: tbleicher at gmail.com (Thomas Bleicher)
Date: Fri, 4 Dec 2015 08:34:28 -0500
Subject: [Radiance-general] Radiance-general Digest, Vol 142, Issue 5
In-Reply-To: <1011964560.97075.1449214701428.JavaMail.yahoo@mail.yahoo.com>
References: <mailman.1.1449172800.11788.radiance-general@radiance-online.org>
	<1011964560.97075.1449214701428.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAKGV-k2KjFRUFfm5NSyCs1h5Y7NYOwWH6oPZ2fJTW=p3UWMJQg@mail.gmail.com>

Per

Basically your command traces rays from the view point (inside the box) to
the surface of the box. Where it intersects with the polygon it creates a
new ray to render everything on the other side of the box with rtrace.

When you use boxes as cut-away shapes for this technique you have to think
from "inside the box". I assume that your clipping boxes are very large,
both enclose the view point and the top and front of the building
respectively. In this case you would see from the inside viewpoint the
following surfaces (top to bottom in an imaginary image):

a) The inside of the box cutting away the front of the building (green
below)
b) The eave of the building (blue below)
c) The bottom of the box cutting away the top of the building (red below)

A bit of ascii art to confuse things:

   +--------------------------------+
   |                                | top cutting box
+-------------------------+         |
|  | * viewpoint          |         |
|  |                      |         |
|  |                      |         |
|  |                      |         |
|  |                      |         |
|  |                      |         |
|  |                      | b       |
|  |                      b   b     |
|  |                    b |     b   |
|  +------------------b-----------b-+
|                     b   |       b
|                     b   |       b
|                     b   |       b
|                         |
+-------------------------+
  front cutting box


Your command will use the first ray intersection with the boxes to generate
the cutting edges: the green and red lines. Everything _behind_ these
cutting planes will be rendered. Therefore the only thing you cut out of
the image is the eave of the building.

To create the effect you want with your current command create a single box
that encloses the building core (the part you want to see). Think of it
more of a "gift wrap" than a "clipping box": It encloses the parts you
want, not the part you don't want.

Hth,
Thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151204/90dfc86e/attachment.html>

From wouter.beck at ascendilex.nl  Fri Dec  4 06:31:40 2015
From: wouter.beck at ascendilex.nl (ascendilex | Wouter Beck)
Date: Fri, 4 Dec 2015 15:31:40 +0100
Subject: [Radiance-general] How to visualize a sky vector?
Message-ID: <5661A3CC.6030106@ascendilex.nl>

An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151204/fa344d73/attachment.html>

From moonen.iris at gmail.com  Fri Dec  4 07:14:47 2015
From: moonen.iris at gmail.com (Iris Moonen)
Date: Fri, 4 Dec 2015 16:14:47 +0100
Subject: [Radiance-general] Luminance - second lowest value
Message-ID: <CAPmJ462iZXU-UVpDkSUd2hMX3C0HMMg5Y=aOzB_Eru-4C=vEAw@mail.gmail.com>

Hello,

I want to calculate the second lowest value of the luminance of a
picture in radiance.
I used the command pvalue ?o ?d ?h ?b ?H picture.hdr | total ?l |
rcalc ?e ?$1=$1*179?, to calculate the lowest value, but this gives me
the value zero. This is indeed the lowest value in my picture, but
therefor I'd like to get the second lowest value of the picture. Is
there an easy way to get this, or is the only way to get this value by
looking into the list of values for every pixel when I don't use the
total command?

Best regards,
Iris


From germolinal at gmail.com  Fri Dec  4 07:20:09 2015
From: germolinal at gmail.com (=?UTF-8?Q?Germ=C3=A1n_Molina_Larrain?=)
Date: Fri, 4 Dec 2015 12:20:09 -0300
Subject: [Radiance-general] How to visualize a sky vector?
In-Reply-To: <5661A3CC.6030106@ascendilex.nl>
References: <5661A3CC.6030106@ascendilex.nl>
Message-ID: <CAF-iH4JrP6EgvfORDyPHxSWhbFTYSZZ-KOA6iJy2TaQ-DeZzuA@mail.gmail.com>

Hello Wouter,

I remember doing this quite a while ago. My approach was to create a sky
with the actual patch values and render just one image. To do this I:


   1. Generate the sky vector values using... using -h for removing the
   header might be useful.
      - gensky XXXXXXX | genskyvec -h | rcalc -e '$1 =
      $1*0.265+$2*0.67+$3*0.065
      - This will lead to one a vector of one value per sky patch.
   2. modified the reinhartb.cal file to create a mod_reinhartb.cal (see
   below). Be aware of modifying the MF parameter according to your needs.
   3. Paste the vector generated on Step 1 in the mod_reinhartb.cal
   4. Write the sky.rad file.
   5. oconv sky.rad > octree.oct
   6. rpict -vth -vd 0 0 1 -vu 0 1 0 -vh 180 -vv 180 -vp 0 0 0 -ab 3
   octree.oct > sky.hdr

You can also plot the values generated on step 1

Hope this help

Germ?n





#sky.rad

void brightfunc skyfunc
2 rad ./mod_reinhartb.cal
0
0

skyfunc glow skyglow
0
0
4 1 1 1 0

skyglow source sky
0
0
4 0 0 1 180



######################################
######################


### mod_reinhartb.cal
{ RCSid $Id: reinhartb.cal,v 2.6 2015/03/27 18:58:06 greg Exp $ }
{
Compute Reinhart high-density sky patch bin (rbin)

MF - Subdivision value (usually a power of two)
Dx,Dy,Dz - Incident direction (normalized, towards surface face)
rNx,rNy,rNz - Surface normal (normalized, away from surface)
Ux,Uy,Uz - Up direction vector (does not need to be normalized)

Modified from reinhart.cal

July 2014 G. Ward
}
{ Useful factors and functions }
DEGREE : PI/180;
Asin(x) : if(x-1, PI/2, if(-1-x, -PI/2, asin(x))) / DEGREE;
posangle(a) : if(-a, a + 2*PI, a) / DEGREE;
Atan2(y,x) : posangle(atan2(y,x));

{ Default to Tregenza sky }
MF = 1;
{ Set to -1 for left-handed coordinate system }
RHS = 1;
{ Default axis orientation (+Y == north) }
rNx = 0; rNy = 0; rNz = -1;
Ux = 0; Uy = 1; Uz = 0;
{ Compute oriented axis angles }
inc_dz = -Dx*rNx-Dy*rNy-Dz*rNz;
inc_rx = -RHS*(Dx*(Uy*rNz-Uz*rNy) + Dy*(Uz*rNx-Ux*rNz) +
Dz*(Ux*rNy-Uy*rNx));
inc_ry = Dx*Ux+Dy*Uy+Dz*Uz + inc_dz*(rNx*Ux+rNy*Uy+rNz*Uz);

r_alt = Asin(inc_dz);
r_azi = Atan2(inc_rx,inc_ry);

alpha = 90/(MF*7 + .5); { Separation between rows in degrees }
{ Number of patches per row }
tnaz(r) : select(r, 30, 30, 24, 24, 18, 12, 6);
rnaz(r) = if(r-(7*MF-.5), 1, MF*tnaz(floor((r+.5)/MF) + 1));

raccum(r) = if(r-.5, rnaz(r-1) + raccum(r-1), 0);

r_row = floor(r_alt/alpha);

r_inc = 360/rnaz(r_row);

r_azn = if(359.9999-.5*r_inc - r_azi, floor((r_azi +.5*r_inc)/r_inc), 0);

{ Final bin value, -1 for "ground" }
rbin = if (r_alt, raccum(r_row) + r_azn, -1);

Nrbins = raccum(7*MF+1); { total number of bins }


rad = select(rbin,
0.8778734094,
        0.3797278557,
        ..... one value per patch.
        ..... Paste the vector generated on step 1 here
);


2015-12-04 11:31 GMT-03:00 ascendilex | Wouter Beck <
wouter.beck at ascendilex.nl>:

> In several places I see nice false color luminance representations of
> Perez skies.
> Trying to render or preferably plot such a representation from a sky
> vector appears not to be so easy.
>
> I looked at Andy's McNeil_BSDFsandPhases.pdf and see that using an
> adaptation of
>
>  vwrays -ff -vf views/back.vf -x 600 -y 600 \
> | rfluxmtx `vwrays -vf views/back.vf -x 600 -y 600 -d` \
> -ffc -ab 12 -ad 50000 -lw 2e-5 \
> - skies/sky.rad \
> materials/testroom.mat objects/testroom.rad
>
>
> followed by an adaptation of
>
> dctimestep dcx/g_%03d.hdr skies/12_21_15.skv \
> > images/122115_clear_dcx.hdr
>
>
> could do the trick. For a MF:4 sky I'll be generating 2305 images.
> Generating these and combining them takes quite long and a lot of disk IO.
> (I did not bother to use a ram disk). Somehow this approach appears to be
> a bit of a detour.
>
> Before proceeding on this path: Isn't there a simpler way?
>
> Basically it should be possible to just plot the sky vector values using
> something like gnuplot.
>
> Best regards,
> Wouter
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151204/075b4375/attachment-0001.html>

From gregoryjward at gmail.com  Fri Dec  4 07:33:03 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Fri, 4 Dec 2015 16:33:03 +0100
Subject: [Radiance-general] How to visualize a sky vector?
In-Reply-To: <CAF-iH4JrP6EgvfORDyPHxSWhbFTYSZZ-KOA6iJy2TaQ-DeZzuA@mail.gmail.com>
References: <5661A3CC.6030106@ascendilex.nl>
	<CAF-iH4JrP6EgvfORDyPHxSWhbFTYSZZ-KOA6iJy2TaQ-DeZzuA@mail.gmail.com>
Message-ID: <005FA670-36A5-4955-B004-D71A52D48CC9@lmi.net>

Hi Wouter,

Germ?n's idea is very clever, but may be more difficult to automate.  You can stick with Andy's original method, yet reduce the file i/o by converting the uncompressed Radiance images produced by rfluxmtx into compressed ones that take much less space.  You just need to run "ra_rgbe -r orig_image.hdr smaller_image.hdr" on each image in your dcx/ directory.

-Greg

> From: Germ?n Molina Larrain <germolinal at gmail.com>
> Subject: Re: [Radiance-general] How to visualize a sky vector?
> Date: December 4, 2015 4:20:09 PM GMT+01:00
> 
> Hello Wouter, 
> 
> I remember doing this quite a while ago. My approach was to create a sky with the actual patch values and render just one image. To do this I:
> 
> Generate the sky vector values using... using -h for removing the header might be useful.
> gensky XXXXXXX | genskyvec -h | rcalc -e '$1 = $1*0.265+$2*0.67+$3*0.065
> This will lead to one a vector of one value per sky patch.
> modified the reinhartb.cal file to create a mod_reinhartb.cal (see below). Be aware of modifying the MF parameter according to your needs.
> Paste the vector generated on Step 1 in the mod_reinhartb.cal
> Write the sky.rad file.
> oconv sky.rad > octree.oct
> rpict -vth -vd 0 0 1 -vu 0 1 0 -vh 180 -vv 180 -vp 0 0 0 -ab 3 octree.oct > sky.hdr
> You can also plot the values generated on step 1
> 
> Hope this help
> 
> Germ?n
> 
> 
> #sky.rad
> 
> void brightfunc skyfunc
> 2 rad ./mod_reinhartb.cal
> 0
> 0
> 
> skyfunc glow skyglow 
> 0 
> 0 
> 4 1 1 1 0
> 
> skyglow source sky 
> 0 
> 0 
> 4 0 0 1 180
> 
> 
> 
> ######################################
> ######################
> 
> 
> ### mod_reinhartb.cal
> { RCSid $Id: reinhartb.cal,v 2.6 2015/03/27 18:58:06 greg Exp $ }
> {
> 	Compute Reinhart high-density sky patch bin (rbin)
> 
> 	MF		- Subdivision value (usually a power of two)
> 	Dx,Dy,Dz	- Incident direction (normalized, towards surface face)
> 	rNx,rNy,rNz	- Surface normal (normalized, away from surface)
> 	Ux,Uy,Uz	- Up direction vector (does not need to be normalized)
> 
> 	Modified from reinhart.cal
> 
> 	July 2014	G. Ward
> }
> 				{ Useful factors and functions }
> DEGREE : PI/180;
> Asin(x) : if(x-1, PI/2, if(-1-x, -PI/2, asin(x))) / DEGREE;
> posangle(a) : if(-a, a + 2*PI, a) / DEGREE;
> Atan2(y,x) : posangle(atan2(y,x));
> 
> 				{ Default to Tregenza sky }
> MF = 1;
> 				{ Set to -1 for left-handed coordinate system }
> RHS = 1;
> 				{ Default axis orientation (+Y == north) }
> rNx = 0; rNy = 0; rNz = -1;
> Ux = 0; Uy = 1; Uz = 0;
> 				{ Compute oriented axis angles }
> inc_dz = -Dx*rNx-Dy*rNy-Dz*rNz;
> inc_rx = -RHS*(Dx*(Uy*rNz-Uz*rNy) + Dy*(Uz*rNx-Ux*rNz) + Dz*(Ux*rNy-Uy*rNx));
> inc_ry = Dx*Ux+Dy*Uy+Dz*Uz + inc_dz*(rNx*Ux+rNy*Uy+rNz*Uz);
> 
> r_alt = Asin(inc_dz);
> r_azi = Atan2(inc_rx,inc_ry);
> 
> alpha = 90/(MF*7 + .5);		{ Separation between rows in degrees }
> 				{ Number of patches per row }
> tnaz(r) : select(r, 30, 30, 24, 24, 18, 12, 6);
> rnaz(r) = if(r-(7*MF-.5), 1, MF*tnaz(floor((r+.5)/MF) + 1));
> 
> raccum(r) = if(r-.5, rnaz(r-1) + raccum(r-1), 0);
> 
> r_row = floor(r_alt/alpha);
> 
> r_inc = 360/rnaz(r_row);
> 
> r_azn = if(359.9999-.5*r_inc - r_azi, floor((r_azi +.5*r_inc)/r_inc), 0);
> 
> 				{ Final bin value, -1 for "ground" }
> rbin = if (r_alt, raccum(r_row) + r_azn, -1);
> 
> Nrbins = raccum(7*MF+1);	{ total number of bins }
> 
> 
> rad = select(rbin,
> 	0.8778734094,
>         0.3797278557,
>         ..... one value per patch.
>         ..... Paste the vector generated on step 1 here
> );
> 
> 
> 2015-12-04 11:31 GMT-03:00 ascendilex | Wouter Beck <wouter.beck at ascendilex.nl>:
> In several places I see nice false color luminance representations of Perez skies.
> Trying to render or preferably plot such a representation from a sky vector appears not to be so easy.
> 
> I looked at Andy's McNeil_BSDFsandPhases.pdf and see that using an adaptation of 
> 
>  vwrays -ff -vf views/back.vf -x 600 -y 600 \
> | rfluxmtx `vwrays -vf views/back.vf -x 600 -y 600 -d` \
> -ffc -ab 12 -ad 50000 -lw 2e-5 \
> - skies/sky.rad \
> materials/testroom.mat objects/testroom.rad
> 
> followed by an adaptation of 
> 
> dctimestep dcx/g_%03d.hdr skies/12_21_15.skv \
> > images/122115_clear_dcx.hdr
> 
> could do the trick. For a MF:4 sky I'll be generating 2305 images. Generating these and combining them takes quite long and a lot of disk IO.
> (I did not bother to use a ram disk). Somehow this approach appears to be a bit of a detour.
> 
> Before proceeding on this path: Isn't there a simpler way?
> 
> Basically it should be possible to just plot the sky vector values using something like gnuplot.  
> 
> Best regards,
> Wouter
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151204/cf0949a4/attachment.html>

From gregoryjward at gmail.com  Fri Dec  4 07:39:54 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Fri, 4 Dec 2015 16:39:54 +0100
Subject: [Radiance-general] Luminance - second lowest value
In-Reply-To: <CAPmJ462iZXU-UVpDkSUd2hMX3C0HMMg5Y=aOzB_Eru-4C=vEAw@mail.gmail.com>
References: <CAPmJ462iZXU-UVpDkSUd2hMX3C0HMMg5Y=aOzB_Eru-4C=vEAw@mail.gmail.com>
Message-ID: <24BB6485-3A30-4959-A5D5-7B0427A6CFCF@lmi.net>

Hi Iris,

The easiest method is to simply exclude values below a certain lower threshold:

	pvalue ?o ?d ?h ?b ?H picture.hdr | rcalc ?e ?$1=$1*179? -e 'cond=$1-1e-6' | total ?l

The "cond" variable in rcalc suppresses any records where cond<=0.  I have set the threshold here to 0.000001 watts/sr/m^2, but you can set it to whatever you like.

If you *really* want the second smallest value in a file, you can use the Unix sort command.  The following should give you the 4 smallest values (ignoring duplicates):

	pvalue ?o ?d ?h ?b ?H picture.hdr | rcalc ?e ?$1=$1*179? | sort -g -u | head -4

Finally, there is the Radiance "histo" command, which can generate a histogram of values, instead:

	pvalue ?o ?d ?h ?b ?H picture.hdr | rcalc ?e ?$1=log10($1*179)? |  histo -7 7

In the above example, I'm generating a histogram of 10-base log luminance values between 10^-7 and 10^7, and you can adjust this as desired.

Cheers,
-Greg


> From: Iris Moonen <moonen.iris at gmail.com>
> Subject: [Radiance-general] Luminance - second lowest value
> Date: December 4, 2015 4:14:47 PM GMT+01:00
> 
> Hello,
> 
> I want to calculate the second lowest value of the luminance of a
> picture in radiance.
> I used the command pvalue ?o ?d ?h ?b ?H picture.hdr | total ?l |
> rcalc ?e ?$1=$1*179?, to calculate the lowest value, but this gives me
> the value zero. This is indeed the lowest value in my picture, but
> therefor I'd like to get the second lowest value of the picture. Is
> there an easy way to get this, or is the only way to get this value by
> looking into the list of values for every pixel when I don't use the
> total command?
> 
> Best regards,
> Iris


From perhaugaard at yahoo.dk  Fri Dec  4 08:06:04 2015
From: perhaugaard at yahoo.dk (Per Haugaard)
Date: Fri, 4 Dec 2015 16:06:04 +0000 (UTC)
Subject: [Radiance-general] Radiance-general Digest, Vol 142, Issue 5
In-Reply-To: <56548A57-B90C-4F68-9AAF-5887022A7A2A@lmi.net>
References: <56548A57-B90C-4F68-9AAF-5887022A7A2A@lmi.net>
Message-ID: <75321843.25184695.1449245164323.JavaMail.yahoo@mail.yahoo.com>

Hi Greg and Thomas,
The obvious solution blinded me :)Thank you very much for your input.

Best regards
Per Haugaard 


    Den 14:16 fredag den 4. december 2015 skrev Greg Ward <gregoryjward at gmail.com>:
 

 Hi Per,
You should try using a single box, setting it up so that the sides visible from your viewpoint are just inside the wall and ceiling of your space. ?That way, your rays will start in the appropriate place. ?Your rays are probably starting outside your space with your current box placements.
Cheers,-Greg

From: Per Haugaard <perhaugaard at yahoo.dk>Subject: Re: [Radiance-general] Radiance-general Digest, Vol 142, Issue 5Date: December 4, 2015 8:38:21 AM GMT+01:00


Hi group,
I have put the octree info and the picture for my rendering at?http://phaugaard.blogspot.dk/2015/12/two-clipping-boxes.html?Both clipping boxes are quite big and cut off one side and the top respectively. The only thing that is removed in the pictere is where the two clipping boxes intersect.
I am not familiar with the second option mentioned in the paper?(used to "peek into" a space while preserving the geometry for the traced rays).
How does the second option work?
Once again thank you for your help.

Best regards
Per Haugaard



  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151204/7f789d0c/attachment-0001.html>

From Robert.Guglielmetti at nrel.gov  Fri Dec  4 08:14:45 2015
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Fri, 4 Dec 2015 16:14:45 +0000
Subject: [Radiance-general] How to visualize a sky vector?
In-Reply-To: <005FA670-36A5-4955-B004-D71A52D48CC9@lmi.net>
References: <5661A3CC.6030106@ascendilex.nl>
	<CAF-iH4JrP6EgvfORDyPHxSWhbFTYSZZ-KOA6iJy2TaQ-DeZzuA@mail.gmail.com>
	<005FA670-36A5-4955-B004-D71A52D48CC9@lmi.net>
Message-ID: <D287093C.2013B%Robert.Guglielmetti@nrel.gov>

Mind blown. Totally didn't realize (but should have) that rfluxmtx image output is not yet RLE. Mind blown! BOOM! Thanks for this gem, Greg!!

- Rob

On 12/4/15, 8:33 AM, "Greg Ward" <gregoryjward at gmail.com<mailto:gregoryjward at gmail.com>> wrote:

You can ... reduce the file i/o by converting the uncompressed Radiance images produced by rfluxmtx into compressed ones that take much less space.  You just need to run "ra_rgbe -r orig_image.hdr smaller_image.hdr" on each image in your dcx/ directory.

-Greg



From gregoryjward at gmail.com  Fri Dec  4 08:51:07 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Fri, 4 Dec 2015 17:51:07 +0100
Subject: [Radiance-general] How to visualize a sky vector?
In-Reply-To: <D287093C.2013B%Robert.Guglielmetti@nrel.gov>
References: <5661A3CC.6030106@ascendilex.nl>
	<CAF-iH4JrP6EgvfORDyPHxSWhbFTYSZZ-KOA6iJy2TaQ-DeZzuA@mail.gmail.com>
	<005FA670-36A5-4955-B004-D71A52D48CC9@lmi.net>
	<D287093C.2013B%Robert.Guglielmetti@nrel.gov>
Message-ID: <4ACFDA7F-89CE-4D53-8883-9E34AD7CE9A2@lmi.net>

Yeah, and I think you can automate the conversion by outputting to a command from rcontrib:

	rcontrib -ffc -o '!ra_rgbe -r > rle_bin%04d.hdr' ...

This should also work for rfluxmtx on the command-line, but I just checked my code and the parameter parser doesn't accept quoted strings the way it should for specifying the output as part of a receiver file comment.  I should look into fixing this!

-Greg

> From: "Guglielmetti, Robert" <Robert.Guglielmetti at nrel.gov>
> Subject: Re: [Radiance-general] How to visualize a sky vector?
> Date: December 4, 2015 5:14:45 PM GMT+01:00
> 
> Mind blown. Totally didn't realize (but should have) that rfluxmtx image output is not yet RLE. Mind blown! BOOM! Thanks for this gem, Greg!!
> 
> - Rob
> 
> On 12/4/15, 8:33 AM, "Greg Ward" <gregoryjward at gmail.com<mailto:gregoryjward at gmail.com>> wrote:
> 
> You can ... reduce the file i/o by converting the uncompressed Radiance images produced by rfluxmtx into compressed ones that take much less space.  You just need to run "ra_rgbe -r orig_image.hdr smaller_image.hdr" on each image in your dcx/ directory.
> 
> -Greg


From Robert.Guglielmetti at nrel.gov  Fri Dec  4 09:08:44 2015
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Fri, 4 Dec 2015 17:08:44 +0000
Subject: [Radiance-general] How to visualize a sky vector?
In-Reply-To: <4ACFDA7F-89CE-4D53-8883-9E34AD7CE9A2@lmi.net>
References: <5661A3CC.6030106@ascendilex.nl>
	<CAF-iH4JrP6EgvfORDyPHxSWhbFTYSZZ-KOA6iJy2TaQ-DeZzuA@mail.gmail.com>
	<005FA670-36A5-4955-B004-D71A52D48CC9@lmi.net>
	<D287093C.2013B%Robert.Guglielmetti@nrel.gov>
	<4ACFDA7F-89CE-4D53-8883-9E34AD7CE9A2@lmi.net>
Message-ID: <D28713B1.20147%Robert.Guglielmetti@nrel.gov>

Yeah, that would be sweet. One reason we don't offer images from the
daylight coefficients in OpenStudio is because of this disk space
concern...

On 12/4/15, 9:51 AM, "Greg Ward" <gregoryjward at gmail.com> wrote:

>Yeah, and I think you can automate the conversion by outputting to a
>command from rcontrib:
>
>	rcontrib -ffc -o '!ra_rgbe -r > rle_bin%04d.hdr' ...
>
>This should also work for rfluxmtx on the command-line, but I just
>checked my code and the parameter parser doesn't accept quoted strings
>the way it should for specifying the output as part of a receiver file
>comment.  I should look into fixing this!
>
>-Greg
>
>> From: "Guglielmetti, Robert" <Robert.Guglielmetti at nrel.gov>
>> Subject: Re: [Radiance-general] How to visualize a sky vector?
>> Date: December 4, 2015 5:14:45 PM GMT+01:00
>> 
>> Mind blown. Totally didn't realize (but should have) that rfluxmtx
>>image output is not yet RLE. Mind blown! BOOM! Thanks for this gem,
>>Greg!!
>> 
>> - Rob
>> 
>> On 12/4/15, 8:33 AM, "Greg Ward"
>><gregoryjward at gmail.com<mailto:gregoryjward at gmail.com>> wrote:
>> 
>> You can ... reduce the file i/o by converting the uncompressed Radiance
>>images produced by rfluxmtx into compressed ones that take much less
>>space.  You just need to run "ra_rgbe -r orig_image.hdr
>>smaller_image.hdr" on each image in your dcx/ directory.
>> 
>> -Greg
>
>_______________________________________________
>Radiance-general mailing list
>Radiance-general at radiance-online.org
>http://www.radiance-online.org/mailman/listinfo/radiance-general



From wouter.beck at ascendilex.nl  Fri Dec  4 12:01:17 2015
From: wouter.beck at ascendilex.nl (ascendilex | Wouter Beck)
Date: Fri, 4 Dec 2015 21:01:17 +0100
Subject: [Radiance-general] How to visualize a sky vector?
In-Reply-To: <005FA670-36A5-4955-B004-D71A52D48CC9@lmi.net>
References: <5661A3CC.6030106@ascendilex.nl>
	<CAF-iH4JrP6EgvfORDyPHxSWhbFTYSZZ-KOA6iJy2TaQ-DeZzuA@mail.gmail.com>
	<005FA670-36A5-4955-B004-D71A52D48CC9@lmi.net>
Message-ID: <5661F10D.2090001@ascendilex.nl>

An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151204/0a95ba8a/attachment.html>

From perhaugaard at yahoo.dk  Tue Dec  8 04:47:09 2015
From: perhaugaard at yahoo.dk (Per Haugaard)
Date: Tue, 8 Dec 2015 12:47:09 +0000 (UTC)
Subject: [Radiance-general] Transparent textures in model models
References: <685953351.28080442.1449578829052.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <685953351.28080442.1449578829052.JavaMail.yahoo@mail.yahoo.com>

Dear Group,
A quick question on?Transparent textures in model models.I have a falsecolor image which I would like to make transparrent and include in my 3D model. When setting up the .cal file I get the following error:?
rtrace: fatal - cannot find picture file "images/TEST_Dyb_station_v2_20151204_21juni_kl12_falsecolor.hdr"
I get the same error when I use rpict to illustrate the "transparent image".

Here is my input for the rendering.
Octree:oconv objects/BOX_PL2-3_top.rad > octrees/Clipping_box.oct
oconv sky/21juni_kl12_sky.rad objects/Dyb_station_v2.rad mapping_PL3.rad > octrees/Dyb_station_v2_20151204_21juni_kl12_Mapping.oct

mapping_PL3.rad:
void colorpict fc_val
7 red green blue images/TEST_Dyb_station_v2_20151204_21juni_kl12_falsecolor.hdr fc.cal fc_u fc_v00
fc_val glow fc_glow004 10 10 10 0
fc_glow polygon office.working_plane0012 33.561465 21.465947 13.742918 33.561465 65.42571 13.742918 21.224001 65.42571 13.742918 21.224001 21.465947 13.742918
void mixpict mp7 fc_glow void nonzero images/TEST_Dyb_station_v2_20151204_21juni_kl12_falsecolor.hdr fc.cal fc_u fc_v00
mp polygon office.working_plane.20012 33.561465 21.465947 13.742918 33.561465 65.42571 13.742918 21.224001 65.42571 13.742918 21.224001 21.465947 13.742918
vwraysvwrays -fd -vf views/View_perspective.vf -x 1000 -y 1000 | rtrace -w -h -fd -opd octrees/Clipping_box.oct | rtrace -w $ambpar -fdc `vwrays -d -vf views/View_perspective.vf -x 1000 -y 1000` octrees/Dyb_station_v2_20151204_21juni_kl12_Mapping.oct > images/Dyb_station_v2_20151204_21juni_kl12_Mapping.pic

I then get the error:rtrace: fatal - cannot find picture file "images/TEST_Dyb_station_v2_20151204_21juni_kl12_falsecolor.hdr"

I can open the image with ximage images/TEST_Dyb_station_v2_20151204_21juni_kl12_falsecolor.hdr. So the image exits and is working, cf.?http://phaugaard.blogspot.dk/2015/12/transparent-image.html
Can anyone spot the rookie error :) ?Thank you very much for your input.

Cheers,
Per Haugaard


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151208/417f5ff4/attachment.html>

From stephen at coolshadow.com  Tue Dec  8 09:27:45 2015
From: stephen at coolshadow.com (Stephen Wasilewski)
Date: Tue, 8 Dec 2015 09:27:45 -0800
Subject: [Radiance-general]  Transparent textures in model models
Message-ID: <CAK5mS-9MuTMARg20wLjDOLU9mXQHYZn6JNL0KWrGcCn1KFdm7Q@mail.gmail.com>

You either need to include the working directory in your RAYPATH
environment value by adding a period at the front of the definition
(something like this:  export RAYPATH=.:/usr/local/radiance/lib) or
explicitly add it in your mixpict definition:

void mixpict mp
7 fc_glow void nonzero
./images/TEST_Dyb_station_v2_20151204_21juni_kl12_falsecolor.hdr fc.cal
fc_u fc_v
0
0

Stephen Wasilewski
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151208/9a18b16c/attachment.html>

From rmfritz3 at gmail.com  Wed Dec 16 19:00:16 2015
From: rmfritz3 at gmail.com (Randolph M. Fritz)
Date: Wed, 16 Dec 2015 19:00:16 -0800
Subject: [Radiance-general] SSD vs. rcontrib
Message-ID: <CANeAMoJ4UW7GOGfeF=CAVdWg+u+J0-4a5erP-Dd6CQMqfp4-uQ@mail.gmail.com>

I think I'm going to get another disk drive for my Windows workstation, so
I have enough space to run Linux on the machine. What do people think of
solid state drives for Radiance runs. I am thinking that they might have
wear problems, especially for programs like *rcontrib**.* Anyone have any
experience this this?
-- 
Randolph M. Fritz, Lighting Design and Simulation
+1 206 659-8617 || rmfritz3 at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151216/aad00666/attachment.html>

From gregoryjward at gmail.com  Wed Dec 16 19:30:32 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Wed, 16 Dec 2015 19:30:32 -0800
Subject: [Radiance-general] SSD vs. rcontrib
In-Reply-To: <CANeAMoJ4UW7GOGfeF=CAVdWg+u+J0-4a5erP-Dd6CQMqfp4-uQ@mail.gmail.com>
References: <CANeAMoJ4UW7GOGfeF=CAVdWg+u+J0-4a5erP-Dd6CQMqfp4-uQ@mail.gmail.com>
Message-ID: <BAAF0955-FD85-47D1-9E2E-0D8A924BEAE0@lmi.net>

Generally speaking, SSDs should last longer in normal use than a regular hard drive, even with lots of write operations.  The wear-leveling management has gotten a lot more sophisticated since their first introduction.  Personally, I like the OWC drives the best.  That's what I've been using for some years, now.

Cheers,
-Greg

> From: "Randolph M. Fritz" <rmfritz3 at gmail.com>
> Subject: [Radiance-general] SSD vs. rcontrib
> Date: December 16, 2015 7:00:16 PM PST
> 
> I think I'm going to get another disk drive for my Windows workstation, so I have enough space to run Linux on the machine. What do people think of solid state drives for Radiance runs. I am thinking that they might have wear problems, especially for programs like rcontrib. Anyone have any experience this this?
> -- 
> Randolph M. Fritz, Lighting Design and Simulation
> +1 206 659-8617 || rmfritz3 at gmail.com
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151216/c35a3382/attachment.html>

From gut at Transsolar.com  Thu Dec 17 03:05:16 2015
From: gut at Transsolar.com (Martin Gut)
Date: Thu, 17 Dec 2015 11:05:16 +0000
Subject: [Radiance-general] Calculation of solar declination in sun.c
Message-ID: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>


Dear Radiance Experts,

I have two questions regarding the calculation of solar declination:


1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?

return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )

https://github.com/NREL/Radiance/blob/master/src/gen/sun.c


2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?

With today computing power, there is no more reason to use this simple formula

Thanks in advance


Martin



Dipl.-Ing. (FH) Martin Gut
TRANSSOLAR Energietechnik GmbH
Landwehrstr. 60/62, D-80336 M?nchen
Tel +49 89 590 688 45
Fax +49 89 590 688 59
www.transsolar.com<http://www.transsolar.com/>
--------------------------------
Amtsgericht Stuttgart, HRB 23347, USt-IdNr.: DE152272639
Gesch?ftsf?hrer: Matthias Schuler, Thomas Auer,
Stefan Holst, Erik Olsen, Helmut Meyer, Dieter Schnelle
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/bbdc3077/attachment.html>

From RGMARC at engr.psu.edu  Thu Dec 17 07:18:53 2015
From: RGMARC at engr.psu.edu (Richard Mistrick)
Date: Thu, 17 Dec 2015 15:18:53 +0000
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
Message-ID: <4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>

I'm not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.

Rick

From: Martin Gut [mailto:gut at Transsolar.com]
Sent: Thursday, December 17, 2015 6:05 AM
To: radiance-general at radiance-online.org
Subject: [Radiance-general] Calculation of solar declination in sun.c


Dear Radiance Experts,

I have two questions regarding the calculation of solar declination:


1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?

return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )

https://github.com/NREL/Radiance/blob/master/src/gen/sun.c


2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?

With today computing power, there is no more reason to use this simple formula

Thanks in advance


Martin



Dipl.-Ing. (FH) Martin Gut
TRANSSOLAR Energietechnik GmbH
Landwehrstr. 60/62, D-80336 M?nchen
Tel +49 89 590 688 45
Fax +49 89 590 688 59
www.transsolar.com<http://www.transsolar.com/>
--------------------------------
Amtsgericht Stuttgart, HRB 23347, USt-IdNr.: DE152272639
Gesch?ftsf?hrer: Matthias Schuler, Thomas Auer,
Stefan Holst, Erik Olsen, Helmut Meyer, Dieter Schnelle
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/18b0649c/attachment-0001.html>

From germolinal at gmail.com  Thu Dec 17 07:31:13 2015
From: germolinal at gmail.com (=?UTF-8?Q?Germ=C3=A1n_Molina_Larrain?=)
Date: Thu, 17 Dec 2015 12:31:13 -0300
Subject: [Radiance-general] OSX El Capitan
Message-ID: <CAF-iH4J2pOPRstq--w_1B-nUNr-YaiHxCu6M23hNSX31WwYaYw@mail.gmail.com>

Hello all,

I have done what I was afraid to do: I updated to OS X "El Capitan" a few
days ago, and updated my Radiance version to the latest as well. So far I
can say that

1. multithreading seem to work... it does not freeze, at least. I have not
done any timing tests.

2. It compiled, even if it gave me the "there were some errors" message...
it has worked fine so far.


I have one concern, though. I THINK I noticed that I need better parameters
than before to get the same results. Can that be? This is just visual and
based on "what I remember from before".

I am posting two pictures of results and parameters, so you can judge by
yourselves.

PARAMS
<https://drive.google.com/file/d/0B2NfkTSl19hQbmducHZxU3FvOG8/view?usp=sharing>
WORKPLANE
<https://drive.google.com/file/d/0B2NfkTSl19hQcHdOcDhfTzkzem8/view?usp=sharing>

Best,

Germ?n
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/f7dd9c0c/attachment.html>

From Robert.Guglielmetti at nrel.gov  Thu Dec 17 07:42:21 2015
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Thu, 17 Dec 2015 15:42:21 +0000
Subject: [Radiance-general] OSX El Capitan
In-Reply-To: <CAF-iH4J2pOPRstq--w_1B-nUNr-YaiHxCu6M23hNSX31WwYaYw@mail.gmail.com>
References: <CAF-iH4J2pOPRstq--w_1B-nUNr-YaiHxCu6M23hNSX31WwYaYw@mail.gmail.com>
Message-ID: <D298244B.20CCC%Robert.Guglielmetti@nrel.gov>

I'd be concerned about the "...errors" message. Something either didn't compile, or wasn't copied to the proper location, are the two most common causes for that message at the end of the makeall script. As for the parameter concern, it's hard to say since we have nothing to compare your results to. Good news about the multithreading, Greg was pretty certain he'd nicked that issue with this commit:

https://github.com/NREL/Radiance/commit/60faf779695d00406cfd3f5dce2e37ad4fcff826

...the more testers we have, the better though!


On 12/17/15, 8:31 AM, "Germ?n Molina Larrain" <germolinal at gmail.com<mailto:germolinal at gmail.com>> wrote:

Hello all,

I have done what I was afraid to do: I updated to OS X "El Capitan" a few days ago, and updated my Radiance version to the latest as well. So far I can say that

1. multithreading seem to work... it does not freeze, at least. I have not done any timing tests.

2. It compiled, even if it gave me the "there were some errors" message... it has worked fine so far.


I have one concern, though. I THINK I noticed that I need better parameters than before to get the same results. Can that be? This is just visual and based on "what I remember from before".

I am posting two pictures of results and parameters, so you can judge by yourselves.

PARAMS<https://drive.google.com/file/d/0B2NfkTSl19hQbmducHZxU3FvOG8/view?usp=sharing>
WORKPLANE<https://drive.google.com/file/d/0B2NfkTSl19hQcHdOcDhfTzkzem8/view?usp=sharing>

Best,

Germ?n


From khalid.ud at gmail.com  Thu Dec 17 04:47:37 2015
From: khalid.ud at gmail.com (Khalid Al)
Date: Thu, 17 Dec 2015 15:47:37 +0300
Subject: [Radiance-general] OSX El Capitan
In-Reply-To: <CAF-iH4J2pOPRstq--w_1B-nUNr-YaiHxCu6M23hNSX31WwYaYw@mail.gmail.com>
References: <CAF-iH4J2pOPRstq--w_1B-nUNr-YaiHxCu6M23hNSX31WwYaYw@mail.gmail.com>
Message-ID: <000a01d138c9$1ca28550$55e78ff0$@gmail.com>

Hi German

 

I just want to ask about software (program)  you used to generate the pictures you attached, the results? grid looks nice.

 

Thanks

 

Khalid

 

 

From: Germ?n Molina Larrain [mailto:germolinal at gmail.com] 
Sent: Thursday, December 17, 2015 6:31 PM
To: Radiance general discussion <radiance-general at radiance-online.org>
Subject: [Radiance-general] OSX El Capitan

 

Hello all, 

 

I have done what I was afraid to do: I updated to OS X "El Capitan" a few days ago, and updated my Radiance version to the latest as well. So far I can say that 

 

1. multithreading seem to work... it does not freeze, at least. I have not done any timing tests. 

 

2. It compiled, even if it gave me the "there were some errors" message... it has worked fine so far.

 

 

I have one concern, though. I THINK I noticed that I need better parameters than before to get the same results. Can that be? This is just visual and based on "what I remember from before". 

 

I am posting two pictures of results and parameters, so you can judge by yourselves. 

 

PARAMS <https://drive.google.com/file/d/0B2NfkTSl19hQbmducHZxU3FvOG8/view?usp=sharing> 

WORKPLANE <https://drive.google.com/file/d/0B2NfkTSl19hQcHdOcDhfTzkzem8/view?usp=sharing> 

 

Best, 

 

Germ?n

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/e45ea0df/attachment.html>

From germolinal at gmail.com  Thu Dec 17 07:52:07 2015
From: germolinal at gmail.com (=?UTF-8?Q?Germ=C3=A1n_Molina_Larrain?=)
Date: Thu, 17 Dec 2015 12:52:07 -0300
Subject: [Radiance-general] OSX El Capitan
In-Reply-To: <000a01d138c9$1ca28550$55e78ff0$@gmail.com>
References: <CAF-iH4J2pOPRstq--w_1B-nUNr-YaiHxCu6M23hNSX31WwYaYw@mail.gmail.com>
	<000a01d138c9$1ca28550$55e78ff0$@gmail.com>
Message-ID: <CAF-iH4J6r3V5HT08z_E-Mcb5J78HQ3xqr_0Od4rMhJJ8-gKEPA@mail.gmail.com>

Hello, Khalid. That program is called Groundhog. Is a SketchUp Extension (
www.groundhogproject.org)

Regards!

2015-12-17 9:47 GMT-03:00 Khalid Al <khalid.ud at gmail.com>:

> Hi German
>
>
>
> I just want to ask about software (program)  you used to generate the
> pictures you attached, the results? grid looks nice.
>
>
>
> Thanks
>
>
>
> Khalid
>
>
>
>
>
> *From:* Germ?n Molina Larrain [mailto:germolinal at gmail.com]
> *Sent:* Thursday, December 17, 2015 6:31 PM
> *To:* Radiance general discussion <radiance-general at radiance-online.org>
> *Subject:* [Radiance-general] OSX El Capitan
>
>
>
> Hello all,
>
>
>
> I have done what I was afraid to do: I updated to OS X "El Capitan" a few
> days ago, and updated my Radiance version to the latest as well. So far I
> can say that
>
>
>
> 1. multithreading seem to work... it does not freeze, at least. I have not
> done any timing tests.
>
>
>
> 2. It compiled, even if it gave me the "there were some errors" message...
> it has worked fine so far.
>
>
>
>
>
> I have one concern, though. I THINK I noticed that I need better
> parameters than before to get the same results. Can that be? This is just
> visual and based on "what I remember from before".
>
>
>
> I am posting two pictures of results and parameters, so you can judge by
> yourselves.
>
>
>
> PARAMS
> <https://drive.google.com/file/d/0B2NfkTSl19hQbmducHZxU3FvOG8/view?usp=sharing>
>
> WORKPLANE
> <https://drive.google.com/file/d/0B2NfkTSl19hQcHdOcDhfTzkzem8/view?usp=sharing>
>
>
>
> Best,
>
>
>
> Germ?n
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/02f104cc/attachment-0001.html>

From rmfritz3 at gmail.com  Thu Dec 17 07:55:22 2015
From: rmfritz3 at gmail.com (Randolph M. Fritz)
Date: Thu, 17 Dec 2015 07:55:22 -0800
Subject: [Radiance-general] SSD vs. rcontrib
In-Reply-To: <BAAF0955-FD85-47D1-9E2E-0D8A924BEAE0@lmi.net>
References: <CANeAMoJ4UW7GOGfeF=CAVdWg+u+J0-4a5erP-Dd6CQMqfp4-uQ@mail.gmail.com>
	<BAAF0955-FD85-47D1-9E2E-0D8A924BEAE0@lmi.net>
Message-ID: <CANeAMo+JqpuBjOFjd4H5VedBGiEVdBN4xo35JB-Wsz=Hxk2M_Q@mail.gmail.com>

Thanks! BTW, Other World Computing is now MacSales.com.

-- 
Randolph M. Fritz || rmfritz3 at gmail.com

On Wed, Dec 16, 2015 at 7:30 PM, Greg Ward <gregoryjward at gmail.com> wrote:

> Generally speaking, SSDs should last longer in normal use than a regular
> hard drive, even with lots of write operations.  The wear-leveling
> management has gotten a lot more sophisticated since their first
> introduction.  Personally, I like the OWC drives the best.  That's what
> I've been using for some years, now.
>
> Cheers,
> -Greg
>
> *From: *"Randolph M. Fritz" <rmfritz3 at gmail.com>
>
> *Subject: *[Radiance-general] SSD vs. rcontrib
>
> *Date: *December 16, 2015 7:00:16 PM PST
>
>
> I think I'm going to get another disk drive for my Windows workstation, so
> I have enough space to run Linux on the machine. What do people think of
> solid state drives for Radiance runs. I am thinking that they might have
> wear problems, especially for programs like *rcontrib**.* Anyone have any
> experience this this?
> --
> Randolph M. Fritz, Lighting Design and Simulation
> +1 206 659-8617 || rmfritz3 at gmail.com
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/b2a192ae/attachment.html>

From gregoryjward at gmail.com  Thu Dec 17 07:59:46 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Thu, 17 Dec 2015 07:59:46 -0800
Subject: [Radiance-general] OSX El Capitan
In-Reply-To: <D298244B.20CCC%Robert.Guglielmetti@nrel.gov>
References: <CAF-iH4J2pOPRstq--w_1B-nUNr-YaiHxCu6M23hNSX31WwYaYw@mail.gmail.com>
	<D298244B.20CCC%Robert.Guglielmetti@nrel.gov>
Message-ID: <C67C654F-F1C5-4F9D-88FD-7FD45E2B9EF2@lmi.net>

Ditto to what Rob said.  If you get a "There were some errors" message, that means something didn't compile.  If you re-run "makeall install" you will see immediately which program(s) were a problem.  You can send me the output of this second run off-list and I'll see if I can sort it out.

Cheers,
-Greg

> From: "Guglielmetti, Robert" <Robert.Guglielmetti at nrel.gov>
> Subject: Re: [Radiance-general] OSX El Capitan
> Date: December 17, 2015 7:42:21 AM PST
> 
> I'd be concerned about the "...errors" message. Something either didn't compile, or wasn't copied to the proper location, are the two most common causes for that message at the end of the makeall script. As for the parameter concern, it's hard to say since we have nothing to compare your results to. Good news about the multithreading, Greg was pretty certain he'd nicked that issue with this commit:
> 
> https://github.com/NREL/Radiance/commit/60faf779695d00406cfd3f5dce2e37ad4fcff826
> 
> ...the more testers we have, the better though!
> 
> 
> On 12/17/15, 8:31 AM, "Germ?n Molina Larrain" <germolinal at gmail.com<mailto:germolinal at gmail.com>> wrote:
> 
> Hello all,
> 
> I have done what I was afraid to do: I updated to OS X "El Capitan" a few days ago, and updated my Radiance version to the latest as well. So far I can say that
> 
> 1. multithreading seem to work... it does not freeze, at least. I have not done any timing tests.
> 
> 2. It compiled, even if it gave me the "there were some errors" message... it has worked fine so far.
> 
> 
> I have one concern, though. I THINK I noticed that I need better parameters than before to get the same results. Can that be? This is just visual and based on "what I remember from before".
> 
> I am posting two pictures of results and parameters, so you can judge by yourselves.
> 
> PARAMS<https://drive.google.com/file/d/0B2NfkTSl19hQbmducHZxU3FvOG8/view?usp=sharing>
> WORKPLANE<https://drive.google.com/file/d/0B2NfkTSl19hQcHdOcDhfTzkzem8/view?usp=sharing>
> 
> Best,
> 
> Germ?n


From gregoryjward at gmail.com  Thu Dec 17 08:14:00 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Thu, 17 Dec 2015 08:14:00 -0800
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
Message-ID: <5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>

Hi Martin,

This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.

As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.

Cheers,
-Greg

> From: Richard Mistrick <RGMARC at engr.psu.edu>
> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
> Date: December 17, 2015 7:18:53 AM PST
> 
> I?m not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.
>  
> Rick
>  
> From: Martin Gut [mailto:gut at Transsolar.com] 
> Sent: Thursday, December 17, 2015 6:05 AM 
>  
> Dear Radiance Experts,
>  
> I have two questions regarding the calculation of solar declination:
>  
> 1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?
>  
> return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )
>  
> https://github.com/NREL/Radiance/blob/master/src/gen/sun.c
>  
> 2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?
> With today computing power, there is no more reason to use this simple formula
>  
> Thanks in advance
>  
> Martin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/9024c027/attachment.html>

From gut at Transsolar.com  Thu Dec 17 08:55:38 2015
From: gut at Transsolar.com (Martin Gut)
Date: Thu, 17 Dec 2015 16:55:38 +0000
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
Message-ID: <1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>

Hi Greg,

Thank You for the quick answer.  I don't know about the history of this debate because I'm quite new in this mailing list.
I think for the CIE standard stuff, sticking on the standard routines is ok.
  But this formula is also used for all the dynamic daylighting stuff like
Gendaymtx
Gendaylit
Daysim
etc.
also for shading studies: I'm wondering that so much computing effort is investigated to render the shading and on the other side the position of this shading is incorrect (especially in Autumn) because of
a very rough calculation of the sun position. The error is not so big, but it could be avoided very easy by using a better formula for solar declination.
Maybe there could be two functions, one for the standard calculations and one for "real"  calculations.

Martin


Von: Greg Ward [mailto:gregoryjward at gmail.com]
Gesendet: Donnerstag, 17. Dezember 2015 17:14
An: Radiance general discussion
Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c

Hi Martin,

This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.

As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.

Cheers,
-Greg



From: Richard Mistrick <RGMARC at engr.psu.edu<mailto:RGMARC at engr.psu.edu>>

Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Date: December 17, 2015 7:18:53 AM PST


I'm not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.

Rick

From: Martin Gut [mailto:gut at Transsolar.com]
Sent: Thursday, December 17, 2015 6:05 AM

Dear Radiance Experts,

I have two questions regarding the calculation of solar declination:


1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?

return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )

https://github.com/NREL/Radiance/blob/master/src/gen/sun.c


2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?

With today computing power, there is no more reason to use this simple formula

Thanks in advance


Martin


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/14c3dda2/attachment-0001.html>

From gregoryjward at gmail.com  Thu Dec 17 09:21:45 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Thu, 17 Dec 2015 09:21:45 -0800
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
Message-ID: <56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>

Given the tool construction, it would be simple enough to introduce a global variable that switches between the de facto solar angle calculation and a more precise version.  I'd like to hear from others that this is worthwhile before I spend too much time on it, though.  Also, whether it should be exposed as an option in all of the calling programs (i.e., IES calculation or more accurate on).

Is there a general consensus on which solar calculation is best?  I would just end up googling it, unless you or someone else has a strong recommendation.

Cheers,
-Greg

> From: Martin Gut <gut at Transsolar.com>
> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
> Date: December 17, 2015 8:55:38 AM PST
> 
> Hi Greg,
>  
> Thank You for the quick answer.  I don?t know about the history of this debate because I?m quite new in this mailing list.
> I think for the CIE standard stuff, sticking on the standard routines is ok.
>   But this formula is also used for all the dynamic daylighting stuff like
> Gendaymtx
> Gendaylit
> Daysim
> etc.
> also for shading studies: I?m wondering that so much computing effort is investigated to render the shading and on the other side the position of this shading is incorrect (especially in Autumn) because of
> a very rough calculation of the sun position. The error is not so big, but it could be avoided very easy by using a better formula for solar declination.
> Maybe there could be two functions, one for the standard calculations and one for ?real?  calculations.
>  
> Martin
>  
>  
> Von: Greg Ward [mailto:gregoryjward at gmail.com] 
> Gesendet: Donnerstag, 17. Dezember 2015 17:14
> An: Radiance general discussion
> Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c
>  
> Hi Martin,
>  
> This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.
>  
> As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.
>  
> Cheers,
> -Greg
> 
> 
> From: Richard Mistrick <RGMARC at engr.psu.edu>
> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
> Date: December 17, 2015 7:18:53 AM PST
>  
> I?m not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.
>  
> Rick
>  
> From: Martin Gut [mailto:gut at Transsolar.com] 
> Sent: Thursday, December 17, 2015 6:05 AM 
>  
> Dear Radiance Experts,
>  
> I have two questions regarding the calculation of solar declination:
>  
> 1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?
>  
> return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )
>  
> https://github.com/NREL/Radiance/blob/master/src/gen/sun.c
>  
> 2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?
> With today computing power, there is no more reason to use this simple formula
>  
> Thanks in advance
>  
> Martin
>  
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/82b8f98f/attachment.html>

From tito_ at mit.edu  Thu Dec 17 09:29:09 2015
From: tito_ at mit.edu (Christoph Reinhart)
Date: Thu, 17 Dec 2015 17:29:09 +0000
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
Message-ID: <1B23446CBF250648A2FC775DE3FE7E80F02ABE1C@OC11expo28.exchange.mit.edu>

Using a more accurate formula that is based on a respectable source like a good idea if the magnitude of the correction is as large as Martin describes. Incidentally, we are having our students do "validations" of the formula by comparing the photograph of an objects as a certain time in the year to a Radiance rendering and that analysis tends to come out pretty well: http://web.mit.edu/sustainabledesignlab/projects/DaylightingHandbook/Exercise_DirectSunlight.htm.

Best,

Christoph



From: Greg Ward [mailto:gregoryjward at gmail.com]
Sent: Thursday, December 17, 2015 12:22 PM
To: Radiance general discussion <radiance-general at radiance-online.org>
Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Given the tool construction, it would be simple enough to introduce a global variable that switches between the de facto solar angle calculation and a more precise version.  I'd like to hear from others that this is worthwhile before I spend too much time on it, though.  Also, whether it should be exposed as an option in all of the calling programs (i.e., IES calculation or more accurate on).

Is there a general consensus on which solar calculation is best?  I would just end up googling it, unless you or someone else has a strong recommendation.

Cheers,
-Greg



From: Martin Gut <gut at Transsolar.com<mailto:gut at Transsolar.com>>

Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Date: December 17, 2015 8:55:38 AM PST


Hi Greg,

Thank You for the quick answer.  I don't know about the history of this debate because I'm quite new in this mailing list.
I think for the CIE standard stuff, sticking on the standard routines is ok.
  But this formula is also used for all the dynamic daylighting stuff like
Gendaymtx
Gendaylit
Daysim
etc.
also for shading studies: I'm wondering that so much computing effort is investigated to render the shading and on the other side the position of this shading is incorrect (especially in Autumn) because of
a very rough calculation of the sun position. The error is not so big, but it could be avoided very easy by using a better formula for solar declination.
Maybe there could be two functions, one for the standard calculations and one for "real"  calculations.

Martin


Von: Greg Ward [mailto:gregoryjward at gmail.com]
Gesendet: Donnerstag, 17. Dezember 2015 17:14
An: Radiance general discussion
Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c

Hi Martin,

This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.

As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.

Cheers,
-Greg




From: Richard Mistrick <RGMARC at engr.psu.edu<mailto:RGMARC at engr.psu.edu>>

Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Date: December 17, 2015 7:18:53 AM PST


I'm not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.

Rick

From: Martin Gut [mailto:gut at Transsolar.com]
Sent: Thursday, December 17, 2015 6:05 AM

Dear Radiance Experts,

I have two questions regarding the calculation of solar declination:


1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?

return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )

https://github.com/NREL/Radiance/blob/master/src/gen/sun.c


2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?

With today computing power, there is no more reason to use this simple formula

Thanks in advance


Martin


_______________________________________________
Radiance-general mailing list
Radiance-general at radiance-online.org<mailto:Radiance-general at radiance-online.org>
http://www.radiance-online.org/mailman/listinfo/radiance-general
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/e6ac03e5/attachment-0001.html>

From mstock at umich.edu  Thu Dec 17 09:30:58 2015
From: mstock at umich.edu (Mark Stock)
Date: Thu, 17 Dec 2015 12:30:58 -0500
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
Message-ID: <CADoMKs09Cuc238N0JAgc9PtJ9HC=vtH2+RBmTBsQrwx9VVC9jw@mail.gmail.com>

I hope this contributes to the discussion: the genUtahSky program that
I presented a few workshops ago (top of
http://markjstock.org/radiance/) uses the libnova library for
astronomical calculations. It's a good place to start for all kinds of
astronomical data, though being an external library might not make it
the best choice for this application.

Mark

On 12/17/15, Greg Ward <gregoryjward at gmail.com> wrote:
> Given the tool construction, it would be simple enough to introduce a global
> variable that switches between the de facto solar angle calculation and a
> more precise version.  I'd like to hear from others that this is worthwhile
> before I spend too much time on it, though.  Also, whether it should be
> exposed as an option in all of the calling programs (i.e., IES calculation
> or more accurate on).
>
> Is there a general consensus on which solar calculation is best?  I would
> just end up googling it, unless you or someone else has a strong
> recommendation.
>
> Cheers,
> -Greg
>
>> From: Martin Gut <gut at Transsolar.com>
>> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
>> Date: December 17, 2015 8:55:38 AM PST
>>
>> Hi Greg,
>>
>> Thank You for the quick answer.  I don?t know about the history of this
>> debate because I?m quite new in this mailing list.
>> I think for the CIE standard stuff, sticking on the standard routines is
>> ok.
>>   But this formula is also used for all the dynamic daylighting stuff
>> like
>> Gendaymtx
>> Gendaylit
>> Daysim
>> etc.
>> also for shading studies: I?m wondering that so much computing effort is
>> investigated to render the shading and on the other side the position of
>> this shading is incorrect (especially in Autumn) because of
>> a very rough calculation of the sun position. The error is not so big, but
>> it could be avoided very easy by using a better formula for solar
>> declination.
>> Maybe there could be two functions, one for the standard calculations and
>> one for ?real?  calculations.
>>
>> Martin
>>
>>
>> Von: Greg Ward [mailto:gregoryjward at gmail.com]
>> Gesendet: Donnerstag, 17. Dezember 2015 17:14
>> An: Radiance general discussion
>> Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c
>>
>> Hi Martin,
>>
>> This debate comes up every so often with the solar calculations used in
>> Radiance and related tools.  The main question is, do we stick with the
>> established standard, which provides for easy "apples to apples"
>> comparisons, or do we update our formulas to get a more precise answer?
>> In the case of the original CIE sky models, which this solar calculation
>> is used in primarily, the accuracy is not that great, so getting the sun
>> in exactly the right place is a minor quibble.  If, on the other hand, you
>> need precise sun position for solar shading studies or the like, then it's
>> easy to argue for a better formula.  I don't think computing power was
>> ever the issue with Radiance.  We don't compute the sun position for every
>> ray-traced or anything silly like that.
>>
>> As Rick points out, the use of 368 is part of the IES standard
>> calculation, but I'm not entirely sure what anomaly it is correcting for.
>>
>> Cheers,
>> -Greg
>>
>>
>> From: Richard Mistrick <RGMARC at engr.psu.edu>
>> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
>> Date: December 17, 2015 7:18:53 AM PST
>>
>> I?m not certain why it is 368, but this equation has been in this format
>> in the IES Lighting Handbook for many years.
>>
>> Rick
>>
>> From: Martin Gut [mailto:gut at Transsolar.com]
>> Sent: Thursday, December 17, 2015 6:05 AM
>>
>> Dear Radiance Experts,
>>
>> I have two questions regarding the calculation of solar declination:
>>
>> 1.       Why has the year in function sdec  in  file sun.c  368 days
>> instead of 365 as in the original formula from Cooper ?
>>
>> return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )
>>
>> https://github.com/NREL/Radiance/blob/master/src/gen/sun.c
>>
>> 2.       Why does Radiance not use a better formula, which takes into
>> account, that the Earth orbit is not a circle?
>> With today computing power, there is no more reason to use this simple
>> formula
>>
>> Thanks in advance
>>
>> Martin
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>


From chris at christianhumann.com  Thu Dec 17 09:48:34 2015
From: chris at christianhumann.com (Christian Humann)
Date: Thu, 17 Dec 2015 09:48:34 -0800
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
Message-ID: <C8DC9C92-526C-43AB-99AD-4A10B91E2EF5@christianhumann.com>

Hi Greg,

I?ve found the NREL algorithms to be quite accurate:
http://www.nrel.gov/docs/fy08osti/34302.pdf

Chris 



On Dec 17, 2015, at 9:21 AM, Greg Ward <gregoryjward at gmail.com> wrote:

> Given the tool construction, it would be simple enough to introduce a global variable that switches between the de facto solar angle calculation and a more precise version.  I'd like to hear from others that this is worthwhile before I spend too much time on it, though.  Also, whether it should be exposed as an option in all of the calling programs (i.e., IES calculation or more accurate on).
> 
> Is there a general consensus on which solar calculation is best?  I would just end up googling it, unless you or someone else has a strong recommendation.
> 
> Cheers,
> -Greg
> 
>> From: Martin Gut <gut at Transsolar.com>
>> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
>> Date: December 17, 2015 8:55:38 AM PST
>> 
>> Hi Greg,
>>  
>> Thank You for the quick answer.  I don?t know about the history of this debate because I?m quite new in this mailing list.
>> I think for the CIE standard stuff, sticking on the standard routines is ok.
>>   But this formula is also used for all the dynamic daylighting stuff like
>> Gendaymtx
>> Gendaylit
>> Daysim
>> etc.
>> also for shading studies: I?m wondering that so much computing effort is investigated to render the shading and on the other side the position of this shading is incorrect (especially in Autumn) because of
>> a very rough calculation of the sun position. The error is not so big, but it could be avoided very easy by using a better formula for solar declination.
>> Maybe there could be two functions, one for the standard calculations and one for ?real?  calculations.
>>  
>> Martin
>>  
>>  
>> Von: Greg Ward [mailto:gregoryjward at gmail.com] 
>> Gesendet: Donnerstag, 17. Dezember 2015 17:14
>> An: Radiance general discussion
>> Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c
>>  
>> Hi Martin,
>>  
>> This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.
>>  
>> As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.
>>  
>> Cheers,
>> -Greg
>> 
>> 
>> From: Richard Mistrick <RGMARC at engr.psu.edu>
>> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
>> Date: December 17, 2015 7:18:53 AM PST
>>  
>> I?m not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.
>>  
>> Rick
>>  
>> From: Martin Gut [mailto:gut at Transsolar.com] 
>> Sent: Thursday, December 17, 2015 6:05 AM 
>>  
>> Dear Radiance Experts,
>>  
>> I have two questions regarding the calculation of solar declination:
>>  
>> 1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?
>>  
>> return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )
>>  
>> https://github.com/NREL/Radiance/blob/master/src/gen/sun.c
>>  
>> 2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?
>> With today computing power, there is no more reason to use this simple formula
>>  
>> Thanks in advance
>>  
>> Martin
>>  
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/531f7416/attachment-0001.html>

From nathanieljon at gmail.com  Thu Dec 17 09:53:59 2015
From: nathanieljon at gmail.com (Nathaniel Jones)
Date: Thu, 17 Dec 2015 12:53:59 -0500
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <C8DC9C92-526C-43AB-99AD-4A10B91E2EF5@christianhumann.com>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
	<C8DC9C92-526C-43AB-99AD-4A10B91E2EF5@christianhumann.com>
Message-ID: <CAJR73tth-VTUAaG3GbpvkJkypD5z64dd_+p1YpaayaRf=nawuQ@mail.gmail.com>

I'll echo Chris's comment, and note that NREL has been nice enough to post
their c source code online (for non-commercial use only). They claim
accuracy within 0.0003 degrees for the years -2000 to 6000.
https://www.nrel.gov/midc/solpos/

Nathaniel

On Thu, Dec 17, 2015 at 12:48 PM, Christian Humann <
chris at christianhumann.com> wrote:

> Hi Greg,
>
> I?ve found the NREL algorithms to be quite accurate:
> http://www.nrel.gov/docs/fy08osti/34302.pdf
>
> Chris
>
>
>
> On Dec 17, 2015, at 9:21 AM, Greg Ward <gregoryjward at gmail.com> wrote:
>
> Given the tool construction, it would be simple enough to introduce a
> global variable that switches between the de facto solar angle calculation
> and a more precise version.  I'd like to hear from others that this is
> worthwhile before I spend too much time on it, though.  Also, whether it
> should be exposed as an option in all of the calling programs (i.e., IES
> calculation or more accurate on).
>
> Is there a general consensus on which solar calculation is best?  I would
> just end up googling it, unless you or someone else has a strong
> recommendation.
>
> Cheers,
> -Greg
>
> *From: *Martin Gut <gut at Transsolar.com>
> *Subject: *Re: [Radiance-general] Calculation of solar declination in
> sun.c
> *Date: *December 17, 2015 8:55:38 AM PST
>
> Hi Greg,
>
> Thank You for the quick answer.  I don?t know about the history of this
> debate because I?m quite new in this mailing list.
> I think for the CIE standard stuff, sticking on the standard routines is
> ok.
>   But this formula is also used for all the dynamic daylighting stuff like
> Gendaymtx
> Gendaylit
> Daysim
> etc.
> also for shading studies: I?m wondering that so much computing effort is
> investigated to render the shading and on the other side the position of
> this shading is incorrect (especially in Autumn) because of
> a very rough calculation of the sun position. The error is not so big, but
> it could be avoided very easy by using a better formula for solar
> declination.
> Maybe there could be two functions, one for the standard calculations and
> one for ?real?  calculations.
>
> Martin
>
>
> *Von:* Greg Ward [mailto:gregoryjward at gmail.com <gregoryjward at gmail.com>]
> *Gesendet:* Donnerstag, 17. Dezember 2015 17:14
> *An:* Radiance general discussion
> *Betreff:* Re: [Radiance-general] Calculation of solar declination in
> sun.c
>
> Hi Martin,
>
> This debate comes up every so often with the solar calculations used in
> Radiance and related tools.  The main question is, do we stick with the
> established standard, which provides for easy "apples to apples"
> comparisons, or do we update our formulas to get a more precise answer?  In
> the case of the original CIE sky models, which this solar calculation is
> used in primarily, the accuracy is not that great, so getting the sun in
> exactly the right place is a minor quibble.  If, on the other hand, you
> need precise sun position for solar shading studies or the like, then it's
> easy to argue for a better formula.  I don't think computing power was ever
> the issue with Radiance.  We don't compute the sun position for every
> ray-traced or anything silly like that.
>
> As Rick points out, the use of 368 is part of the IES standard
> calculation, but I'm not entirely sure what anomaly it is correcting for.
>
> Cheers,
> -Greg
>
>
> *From: *Richard Mistrick <RGMARC at engr.psu.edu>
>
> *Subject: *Re: [Radiance-general] Calculation of solar declination in
> sun.c
>
> *Date: *December 17, 2015 7:18:53 AM PST
>
>
>
> I?m not certain why it is 368, but this equation has been in this format
> in the IES Lighting Handbook for many years.
>
> Rick
>
> *From:* Martin Gut [mailto:gut at Transsolar.com <gut at Transsolar.com>]
> *Sent:* Thursday, December 17, 2015 6:05 AM
>
> Dear Radiance Experts,
>
> I have two questions regarding the calculation of solar declination:
>
> 1.       Why has the year in function sdec  in  file sun.c  368 days
> instead of 365 as in the original formula from Cooper ?
>
> return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )
>
> https://github.com/NREL/Radiance/blob/master/src/gen/sun.c
>
> 2.       Why does Radiance not use a better formula, which takes into
> account, that the Earth orbit is not a circle?
> With today computing power, there is no more reason to use this simple
> formula
>
> Thanks in advance
>
> Martin
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151217/2dcc2437/attachment.html>

From gut at Transsolar.com  Fri Dec 18 07:40:37 2015
From: gut at Transsolar.com (Martin Gut)
Date: Fri, 18 Dec 2015 15:40:37 +0000
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <1B23446CBF250648A2FC775DE3FE7E80F02ABE1C@OC11expo28.exchange.mit.edu>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
	<1B23446CBF250648A2FC775DE3FE7E80F02ABE1C@OC11expo28.exchange.mit.edu>
Message-ID: <1AF0F42605A31D4AAFCA9C502D759F2D5A345EF8@SRV-EX01.transsolar.local>


For me, the difference of the real picture and the simulation is quite visible. Maybe this discussion topic is one reason for this.

We came across this issue by doing a combined thermal and dynamic daylight analysis.
One calculation with original DAYSIM  and one DAYSIM calculation with sun position calculated from TRNSYS.
There were quite visible differences, especially in Autumn.

https://drive.google.com/file/d/0B_k3K9s5QAlISGdYWFdlMHZFc00/view?usp=sharing

and

https://drive.google.com/file/d/0B_k3K9s5QAlIb0lRN3VrdXVQaFU/view?usp=sharing

TRNSYS uses the Spencer-Algorithm  from 1971 for the calculation of solar declination.
Implementing this Algorithm is easy because it has just a few more sin() and cos() statements .

This graph:

https://drive.google.com/file/d/0B_k3K9s5QAlIbWVXZHhINXhYTDA/view?usp=sharing

shows the differences between this algorithm, the Cooper Algorithm and the Algorithm used in Radiance.
So my first question is answered by this. By using 368 days per year the deviation is smaller than with the original
Cooper Algorithm.

A good starting point for choosing the right algorithm could be in my opinion :
"Computing the solar vector" in  Solar Energy Vol. 70, No. 5, pp. 431-441, 2001 by  MANUEL BLANCO-MURIEL et al.
Here, the differences of common algorithm are described. They use only the Spencer Algorithm as an example of a simple algorithm.
Following table shows, that there are considerable differences:
https://drive.google.com/file/d/0B_k3K9s5QAlIcS1JQmZFSGttbWs/view?usp=sharing
They recommend the Michalsky-Algorithm or their own PSA-Algorithm, which is a little bit better.
The Michalsky Algorithm is also used in the program SolPos Nathaniel Jones recommended:

https://www.nrel.gov/midc/solpos/

The Source Code for the PSA-Algorithm is available under:

http://www.psa.es/sdg/sunpos.htm

It seems to be comparable to the  from  Christian Humann recommended NREL algorithms which is used in the program spa:

https://www.nrel.gov/midc/spa/

>From my point of view as a user it would be desirable, that the main used Simulation Programs uses the same or at least quite similar algorithm for calculating the sun position.
TRNSYS uses the Spencer-Algorithm, which is due to the upper publications also not the best choice.
It would be interesting what algorithm EnergyPlus uses.

Regards

Martin



Von: Christoph Reinhart [mailto:tito_ at mit.edu]
Gesendet: Donnerstag, 17. Dezember 2015 18:29
An: Radiance general discussion
Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c

Using a more accurate formula that is based on a respectable source like a good idea if the magnitude of the correction is as large as Martin describes. Incidentally, we are having our students do "validations" of the formula by comparing the photograph of an objects as a certain time in the year to a Radiance rendering and that analysis tends to come out pretty well: http://web.mit.edu/sustainabledesignlab/projects/DaylightingHandbook/Exercise_DirectSunlight.htm.

Best,

Christoph



From: Greg Ward [mailto:gregoryjward at gmail.com]
Sent: Thursday, December 17, 2015 12:22 PM
To: Radiance general discussion <radiance-general at radiance-online.org<mailto:radiance-general at radiance-online.org>>
Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Given the tool construction, it would be simple enough to introduce a global variable that switches between the de facto solar angle calculation and a more precise version.  I'd like to hear from others that this is worthwhile before I spend too much time on it, though.  Also, whether it should be exposed as an option in all of the calling programs (i.e., IES calculation or more accurate on).

Is there a general consensus on which solar calculation is best?  I would just end up googling it, unless you or someone else has a strong recommendation.

Cheers,
-Greg


From: Martin Gut <gut at Transsolar.com<mailto:gut at Transsolar.com>>

Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Date: December 17, 2015 8:55:38 AM PST


Hi Greg,

Thank You for the quick answer.  I don't know about the history of this debate because I'm quite new in this mailing list.
I think for the CIE standard stuff, sticking on the standard routines is ok.
  But this formula is also used for all the dynamic daylighting stuff like
Gendaymtx
Gendaylit
Daysim
etc.
also for shading studies: I'm wondering that so much computing effort is investigated to render the shading and on the other side the position of this shading is incorrect (especially in Autumn) because of
a very rough calculation of the sun position. The error is not so big, but it could be avoided very easy by using a better formula for solar declination.
Maybe there could be two functions, one for the standard calculations and one for "real"  calculations.

Martin


Von: Greg Ward [mailto:gregoryjward at gmail.com]
Gesendet: Donnerstag, 17. Dezember 2015 17:14
An: Radiance general discussion
Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c

Hi Martin,

This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.

As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.

Cheers,
-Greg



From: Richard Mistrick <RGMARC at engr.psu.edu<mailto:RGMARC at engr.psu.edu>>

Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Date: December 17, 2015 7:18:53 AM PST


I'm not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.

Rick

From: Martin Gut [mailto:gut at Transsolar.com]
Sent: Thursday, December 17, 2015 6:05 AM

Dear Radiance Experts,

I have two questions regarding the calculation of solar declination:


1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?

return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )

https://github.com/NREL/Radiance/blob/master/src/gen/sun.c


2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?

With today computing power, there is no more reason to use this simple formula

Thanks in advance


Martin


_______________________________________________
Radiance-general mailing list
Radiance-general at radiance-online.org<mailto:Radiance-general at radiance-online.org>
http://www.radiance-online.org/mailman/listinfo/radiance-general
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151218/677dad7e/attachment-0001.html>

From Robert.Guglielmetti at nrel.gov  Fri Dec 18 08:28:21 2015
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Fri, 18 Dec 2015 16:28:21 +0000
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <1AF0F42605A31D4AAFCA9C502D759F2D5A345EF8@SRV-EX01.transsolar.local>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
	<1B23446CBF250648A2FC775DE3FE7E80F02ABE1C@OC11expo28.exchange.mit.edu>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345EF8@SRV-EX01.transsolar.local>
Message-ID: <D2998198.20D02%Robert.Guglielmetti@nrel.gov>

This is fascinating, and in my opinion a cautionary tale for the community, given all the weight being placed on ASE as a daylight metric lately.

On 12/18/15, 8:40 AM, "Martin Gut" <gut at Transsolar.com<mailto:gut at Transsolar.com>> wrote:


For me, the difference of the real picture and the simulation is quite visible. Maybe this discussion topic is one reason for this.

We came across this issue by doing a combined thermal and dynamic daylight analysis.
One calculation with original DAYSIM  and one DAYSIM calculation with sun position calculated from TRNSYS.
There were quite visible differences, especially in Autumn.

https://drive.google.com/file/d/0B_k3K9s5QAlISGdYWFdlMHZFc00/view?usp=sharing

and

https://drive.google.com/file/d/0B_k3K9s5QAlIb0lRN3VrdXVQaFU/view?usp=sharing

TRNSYS uses the Spencer-Algorithm  from 1971 for the calculation of solar declination.
Implementing this Algorithm is easy because it has just a few more sin() and cos() statements .

This graph:

https://drive.google.com/file/d/0B_k3K9s5QAlIbWVXZHhINXhYTDA/view?usp=sharing

shows the differences between this algorithm, the Cooper Algorithm and the Algorithm used in Radiance.
So my first question is answered by this. By using 368 days per year the deviation is smaller than with the original
Cooper Algorithm.

A good starting point for choosing the right algorithm could be in my opinion :
?Computing the solar vector? in  Solar Energy Vol. 70, No. 5, pp. 431?441, 2001 by  MANUEL BLANCO-MURIEL et al.
Here, the differences of common algorithm are described. They use only the Spencer Algorithm as an example of a simple algorithm.
Following table shows, that there are considerable differences:
https://drive.google.com/file/d/0B_k3K9s5QAlIcS1JQmZFSGttbWs/view?usp=sharing
They recommend the Michalsky-Algorithm or their own PSA-Algorithm, which is a little bit better.
The Michalsky Algorithm is also used in the program SolPos Nathaniel Jones recommended:

https://www.nrel.gov/midc/solpos/

The Source Code for the PSA-Algorithm is available under:

http://www.psa.es/sdg/sunpos.htm

It seems to be comparable to the  from  Christian Humann recommended NREL algorithms which is used in the program spa:

https://www.nrel.gov/midc/spa/

>From my point of view as a user it would be desirable, that the main used Simulation Programs uses the same or at least quite similar algorithm for calculating the sun position.
TRNSYS uses the Spencer-Algorithm, which is due to the upper publications also not the best choice.
It would be interesting what algorithm EnergyPlus uses.

Regards

Martin



Von: Christoph Reinhart [mailto:tito_ at mit.edu]
Gesendet: Donnerstag, 17. Dezember 2015 18:29
An: Radiance general discussion
Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c

Using a more accurate formula that is based on a respectable source like a good idea if the magnitude of the correction is as large as Martin describes. Incidentally, we are having our students do ?validations? of the formula by comparing the photograph of an objects as a certain time in the year to a Radiance rendering and that analysis tends to come out pretty well: http://web.mit.edu/sustainabledesignlab/projects/DaylightingHandbook/Exercise_DirectSunlight.htm.

Best,

Christoph



From: Greg Ward [mailto:gregoryjward at gmail.com]
Sent: Thursday, December 17, 2015 12:22 PM
To: Radiance general discussion <radiance-general at radiance-online.org<mailto:radiance-general at radiance-online.org>>
Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Given the tool construction, it would be simple enough to introduce a global variable that switches between the de facto solar angle calculation and a more precise version.  I'd like to hear from others that this is worthwhile before I spend too much time on it, though.  Also, whether it should be exposed as an option in all of the calling programs (i.e., IES calculation or more accurate on).

Is there a general consensus on which solar calculation is best?  I would just end up googling it, unless you or someone else has a strong recommendation.

Cheers,
-Greg


From: Martin Gut <gut at Transsolar.com<mailto:gut at Transsolar.com>>

Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Date: December 17, 2015 8:55:38 AM PST


Hi Greg,

Thank You for the quick answer.  I don?t know about the history of this debate because I?m quite new in this mailing list.
I think for the CIE standard stuff, sticking on the standard routines is ok.
  But this formula is also used for all the dynamic daylighting stuff like
Gendaymtx
Gendaylit
Daysim
etc.
also for shading studies: I?m wondering that so much computing effort is investigated to render the shading and on the other side the position of this shading is incorrect (especially in Autumn) because of
a very rough calculation of the sun position. The error is not so big, but it could be avoided very easy by using a better formula for solar declination.
Maybe there could be two functions, one for the standard calculations and one for ?real?  calculations.

Martin


Von: Greg Ward [mailto:gregoryjward at gmail.com]
Gesendet: Donnerstag, 17. Dezember 2015 17:14
An: Radiance general discussion
Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c

Hi Martin,

This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.

As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.

Cheers,
-Greg



From: Richard Mistrick <RGMARC at engr.psu.edu<mailto:RGMARC at engr.psu.edu>>

Subject: Re: [Radiance-general] Calculation of solar declination in sun.c

Date: December 17, 2015 7:18:53 AM PST


I?m not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.

Rick

From: Martin Gut [mailto:gut at Transsolar.com]
Sent: Thursday, December 17, 2015 6:05 AM

Dear Radiance Experts,

I have two questions regarding the calculation of solar declination:


1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?

return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )

https://github.com/NREL/Radiance/blob/master/src/gen/sun.c


2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?

With today computing power, there is no more reason to use this simple formula

Thanks in advance


Martin


_______________________________________________
Radiance-general mailing list
Radiance-general at radiance-online.org<mailto:Radiance-general at radiance-online.org>
http://www.radiance-online.org/mailman/listinfo/radiance-general


From raghuram.kalyanam at bauing.uni-kl.de  Fri Dec 18 09:34:50 2015
From: raghuram.kalyanam at bauing.uni-kl.de (raghuram kalyanam)
Date: Fri, 18 Dec 2015 18:34:50 +0100
Subject: [Radiance-general] Model a Double glazing window
Message-ID: <196BD4EE-3C53-40DD-AB64-6BF8BDDFD199@bauing.uni-kl.de>


Hi Every one,

I want to model a Double glazing window which contains glasses with different transmittances. I did the following  

1. window.rad -- included the properties of materials such as window frame, glass1 and glass 2
2. glass.rad -- position of glasses using genbox 
3. frame.rad -- position of frame using genbox

then made octree of altogether.

Please let me know if  this is the  right way or if not please suggest a better one.


Best Regards,
Raghu



From jedev at visarc.com  Fri Dec 18 13:39:22 2015
From: jedev at visarc.com (Jack de Valpine)
Date: Fri, 18 Dec 2015 16:39:22 -0500
Subject: [Radiance-general] Model a Double glazing window
In-Reply-To: <196BD4EE-3C53-40DD-AB64-6BF8BDDFD199@bauing.uni-kl.de>
References: <196BD4EE-3C53-40DD-AB64-6BF8BDDFD199@bauing.uni-kl.de>
Message-ID: <56747D0A.1030107@visarc.com>

Hi Raghu,

Here are a couple of things to think about.

MODEL GEOMETRY
Based on your description, I am guessing that you are using genbox to 
model each sheet of glass in your insulating glass unit. The radiance 
materials that can be used to describe glass, such as "glass" and 
"brtdfunc" are designed to be applied to a surface as opposed to a 
volume. Using genbox will give you a volume, applying a "glass" material 
with a specific transmittance to that volume will not give you the 
correct resulting transmittance because rays are going through two 
pieces of geometry. In order to get the correct transmittance for a 
given glass material you would need to use a single surface to describe 
the geometry.

GLASS MATERIALS
If all you care about is transmittance through a insulating glass unit 
composed of two layers of glass, there are a variety of ways to to come 
up with a material description. The resulting transmittance of a 
specific makeup should either be available from a manufacturer or can be 
calculated with an application like Windows or Optics (both available 
from LBNL). Note that for the glass material type transmittance needs to 
be transformed to the Radiance term for transmissivity. If you also need 
to more carefully account for reflectance for such a glazing unit, 
assuming you are using Radiance on Linux, then you can use the "glaze" 
script that comes with Radiance. To learn more about how to use the 
script, you can check out my blog post:

    http://modsimvis.blogspot.com/2014/12/glass-in-radiance.html

Best,

-Jack de Valpine,
Visarc Inc


On 12/18/2015 12:34 PM, raghuram kalyanam wrote:
> Hi Every one,
>
> I want to model a Double glazing window which contains glasses with different transmittances. I did the following
>
> 1. window.rad -- included the properties of materials such as window frame, glass1 and glass 2
> 2. glass.rad -- position of glasses using genbox
> 3. frame.rad -- position of frame using genbox
>
> then made octree of altogether.
>
> Please let me know if  this is the  right way or if not please suggest a better one.
>
>
> Best Regards,
> Raghu
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151218/7a7d95c0/attachment.html>

From gregoryjward at gmail.com  Fri Dec 18 14:16:51 2015
From: gregoryjward at gmail.com (Greg Ward)
Date: Fri, 18 Dec 2015 14:16:51 -0800
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <D2998198.20D02%Robert.Guglielmetti@nrel.gov>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
	<1B23446CBF250648A2FC775DE3FE7E80F02ABE1C@OC11expo28.exchange.mit.edu>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345EF8@SRV-EX01.transsolar.local>
	<D2998198.20D02%Robert.Guglielmetti@nrel.gov>
Message-ID: <78C560E7-3860-4592-A16C-D4178C02A203@lmi.net>

Yes, though it's worth noting that the differences also occur where there is high variance in the data already.  I'm less sure what's going on with the peakiness of the second graph, and whether that was due to some other resolution difference and not just the solar position.

If I can get a clear consensus from folks about which formulas to use, I can work on an implementation at some point.  Perhaps someone wants to compare the Spencer algorithm to the astronomical calculations library Mark mentioned?

-Greg

> From: "Guglielmetti, Robert" <Robert.Guglielmetti at nrel.gov>
> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
> Date: December 18, 2015 8:28:21 AM PST
> 
> This is fascinating, and in my opinion a cautionary tale for the community, given all the weight being placed on ASE as a daylight metric lately.
> 
> On 12/18/15, 8:40 AM, "Martin Gut" <gut at Transsolar.com<mailto:gut at Transsolar.com>> wrote:
> 
> 
> For me, the difference of the real picture and the simulation is quite visible. Maybe this discussion topic is one reason for this.
> 
> We came across this issue by doing a combined thermal and dynamic daylight analysis.
> One calculation with original DAYSIM  and one DAYSIM calculation with sun position calculated from TRNSYS.
> There were quite visible differences, especially in Autumn.
> 
> https://drive.google.com/file/d/0B_k3K9s5QAlISGdYWFdlMHZFc00/view?usp=sharing
> 
> and
> 
> https://drive.google.com/file/d/0B_k3K9s5QAlIb0lRN3VrdXVQaFU/view?usp=sharing
> 
> TRNSYS uses the Spencer-Algorithm  from 1971 for the calculation of solar declination.
> Implementing this Algorithm is easy because it has just a few more sin() and cos() statements .
> 
> This graph:
> 
> https://drive.google.com/file/d/0B_k3K9s5QAlIbWVXZHhINXhYTDA/view?usp=sharing
> 
> shows the differences between this algorithm, the Cooper Algorithm and the Algorithm used in Radiance.
> So my first question is answered by this. By using 368 days per year the deviation is smaller than with the original
> Cooper Algorithm.
> 
> A good starting point for choosing the right algorithm could be in my opinion :
> ?Computing the solar vector? in  Solar Energy Vol. 70, No. 5, pp. 431?441, 2001 by  MANUEL BLANCO-MURIEL et al.
> Here, the differences of common algorithm are described. They use only the Spencer Algorithm as an example of a simple algorithm.
> Following table shows, that there are considerable differences:
> https://drive.google.com/file/d/0B_k3K9s5QAlIcS1JQmZFSGttbWs/view?usp=sharing
> They recommend the Michalsky-Algorithm or their own PSA-Algorithm, which is a little bit better.
> The Michalsky Algorithm is also used in the program SolPos Nathaniel Jones recommended:
> 
> https://www.nrel.gov/midc/solpos/
> 
> The Source Code for the PSA-Algorithm is available under:
> 
> http://www.psa.es/sdg/sunpos.htm
> 
> It seems to be comparable to the  from  Christian Humann recommended NREL algorithms which is used in the program spa:
> 
> https://www.nrel.gov/midc/spa/
> 
> From my point of view as a user it would be desirable, that the main used Simulation Programs uses the same or at least quite similar algorithm for calculating the sun position.
> TRNSYS uses the Spencer-Algorithm, which is due to the upper publications also not the best choice.
> It would be interesting what algorithm EnergyPlus uses.
> 
> Regards
> 
> Martin
> 
> 
> 
> Von: Christoph Reinhart [mailto:tito_ at mit.edu]
> Gesendet: Donnerstag, 17. Dezember 2015 18:29
> An: Radiance general discussion
> Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c
> 
> Using a more accurate formula that is based on a respectable source like a good idea if the magnitude of the correction is as large as Martin describes. Incidentally, we are having our students do ?validations? of the formula by comparing the photograph of an objects as a certain time in the year to a Radiance rendering and that analysis tends to come out pretty well: http://web.mit.edu/sustainabledesignlab/projects/DaylightingHandbook/Exercise_DirectSunlight.htm.
> 
> Best,
> 
> Christoph
> 
> 
> 
> From: Greg Ward [mailto:gregoryjward at gmail.com]
> Sent: Thursday, December 17, 2015 12:22 PM
> To: Radiance general discussion <radiance-general at radiance-online.org<mailto:radiance-general at radiance-online.org>>
> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
> 
> Given the tool construction, it would be simple enough to introduce a global variable that switches between the de facto solar angle calculation and a more precise version.  I'd like to hear from others that this is worthwhile before I spend too much time on it, though.  Also, whether it should be exposed as an option in all of the calling programs (i.e., IES calculation or more accurate on).
> 
> Is there a general consensus on which solar calculation is best?  I would just end up googling it, unless you or someone else has a strong recommendation.
> 
> Cheers,
> -Greg
> 
> 
> From: Martin Gut <gut at Transsolar.com<mailto:gut at Transsolar.com>>
> 
> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
> 
> Date: December 17, 2015 8:55:38 AM PST
> 
> 
> Hi Greg,
> 
> Thank You for the quick answer.  I don?t know about the history of this debate because I?m quite new in this mailing list.
> I think for the CIE standard stuff, sticking on the standard routines is ok.
>  But this formula is also used for all the dynamic daylighting stuff like
> Gendaymtx
> Gendaylit
> Daysim
> etc.
> also for shading studies: I?m wondering that so much computing effort is investigated to render the shading and on the other side the position of this shading is incorrect (especially in Autumn) because of
> a very rough calculation of the sun position. The error is not so big, but it could be avoided very easy by using a better formula for solar declination.
> Maybe there could be two functions, one for the standard calculations and one for ?real?  calculations.
> 
> Martin
> 
> 
> Von: Greg Ward [mailto:gregoryjward at gmail.com]
> Gesendet: Donnerstag, 17. Dezember 2015 17:14
> An: Radiance general discussion
> Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c
> 
> Hi Martin,
> 
> This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.
> 
> As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.
> 
> Cheers,
> -Greg
> 
> 
> 
> From: Richard Mistrick <RGMARC at engr.psu.edu<mailto:RGMARC at engr.psu.edu>>
> 
> Subject: Re: [Radiance-general] Calculation of solar declination in sun.c
> 
> Date: December 17, 2015 7:18:53 AM PST
> 
> 
> I?m not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.
> 
> Rick
> 
> From: Martin Gut [mailto:gut at Transsolar.com]
> Sent: Thursday, December 17, 2015 6:05 AM
> 
> Dear Radiance Experts,
> 
> I have two questions regarding the calculation of solar declination:
> 
> 
> 1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?
> 
> return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )
> 
> https://github.com/NREL/Radiance/blob/master/src/gen/sun.c
> 
> 
> 2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?
> 
> With today computing power, there is no more reason to use this simple formula
> 
> Thanks in advance
> 
> 
> Martin
> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org<mailto:Radiance-general at radiance-online.org>
> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general


From kalyanam at rhrk.uni-kl.de  Mon Dec 21 05:45:18 2015
From: kalyanam at rhrk.uni-kl.de (Raghuram Kalyanam)
Date: Mon, 21 Dec 2015 14:45:18 +0100
Subject: [Radiance-general] Model a Double glazing window
In-Reply-To: <56747D0A.1030107@visarc.com>
References: <196BD4EE-3C53-40DD-AB64-6BF8BDDFD199@bauing.uni-kl.de>
	<56747D0A.1030107@visarc.com>
Message-ID: <3CBBAC21-2913-480B-B654-32D407300AF4@rhrk.uni-kl.de>

Hi Jack,

Wow this what exactly  I am looking for. Thank you very much. I have another question. Is there a better way to do geometric modeling and then export into radiance? as it seems a bit cumbersome to model in command prompt in my Mac and then check its geometry every time making an octree.

Best Regards,
Raghu

> On Dec 18, 2015, at 10:39 PM, Jack de Valpine <jedev at visarc.com> wrote:
> 
> Hi Raghu,
> 
> Here are a couple of things to think about. 
> 
> MODEL GEOMETRY
> Based on your description, I am guessing that you are using genbox to model each sheet of glass in your insulating glass unit. The     radiance materials that can be used to describe glass, such as "glass" and "brtdfunc" are designed to be applied to a surface as opposed to a volume. Using genbox will give you a volume, applying a "glass" material with a specific transmittance to that volume will not give you the correct resulting transmittance because rays are going through two pieces of geometry. In order to get the correct transmittance for a given glass material you would need to use a single surface to describe the geometry.
> 
> GLASS MATERIALS
> If all you care about is transmittance through a insulating glass unit composed of two layers of glass, there are a variety of ways to to come up with a material description. The resulting transmittance of a specific makeup should either be available from a manufacturer or can be calculated with an application like Windows or Optics (both available from LBNL). Note that for the glass material type transmittance needs to be transformed to the Radiance term for transmissivity. If you also need to more carefully account for reflectance for such a glazing unit, assuming you are using Radiance on Linux, then you can use the "glaze" script that comes with Radiance. To learn more about how to use the script, you can check out my blog post:
> http://modsimvis.blogspot.com/2014/12/glass-in-radiance.html <http://modsimvis.blogspot.com/2014/12/glass-in-radiance.html>
> Best,
> 
> -Jack de Valpine,
> Visarc Inc
> 
> 
> On 12/18/2015 12:34 PM, raghuram kalyanam wrote:
>> Hi Every one,
>> 
>> I want to model a Double glazing window which contains glasses with different transmittances. I did the following  
>> 
>> 1. window.rad -- included the properties of materials such as window frame, glass1 and glass 2
>> 2. glass.rad -- position of glasses using genbox 
>> 3. frame.rad -- position of frame using genbox
>> 
>> then made octree of altogether.
>> 
>> Please let me know if  this is the  right way or if not please suggest a better one.
>> 
>> 
>> Best Regards,
>> Raghu
>> 
>> 
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org <mailto:Radiance-general at radiance-online.org>
>> http://www.radiance-online.org/mailman/listinfo/radiance-general <http://www.radiance-online.org/mailman/listinfo/radiance-general>
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151221/938e49d3/attachment.html>

From Robert.Guglielmetti at nrel.gov  Mon Dec 21 07:28:24 2015
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Mon, 21 Dec 2015 15:28:24 +0000
Subject: [Radiance-general] Model a Double glazing window
In-Reply-To: <3CBBAC21-2913-480B-B654-32D407300AF4@rhrk.uni-kl.de>
References: <196BD4EE-3C53-40DD-AB64-6BF8BDDFD199@bauing.uni-kl.de>
	<56747D0A.1030107@visarc.com>
	<3CBBAC21-2913-480B-B654-32D407300AF4@rhrk.uni-kl.de>
Message-ID: <D29D6698.20D5E%Robert.Guglielmetti@nrel.gov>

OH MY GOD, YES. There are lots of CAD tools out there, which I'm sure you're familiar with. But there are also some CAD-to-Radiance geometry translators out there. Jack has some great workflows for this, if you use Revit or whatever BIM mess you're lashed to. Lots of people here use Rhino for geometry, and get into Radiance by way of the Alias-Wavefront (.obj) format. Again others here will have some workflow ideas. The project I work on (OpenStudio) can take a SketchUp model and translate it to Radiance format (and actually do a hell of a lot of setup for you if you're doing 3-phase daylight coefficient-type modeling with Radiance, but those models are biased toward energy modeling tools.

If you simply want to make a nice model in a free cad tool and export exactly what you've modeled into pure Radiance input, I'd highly recommend you look at SketchUp for modeling, and Groundhog and/or su2rad for the geometry translation:

http://igd-labs.github.io/Groundhog/
https://code.google.com/p/su2rad/wiki/Su2radIntro



On 12/21/15, 6:45 AM, "Raghuram Kalyanam" <kalyanam at rhrk.uni-kl.de<mailto:kalyanam at rhrk.uni-kl.de>> wrote:
 I have another question. Is there a better way to do geometric modeling and then export into radiance? as it seems a bit cumbersome to model in command prompt in my Mac and then check its geometry every time making an octree.

Best Regards,
Raghu




From jedev at visarc.com  Mon Dec 21 07:43:03 2015
From: jedev at visarc.com (Jack de Valpine)
Date: Mon, 21 Dec 2015 10:43:03 -0500
Subject: [Radiance-general] Model a Double glazing window
In-Reply-To: <D29D6698.20D5E%Robert.Guglielmetti@nrel.gov>
References: <196BD4EE-3C53-40DD-AB64-6BF8BDDFD199@bauing.uni-kl.de>
	<56747D0A.1030107@visarc.com>
	<3CBBAC21-2913-480B-B654-32D407300AF4@rhrk.uni-kl.de>
	<D29D6698.20D5E%Robert.Guglielmetti@nrel.gov>
Message-ID: <56781E07.2080600@visarc.com>

Hi Raghu,

Yes, basically what Rob said.... Depending on your desire for figuring 
workflow (eg getting geometry from on format to one suitable for use in 
Radiance), there are lots of ways to go:

    Autodesk based products - Autocad, Revit, Max, Maya....
    Rhino
    Sketchup
    Blender

There are probably others I am not thinking of. Probably the safest 
intermediate geometry format is Alias/Wavefront (.obj) as Rob mentioned. 
Radiance has tools (obj2rad and obj2mesh) that can handle translating 
this format into its native geometry format.

Best,

-Jack


On 12/21/2015 10:28 AM, Guglielmetti, Robert wrote:
> OH MY GOD, YES. There are lots of CAD tools out there, which I'm sure you're familiar with. But there are also some CAD-to-Radiance geometry translators out there. Jack has some great workflows for this, if you use Revit or whatever BIM mess you're lashed to. Lots of people here use Rhino for geometry, and get into Radiance by way of the Alias-Wavefront (.obj) format. Again others here will have some workflow ideas. The project I work on (OpenStudio) can take a SketchUp model and translate it to Radiance format (and actually do a hell of a lot of setup for you if you're doing 3-phase daylight coefficient-type modeling with Radiance, but those models are biased toward energy modeling tools.
>
> If you simply want to make a nice model in a free cad tool and export exactly what you've modeled into pure Radiance input, I'd highly recommend you look at SketchUp for modeling, and Groundhog and/or su2rad for the geometry translation:
>
> http://igd-labs.github.io/Groundhog/
> https://code.google.com/p/su2rad/wiki/Su2radIntro
>
>
>
> On 12/21/15, 6:45 AM, "Raghuram Kalyanam" <kalyanam at rhrk.uni-kl.de<mailto:kalyanam at rhrk.uni-kl.de>> wrote:
>   I have another question. Is there a better way to do geometric modeling and then export into radiance? as it seems a bit cumbersome to model in command prompt in my Mac and then check its geometry every time making an octree.
>
> Best Regards,
> Raghu
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151221/fa059c32/attachment.html>

From jan.wienold at epfl.ch  Mon Dec 21 09:08:00 2015
From: jan.wienold at epfl.ch (Jan Wienold)
Date: Mon, 21 Dec 2015 18:08:00 +0100
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <1AF0F42605A31D4AAFCA9C502D759F2D5A345EF8@SRV-EX01.transsolar.local>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
	<1B23446CBF250648A2FC775DE3FE7E80F02ABE1C@OC11expo28.exchange.mit.edu>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345EF8@SRV-EX01.transsolar.local>
Message-ID: <567831F0.7070409@epfl.ch>

Hi Martin,

be aware, that daysim uses interpolated sun positions (default: 
interpolation between the four nearby calculated sun positions). This 
interpolation has a much bigger impact than the small deviation of the 
sun position caused by the RADIANCE algorithm. This interpolation could 
cause a big deviation for a single timestep - especially, when you want 
to control your blinds with a cut-off strategy. And it shouldn't be used 
at all if you want to calculate the the amount of time direct radiation 
is falling through small gaps (e.g. fixed blinds).
you can reduce this error by invoking the shadow testing option for the 
sun interpolation in the header file.

Usually, I don't think that the error in sun position matters so much 
for the daylight calculations.
We also did it once a deviation calculation (between RADIANCE and the 
NREL algorithm) and it was max. 1-2 degrees - which is usually not that 
important for daylight calculations.
You definitely need a higher accuracy if you have a solar concentrator 
system and want to control your mirror - in that case the NREL 
calculation is reliable.

But of course it would be nice to have a more  accurate sun positions 
implemented in gensky/gendaylit somewhere in future.

Jan


Am 12/18/15 um 4:40 PM schrieb Martin Gut:
>
> For me, the difference of the real picture and the simulation is quite 
> visible. Maybe this discussion topic is one reason for this.
>
> We came across this issue by doing a combined thermal and dynamic 
> daylight analysis.
>
> One calculation with original DAYSIM  and one DAYSIM calculation with 
> sun position calculated from TRNSYS.
>
> There were quite visible differences, especially in Autumn.
>
> https://drive.google.com/file/d/0B_k3K9s5QAlISGdYWFdlMHZFc00/view?usp=sharing
>
> and
>
> https://drive.google.com/file/d/0B_k3K9s5QAlIb0lRN3VrdXVQaFU/view?usp=sharing
>
> TRNSYS uses the Spencer-Algorithm  from 1971 for the calculation of 
> solar declination.
>
> Implementing this Algorithm is easy because it has just a few more 
> sin() and cos() statements .
>
> This graph:
>
> https://drive.google.com/file/d/0B_k3K9s5QAlIbWVXZHhINXhYTDA/view?usp=sharing
>
> shows the differences between this algorithm, the Cooper Algorithm and 
> the Algorithm used in Radiance.
>
> So my first question is answered by this. By using 368 days per year 
> the deviation is smaller than with the original
>
> Cooper Algorithm.
>
> A good starting point for choosing the right algorithm could be in my 
> opinion :
>
> ?Computing the solar vector? in  Solar Energy Vol. 70, No. 5, pp. 
> 431?441, 2001 by  MANUEL BLANCO-MURIEL et al.
>
> Here, the differences of common algorithm are described. They use only 
> the Spencer Algorithm as an example of a simple algorithm.
>
> Following table shows, that there are considerable differences:
>
> https://drive.google.com/file/d/0B_k3K9s5QAlIcS1JQmZFSGttbWs/view?usp=sharing
>
> They recommend the Michalsky-Algorithm or their own PSA-Algorithm, 
> which is a little bit better.
>
> The Michalsky Algorithm is also used in the program SolPos Nathaniel 
> Jones recommended:
>
> https://www.nrel.gov/midc/solpos/
>
> The Source Code for the PSA-Algorithm is available under:
>
> http://www.psa.es/sdg/sunpos.htm
>
> It seems to be comparable to the  from  Christian Humann recommended 
> NREL algorithms which is used in the program spa:
>
> https://www.nrel.gov/midc/spa/
>
> From my point of view as a user it would be desirable, that the main 
> used Simulation Programs uses the same or at least quite similar 
> algorithm for calculating the sun position.
>
> TRNSYS uses the Spencer-Algorithm, which is due to the upper 
> publications also not the best choice.
>
> It would be interesting what algorithm EnergyPlus uses.
>
> Regards
>
> Martin
>
> *Von:*Christoph Reinhart [mailto:tito_ at mit.edu]
> *Gesendet:* Donnerstag, 17. Dezember 2015 18:29
> *An:* Radiance general discussion
> *Betreff:* Re: [Radiance-general] Calculation of solar declination in 
> sun.c
>
> Using a more accurate formula that is based on a respectable source 
> like a good idea if the magnitude of the correction is as large as 
> Martin describes. Incidentally, we are having our students do 
> ?validations? of the formula by comparing the photograph of an objects 
> as a certain time in the year to a Radiance rendering and that 
> analysis tends to come out pretty well: 
> http://web.mit.edu/sustainabledesignlab/projects/DaylightingHandbook/Exercise_DirectSunlight.htm.
>
> Best,
>
> Christoph
>
> *From:* Greg Ward [mailto:gregoryjward at gmail.com]
> *Sent:* Thursday, December 17, 2015 12:22 PM
> *To:* Radiance general discussion 
> <radiance-general at radiance-online.org 
> <mailto:radiance-general at radiance-online.org>>
> *Subject:* Re: [Radiance-general] Calculation of solar declination in 
> sun.c
>
> Given the tool construction, it would be simple enough to introduce a 
> global variable that switches between the de facto solar angle 
> calculation and a more precise version.  I'd like to hear from others 
> that this is worthwhile before I spend too much time on it, though. 
>  Also, whether it should be exposed as an option in all of the calling 
> programs (i.e., IES calculation or more accurate on).
>
> Is there a general consensus on which solar calculation is best?  I 
> would just end up googling it, unless you or someone else has a strong 
> recommendation.
>
> Cheers,
>
> -Greg
>
>     *From: *Martin Gut <gut at Transsolar.com <mailto:gut at Transsolar.com>>
>
>     *Subject: *Re: [Radiance-general] Calculation of solar declination
>     in sun.c
>
>     *Date: *December 17, 2015 8:55:38 AM PST
>
>     Hi Greg,
>
>     Thank You for the quick answer.  I don?t know about the history of
>     this debate because I?m quite new in this mailing list.
>
>     I think for the CIE standard stuff, sticking on the standard
>     routines is ok.
>
>       But this formula is also used for all the dynamic daylighting
>     stuff like
>
>     Gendaymtx
>
>     Gendaylit
>
>     Daysim
>
>     etc.
>
>     also for shading studies: I?m wondering that so much computing
>     effort is investigated to render the shading and on the other side
>     the position of this shading is incorrect (especially in Autumn)
>     because of
>
>     a very rough calculation of the sun position. The error is not so
>     big, but it could be avoided very easy by using a better formula
>     for solar declination.
>
>     Maybe there could be two functions, one for the standard
>     calculations and one for ?real?  calculations.
>
>     Martin
>
>     *Von:*Greg Ward [mailto:gregoryjward at gmail.com]
>     *Gesendet:* Donnerstag, 17. Dezember 2015 17:14
>     *An:* Radiance general discussion
>     *Betreff:* Re: [Radiance-general] Calculation of solar declination
>     in sun.c
>
>     Hi Martin,
>
>     This debate comes up every so often with the solar calculations
>     used in Radiance and related tools.  The main question is, do we
>     stick with the established standard, which provides for easy
>     "apples to apples" comparisons, or do we update our formulas to
>     get a more precise answer?  In the case of the original CIE sky
>     models, which this solar calculation is used in primarily, the
>     accuracy is not that great, so getting the sun in exactly the
>     right place is a minor quibble.  If, on the other hand, you need
>     precise sun position for solar shading studies or the like, then
>     it's easy to argue for a better formula.  I don't think computing
>     power was ever the issue with Radiance.  We don't compute the sun
>     position for every ray-traced or anything silly like that.
>
>     As Rick points out, the use of 368 is part of the IES standard
>     calculation, but I'm not entirely sure what anomaly it is
>     correcting for.
>
>     Cheers,
>
>     -Greg
>
>
>
>     *From: *Richard Mistrick <RGMARC at engr.psu.edu
>     <mailto:RGMARC at engr.psu.edu>>
>
>     *Subject: *Re: [Radiance-general] Calculation of solar declination
>     in sun.c
>
>     *Date: *December 17, 2015 7:18:53 AM PST
>
>         I?m not certain why it is 368, but this equation has been in
>         this format in the IES Lighting Handbook for many years.
>
>         Rick
>
>         *From:* Martin Gut [mailto:gut at Transsolar.com]
>         *Sent:* Thursday, December 17, 2015 6:05 AM
>
>         Dear Radiance Experts,
>
>         I have two questions regarding the calculation of solar
>         declination:
>
>         1.Why has the year in function sdec  in  file sun.c  368 days
>         instead of 365 as in the original formula from Cooper ?
>
>         return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )
>
>         https://github.com/NREL/Radiance/blob/master/src/gen/sun.c
>
>         2.Why does Radiance not use a better formula, which takes into
>         account, that the Earth orbit is not a circle?
>
>         With today computing power, there is no more reason to use
>         this simple formula
>
>         Thanks in advance
>
>         Martin
>
>     _______________________________________________
>     Radiance-general mailing list
>     Radiance-general at radiance-online.org
>     <mailto:Radiance-general at radiance-online.org>
>     http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

-- 
Dr.-Ing.  Jan Wienold
Ecole Polytechnique F?d?rale de Lausanne (EPFL)
EPFL ENAC IA LIPID

http://people.epfl.ch/jan.wienold
LE 1 111 (Office)
Phone    +41 21 69 30849

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151221/c470e382/attachment-0001.html>

From gut at Transsolar.com  Tue Dec 22 01:50:29 2015
From: gut at Transsolar.com (Martin Gut)
Date: Tue, 22 Dec 2015 09:50:29 +0000
Subject: [Radiance-general] Calculation of solar declination in sun.c
In-Reply-To: <78C560E7-3860-4592-A16C-D4178C02A203@lmi.net>
References: <1AF0F42605A31D4AAFCA9C502D759F2D5A345CC4@SRV-EX01.transsolar.local>
	<4CBA3F4FC743644B878E92A40FD348F9D79BC515@ENGR2K10NODE1.engr.psu.edu>
	<5F75EF7E-73BC-4DDD-BCEF-A337A317F176@lmi.net>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345D9D@SRV-EX01.transsolar.local>
	<56D013F5-4A92-46CC-8B39-F27665701B6C@lmi.net>
	<1B23446CBF250648A2FC775DE3FE7E80F02ABE1C@OC11expo28.exchange.mit.edu>
	<1AF0F42605A31D4AAFCA9C502D759F2D5A345EF8@SRV-EX01.transsolar.local>
	<D2998198.20D02%Robert.Guglielmetti@nrel.gov>
	<78C560E7-3860-4592-A16C-D4178C02A203@lmi.net>
Message-ID: <1AF0F42605A31D4AAFCA9C502D759F2D5A3462AD@SRV-EX01.transsolar.local>

Hi Greg and Jan,

The second graph is just a zoom of the first graph. The peaks occur around hour: 6800 = day 283,  this is also the time with the max. deviation of the solar declination calculation methods.
The in Radiance calculated elevation angle is at this time lower than the reference. Therefore direct daylight gets deeper into the room and the peaks are higher. That makes for me sense.
  The test model is quite simple as shown. Just a box with one window, no shading device, no small gaps.
The magnitude of the differences could of course have also other reasons than just the solar declination calculation, but at the end only differences in the solar position calculation leads to the two different results.
   If the error is between 1-2? as Jan Wienold wrote, than the length of a shadow  of the upper part of a window differs from 9 cm to 18 cm at a location at 48?north. If the object is just 30 cm high, than the shadow length differs from 0.9 to 1.8 cm. This is the magnitude I also could see in the pictures of Christoph Reinhart's students. 

As Summary:
All this examples just show, that the effect of the sun position calculation method could also be seen in the daylight calculation results. This differences could be reduced by just using a more up to date calculation method, which has no significant influence to computation time.

Martin


PS.: The whole article I mentioned in the previous e-mails could be downloaded for free under:

https://www.researchgate.net/publication/224807292_Computing_the_Solar_Vector

-----Urspr?ngliche Nachricht-----
Von: Greg Ward [mailto:gregoryjward at gmail.com] 
Gesendet: Freitag, 18. Dezember 2015 23:17
An: Radiance general discussion
Betreff: Re: [Radiance-general] Calculation of solar declination in sun.c

Yes, though it's worth noting that the differences also occur where there is high variance in the data already.  I'm less sure what's going on with the peakiness of the second graph, and whether that was due to some other resolution difference and not just the solar position.

If I can get a clear consensus from folks about which formulas to use, I can work on an implementation at some point.  Perhaps someone wants to compare the Spencer algorithm to the astronomical calculations library Mark mentioned?

-Greg

> From: "Guglielmetti, Robert" <Robert.Guglielmetti at nrel.gov>
> Subject: Re: [Radiance-general] Calculation of solar declination in 
> sun.c
> Date: December 18, 2015 8:28:21 AM PST
> 
> This is fascinating, and in my opinion a cautionary tale for the community, given all the weight being placed on ASE as a daylight metric lately.
> 
> On 12/18/15, 8:40 AM, "Martin Gut" <gut at Transsolar.com<mailto:gut at Transsolar.com>> wrote:
> 
> 
> For me, the difference of the real picture and the simulation is quite visible. Maybe this discussion topic is one reason for this.
> 
> We came across this issue by doing a combined thermal and dynamic daylight analysis.
> One calculation with original DAYSIM  and one DAYSIM calculation with sun position calculated from TRNSYS.
> There were quite visible differences, especially in Autumn.
> 
> https://drive.google.com/file/d/0B_k3K9s5QAlISGdYWFdlMHZFc00/view?usp=
> sharing
> 
> and
> 
> https://drive.google.com/file/d/0B_k3K9s5QAlIb0lRN3VrdXVQaFU/view?usp=
> sharing
> 
> TRNSYS uses the Spencer-Algorithm  from 1971 for the calculation of solar declination.
> Implementing this Algorithm is easy because it has just a few more sin() and cos() statements .
> 
> This graph:
> 
> https://drive.google.com/file/d/0B_k3K9s5QAlIbWVXZHhINXhYTDA/view?usp=
> sharing
> 
> shows the differences between this algorithm, the Cooper Algorithm and the Algorithm used in Radiance.
> So my first question is answered by this. By using 368 days per year 
> the deviation is smaller than with the original Cooper Algorithm.
> 
> A good starting point for choosing the right algorithm could be in my opinion :
> "Computing the solar vector" in  Solar Energy Vol. 70, No. 5, pp. 431-441, 2001 by  MANUEL BLANCO-MURIEL et al.
> Here, the differences of common algorithm are described. They use only the Spencer Algorithm as an example of a simple algorithm.
> Following table shows, that there are considerable differences:
> https://drive.google.com/file/d/0B_k3K9s5QAlIcS1JQmZFSGttbWs/view?usp=
> sharing They recommend the Michalsky-Algorithm or their own 
> PSA-Algorithm, which is a little bit better.
> The Michalsky Algorithm is also used in the program SolPos Nathaniel Jones recommended:
> 
> https://www.nrel.gov/midc/solpos/
> 
> The Source Code for the PSA-Algorithm is available under:
> 
> http://www.psa.es/sdg/sunpos.htm
> 
> It seems to be comparable to the  from  Christian Humann recommended NREL algorithms which is used in the program spa:
> 
> https://www.nrel.gov/midc/spa/
> 
> From my point of view as a user it would be desirable, that the main used Simulation Programs uses the same or at least quite similar algorithm for calculating the sun position.
> TRNSYS uses the Spencer-Algorithm, which is due to the upper publications also not the best choice.
> It would be interesting what algorithm EnergyPlus uses.
> 
> Regards
> 
> Martin
> 
> 
> 
> Von: Christoph Reinhart [mailto:tito_ at mit.edu]
> Gesendet: Donnerstag, 17. Dezember 2015 18:29
> An: Radiance general discussion
> Betreff: Re: [Radiance-general] Calculation of solar declination in 
> sun.c
> 
> Using a more accurate formula that is based on a respectable source like a good idea if the magnitude of the correction is as large as Martin describes. Incidentally, we are having our students do "validations" of the formula by comparing the photograph of an objects as a certain time in the year to a Radiance rendering and that analysis tends to come out pretty well: http://web.mit.edu/sustainabledesignlab/projects/DaylightingHandbook/Exercise_DirectSunlight.htm.
> 
> Best,
> 
> Christoph
> 
> 
> 
> From: Greg Ward [mailto:gregoryjward at gmail.com]
> Sent: Thursday, December 17, 2015 12:22 PM
> To: Radiance general discussion 
> <radiance-general at radiance-online.org<mailto:radiance-general at radiance
> -online.org>>
> Subject: Re: [Radiance-general] Calculation of solar declination in 
> sun.c
> 
> Given the tool construction, it would be simple enough to introduce a global variable that switches between the de facto solar angle calculation and a more precise version.  I'd like to hear from others that this is worthwhile before I spend too much time on it, though.  Also, whether it should be exposed as an option in all of the calling programs (i.e., IES calculation or more accurate on).
> 
> Is there a general consensus on which solar calculation is best?  I would just end up googling it, unless you or someone else has a strong recommendation.
> 
> Cheers,
> -Greg
> 
> 
> From: Martin Gut <gut at Transsolar.com<mailto:gut at Transsolar.com>>
> 
> Subject: Re: [Radiance-general] Calculation of solar declination in 
> sun.c
> 
> Date: December 17, 2015 8:55:38 AM PST
> 
> 
> Hi Greg,
> 
> Thank You for the quick answer.  I don't know about the history of this debate because I'm quite new in this mailing list.
> I think for the CIE standard stuff, sticking on the standard routines is ok.
>  But this formula is also used for all the dynamic daylighting stuff 
> like Gendaymtx Gendaylit Daysim etc.
> also for shading studies: I'm wondering that so much computing effort 
> is investigated to render the shading and on the other side the position of this shading is incorrect (especially in Autumn) because of a very rough calculation of the sun position. The error is not so big, but it could be avoided very easy by using a better formula for solar declination.
> Maybe there could be two functions, one for the standard calculations and one for "real"  calculations.
> 
> Martin
> 
> 
> Von: Greg Ward [mailto:gregoryjward at gmail.com]
> Gesendet: Donnerstag, 17. Dezember 2015 17:14
> An: Radiance general discussion
> Betreff: Re: [Radiance-general] Calculation of solar declination in 
> sun.c
> 
> Hi Martin,
> 
> This debate comes up every so often with the solar calculations used in Radiance and related tools.  The main question is, do we stick with the established standard, which provides for easy "apples to apples" comparisons, or do we update our formulas to get a more precise answer?  In the case of the original CIE sky models, which this solar calculation is used in primarily, the accuracy is not that great, so getting the sun in exactly the right place is a minor quibble.  If, on the other hand, you need precise sun position for solar shading studies or the like, then it's easy to argue for a better formula.  I don't think computing power was ever the issue with Radiance.  We don't compute the sun position for every ray-traced or anything silly like that.
> 
> As Rick points out, the use of 368 is part of the IES standard calculation, but I'm not entirely sure what anomaly it is correcting for.
> 
> Cheers,
> -Greg
> 
> 
> 
> From: Richard Mistrick 
> <RGMARC at engr.psu.edu<mailto:RGMARC at engr.psu.edu>>
> 
> Subject: Re: [Radiance-general] Calculation of solar declination in 
> sun.c
> 
> Date: December 17, 2015 7:18:53 AM PST
> 
> 
> I'm not certain why it is 368, but this equation has been in this format in the IES Lighting Handbook for many years.
> 
> Rick
> 
> From: Martin Gut [mailto:gut at Transsolar.com]
> Sent: Thursday, December 17, 2015 6:05 AM
> 
> Dear Radiance Experts,
> 
> I have two questions regarding the calculation of solar declination:
> 
> 
> 1.       Why has the year in function sdec  in  file sun.c  368 days instead of 365 as in the original formula from Cooper ?
> 
> return( 0.4093 * sin( (2*PI/368) * (jd - 81) ) )
> 
> https://github.com/NREL/Radiance/blob/master/src/gen/sun.c
> 
> 
> 2.       Why does Radiance not use a better formula, which takes into account, that the Earth orbit is not a circle?
> 
> With today computing power, there is no more reason to use this simple 
> formula
> 
> Thanks in advance
> 
> 
> Martin
> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org<mailto:Radiance-general at radiance-
> online.org> 
> http://www.radiance-online.org/mailman/listinfo/radiance-general
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general

_______________________________________________
Radiance-general mailing list
Radiance-general at radiance-online.org
http://www.radiance-online.org/mailman/listinfo/radiance-general


From kalyanam at rhrk.uni-kl.de  Thu Dec 24 06:23:18 2015
From: kalyanam at rhrk.uni-kl.de (Raghuram Kalyanam)
Date: Thu, 24 Dec 2015 15:23:18 +0100
Subject: [Radiance-general] rcontrib tutorial
Message-ID: <750640EE-FA51-4036-98FD-DECB4F63E61C@rhrk.uni-kl.de>

Hi Everyone,

Could anyone share rcontrib tutorial or any relevant material.

Thanks & Regards,
Raghu

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151224/78247ebb/attachment.html>

From Robert.Guglielmetti at nrel.gov  Thu Dec 24 06:53:22 2015
From: Robert.Guglielmetti at nrel.gov (Guglielmetti, Robert)
Date: Thu, 24 Dec 2015 14:53:22 +0000
Subject: [Radiance-general] rcontrib tutorial
In-Reply-To: <750640EE-FA51-4036-98FD-DECB4F63E61C@rhrk.uni-kl.de>
References: <750640EE-FA51-4036-98FD-DECB4F63E61C@rhrk.uni-kl.de>
Message-ID: <D2A153F9.20E4F%Robert.Guglielmetti@nrel.gov>

The best single source for links to tutorials and docs is:

http://www.radiance-online.org/learning/tutorials

Unfortunately the original rcontrib tutorial is no longer available, but Andy McNeil's 3- and 5-phase tutorials give a good overview of the theory and the process, and are, for the most part, updated to use the newer tools (e.g. rfluxmtx, rmtxop) and options that facilitate these methods. Both of these tutorials are available at the link above.

Happy Holidays to everyone here. You guys are family to me.

- Rob

On 12/24/15, 7:23 AM, "Raghuram Kalyanam" <kalyanam at rhrk.uni-kl.de<mailto:kalyanam at rhrk.uni-kl.de>> wrote:

Hi Everyone,

Could anyone share rcontrib tutorial or any relevant material.

Thanks & Regards,
Raghu



From kalyanam at rhrk.uni-kl.de  Thu Dec 24 07:11:20 2015
From: kalyanam at rhrk.uni-kl.de (Raghuram Kalyanam)
Date: Thu, 24 Dec 2015 16:11:20 +0100
Subject: [Radiance-general] rcontrib tutorial
In-Reply-To: <D2A153F9.20E4F%Robert.Guglielmetti@nrel.gov>
References: <750640EE-FA51-4036-98FD-DECB4F63E61C@rhrk.uni-kl.de>
	<D2A153F9.20E4F%Robert.Guglielmetti@nrel.gov>
Message-ID: <83513398-C2A0-450F-A09B-35B215FE7771@rhrk.uni-kl.de>

Thanks Rob and same to you.

Cheers,
Raghu

> On Dec 24, 2015, at 3:53 PM, Guglielmetti, Robert <Robert.Guglielmetti at nrel.gov> wrote:
> 
> The best single source for links to tutorials and docs is:
> 
> http://www.radiance-online.org/learning/tutorials
> 
> Unfortunately the original rcontrib tutorial is no longer available, but Andy McNeil's 3- and 5-phase tutorials give a good overview of the theory and the process, and are, for the most part, updated to use the newer tools (e.g. rfluxmtx, rmtxop) and options that facilitate these methods. Both of these tutorials are available at the link above.
> 
> Happy Holidays to everyone here. You guys are family to me.
> 
> - Rob
> 
> On 12/24/15, 7:23 AM, "Raghuram Kalyanam" <kalyanam at rhrk.uni-kl.de<mailto:kalyanam at rhrk.uni-kl.de>> wrote:
> 
> Hi Everyone,
> 
> Could anyone share rcontrib tutorial or any relevant material.
> 
> Thanks & Regards,
> Raghu
> 
> 
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general



From roland.schregle at gmail.com  Sat Dec 26 05:34:54 2015
From: roland.schregle at gmail.com (Schregle Roland HSLU T&A)
Date: Sat, 26 Dec 2015 14:34:54 +0100
Subject: [Radiance-general] Photon map + rcontrib Advisory
Message-ID: <op.x986oghvgbjfop@deldo>

Dear colleagues,

it has come to our attention that the contribution photon mapping module  
in the current RADIANCE 5.0 release exhibits systematic underestimation.  
This affects photon maps generated with mkpmap using the -apC option, and
evaluated with rcontrib using the -ab 1 option (the default). In  
particular, we have observed deviations exceeding 50% in some cases with  
GLOW sources.

We are issuing this advisory to inform current and prospective users of  
the RADIANCE photon map about this issue. As a workaround, we suggest  
using the -ab -1 option with rcontrib, which evaluates contributed photons  
directly at the sensor points. This will increase performance but results  
in substantially higher noise, possibly requiring a larger photon map for  
acceptable quality.

We will issue a bugfix and commit it to the RADIANCE CVS and HEAD release  
in January. Sorry for any inconvenience this may cause in the interim.

Happy holidays and best wishes for the new year,

--Roland


-- 
Dr. Roland Schregle
Senior Research Associate

Lucerne University of Applied Sciences and Arts
School of Engineering and Architecture
CC Envelopes and Solar Energy (EASE)
www.hslu.ch/ccease

T direct: +41 41 349 36 26 (New)
roland.schregle at hslu.ch

Technikumstrasse 21, CH-6048 Horw (Correspondence)
Ebenaustrasse 20, CH-6048 Horw (Office)
T +41 41 349 33 11, F +41 41 349 39 60


From alireh at uw.edu  Mon Dec 28 19:09:14 2015
From: alireh at uw.edu (Alireza Hashemloo)
Date: Mon, 28 Dec 2015 19:09:14 -0800
Subject: [Radiance-general] Three Phase Method Tutorial - Example 1
In-Reply-To: <CAEFJVk_XO0O8DMkRJrdXTh9fBF_T8A4vbrm0pSiAzSFirqc=tg@mail.gmail.com>
References: <CADjcregxpf13c4xW5ARyDyauhpE0ut9QZLmRQpa-uupNJaAK+w@mail.gmail.com>
	<9B627B18-5355-4FBB-AA95-4EFDB691899C@lmi.net>
	<CADjcrejxfzc+MzouA5muuCbNuGQVWfOKAoBD=ES_LKXpW21Wiw@mail.gmail.com>
	<CAEFJVk_XO0O8DMkRJrdXTh9fBF_T8A4vbrm0pSiAzSFirqc=tg@mail.gmail.com>
Message-ID: <CADjcrei5A61O=bPN0P-P3K7b3n9raB+9X-NGW_9iFFyBx+EnWQ@mail.gmail.com>

Hi Andy,

Thank you very much for your response.

1) Following your recommendation to provide the first 10 lines in the
daylight matrix and sky vector files:

Daylight matrix file (10 first lines):

#?RADIANCE
oconv materials/box_03.mat objects/box_03.rad sky/sky_white1.rad
rcontrib -c 1000 -e MF:4 -f reinhart.cal -b rbin -bn Nrbins -m sky_mat -faf
SOFTWARE= RADIANCE 4.2a lastmod  by  on w015t-001
CAPDATE= 2015:11:24 13:39:14
GMT= 2015:11:24 21:39:14
NCOMP=3
NCOLS=2306
FORMAT=float

Sky vector file (10 first lines):

#?RADIANCE
genskyvec -m 4 -c 1 1 1
NROWS=2306
NCOLS=1
NCOMP=3
FORMAT=ascii

6.78784323    6.78784323    6.78784323
12.3089937    12.3089937    12.3089937
12.399048    12.399048    12.399048

2) I managed to find the error in my process following the Example 1 in the
second tutorial (
https://www.gitbook.com/book/andymcneil/three-phase-method-tutorial/details).
However, I encountered the following error message in the last step using
the dctimestep call to generate renderings:

"fatal - unexpected column count in header"


Thank you for your help,
Alireza


On Mon, Nov 30, 2015 at 9:05 PM, Andy McNeil <mcneil.andrew at gmail.com>
wrote:

> Alireza,
>
> I suspect your first error stems from an unexpected or missing header. Can
> you open your daylight matrix and sky vector in notepad and respond with
> the first 10 lines in each file?
>
> The second tutorial that you've found is meant to replace the old
> tutorial, but I've not finished it yet so there may be some
> inconsistencies.  Can you email the comment line of your window.rad file
> (the one that starts #@rfluxmtx) as this is where the sampling basis is
> specified.
>
> Andy
>
>
>
> On Mon, Nov 30, 2015 at 6:41 PM, Alireza Hashemloo <alireh at uw.edu> wrote:
>
>> Hi Greg,
>>
>> Thank you for your response.
>>
>> I am working on a Windows 7 (64-bit) operating system and I use GitBash
>> shell for my command line.
>> Following the description of the two error messages relative to the two
>> versions of the Three-Phase Method tutorial, I have provided the exact
>> command line raising the errors
>> in the Example #1 of both tutorials:
>>
>> 1- Tutorial Document Title: "The Three-Phase Method for Simulating
>> Complex Fenestration with Radiance"
>>     Access Link:
>> http://www.radiance-online.org/learning/tutorials/Tutorial-ThreePhaseMethod.pdf
>>     Page # 21
>>     Command:    $ dctimestep images/vmx/window_%03d.hdr
>> data/singleclear.xml results/south.dmx skies/12_21_15.skv >
>> images/122115_clear.hdr
>>     Error: "fatal - unexpected EOF reading results/south.dmx"
>>
>> 2- Tutorial Document Title: "Radiance Three Phase Method Tutorial"
>>     Access link:
>> https://www.gitbook.com/book/andymcneil/three-phase-method-tutorial/details
>>     Page # 21
>>     Command:  $ vwrays -fa -vf views/back.vf -x 600 -y 600 | rfluxmtx
>> `vwrays -vf views/back.vf -x 600 -y 600 -d` -n 8 -fac -ab 12 -ad 50000 -lw
>> 2e-5 - objects/window.rad materials/testroom.mat objects/testroom.rad
>>     Error: "C:\Radiance\bin\rfluxmtx.exe: missing hemisphere sampling
>> type!"
>>
>> I hope the referenced commands would help to give a better description of
>> how the errors are raised.
>> Please let me know if you need any further information.
>>
>> Thank you,
>> Alireza
>>
>> On Mon, Nov 30, 2015 at 9:40 AM, Greg Ward <gregoryjward at gmail.com>
>> wrote:
>>
>>> Hi Alireza,
>>>
>>> There have been a few changes to the programs since this tutorial was
>>> written.  It would help to know what system you are on (esp. if Windows)
>>> and the exact commands you used leading up to the error.
>>>
>>> Cheers,
>>> -Greg
>>>
>>> *From: *Alireza Hashemloo <alireh at uw.edu>
>>>
>>> *Subject: *[Radiance-general] Three Phase Method Tutorial - Example 1
>>>
>>> *Date: *November 30, 2015 1:04:14 AM PST
>>>
>>>
>>> Hello,
>>>
>>> I have a couple of questions with regards to the three-phase method
>>> tutorials:
>>>
>>> 1- Following the Example 1 in the tutorial document titled as "The
>>> Three-Phase Method for Simulating Complex Fenestration with Radiance"
>>> (available at
>>> http://www.radiance-online.org/learning/tutorials/Tutorial-ThreePhaseMethod.pdf)
>>> I have encountered the following error message using the dctimestep (page
>>> 21) to generate a rendering:
>>>
>>> "fatal - unexpected EOF reading results/south.dmx"
>>>
>>> I have checked the content of the south.dmx file generated in the
>>> previous steps and it appears that with the exception of the first 9 lines
>>> providing information such as the Format, Software, Capdate etc, the
>>> remaining of the lines contain NULL values. This is despite the fact that I
>>> have not received any error messages following the Example 1 through each
>>> step prior to this last step where the EOF error is raised.
>>>
>>> 2- There is another document titled as "Radiance Three Phase Method
>>> Tutorial" (also by Andy McNeil) which I could not find on the Radiance
>>> website but it it published via GitBook at the following link:
>>>
>>>
>>> https://www.gitbook.com/book/andymcneil/three-phase-method-tutorial/details
>>>
>>> Following the Example 1 of this new tutorial document, the 'rcontib'
>>> call is replaced with 'rfluxmtx' to create the view matrix renderings. I
>>> have also attempted to pursue this example step by step, however, the call
>>> for the 'rfluxmtx' for generating view matrix renderings (page 21) raises
>>> the following error message:
>>>
>>> "missing hemisphere sampling type"
>>>
>>> I have checked the 'rfluxmtx' document describing the application of a
>>> "#@rfluxmtx variable=value" form to pass the sampling basis (eg. h=kf for
>>> full Klems sampling model). However, I could not find the correct syntax to
>>> add this variable to the rfluxmtx command call in the tutorial (page 21) in
>>> response to the "missing hemisphere sampling type" error.
>>>
>>>
>>> I would appreciate if you could help me with these two questions.
>>>
>>> Thank you,
>>> Alireza
>>>
>>>
>>> _______________________________________________
>>> Radiance-general mailing list
>>> Radiance-general at radiance-online.org
>>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>>
>>>
>>
>> _______________________________________________
>> Radiance-general mailing list
>> Radiance-general at radiance-online.org
>> http://www.radiance-online.org/mailman/listinfo/radiance-general
>>
>>
>
> _______________________________________________
> Radiance-general mailing list
> Radiance-general at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/radiance-general
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/radiance-general/attachments/20151228/ef94b7dc/attachment.html>

From jdb.walter at gmail.com  Tue Dec 29 04:38:42 2015
From: jdb.walter at gmail.com (Jan Walter)
Date: Tue, 29 Dec 2015 12:38:42 +0000
Subject: [Radiance-general] Blender exporter
Message-ID: <CAKXUb-B0aqAsnSgSWb1+J_9u2Os9H6QQQ-0x15Sh2Y8FRDNGhQ@mail.gmail.com>

Recently I worked a bit on the (Blender) exporter for Radiance files ...

More here:
https://www.janwalter.org/jekyll/rendering/radiance/2015/12/28/radiance-exporter.html

Jan


