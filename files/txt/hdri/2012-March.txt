From ytyukhova at unomaha.edu  Thu Mar  1 12:46:29 2012
From: ytyukhova at unomaha.edu (Tyukhova, Yulia)
Date: Thu, 1 Mar 2012 14:46:29 -0600
Subject: [HDRI] HDRI capture of LED (histograms and range)
Message-ID: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>

Hello!

I've been experimenting with the number of photos to include in final HDRI.

I took a sequence of photos of a single LED with reflectance standards
included in the scene.

EOS7D 28-105mm lens at 28mm

F16 1/8000-1/15??

F4   1/30-5 mins

With the ND filter t=0.0094

Images are fused with raw2hdr.

They were calibrated at white reflectance standard 215 cd/m2.

I?ve noticed the following tendency:

If I fuse different number of photos (cut the number of photos on the
shortest end), after calibrating at white reflectance standard, I get
different luminance values for the LED.

*Shortest exposure to fuse             L,cd/m2*

1/125?? f16                                   4.5*106

1/250?? f16                                   9.06*106

1/500?? f16                                   18*106

I've seen interesting discussion between Axel and Greg on photos to
include. But it seems like there are many uncertainties.

In HDRI second edition book it says "The darkest exposure should have no
RGB values greater than 200 or so, and the lightest exposure should have no
RGB values less than 20 or so. Do NOT include an excess of exposures beyond
this range, as it will do nothing to help with the response recovery and
may hurt."
I assume it is the same for any HDRI sequence, not only for response curve.

I have plenty of photos of dark exposures that have no values greater than
200, same with the light exposures and 20.If somebody can clarify what
photos should be included or have any other suggestions that would be great

Thank you,
*Yulia *
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120301/0b864d07/attachment.html>

From gregoryjward at gmail.com  Thu Mar  1 17:03:41 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Thu, 1 Mar 2012 17:03:41 -0800
Subject: [HDRI] HDRI capture of LED (histograms and range)
In-Reply-To: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
References: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
Message-ID: <DE15F322-8E1E-4842-84A5-4FD923A3965A@gmail.com>

Hi Yulia,

Since your maximum values are tracking the differences in your shorter exposures, it seems to indicate that you still haven't captured the brightest point on the LED.  What are you looking at that makes you think the exposures have nothing over 200?

There is no harm in the newer version of hdrgen in including exposures that are too dark or too light.  More naive methods might have trouble with this, but not hdrgen or raw2hdr.

Best,
-Greg

> From: "Tyukhova, Yulia" <ytyukhova at unomaha.edu>
> Date: March 1, 2012 12:46:29 PM PST
> 
> Hello!
> 
> I've been experimenting with the number of photos to include in final HDRI.
> 
> I took a sequence of photos of a single LED with reflectance standards included in the scene.
> EOS7D 28-105mm lens at 28mm
> F16 1/8000-1/15??
> F4   1/30-5 mins
> With the ND filter t=0.0094
> Images are fused with raw2hdr.
> They were calibrated at white reflectance standard 215 cd/m2.
> I?ve noticed the following tendency:
> If I fuse different number of photos (cut the number of photos on the shortest end), after calibrating at white reflectance standard, I get different luminance values for the LED.
> Shortest exposure to fuse             L,cd/m2
> 1/125?? f16                                   4.5*106     
> 1/250?? f16                                   9.06*106     
> 1/500?? f16                                   18*106      
> 
> I've seen interesting discussion between Axel and Greg on photos to include. But it seems like there are many uncertainties. 
> 
> In HDRI second edition book it says "The darkest exposure should have no RGB values greater than 200 or so, and the lightest exposure should have no RGB values less than 20 or so. Do NOT include an excess of exposures beyond this range, as it will do nothing to help with the response recovery and may hurt."
> I assume it is the same for any HDRI sequence, not only for response curve. 
> 
> I have plenty of photos of dark exposures that have no values greater than 200, same with the light exposures and 20.If somebody can clarify what photos should be included or have any other suggestions that would be great
> 
> Thank you,
> Yulia 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120301/a08a66ad/attachment.html>

From m.moeck at osram.com  Fri Mar  2 04:04:56 2012
From: m.moeck at osram.com (Moeck, Dr. Martin)
Date: Fri, 2 Mar 2012 13:04:56 +0100
Subject: [HDRI] HDRI capture of LED (histograms and range)
In-Reply-To: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
References: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
Message-ID: <F26DB3928A041843B352BA7F4307A46141AEAAADE7@EXC-MCHVS12.mch.osram.de>

I suggest to use two parallel approaches, one with your LED, one with an incandescent low voltage. The problem with LED luminance measurements from HDRI is that a) the color gamut is small and b) the photopic sensitivity curve V(lambda) currently used is incorrect. It underestimates blue wavelengths quite a bit. Therefore, start with an incandescent first, because LEDs have a strong blue peak around 440 or 460 nm, depending on the manufacturer. You are dealing with the liumitations of V(lambda) and then with tristimulus values which are just not good enough for narrowband LEDs, including white ones with a blue peak.

When you use the incandescent instead use it in a black lab. Place a few white paper samples on the walls at different known locations. Place your incandescent at a defined location. Derive the geometry, all distances and all angles between those white papers and the lamp. Turn the incandescent on and the room lights off. Measure the luminance of the white papers at a location that you marked with a soft pencil. Make HDR images and determine the luminance and scale.

Based on the luminance values of the papers, you can now derive the luminance of the incandescent filament. Make HDR images of the filament as seen from those papers. Check if the corresponding illuminance values of the white paper at reflectance around 85% corresponds to the luminance values of the filament in that direction.

Repeat several times to give you confidence.

Once you are heading in the right direction, you can repeat the whole procedure with an LED. But this time your values will be around 20-30% off. You should really use a CCD camera with a photopic filter to get better values, and then try to come up with a procedure to minimize errors for the HDR approach.

Regards

Martin Moeck
Osram
________________________________
From: Tyukhova, Yulia [mailto:ytyukhova at unomaha.edu]
Sent: Thursday, March 01, 2012 9:46 PM
To: hdri at radiance-online.org
Subject: [HDRI] HDRI capture of LED (histograms and range)

Hello!

I've been experimenting with the number of photos to include in final HDRI.

I took a sequence of photos of a single LED with reflectance standards included in the scene.
EOS7D 28-105mm lens at 28mm
F16 1/8000-1/15''
F4   1/30-5 mins
With the ND filter t=0.0094
Images are fused with raw2hdr.
They were calibrated at white reflectance standard 215 cd/m2.
I've noticed the following tendency:
If I fuse different number of photos (cut the number of photos on the shortest end), after calibrating at white reflectance standard, I get different luminance values for the LED.
Shortest exposure to fuse             L,cd/m2
1/125'' f16                                   4.5*106
1/250'' f16                                   9.06*106
1/500'' f16                                   18*106

I've seen interesting discussion between Axel and Greg on photos to include. But it seems like there are many uncertainties.

In HDRI second edition book it says "The darkest exposure should have no RGB values greater than 200 or so, and the lightest exposure should have no RGB values less than 20 or so. Do NOT include an excess of exposures beyond this range, as it will do nothing to help with the response recovery and may hurt."
I assume it is the same for any HDRI sequence, not only for response curve.

I have plenty of photos of dark exposures that have no values greater than 200, same with the light exposures and 20.If somebody can clarify what photos should be included or have any other suggestions that would be great

Thank you,
Yulia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120302/2af667cd/attachment-0001.html>

From grobe at gmx.net  Fri Mar  2 04:11:38 2012
From: grobe at gmx.net (Lars O. Grobe)
Date: Fri, 02 Mar 2012 13:11:38 +0100
Subject: [HDRI] HDRI capture of LED (histograms and range)
In-Reply-To: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
References: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
Message-ID: <4F50B8FA.2080504@gmx.net>

Hi Yulia and all,

I just have one small question for understanding what you are doing. Did 
you derive the response curve of your camera using another setup (not 
the directly visible LED) and reuse that camera response later on your 
LED captures? Or do you take the camera response from the same set of 
images (showing the LED in an otherwise dark room) that you are going to 
assemble into a HDR?

Cheers, Lars.


From ytyukhova at unomaha.edu  Fri Mar  2 09:14:15 2012
From: ytyukhova at unomaha.edu (Tyukhova, Yulia)
Date: Fri, 2 Mar 2012 11:14:15 -0600
Subject: [HDRI] HDRI capture of LED (histograms and range)
Message-ID: <CAJYAbgqzaXeEk6_x0_e=EjPkc0iUHbEyM7+KBYFWc4k7oyTz9A@mail.gmail.com>

Hello everybody!

I appreciate your help and responses.

Greg,

I've been checking histograms with CANON Digital Photo Professional. I was
checking L channel, I guess I need to make sure RGB values are below 200 as
well. Are there any suggestions on this issue?

Martin,

That is a very interesting suggestion! I guess I can see the difference
between the measurements of two light sources.

>> ..the photopic sensitivity curve V(lambda) currently used is incorrect.
It underestimates blue wavelengths quite a bit.
>> You should really use a CCD camera with a photopic filter to get better
values..

You say that V(lambda) underestimates the values. But doesn't CCD camera's
photopic filter have the same response curve? So, it would have the same
mistake.

Lars,

>> Did you derive the response curve of your camera using another setup
(not the directly visible LED) and reuse that camera response later on your LED
captures? Or do you take the camera response from the same set of images
(showing the LED in an otherwise dark room) that you are going to assemble
into a HDR?

I've tried two approaches. The first one is to derive the response curve
from the scene with very dark and bright areas with smooth gradients
and neutral colors. Then fuse them to obtain RC. And then I've used it in
photosphere for subsequent HDRIs. And the second one is to fuse raw images
with Greg's script raw2hdr, where you don't have to have response curve.
Greg: "The raw2hdr script doesn't need to derive a response curve, since
the sensor data is linear.  Instead, it creates an output from dcraw that
follows a 2.0 gamma and creates an artificial response curve of x^2 to
decode it.  This reduces quantization errors from the 8-bit intermediate
images". And then I can analyse my hdr image in Photosphere.

-- 
Thank you,
*Yulia Tyukhova*
*
*
Fulbright Scholar, "Intern LC"
Architectural Engineering Graduate Student, UNL-Omaha, NE, USA
B.E. and M.E. in Lighting Engineering (MPEI), Moscow, Russia
jtyukhova at yahoo.com
ytyukhova at unomaha.edu
+1 (402) 996 0910
PKI 247
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120302/dab69a94/attachment.html>

From gregoryjward at gmail.com  Fri Mar  2 09:25:58 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Fri, 2 Mar 2012 09:25:58 -0800
Subject: [HDRI] HDRI capture of LED (histograms and range)
In-Reply-To: <CAJYAbgqzaXeEk6_x0_e=EjPkc0iUHbEyM7+KBYFWc4k7oyTz9A@mail.gmail.com>
References: <CAJYAbgqzaXeEk6_x0_e=EjPkc0iUHbEyM7+KBYFWc4k7oyTz9A@mail.gmail.com>
Message-ID: <56135427-7137-42B8-AD80-26C7F0B4A1BB@gmail.com>

Hi Yulia,

> From: "Tyukhova, Yulia" <ytyukhova at unomaha.edu>
> Date: March 2, 2012 9:14:15 AM PST
> 
> Greg,
> 
> I've been checking histograms with CANON Digital Photo Professional. I was checking L channel, I guess I need to make sure RGB values are below 200 as well. Are there any suggestions on this issue?

Photosphere or Photoshop can give you an RGB histogram (along with max. values) from an 8-bit image.


> Martin,
> 
> That is a very interesting suggestion! I guess I can see the difference between the measurements of two light sources.
> 
> >> ..the photopic sensitivity curve V(lambda) currently used is incorrect. It underestimates blue wavelengths quite a bit. 
> >> You should really use a CCD camera with a photopic filter to get better values..
> 
> You say that V(lambda) underestimates the values. But doesn't CCD camera's photopic filter have the same response curve? So, it would have the same mistake.

Typical cameras do not follow the CIE standard observer curves for a number of reasons.  Instead, they use red, green and blue bandpass filters and a color matrix optimized for color reproduction using some set of patches.  It's an under-constrained problem, and different makers will optimize their color transform matrix differently.  This is why dcraw tends to be more reliable -- Dave Coffin always derives his CTM the same way and doesn't bias it towards one set of colors or another.

Even so, Martin is correct that highly saturated colors, such as those produced by typical LEDs, will often cause problems for reproduction and luminance estimation.  There is no easy fix for this, unfortunately.

Best,
-Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120302/2dda992a/attachment.html>

From geotrupes at mac.com  Fri Mar  2 11:50:16 2012
From: geotrupes at mac.com (giulio antonutto)
Date: Fri, 02 Mar 2012 19:50:16 +0000
Subject: [HDRI] HDRI capture of LED (histograms and range)
In-Reply-To: <F26DB3928A041843B352BA7F4307A46141AEAAADE7@EXC-MCHVS12.mch.osram.de>
References: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
	<F26DB3928A041843B352BA7F4307A46141AEAAADE7@EXC-MCHVS12.mch.osram.de>
Message-ID: <857A7966-BDDD-46C7-8B7F-7CD32D78C196@mac.com>

Another thing to note on incandescent lamps. Probably applies to none but me?.
But one thing to do is to check what is the sensitivity of your camera to the infrared.
For example the Leica M8 is well known to be extremely sensitive, to the point of requiring filters to cut UV/IR.
And this is usually visible in the black fabrics which become purple.
If so use filters or expect to measure higher luminance values when IR is present.

This also applies to the old Nikon D100 and probably other 2005ish cameras
G

 
On 2 Mar 2012, at 12:04, Moeck, Dr. Martin wrote:

> I suggest to use two parallel approaches, one with your LED, one with an incandescent low voltage. The problem with LED luminance measurements from HDRI is that a) the color gamut is small and b) the photopic sensitivity curve V(lambda) currently used is incorrect. It underestimates blue wavelengths quite a bit. Therefore, start with an incandescent first, because LEDs have a strong blue peak around 440 or 460 nm, depending on the manufacturer. You are dealing with the liumitations of V(lambda) and then with tristimulus values which are just not good enough for narrowband LEDs, including white ones with a blue peak.
>  
> When you use the incandescent instead use it in a black lab. Place a few white paper samples on the walls at different known locations. Place your incandescent at a defined location. Derive the geometry, all distances and all angles between those white papers and the lamp. Turn the incandescent on and the room lights off. Measure the luminance of the white papers at a location that you marked with a soft pencil. Make HDR images and determine the luminance and scale.
>  
> Based on the luminance values of the papers, you can now derive the luminance of the incandescent filament. Make HDR images of the filament as seen from those papers. Check if the corresponding illuminance values of the white paper at reflectance around 85% corresponds to the luminance values of the filament in that direction.
>  
> Repeat several times to give you confidence.
>  
> Once you are heading in the right direction, you can repeat the whole procedure with an LED. But this time your values will be around 20-30% off. You should really use a CCD camera with a photopic filter to get better values, and then try to come up with a procedure to minimize errors for the HDR approach.
>  
> Regards
>  
> Martin Moeck
> Osram
> From: Tyukhova, Yulia [mailto:ytyukhova at unomaha.edu] 
> Sent: Thursday, March 01, 2012 9:46 PM
> To: hdri at radiance-online.org
> Subject: [HDRI] HDRI capture of LED (histograms and range)
>  
> Hello!
>  
> I've been experimenting with the number of photos to include in final HDRI.
>  
> I took a sequence of photos of a single LED with reflectance standards included in the scene.
> EOS7D 28-105mm lens at 28mm
> F16 1/8000-1/15??
> F4   1/30-5 mins
> With the ND filter t=0.0094
> Images are fused with raw2hdr.
> They were calibrated at white reflectance standard 215 cd/m2.
> I?ve noticed the following tendency:
> If I fuse different number of photos (cut the number of photos on the shortest end), after calibrating at white reflectance standard, I get different luminance values for the LED.
> Shortest exposure to fuse             L,cd/m2
> 1/125?? f16                                   4.5*106     
> 1/250?? f16                                   9.06*106     
> 1/500?? f16                                   18*106      
>  
> I've seen interesting discussion between Axel and Greg on photos to include. But it seems like there are many uncertainties. 
>  
> In HDRI second edition book it says "The darkest exposure should have no RGB values greater than 200 or so, and the lightest exposure should have no RGB values less than 20 or so. Do NOT include an excess of exposures beyond this range, as it will do nothing to help with the response recovery and may hurt."
> I assume it is the same for any HDRI sequence, not only for response curve. 
>  
> I have plenty of photos of dark exposures that have no values greater than 200, same with the light exposures and 20.If somebody can clarify what photos should be included or have any other suggestions that would be great
> 
> Thank you,
> Yulia 
> _______________________________________________
> HDRI mailing list
> HDRI at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/hdri

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120302/c60411be/attachment-0001.html>

From gregoryjward at gmail.com  Sun Mar  4 09:45:03 2012
From: gregoryjward at gmail.com (Greg Ward)
Date: Sun, 4 Mar 2012 09:45:03 -0800
Subject: [HDRI] camera ball taking 360 degree panoramic photo
In-Reply-To: <CAD83LVKcnCTqNNwjA_6iU+jn1iQ99GC44pFfiuAdz_6kFu1-VA@mail.gmail.com>
References: <CAD83LVKcnCTqNNwjA_6iU+jn1iQ99GC44pFfiuAdz_6kFu1-VA@mail.gmail.com>
Message-ID: <973402B1-A866-4EF7-9734-B3904A3896FF@lmi.net>

Cross-posting to HDRI mailing list.  Please sign up and respond there.

Love the ball camera concept, but unless you integrate some HDR sensors, I don't see how you would do it.  Even if you could program it to take multiple shots, it would be a challenge to align and stitch them.  You would likely have to do the stitching first and alignment later, and motion blur might be a problem as well as parallax, depending on the time between shots taken near the apex of its flight.

-Greg

> From: Ji Zhang <hope.zh at gmail.com>
> Date: March 4, 2012 7:35:45 AM PST
> 
> http://jonaspfeil.de/ballcamera
> 
> The camera ball designed by Jonas Prefli can take 360 degree panoramic photo. 
> 
> I wander how this device can be utilized in daylight research if it can take HDR photos. 
> 
> - Cheers, Ji
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120304/465e7fcc/attachment.html>

From RFritz at lbl.gov  Mon Mar  5 14:32:03 2012
From: RFritz at lbl.gov (Randolph M. Fritz)
Date: Mon, 5 Mar 2012 14:32:03 -0800
Subject: [HDRI] HDR Video Camera
Message-ID: <jj3et2$8ee$1@dough.gmane.org>

Anyone seen this work?  It looks fascinating.
  http://www.hdrv.org/

They've also got a WebGL HDR viewer; you can see it in action at:
  http://www.hdrv.org/Resources.php

-- 
Randolph M. Fritz




From kallie at umn.edu  Wed Mar  7 14:16:45 2012
From: kallie at umn.edu (Chris Kallie)
Date: Wed, 07 Mar 2012 16:16:45 -0600
Subject: [HDRI] HDRI capture of LED
In-Reply-To: <76975D9C-4971-428F-B69C-BA8563DC25DA@gmail.com>
References: <CAJYAbgqVPo9E_SBCPNEkWYr3RyHQEO=NzScC33RBkvdZzYtEEA@mail.gmail.com>
	<76975D9C-4971-428F-B69C-BA8563DC25DA@gmail.com>
Message-ID: <4F57DE4D.8040203@umn.edu>

Dear All,

I would like to make use of Greg's script, but had a problem. It seems 
that either my search path for the exiftool is not checking the local 
directory, or I have to copy exiftool to the right directory, or update 
perl, but I'm not sure. My input and output is shown below. The error at 
the bottom of the snippet repeats for each image. Any advice?

Also, is there a good reason for me to create my own calibration file 
for my camera? Or is it safe to use the built-in calibration data for my 
camera?

Thanks!
Chris

GRad:~ chris$ cd Thesis/BangFilt/WardMethod/raw/B1
GRad:B1 chris$ ls
Img1310.NEF    Img1312.NEF    Img1314.NEF    Img1316.NEF    
Img1318.NEF    dcraw        hdrgen
Img1311.NEF    Img1313.NEF    Img1315.NEF    Img1317.NEF    
Img1319.NEF    exiftool    raw2hdr
GRad:B1 chris$ raw2hdr -o B1.hdr *.NEF
Loading NIKON D90 image from Img1310.NEF ...
Scaling with darkness 0, saturation 3840, and
multipliers 2.170906 1.000000 1.163172 1.000000
AHD interpolation...
Converting to sRGB colorspace...
Writing data to standard output ...
Can't locate Image/ExifTool.pm in @INC (@INC contains: ./lib 
/Library/Perl/Updates/5.10.0 
/System/Library/Perl/5.10.0/darwin-thread-multi-2level 
/System/Library/Perl/5.10.0 
/Library/Perl/5.10.0/darwin-thread-multi-2level /Library/Perl/5.10.0 
/Network/Library/Perl/5.10.0/darwin-thread-multi-2level 
/Network/Library/Perl/5.10.0 /Network/Library/Perl 
/System/Library/Perl/Extras/5.10.0/darwin-thread-multi-2level 
/System/Library/Perl/Extras/5.10.0 .) at ./exiftool line 30.
BEGIN failed--compilation aborted at ./exiftool line 30.


On 2/20/12 12:10 PM, Gregory J. Ward wrote:
>
> Photosphere does not accept camera RAW as input, but I have written a 
> Perl script that uses dcraw with the command-line HDR image builder 
> hdrgen to overcome this limitation.  It also requires the use of 
> another third-party program, exiftool, which I have packaged together 
> for you at:
>
> http://www.anyhere.com/gward/pickup/raw2hdr.tgz
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120307/3e1695ad/attachment.html>

From gregoryjward at gmail.com  Wed Mar  7 14:50:02 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Wed, 7 Mar 2012 14:50:02 -0800
Subject: [HDRI] HDRI capture of LED
In-Reply-To: <4F57DE4D.8040203@umn.edu>
References: <CAJYAbgqVPo9E_SBCPNEkWYr3RyHQEO=NzScC33RBkvdZzYtEEA@mail.gmail.com>
	<76975D9C-4971-428F-B69C-BA8563DC25DA@gmail.com>
	<4F57DE4D.8040203@umn.edu>
Message-ID: <91E2C1B7-7FBA-41E0-BA33-F0382F0FEB0A@gmail.com>

I goofed with the posted script.  You need to download and install Exiftool yourself from:

	http://www.sno.phy.queensu.ca/~phil/exiftool/install.html

I think I mentioned this in a follow-up post.  Once you have that, the script should at least urn.

-Greg

> From: Chris Kallie <kallie at umn.edu>
> Date: March 7, 2012 2:16:45 PM PST
> 
> Dear All,
> 
> I would like to make use of Greg's script, but had a problem. It seems that either my search path for the exiftool is not checking the local directory, or I have to copy exiftool to the right directory, or update perl, but I'm not sure. My input and output is shown below. The error at the bottom of the snippet repeats for each image. Any advice?
> 
> Also, is there a good reason for me to create my own calibration file for my camera? Or is it safe to use the built-in calibration data for my camera?
> 
> Thanks!
> Chris
> 
> GRad:~ chris$ cd Thesis/BangFilt/WardMethod/raw/B1
> GRad:B1 chris$ ls
> Img1310.NEF    Img1312.NEF    Img1314.NEF    Img1316.NEF    Img1318.NEF    dcraw        hdrgen
> Img1311.NEF    Img1313.NEF    Img1315.NEF    Img1317.NEF    Img1319.NEF    exiftool    raw2hdr
> GRad:B1 chris$ raw2hdr -o B1.hdr *.NEF
> Loading NIKON D90 image from Img1310.NEF ...
> Scaling with darkness 0, saturation 3840, and
> multipliers 2.170906 1.000000 1.163172 1.000000
> AHD interpolation...
> Converting to sRGB colorspace...
> Writing data to standard output ...
> Can't locate Image/ExifTool.pm in @INC (@INC contains: ./lib /Library/Perl/Updates/5.10.0 /System/Library/Perl/5.10.0/darwin-thread-multi-2level /System/Library/Perl/5.10.0 /Library/Perl/5.10.0/darwin-thread-multi-2level /Library/Perl/5.10.0 /Network/Library/Perl/5.10.0/darwin-thread-multi-2level /Network/Library/Perl/5.10.0 /Network/Library/Perl /System/Library/Perl/Extras/5.10.0/darwin-thread-multi-2level /System/Library/Perl/Extras/5.10.0 .) at ./exiftool line 30.
> BEGIN failed--compilation aborted at ./exiftool line 30.
> 
> 
> On 2/20/12 12:10 PM, Gregory J. Ward wrote:
>> 
>> 
>> Photosphere does not accept camera RAW as input, but I have written a Perl script that uses dcraw with the command-line HDR image builder hdrgen to overcome this limitation.  It also requires the use of another third-party program, exiftool, which I have packaged together for you at:
>> 
>>  http://www.anyhere.com/gward/pickup/raw2hdr.tgz
>> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120307/ec82ee4c/attachment.html>

From kallie at umn.edu  Wed Mar  7 19:53:21 2012
From: kallie at umn.edu (Chris Kallie)
Date: Wed, 07 Mar 2012 21:53:21 -0600
Subject: [HDRI] HDRI capture of LED
In-Reply-To: <91E2C1B7-7FBA-41E0-BA33-F0382F0FEB0A@gmail.com>
References: <CAJYAbgqVPo9E_SBCPNEkWYr3RyHQEO=NzScC33RBkvdZzYtEEA@mail.gmail.com>
	<76975D9C-4971-428F-B69C-BA8563DC25DA@gmail.com>
	<4F57DE4D.8040203@umn.edu>
	<91E2C1B7-7FBA-41E0-BA33-F0382F0FEB0A@gmail.com>
Message-ID: <4F582D31.5020506@umn.edu>

Thanks Greg! I am getting closer... Can I bother anyone with a few more 
questions?

1) My first attempt after installing the Unix version of exiftool showed 
this output near the end:

 >raw2hdr -o B1.hdr *.NEF
.
.
.
Loading NIKON D90 image from Img1319.NEF ...
Scaling with darkness 0, saturation 3840, and
multipliers 2.170906 1.000000 1.163172 1.000000
AHD interpolation...
Converting to sRGB colorspace...
Writing data to standard output ...
     1 image files updated
Executing: hdrgen -m 400 -e -a -r /tmp/raw2hdr.vVpbvN/sqr.rsp -o B1.hdr 
-c sRGB /tmp/raw2hdr.vVpbvN/Img1310.tif /tmp/raw2hdr.vVpbvN/Img1311.tif 
/tmp/raw2hdr.vVpbvN/Img1312.tif /tmp/raw2hdr.vVpbvN/Img1313.tif 
/tmp/raw2hdr.vVpbvN/Img1314.tif /tmp/raw2hdr.vVpbvN/Img1315.tif 
/tmp/raw2hdr.vVpbvN/Img1316.tif /tmp/raw2hdr.vVpbvN/Img1317.tif 
/tmp/raw2hdr.vVpbvN/Img1318.tif /tmp/raw2hdr.vVpbvN/Img1319.tif
phdrimg.cpp at 564>data: /tmp/raw2hdr.vVpbvN/Img1310.tif: needs exposure 
calibration
hdrgenmain.cpp at 185>data: Failure generating HDR image

2) I then dug up an old response file, and tried a few different 
permutations of the following:

 >raw2hdr hdrgen -r cama.rsp -o output.hdr *.NEF
 >raw2hdr -r cama.rsp -o output.hdr *.NEF
 >...etc..

However, I got different errors with different command orderings. I am 
sure I have a syntax/command order problem, but I am also worried that 
if/when I get it right, there will be another problem... The cama.rsp 
file I have was made from jpegs. I may have to remake this with .NEFs, 
but I am not sure how to get a .rsp file from .NEFs. Any suggestions?

3) Finally, I have a lot of Radiance/Photosphere/hdrgen creators and 
software to credit in my work. Is there a documented list for proper 
software references, or should I do my best by examining the literature?

Thanks again!
-Chris

On 3/7/12 4:50 PM, Gregory J. Ward wrote:
> I goofed with the posted script.  You need to download and install 
> Exiftool yourself from:
>
> http://www.sno.phy.queensu.ca/~phil/exiftool/install.html 
> <http://www.sno.phy.queensu.ca/%7Ephil/exiftool/install.html>
>
> I think I mentioned this in a follow-up post.  Once you have that, the 
> script should at least urn.
>
> -Greg
>
>> *From: *Chris Kallie <kallie at umn.edu <mailto:kallie at umn.edu>>
>>
>> *Date: *March 7, 2012 2:16:45 PM PST
>>
>> *
>> *
>>
>> Dear All,
>>
>> I would like to make use of Greg's script, but had a problem. It 
>> seems that either my search path for the exiftool is not checking the 
>> local directory, or I have to copy exiftool to the right directory, 
>> or update perl, but I'm not sure. My input and output is shown below. 
>> The error at the bottom of the snippet repeats for each image. Any 
>> advice?
>>
>> Also, is there a good reason for me to create my own calibration file 
>> for my camera? Or is it safe to use the built-in calibration data for 
>> my camera?
>>
>> Thanks!
>> Chris
>>
>> GRad:~ chris$ cd Thesis/BangFilt/WardMethod/raw/B1
>> GRad:B1 chris$ ls
>> Img1310.NEF    Img1312.NEF    Img1314.NEF    Img1316.NEF    
>> Img1318.NEF    dcraw        hdrgen
>> Img1311.NEF    Img1313.NEF    Img1315.NEF    Img1317.NEF    
>> Img1319.NEF    exiftool    raw2hdr
>> GRad:B1 chris$ raw2hdr -o B1.hdr *.NEF
>> Loading NIKON D90 image from Img1310.NEF ...
>> Scaling with darkness 0, saturation 3840, and
>> multipliers 2.170906 1.000000 1.163172 1.000000
>> AHD interpolation...
>> Converting to sRGB colorspace...
>> Writing data to standard output ...
>> Can't locate Image/ExifTool.pm in @INC (@INC contains: ./lib 
>> /Library/Perl/Updates/5.10.0 
>> /System/Library/Perl/5.10.0/darwin-thread-multi-2level 
>> /System/Library/Perl/5.10.0 
>> /Library/Perl/5.10.0/darwin-thread-multi-2level /Library/Perl/5.10.0 
>> /Network/Library/Perl/5.10.0/darwin-thread-multi-2level 
>> /Network/Library/Perl/5.10.0 /Network/Library/Perl 
>> /System/Library/Perl/Extras/5.10.0/darwin-thread-multi-2level 
>> /System/Library/Perl/Extras/5.10.0 .) at ./exiftool line 30.
>> BEGIN failed--compilation aborted at ./exiftool line 30.
>>
>>
>> On 2/20/12 12:10 PM, Gregory J. Ward wrote:
>>>
>>> Photosphere does not accept camera RAW as input, but I have written 
>>> a Perl script that uses dcraw with the command-line HDR image 
>>> builder hdrgen to overcome this limitation.  It also requires the 
>>> use of another third-party program, exiftool, which I have packaged 
>>> together for you at:
>>>
>>> http://www.anyhere.com/gward/pickup/raw2hdr.tgz
>>>
>
>
> _______________________________________________
> HDRI mailing list
> HDRI at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/hdri
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120307/99142ed2/attachment-0001.html>

From gregoryjward at gmail.com  Wed Mar  7 20:05:10 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Wed, 7 Mar 2012 20:05:10 -0800
Subject: [HDRI] HDRI capture of LED
In-Reply-To: <4F582D31.5020506@umn.edu>
References: <CAJYAbgqVPo9E_SBCPNEkWYr3RyHQEO=NzScC33RBkvdZzYtEEA@mail.gmail.com>
	<76975D9C-4971-428F-B69C-BA8563DC25DA@gmail.com>
	<4F57DE4D.8040203@umn.edu>
	<91E2C1B7-7FBA-41E0-BA33-F0382F0FEB0A@gmail.com>
	<4F582D31.5020506@umn.edu>
Message-ID: <6219E86B-1870-41C9-BA54-8215BA81E8C2@gmail.com>

Hi Chris,

Unfortunately, it seems that either the version of Exiftool you got isn't working right, or the input images are missing information.  You should send me a copy of one of your NEF input images in a private message and I'll have a look at it.

Using a different response function will not solve the problem.

I have not written any papers on Photosphere or hdrgen.  You'll just have to refer to the anyhere.com website, I'm afraid.

Best,
-Greg

> From: Chris Kallie <kallie at umn.edu>
> Date: March 7, 2012 7:53:21 PM PST
> 
> Thanks Greg! I am getting closer... Can I bother anyone with a few more questions?
> 
> 1) My first attempt after installing the Unix version of exiftool showed this output near the end:
> 
> >raw2hdr -o B1.hdr *.NEF
> .
> .
> .
> Loading NIKON D90 image from Img1319.NEF ...
> Scaling with darkness 0, saturation 3840, and
> multipliers 2.170906 1.000000 1.163172 1.000000
> AHD interpolation...
> Converting to sRGB colorspace...
> Writing data to standard output ...
>     1 image files updated
> Executing: hdrgen -m 400 -e -a -r /tmp/raw2hdr.vVpbvN/sqr.rsp -o B1.hdr -c sRGB /tmp/raw2hdr.vVpbvN/Img1310.tif /tmp/raw2hdr.vVpbvN/Img1311.tif /tmp/raw2hdr.vVpbvN/Img1312.tif /tmp/raw2hdr.vVpbvN/Img1313.tif /tmp/raw2hdr.vVpbvN/Img1314.tif /tmp/raw2hdr.vVpbvN/Img1315.tif /tmp/raw2hdr.vVpbvN/Img1316.tif /tmp/raw2hdr.vVpbvN/Img1317.tif /tmp/raw2hdr.vVpbvN/Img1318.tif /tmp/raw2hdr.vVpbvN/Img1319.tif
> phdrimg.cpp at 564>data: /tmp/raw2hdr.vVpbvN/Img1310.tif: needs exposure calibration
> hdrgenmain.cpp at 185>data: Failure generating HDR image
> 
> 2) I then dug up an old response file, and tried a few different permutations of the following:
> 
> >raw2hdr hdrgen -r cama.rsp -o output.hdr *.NEF
> >raw2hdr -r cama.rsp -o output.hdr *.NEF
> >...etc..
> 
> However, I got different errors with different command orderings. I am sure I have a syntax/command order problem, but I am also worried that if/when I get it right, there will be another problem... The cama.rsp file I have was made from jpegs. I may have to remake this with .NEFs, but I am not sure how to get a .rsp file from .NEFs. Any suggestions?
> 
> 3) Finally, I have a lot of Radiance/Photosphere/hdrgen creators and software to credit in my work. Is there a documented list for proper software references, or should I do my best by examining the literature?
> 
> Thanks again!
> -Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120307/66c11157/attachment.html>

From gregoryjward at gmail.com  Wed Mar  7 20:59:21 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Wed, 7 Mar 2012 20:59:21 -0800
Subject: [HDRI] Fwd:  HDRI capture of LED
References: <4F583BD0.5000700@umn.edu>
Message-ID: <13D1A6FC-D7F4-48FD-8B29-830903A8C7AB@gmail.com>

Problem solved....

> From: Chris Kallie <kallie at umn.edu>
> Date: March 7, 2012 8:55:44 PM PST
> 
> Hi Greg,
> 
> You are right about ISO 200 on the D90, and adding -ISO to the script worked! Thanks a million!!!
> 
> -Chris
> 
> On 3/7/12 10:40 PM, Gregory J. Ward wrote:
>> 
>> Hi Chris,
>> 
>> Your image was shot with a Nikon D90 with an "extended ISO" setting of 100.  This messes up dcraw a bit and it doesn't store the ISO value in the usual way.  You can avoid this problem by shooting with ISO 200, which is the lowest native sensor gain on the D90, or (I believe) by adding -ISO to the @exiftags setting near the top of the raw2hdr script.
>> 
>> Try it!
>> 
>> -Greg
>> 
>>> From: Chris Kallie <kallie at umn.edu>
>>> Date: March 7, 2012 8:15:34 PM PST
>>> 
>>> Hi Greg,
>>> 
>>> Attached is an image of a Bangerter filter with the camera pointed at a makeshift delta function. We are essentially digitizing a physical filter to convolve with regular camera and radiance hdr images. So far it has been working well, but with the recent LED discussion, I thought I'd try to improve the accuracy of the model...
>>> 
>>> Thanks for all your help! I am amazed at your dedication and responsiveness!
>>> -Chris
>>> 
>>> On 3/7/12 10:05 PM, Gregory J. Ward wrote:
>>>> 
>>>> Hi Chris,
>>>> 
>>>> Unfortunately, it seems that either the version of Exiftool you got isn't working right, or the input images are missing information.  You should send me a copy of one of your NEF input images in a private message and I'll have a look at it.
>>>> 
>>>> Using a different response function will not solve the problem.
>>>> 
>>>> I have not written any papers on Photosphere or hdrgen.  You'll just have to refer to the anyhere.com website, I'm afraid.
>>>> 
>>>> Best,
>>>> -Greg

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120307/50d60675/attachment.html>

From ytyukhova at unomaha.edu  Sun Mar 11 22:52:40 2012
From: ytyukhova at unomaha.edu (Tyukhova, Yulia)
Date: Mon, 12 Mar 2012 00:52:40 -0500
Subject: [HDRI] HDRI analysis
Message-ID: <CAJYAbgp9B44JaN5pUki-y7p-3xReGmCXCwiNdNEUZES4p0M7xw@mail.gmail.com>

Hello everybody,

I have a couple of questions on HDR image analysis.

1. How could I extract the luminance values from image.hdr?

With the pvalue tool I get RGB values. And in August 2007 thread Greg
mentioned this (to get L):
% pvalue -h -H -b render.pic \

		| rcalc -e '$1=$1;$2=$2;$3=179*$3'

But I would assume this is for .pic files. Is there a way how I can get it
from .hdr that was already calibrated in Photosphere?

2. How is a standard deviation calculated in Photosphere? What does 1.1x
mean? I would expect to see number closer to the luminance value displayed
in the image.

3. In June 2009 thread there was a discussion on averaging luminance values
withing the circular area. From anybody's experience, what is the easiest
way to get average L value from hdr image within the circle area?

Thank you for all your help,
*Yulia*
*
*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120312/32c18473/attachment.html>

From gregoryjward at gmail.com  Sun Mar 11 23:38:49 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Sun, 11 Mar 2012 23:38:49 -0700
Subject: [HDRI] HDRI analysis
In-Reply-To: <CAJYAbgp9B44JaN5pUki-y7p-3xReGmCXCwiNdNEUZES4p0M7xw@mail.gmail.com>
References: <CAJYAbgp9B44JaN5pUki-y7p-3xReGmCXCwiNdNEUZES4p0M7xw@mail.gmail.com>
Message-ID: <548C6818-0BD2-4837-A04A-6865E22E5215@gmail.com>

Hi Yulia,

1.  You need the "-o" option to pvalue, and the rest should work.  The ".pic" file is the same as the ".hdr" file produced by Photosphere, a.k.a. "Radiance RGBE format" in the "Save As..." dialog.

2.  The standard deviation for luminance is computed in the log domain, so what it gives you is a multiplier/divisor on the value rather than an absolute deviation.  In other words, one standard deviation above is 1.1x the median, and one standard deviation below is median/1.1.

3.  Averaging in a circular area is tricky and usually not worth the effort.  There aren't any luminance meters that are accurate enough about their circles to worry about the difference between a circle and a square.  If you must do it, it's a long and nasty-looking pcomb command.

Best,
-Greg

> From: "Tyukhova, Yulia" <ytyukhova at unomaha.edu>
> Date: March 11, 2012 10:52:40 PM PDT
> 
> Hello everybody,
> 
> I have a couple of questions on HDR image analysis.
> 
> 1. How could I extract the luminance values from image.hdr?
> 
> With the pvalue tool I get RGB values. And in August 2007 thread Greg mentioned this (to get L):
> % pvalue -h -H -b render.pic \
> 		| rcalc -e '$1=$1;$2=$2;$3=179*$3'
> But I would assume this is for .pic files. Is there a way how I can get it from .hdr that was already calibrated in Photosphere?
> 
> 2. How is a standard deviation calculated in Photosphere? What does 1.1x mean? I would expect to see number closer to the luminance value displayed in the image.
> 
> 3. In June 2009 thread there was a discussion on averaging luminance values withing the circular area. From anybody's experience, what is the easiest way to get average L value from hdr image within the circle area?
> 
> Thank you for all your help,
> Yulia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120311/f4d098df/attachment.html>

From purple200 at googlemail.com  Thu Mar  1 22:35:09 2012
From: purple200 at googlemail.com (purple200)
Date: Fri, 02 Mar 2012 06:35:09 -0000
Subject: [HDRI] HDRI capture of LED (histograms and range)
In-Reply-To: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
References: <CAJYAbgpbjXXqpHJYQf4GzP8xC24OBPCfeX0DEtjAkh5ULR0X5w@mail.gmail.com>
Message-ID: <CADECyjhtPvwd7Hwgxqeqx5okwApn3D=dtj-MUiJirESa=qQ_iQ@mail.gmail.com>

I suggest to use two parallel approaches, one with your LED, one with
an incandescent low voltage. The problem with LED luminance
measurements from HDRI is that a) the color gamut is small and b)
that the photopic sensitivity curve V(lambda) currently used is
incorrect. It underestimates blue wavelengths quite a bit. Therefore,
start with an incandescent first, because LEDs have a strong blue peak
around 440 or 460 nm, depending on the manufacturer. Therefore, you
have to mess with V(lambda) and then with tristimulus values which are
just not good enough for LEDs, including white ones.

When you use the incandescent instead use it in a black lab. Place a
few  white paper samples on the walls at different known locations.
Place your incandescent at a defined location. Derive the geometry,
all distances and all angles between those white papers and the lamp.
Turn the incandescent on and the room lights off. Measure the
luminance of the white papers at a location that you marked with a
soft pencil. Make HDR images and determine the luminance and scale.

Based on the luminance values of the papers, you can now derive the
luminance of the incandescent filament. Make HDR images of the
filament as seen from those papers. Check if the corresponding
illuminance values of the white paper at reflectance around 85%
corresponds to the luminance values of the filament in that direction.

Repeat several times to give you confidence.

Once you are heading in the right direction, you can repeat the whole
procedure with an LED. But this time your values will be around 20-30%
off. You should really use a CCD camera with a photopic filter to get
better values, and then try tom come up with a procedure to minimize
errors for the HDR approach.

Regards

Martin Moeck
Osram





On Thu, Mar 1, 2012 at 9:46 PM, Tyukhova, Yulia <ytyukhova at unomaha.edu> wrote:
> Hello!
>
> I've been experimenting with the number of photos to include in final HDRI.
>
> I took a sequence of photos of a single LED with reflectance standards
> included in the scene.
>
> EOS7D 28-105mm lens at 28mm
>
> F16 1/8000-1/15??
>
> F4?? 1/30-5 mins
>
> With the ND filter t=0.0094
>
> Images are fused with raw2hdr.
>
> They were calibrated at white reflectance standard 215 cd/m2.
>
> I?ve noticed the following tendency:
>
> If I fuse different number of photos (cut the number of photos on the
> shortest end), after calibrating at white reflectance standard, I get
> different luminance values for the LED.
>
> Shortest exposure to fuse? ? ? ? ? ? ?L,cd/m2
>
> 1/125?? f16?????????????????????????????????? 4.5*106
>
> 1/250?? f16?????????????????????????????????? 9.06*106
>
> 1/500?? f16?????????????????????????????????? 18*106
>
>
> I've seen interesting discussion between Axel and Greg on photos to include.
> But it seems like there are many uncertainties.
>
> In HDRI second edition book it says "The darkest exposure should have no RGB
> values greater than 200 or so, and the lightest exposure should have no RGB
> values less than 20 or so. Do NOT include an excess of exposures beyond this
> range, as it will do nothing to help with the response recovery and may
> hurt."
> I assume it is the same for any HDRI sequence, not only for response curve.
>
> I have plenty of photos of dark exposures that have no values greater than
> 200, same with the light?exposures?and 20.If somebody can clarify what
> photos should be included or have any other suggestions that would be great
>
> Thank you,
> Yulia
>
> _______________________________________________
> HDRI mailing list
> HDRI at radiance-online.org
> http://www.radiance-online.org/mailman/listinfo/hdri
>


From chris at coolshadow.com  Thu Mar 22 10:18:25 2012
From: chris at coolshadow.com (Humann Chris)
Date: Thu, 22 Mar 2012 10:18:25 -0700
Subject: [HDRI] HDRgen - Nikon D50 exposure calibration
Message-ID: <2F74DC0F-B5B3-4FEB-AD0E-7232F45534B5@coolshadow.com>

Dear all,

I've had good success using  Greg's  HDRgen program on several  
different cameras however when I try generating an HDR from jpgs taken  
with my Nikon D50 I get the following error:

phdrimg.cpp at 560>data: DSC_3043.JPG: needs exposure calibration
hdrgenmain.cpp at 123>data: Failure generating HDR image

DSC_3043.JPG is the first image in the series and,  if I exclude it,  
HDRgen throws the same error on the next, following image.

The command I'm using is:
hdrgen -o test.hdr -r nikon_D50.rsp *.JPG

FWIW I can generate the HDR image in Photosphere

Has anyone stumbled on this and come across a solution?

Thanks and best regards to all,
Chris


Christian Humann ~ Associate
LOISOS + UBBELOHDE
- - - - - - - - - - - - - - - - - - - - - - - - - - -
1917 Clement Avenue  Building 10A
Alameda, CA  94501 USA
- - - - - - - - - - - - - - - - - - - - - - - - - - -
510 521 3800 VOICE
510 521 3820 FAX
- - - - - - - - - - - - - - - - - - - - - - - - - - -
www.coolshadow.com



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.radiance-online.org/pipermail/hdri/attachments/20120322/d6d40d9e/attachment.html>

From gregoryjward at gmail.com  Thu Mar 22 10:37:32 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Thu, 22 Mar 2012 10:37:32 -0700
Subject: [HDRI] HDRgen - Nikon D50 exposure calibration
In-Reply-To: <2F74DC0F-B5B3-4FEB-AD0E-7232F45534B5@coolshadow.com>
References: <2F74DC0F-B5B3-4FEB-AD0E-7232F45534B5@coolshadow.com>
Message-ID: <2A4A7067-4767-4A39-8BBE-CBAC55D96B8C@gmail.com>

Sorry for the reposting of old messages -- that was me.  I was behind on clearing out the "junk" queue for the mailing list.

This error is probably due to using an "extended ISO" setting on the camera.  Try bumping the ISO up from the lowest setting and seeing if that fixes it.

Cheers,
-Greg

> From: Humann Chris <chris at coolshadow.com>
> Date: March 22, 2012 10:18:25 AM PDT
> 
> Dear all,
> 
> I've had good success using  Greg's  HDRgen program on several different cameras however when I try generating an HDR from jpgs taken with my Nikon D50 I get the following error:
> 
> phdrimg.cpp at 560>data: DSC_3043.JPG: needs exposure calibration
> hdrgenmain.cpp at 123>data: Failure generating HDR image
> 
> DSC_3043.JPG is the first image in the series and,  if I exclude it, HDRgen throws the same error on the next, following image.
>  
> The command I'm using is:
> hdrgen -o test.hdr -r nikon_D50.rsp *.JPG
> 
> FWIW I can generate the HDR image in Photosphere
> 
> Has anyone stumbled on this and come across a solution? 
> 
> Thanks and best regards to all,
> Chris


From chris at coolshadow.com  Fri Mar 23 12:22:46 2012
From: chris at coolshadow.com (Chris Humann)
Date: Fri, 23 Mar 2012 12:22:46 -0700
Subject: [HDRI] HDR brightness values change after image manipulation with
	pcompos and pfilt
Message-ID: <EB450FA8-C1E6-45B1-93C4-D6AB84AEE23B@coolshadow.com>

Dear list,

I would like to both scale down the resolution and crop a circular  
fisheye HDR photograph of the skyvault using the following commands to  
do so but can't figure why I'm getting slight changes in brightness  
values.

The max brightness of the original HDR image is:
==>  pextrem -o 11:58:00.hdr  | rcalc -e '$1=($3+$4+$5)/3*179'
2.23350842
49393.2719

When I crop the fisheye image horizontally to bound the circular  
fisheye view evenly in the x and y dimension with:
==> ra_xyze -r -o -u 11:58:00.hdr | pcompos -o -x 3744 - -936 0 >  
11:58:00_crop.hdr

I get a higher max value and the EXPOSURE header disappears from the  
file:

==>  pextrem -o 11:58:00_crop.hdr  | rcalc -e '$1=($3+$4+$5)/3*179'
1.88461284
49702.3333

Then when I scale the image down:

==> pfilt -1 -e 1 -x /4 -y /4 11:58:00_crop.hdr >  
11:58:00_crop_scale.hdr

I get a lower value:

==>  pextrem -o 11:58:00_crop_scale.hdr  | rcalc -e '$1=($3+$4+$5)/ 
3*179'
4.05328376
48270.3333

If I perform the scaling operation first the EXPOSURE header remains  
but the value is still lower:

==>  pextrem -o 11:58:00_scale.hdr  | rcalc -e '$1=($3+$4+$5)/3*179'
2.59250175
48056.5119


Any thoughts on what I might be doing wrong?


As always, thanks!

Chris






From gregoryjward at gmail.com  Fri Mar 23 12:40:20 2012
From: gregoryjward at gmail.com (Gregory J. Ward)
Date: Fri, 23 Mar 2012 12:40:20 -0700
Subject: [HDRI] HDR brightness values change after image manipulation
	with pcompos and pfilt
In-Reply-To: <EB450FA8-C1E6-45B1-93C4-D6AB84AEE23B@coolshadow.com>
References: <EB450FA8-C1E6-45B1-93C4-D6AB84AEE23B@coolshadow.com>
Message-ID: <EDDA8737-F0AA-4320-BC82-80C64C505F1D@gmail.com>

Hi Chris,

The -o option to ra_xyze should eliminate the exposure line, so pcompos shouldn't mess up the values.  (I don't think you want to use the pcompos '-o' option, which specifies an anchor offset and isn't used correctly in your command.)

The pextrem command gives you the absolute brightest and darkest pixel, whose values will change with filtering as everything gets averaged with its neighbors.  Cropping the image can also affect the extrema, since they may have lived in the pixels you cropped out.  Slight changes on the order of 1% can be explained just by scaling RGBE image values, whose accuracy is no better than this.

Best,
-Greg

> From: Chris Humann <chris at coolshadow.com>
> Date: March 23, 2012 12:22:46 PM PDT
> 
> Dear list,
> 
> I would like to both scale down the resolution and crop a circular fisheye HDR photograph of the skyvault using the following commands to do so but can't figure why I'm getting slight changes in brightness values.
> 
> The max brightness of the original HDR image is:
> ==>  pextrem -o 11:58:00.hdr  | rcalc -e '$1=($3+$4+$5)/3*179'
> 2.23350842
> 49393.2719
> 
> When I crop the fisheye image horizontally to bound the circular fisheye view evenly in the x and y dimension with:
> ==> ra_xyze -r -o -u 11:58:00.hdr | pcompos -o -x 3744 - -936 0 > 11:58:00_crop.hdr
> 
> I get a higher max value and the EXPOSURE header disappears from the file:
> 
> ==>  pextrem -o 11:58:00_crop.hdr  | rcalc -e '$1=($3+$4+$5)/3*179'
> 1.88461284
> 49702.3333
> 
> Then when I scale the image down:
> 
> ==> pfilt -1 -e 1 -x /4 -y /4 11:58:00_crop.hdr > 11:58:00_crop_scale.hdr
> 
> I get a lower value:
> 
> ==>  pextrem -o 11:58:00_crop_scale.hdr  | rcalc -e '$1=($3+$4+$5)/3*179'
> 4.05328376
> 48270.3333
> 
> If I perform the scaling operation first the EXPOSURE header remains but the value is still lower:
> 
> ==>  pextrem -o 11:58:00_scale.hdr  | rcalc -e '$1=($3+$4+$5)/3*179'
> 2.59250175
> 48056.5119
> 
> 
> Any thoughts on what I might be doing wrong?
> 
> 
> As always, thanks!
> 
> Chris


